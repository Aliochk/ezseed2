/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*!
 * classie - class helper functions
 * from bonzo https://github.com/ded/bonzo
 * 
 * classie.has( elem, 'my-class' ) -> true/false
 * classie.add( elem, 'my-new-class' )
 * classie.remove( elem, 'my-unwanted-class' )
 * classie.toggle( elem, 'my-class' )
 */

/*!
 * getStyleProperty v1.0.3
 * original by kangax
 * http://perfectionkills.com/feature-testing-css-properties/
 */

/*!
 * eventie v1.0.3
 * event binding helper
 *   eventie.bind( elem, 'click', myFn )
 *   eventie.unbind( elem, 'click', myFn )
 */

/*!
 * docReady
 * Cross browser DOMContentLoaded event emitter
 */

/*!
 * EventEmitter v4.2.5 - git.io/ee
 * Oliver Caldwell
 * MIT license
 * @preserve
 */

/*!
 * Outlayer v1.1.8
 * the brains and guts of a layout library
 */

/*!
 * Packery v1.1.2
 * bin-packing layout library
 * http://packery.metafizzy.co
 *
 * Commercial use requires one-time purchase of a commercial license
 * http://packery.metafizzy.co/license.html
 *
 * Non-commercial use is licensed under the GPL v3 License
 *
 * Copyright 2013 Metafizzy
 */

/*!
 * imagesLoaded v3.0.4
 * JavaScript is all like "You images are done yet or what?"
 */

//     Underscore.js 1.5.2
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */

/*! alertify - v0.3.11 - 2013-10-08 */

/*
 * Collapse plugin for jQuery
 * --
 * source: http://github.com/danielstocks/jQuery-Collapse/
 * site: http://webcloud.se/jQuery-Collapse
 *
 * @author Daniel Stocks (http://webcloud.se)
 * Copyright 2013, Daniel Stocks
 * Released under the MIT, BSD, and GPL Licenses.
 */

/*
 * Storage for jQuery Collapse
 * --
 * source: http://github.com/danielstocks/jQuery-Collapse/
 * site: http://webcloud.se/jQuery-Collapse
 *
 * @author Daniel Stocks (http://webcloud.se)
 * Copyright 2013, Daniel Stocks
 * Released under the MIT, BSD, and GPL Licenses.
 */

/*!
 * jquery.customSelect() - v0.4.1
 * http://adam.co/lab/jquery/customselect/
 * 2013-05-13
 *
 * Copyright 2013 Adam Coulombe
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 * @license http://www.gnu.org/licenses/gpl.html GPL2 License 
 */

function DGAuroraPlayer(t,e){this.player=t,this.ui=e,e.seekTime=0,e.duration=0,e.bufferProgress=0;var i,n,r,a,s,o,l,u;e.on("play",i=function(){t.play(),e.state="playing"}),e.on("pause",n=function(){t.pause(),e.state="paused"}),e.on("volume",r=function(e){t.volume=e}),t.on("buffer",s=function(t){e.bufferProgress=t}),t.on("progress",o=function(t){e.seekTime=t}),t.on("duration",l=function(t){e.duration=t}),t.on("metadata",u=function(t){e.songTitle=t.title,e.album=t,e.coverArt=e.current.picture?e.current.picture:t.coverArt?t.coverArt.toBlobURL():UNKNOWN_ART});e.fileDescription;t.on("error",onerror=function(t){console.log(t),e.state="paused",e.duration=0,e.bufferProgress=0,e.seekTime=0,e.coverArt=UNKNOWN_ART,e.songTitle="Unknown Title",e.songArtist="Unknown Artist"}),t.volume=e.volume,t.play(),e.state="playing",this.disconnect=function(){t&&t.stop(),e.off("play",i),e.off("pause",n),e.off("volume",r),t.off("buffer",s),t.off("format",a),t.off("progress",o),t.off("duration",l),t.off("metadata",u)}}function DGPlayer(t){function e(t){if(i[t])for(var e=Array.prototype.slice.call(arguments,1),n=i[t],r=0,a=n.length;a>r;r++)n[r].apply(null,e)}var i={},n="paused";t.onselectstart=function(){return!1};var r=function(){function i(t){return("00"+t).slice(-2)}var n=t.querySelector(".seek .track .loaded"),r=t.querySelector(".seek .track .progress"),a=t.querySelector(".seek span:first-child"),s=t.querySelector(".seek span:last-child"),o=n.parentNode.offsetWidth-2,l=0,u=0,c=0,f=0;return{getTrackLength:function(){return c},setTrackLength:function(t){c=t,this.seekTime=u},getCurrentTime:function(){return u},setCurrentTime:function(t){f=Math.floor(u/1e3%60),u=t,u>=c&&c>0&&(e("pause"),e("trackends"));var n=u/1e3,l=Math.floor(n%60),h=Math.floor((n/=60)%60);if(l!==f)if(a.innerHTML=h+":"+i(l),c>0){var d=(c-u)/1e3,p=Math.floor(d%60),m=Math.floor((d/=60)%60);s.innerHTML="-"+m+":"+i(p),position=Math.max(0,Math.min(1,u/c)),r.style.width=o*position+"px"}else s.innerHTML="-0:00"},getAmountLoaded:function(){return l},setAmountLoaded:function(t){l=Math.max(0,Math.min(100,t)),n.style.width=o*(l/100)+"px"}}}(),a=function(){function i(t){(a=t)?(r.classList.remove("entypo-play"),r.classList.add("entypo-pause")):(r.classList.remove("entypo-pause"),r.classList.add("entypo-play"))}var n=t.querySelector(".button"),r=n.querySelector("i"),a=!1;return n.onclick=function(){e(a?"pause":"play")},t.addEventListener("keyup",function(t){32===t.which&&e(a?"pause":"play")}),{setPlaying:i,getPlaying:function(){return a}}}(),s=function(){function i(t){"webkitTransform"in s.style?s.style.webkitTransform="translate3d("+m+"px,0, 0)":s.style.left=m+"px",o.style.width=m+"px",v=Math.round((m-d)/(p-d)*100),t||e("volume",v)}function n(t){var e=t.targetTouches?t.targetTouches[0].pageX:t.clientX,n=Math.max(d,Math.min(p,m+e-u));c&&n!==m&&(m=n,u=e,i())}function r(){c&&(c=!1,s.classList.remove("active"))}function a(){s.classList.add("animatable"),o.classList.add("animatable"),i(),setTimeout(function(){s.classList.remove("animatable"),o.classList.remove("animatable")},250)}var s=t.querySelector(".volume .handle"),o=t.querySelector(".volume .progress"),l=t.querySelector(".volume .track");volumeLeft=t.querySelector(".volume img:last-child"),volumeRight=t.querySelector(".volume img:first-child");var u=0,c=!1,f=70,h=20,d=0,p=f-h/2-3,m=Math.floor(f/2-h/2),v=50;return i(),s.onmousedown=s.ontouchstart=function(t){u=t.targetTouches?t.targetTouches[0].pageX:t.clientX,c=!0,t.stopPropagation(),s.classList.add("active"),t.preventDefault()},document.addEventListener("mousemove",n,!1),document.addEventListener("touchmove",n,!1),document.addEventListener("mouseup",r,!1),document.addEventListener("touchend",r,!1),volumeLeft.onclick=function(){m=p,a()},volumeRight.onclick=function(){m=d,a()},l.onmousedown=l.ontouchstart=function(t){for(var e=t.targetTouches?t.targetTouches[0].pageX:t.clientX,n=0,r=l;r;)n+=r.offsetLeft,r=r.offsetParent;m=Math.max(d,Math.min(p,e-n-(h+d))),s.onmousedown(t),i()},{getValue:function(){return v},setValue:function(t){t=Math.max(0,Math.min(100,t)),curY=p-t/100*(p-d),i(!0)}}}(),o={on:function(t,e){i[t]||(i[t]=[]),i[t].push(e)},off:function(t,e){var n=i[t],r=n.indexOf(e);~r&&n.splice(r,1)}};Object.defineProperty||(Object.defineProperty=function(t,e,i){i.get&&t.__defineGetter__&&t.__defineGetter__(e,i.get),i.set&&t.__defineSetter__&&t.__defineSetter__(e,i.set)}),Object.defineProperty(o,"bufferProgress",{get:r.getAmountLoaded,set:r.setAmountLoaded}),Object.defineProperty(o,"state",{set:function(t){a.setPlaying("playing"==t||"buffering"==t),n=t},get:function(){return n}}),Object.defineProperty(o,"duration",{get:r.getTrackLength,set:r.setTrackLength}),Object.defineProperty(o,"seekTime",{get:r.getCurrentTime,set:r.setCurrentTime}),Object.defineProperty(o,"volume",{get:s.getValue,set:s.setValue});var l=t.querySelector(".avatar img");Object.defineProperty(o,"coverArt",{get:function(){return l.src},set:function(t){l.src=t}});var u=t.querySelector("span.title"),c=t.querySelector("span.artist");Object.defineProperty(o,"songTitle",{get:function(){return u.innerHTML},set:function(t){u.innerHTML=t}}),Object.defineProperty(o,"songArtist",{get:function(){return c.innerHTML},set:function(t){c.innerHTML=t}});var f,h,d=[],p=!1,m=t.querySelector("#playlist"),v=function(t){t.preventDefault();var i=t.target.parentElement.dataset.no,n=m.querySelector("li.active");n&&n.classList.remove("active"),t.target.parentElement.classList.add("active"),o.current=i,e("playlist")},y=function(){var t=m.querySelector("li.active");t&&t.classList.remove("active"),d.length&&m.querySelector("li[data-no='"+h+"']").classList.add("active")},g=function(){var i=t.querySelector(".button-prev"),n=t.querySelector(".button-next"),r=t.querySelector(".button-playlist"),a="<ol><% for(var i in songs) {  var song = songs[i];%><li data-no='<%= i %>'><a href=''><%= song.name %></a></li><% } %></ol>",s=function(){for(var t=m.querySelectorAll("li"),e=0;e<t.length;e++)t[e].onclick=v;p=!0};return o.on("play",y),o.on("trackends",function(){var t=o.current;o.current=h+1<d.length?h+1:h,o.current==t?e("pause"):(y(),e("playlist"))}),i.onclick=function(){o.current=h-1>=0?h-1:h,y(),e("playlist")},n.onclick=function(){o.current=h+1<d.length?h+1:h,y(),e("playlist")},r.onclick=function(){this.classList.toggle("active"),m.classList.toggle("show")},{getValue:function(){return d},setValue:function(t){var i=d.length;d=_.union(d,t),m.innerHTML=_.template(a,{songs:d}),s(),0!==i&&d.length>i?(h=i,f=d[h],e("playlist")):i==d.length||(h=0,f=d[h]),y()}}}();Object.defineProperty(o,"playlist",{get:g.getValue,set:g.setValue});var b={artist:null,album:null,picture:null};return Object.defineProperty(o,"album",{get:function(){return album},set:function(t){t=_.extend(b,t),b=t,o.songArtist=t.artist&&t.album?t.artist+" - "+t.album:t.artist&&!t.album?t.artist:t.album,t.picture&&(o.coverArt=t.picture),t.songs&&(o.playlist=t.songs)}}),Object.defineProperty(o,"current",{get:function(){return f},set:function(t){h=t,f=d[t]}}),Object.defineProperty(o,"addSong",{get:function(){return!1},set:function(t){d.push(t);var e=d.length-1,i="<li data-no='<%= i %>'><a href=''><%= song.name %></a></li>",n=document.createElement("div");n.innerHTML=_.template(i,{i:e,song:t}),n=n.firstChild,n.onclick=v,m.querySelector("ol").appendChild(n),delete n}}),Object.defineProperty(o,"removeSong",{get:function(){return!1},set:function(t){if(d[t]){f==d[t]&&e("pause"),d.splice(t,1);var i=m.querySelector("li[data-no='"+t+"']");i.removeEventListener("click",v),m.querySelector("ol").removeChild(i);var n=m.querySelectorAll("ol > li");for(var r in n)n[r].dataset&&(n[r].dataset.no=r)}else console.error("Song doesn't exist")}}),o}define("text",["module"],function(t){var e,i,n,r,a,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,c=u&&location.protocol&&location.protocol.replace(/\:/,""),f=u&&location.hostname,h=u&&(location.port||void 0),d={},p=t.config&&t.config()||{};return e={version:"2.0.10",strip:function(t){if(t){t=t.replace(o,"");var e=t.match(l);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var t,e,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;3>e;e+=1){i=s[e];try{t=new ActiveXObject(i)}catch(n){}if(t){s=[i];break}}return t},parseName:function(t){var e,i,n,r=!1,a=t.indexOf("."),s=0===t.indexOf("./")||0===t.indexOf("../");return-1!==a&&(!s||a>1)?(e=t.substring(0,a),i=t.substring(a+1,t.length)):e=t,n=i||e,a=n.indexOf("!"),-1!==a&&(r="strip"===n.substring(a+1),n=n.substring(0,a),i?i=n:e=n),{moduleName:e,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,r){var a,s,o,l=e.xdRegExp.exec(t);return l?(a=l[2],s=l[3],s=s.split(":"),o=s[1],s=s[0],!(a&&a!==i||s&&s.toLowerCase()!==n.toLowerCase()||(o||s)&&o!==r)):!0},finishLoad:function(t,i,n,r){n=i?e.strip(n):n,p.isBuild&&(d[t]=n),r(n)},load:function(t,i,n,r){if(r.isBuild&&!r.inlineText)return n(),void 0;p.isBuild=r.isBuild;var a=e.parseName(t),s=a.moduleName+(a.ext?"."+a.ext:""),o=i.toUrl(s),l=p.useXhr||e.useXhr;return 0===o.indexOf("empty:")?(n(),void 0):(!u||l(o,c,f,h)?e.get(o,function(i){e.finishLoad(t,a.strip,i,n)},function(t){n.error&&n.error(t)}):i([s],function(t){e.finishLoad(a.moduleName+"."+a.ext,a.strip,t,n)}),void 0)},write:function(t,i,n){if(d.hasOwnProperty(i)){var r=e.jsEscape(d[i]);n.asModule(t+"!"+i,"define(function () { return '"+r+"';});\n")}},writeFile:function(t,i,n,r,a){var s=e.parseName(i),o=s.ext?"."+s.ext:"",l=s.moduleName+o,u=n.toUrl(s.moduleName+o)+".js";e.load(l,n,function(){var i=function(t){return r(u,t)};i.asModule=function(t,e){return r.asModule(t,u,e)},e.write(t,l,i,a)},a)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),e.get=function(t,e,n){try{var r=i.readFileSync(t,"utf8");0===r.indexOf("﻿")&&(r=r.substring(1)),e(r)}catch(a){n(a)}}):"xhr"===p.env||!p.env&&e.createXhr()?e.get=function(t,i,n,r){var a,s=e.createXhr();if(s.open("GET",t,!0),r)for(a in r)r.hasOwnProperty(a)&&s.setRequestHeader(a.toLowerCase(),r[a]);p.onXhr&&p.onXhr(s,t),s.onreadystatechange=function(){var e,r;4===s.readyState&&(e=s.status,e>399&&600>e?(r=new Error(t+" HTTP status: "+e),r.xhr=s,n(r)):i(s.responseText),p.onXhrComplete&&p.onXhrComplete(s,t))},s.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,e){var i,n,r="utf-8",a=new java.io.File(t),s=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),r)),l="";try{for(i=new java.lang.StringBuffer,n=o.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=o.readLine());)i.append(s),i.append(n);l=String(i.toString())}finally{o.close()}e(l)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in n,e.get=function(t,e){var i,s,o,l={};a&&(t=t.replace(/\//g,"\\")),o=new FileUtils.File(t);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),i.init(o,1,0,!1),s=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),s.init(i,"utf-8",i.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(i.available(),l),s.close(),i.close(),e(l.value)}catch(u){throw new Error((o&&o.path||"")+": "+u)}}),e}),define("text!../views/albums.ejs",[],function(){return'<%\nalbums.forEach(function(album) {\n\n	album.title = \'\';\n	album.title += (album.artist !== undefined && album.artist !== null) ? album.artist : \'\';\n	album.title += (album.album !== undefined && album.album !== null) ? \' - \' + album.album : \'\';\n	if(album.title.length == 0) {\n		var t = album.prevDir.split(\'/\');\n		t = t[t.length-1];\n\n		album.title += t;\n	}\n	if(album.songs.length > 1) {\n		var tailleDossier = 0;\n\n		for(var i = 0; i < album.songs.length; i++) {\n			tailleDossier += parseFloat(album.songs[i].size);\n		}\n\n	}\n	%>\n	<div data-id="<%- album._id %>" class="element list audio clearfix" data-date-added="<%- new Date(album.dateAdded).getTime() %>">\n		<div class="pullLeft">\n			<a href="#/listen/<%- album._id %>" title="Écouter" class="listen">\n				<div class="cover">\n					<div class="cover-hover">\n						<i class="entypo-play"></i>\n					</div>\n					<% if(album.picture == undefined || album.picture === null) {%>\n						<img src="/images/cover/audio.png" />\n					<% } else { %>\n						<img src="<%- album.picture %>" />\n					<% } %>\n				</div>\n			</a>\n		</div>\n		<div class="list-infos">\n			<h1 class="league-gothic"><%- album.title %></h1>\n\n			<div class="button-group">\n				<a href="#/listen/<%- album._id %>" title="Écouter" class="listen">\n					<i class="entypo-note-beamed"></i>\n				</a>\n				<% if(album.songs.length > 1) {%>\n				<a href="/archive/<%- album._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n				<% } else {%>\n				<a href="/download/<%- album._id %>" title="Télécharger">\n				<% } %>\n					<i class="entypo-download"></i>\n				</a>\n				<a href="/delete/album/<%- album._id %>" class="delete-item" title="Supprimer">\n					<i class="entypo-trash"></i>\n				</a>\n				<a href="#" class="reset-item" title="Enlever de la base de données (il reviens)" data-type="album">\n					<i class="entypo-cancel"></i>\n				</a>\n			</div>\n\n			<hr />\n			<p class="infos">\n				<% if(!_.isEmpty(album.artist)) { %>\n					Artiste : <%- album.artist %><br />\n				<% } %>\n				<% if(!_.isEmpty(album.album)) { %>\n					Album : <%- album.album %><br />\n				<% } %>\n\n				<% if(!_.isEmpty(album.genre)) { %>\n					Genre : <%- album.genre %><br />\n				<% } %>\n\n				<% if(!_.isEmpty(album.year)) { %>\n					Année : <%- album.year %><br />\n				<% } %>\n			</p>\n\n		</div>\n\n		<% if(album.songs.length) { %>\n			<div class="showFiles">\n				<i class="entypo-attach"></i>Fichiers\n			</div>\n			<div class="files">\n				<table>\n					<thead>\n						<tr><th>#</th><th>Nom</th><th>Poids</th></tr>\n					</thead>\n					<tbody>\n						<%	\n						var i = 1, songs, hasDiscs = false;\n\n						if(album.songs[0].disc !== undefined) {\n							songs = _.groupBy(album.songs, function(e) { return e.disc; });\n							hasDiscs = true;\n						} else\n							songs = [album.songs];\n\n\n						_.each(songs, function(disk, i) {\n							songs[i] = disk.sort(function(a, b) {\n								if (a.name == b.name)\n							        return 0;\n							    else if (a.name > b.name)\n							        return 1;\n							   	else\n								    return -1;\n							});\n						});\n\n\n						_.each(songs, function(disc, noDisc) {\n							if(hasDiscs) {\n								%>\n								<tr>\n									<td colspan="3" style="text-align:center">Disque n°<%= noDisc %></td>\n								</tr>\n								<%\n							}\n\n							_.each(disc, function(file) {\n						%>\n							<tr>\n								<td><%- i %></td>\n								<td style="text-align:left"><a href="/download/<%- album._id %>/<%- file._id%>"><%- file.name %></a></td>\n								<td><%- bytesToSize(file.size) %></td>\n							</tr>			\n						<% \n								i++;\n							});\n							i = 1;\n							\n						}); \n						%>\n					</tbody>\n					<tfoot>\n						<tr>\n						<td colspan="2" style="text-align:left">Taille totale : <%- bytesToSize(tailleDossier) %></td>\n						<td>\n							<a href="/archive/<%- album._id %>" data-full-size="<%- tailleDossier %>" class="archive">Télécharger le dossier</a>\n						</td>\n						</tr>\n					</tfoot>\n				</table>\n			</div>\n		<% } %>\n	</div>\n	<div data-id="<%- album._id %>" class="element miniature audio clearfix" data-date-added="<%- new Date(album.dateAdded).getTime() %>">\n		<div class="titre"><h1 class="league-gothic" title="<%- album.title %>"><%- album.title %></h1></div>\n\n		<a href="#/listen/<%- album._id %>" title="Écouter" class="listen">\n			<% if(album.picture == undefined || album.picture === null) {%>\n				<img src="/images/cover/audio.png" />\n			<% } else { %>\n				<img src="<%- album.picture %>" />\n			<% } %>\n		</a>\n	</div>\n	<div data-id="<%- album._id %>" class="element table audio" data-date-added="<%- new Date(album.dateAdded).getTime() %>">\n		<i class="entypo-music"></i>\n		<a href="#/listen/<%- album._id %>" title="Écouter" class="listen table-link">\n			<%- album.title %>\n		</a>\n		<div class="button-group">\n			<a href="#/listen/<%- album._id %>" title="Écouter" class="listen">\n				<i class="entypo-note-beamed"></i>\n			</a>\n			<% if(album.songs.length > 1) {%>\n			<a href="/archive/<%- album._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n			<% } else {%>\n			<a href="/download/<%- album._id %>" title="Télécharger">\n			<% } %>\n				<i class="entypo-download"></i>\n			</a>\n			<a href="/delete/album/<%- album._id %>" class="delete-item" title="Supprimer">\n				<i class="entypo-trash"></i>\n			</a>\n		</div>\n	</div>\n<%\n});\n%>'}),define("text!../views/movies.ejs",[],function(){return'<%\nmovies.forEach(function(movie) {\n	var tailleDossier = 0;\n\n	if(movie.videos.length > 1)\n		for(var i = 0; i < movie.videos.length; i++)\n			tailleDossier += parseFloat(movie.videos[i].size);\n\n%>\n	<div data-id="<%- movie._id %>" class="element list video clearfix" data-date-added="<%- new Date(movie.dateAdded).getTime() %>">\n		<div class="pullLeft">\n			<a href="/watch/<%- movie._id %>" title="Visionner">\n				<div class="cover">\n					<div class="cover-hover">\n						<i class="entypo-play"></i>\n					</div>\n					<% if(movie.infos.picture == undefined) {%>\n						<img src="/images/cover/video.png" />\n					<% } else { %>\n						<img src="<%- movie.infos.picture %>" />\n					<% } %>\n				</div>\n			</a>\n		</div>\n		<div class="list-infos">\n			<h1 class="league-gothic"><%- movie.infos.title %><% if(movie.infos.season != undefined) { %> - S<%- movie.infos.season%><% if(movie.videos[0].episode != undefined && movie.videos.length <= 1) { %>E<%- movie.videos[0].episode%><% } } %></h1>\n\n			<div class="button-group">\n				<a href="/watch/<%- movie._id %>" title="Visionner">\n					<i class="entypo-eye"></i>\n				</a>\n\n				<% if(movie.videos.length > 1 ) { %>\n				<a href="/archive/<%- movie._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n				<% } else {%>\n				<a href="/download/<%- movie._id %>" title="Télécharger">\n				<% } %>\n					<i class="entypo-download"></i>\n				</a>\n\n				<a href="/delete/movie/<%- movie._id %>" class="delete-item" title="Supprimer">\n					<i class="entypo-trash"></i>\n				</a>\n\n				<a href="#" class="reset-item" title="Enlever de la base de données (il reviens)" data-type="movie">\n					<i class="entypo-cancel"></i>\n				</a>\n			</div>\n\n			<hr />\n			<p class="infos">\n				<%- movie.infos.synopsis %><br>\n				<% if(movie.infos.trailer != undefined) { %>\n					<a href="<%- movie.infos.trailer %>" target="_blank">Voir le trailer</a>\n				<% } %>\n			</p>\n\n			<% if(movie.quality != undefined && movie.quality.length > 0) { %>\n				<p class="info"><i class="entypo-monitor"></i><%- movie.quality %></p>\n			<% } %>\n			<% if(movie.format != undefined && movie.format.length > 0) { %>\n				<p class="info"><i class="entypo-doc-landscape"></i><%- movie.format %></p>\n			<% } %>\n			<% if(movie.language != undefined && movie.language.length > 0) { %>\n				<p class="info"><i class="entypo-sound"></i><%- movie.language %></p>\n			<% } %>\n			<% if(movie.subtitles != undefined && movie.subtitles.length > 0) { %>\n				<p class="info"><i class="entypo-text-doc"></i><%- movie.subtitles %></p>\n			<% } %>\n\n			<% if(movie.audio != undefined && movie.audio.length > 0 ) { %>\n				<p class="info"><i class="entypo-sound"></i><%- movie.audio %></p>\n			<% } %>\n\n		</div>\n		<% if(movie.videos.length > 1) { %>\n			<div class="showFiles">\n				<i class="entypo-attach"></i><% if(movie.type == \'tvseries\') { %>Episodes<%} else {%>Fichiers<%}%>\n			</div>\n			<div class="files">\n				<table>\n					<thead>\n						<tr><th>#</th><th>Nom</th><th>Poids</th><th>Options</th></tr>\n					</thead>\n					<tbody>\n						<%	var i = 1;\n\n						if(movie.movieType == "tvseries") {\n							movie.videos.sort(function (a, b) {\n								if(a.episode == b.episode)\n									return 0;\n								else if(a.episode > b.episode)\n									return 1;\n\n								return -1;\n							});\n						} else {\n							movie.videos.sort(function (a, b) {\n							    if (a.name == b.name) {\n							        return 0;\n							    } else if (a.name > b.name) {\n							        return 1;\n							    }\n							    return -1;\n							});\n						}\n\n						movie.videos.forEach(function(file) {\n						%>\n						<tr data-id="<%if(file.episode !== undefined){%><%-file._id%><%} %>">\n							<td><%- i %></td>\n							<td class="file_name" style="text-align:left"><%- file.name %> <%= (file.episode !== null && file.episode.length) ? \'- E\' + file.episode : \'\' %></td>\n							<td><%- bytesToSize(file.size) %></td>\n							<td>\n								<a href="/download/<%-movie._id%>/<%-file._id%>"><i class="entypo-download"></i></a>\n								<a href="/watch/<%-movie._id%>/<%-file._id%>"><i class="entypo-eye"></i></a>\n							</td>\n						</tr>			\n						<% \n							i++;\n						}); \n						%>\n					</tbody>\n					<tfoot>\n						<tr>\n							<% if(movie.videos[0].episode === null ) { %> \n								<td colspan="3" style="text-align:left">Taille totale : <%- bytesToSize(tailleDossier) %></td>\n								<td>\n									<a href="/archive/<%- movie._id %>" data-full-size="<%- tailleDossier %>" class="archive">Télécharger le dossier</a>\n								</td>\n							<% } %>\n						</tr>\n					</tfoot>\n				</table>\n			</div>\n		<% } %>\n	</div>\n	<div data-id="<%- movie._id %>" class="element miniature video" data-date-added="<%- new Date(movie.dateAdded).getTime() %>">\n		<div class="titre"><h1 class="league-gothic"><%- movie.infos.title %><% if(movie.infos.season != undefined) { %> - S<%- movie.infos.season%><% if(movie.videos[0].episode != undefined && movie.videos.length <= 1) { %>E<%- movie.videos[0].episode%><% } } %></h1></div>\n	\n		<a href="/watch/<%- movie._id %>">\n 			<% if(movie.infos.picture == undefined) {%>\n				<img src="/images/cover/video.png" />\n			<% } else { %>\n				<img src="<%- movie.infos.picture %>" />\n			<% } %>\n		</a>\n	</div>\n	<div data-id="<%- movie._id %>" class="element table video" data-date-added="<%- new Date(movie.dateAdded).getTime() %>">\n		<i class="entypo-video"></i>\n\n		<a href="/watch/<%- movie._id %>" class="table-link">\n			<%- movie.infos.title %><% if(movie.infos.season != undefined) { %> - S<%- movie.infos.season%><% if(movie.videos[0].episode != undefined && movie.videos.length <= 1) { %>E<%- movie.videos[0].episode%><% } } %>\n		</a>\n\n		<div class="button-group">\n			<a href="/watch/<%- movie._id %>" title="Visionner">\n				<i class="entypo-eye"></i>\n			</a>\n\n			<% if(movie.videos.length > 1 ) { %>\n			<a href="/archive/<%- movie._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n			<% } else {%>\n			<a href="/download/<%- movie._id %>" title="Télécharger">\n			<% } %>\n				<i class="entypo-download"></i>\n			</a>\n\n			<a href="/delete/movie/<%- movie._id %>" class="delete-item" title="Supprimer">\n				<i class="entypo-trash"></i>\n			</a>\n		</div>\n	</div>\n<%\n});\n%>'}),define("text!../views/others.ejs",[],function(){return'<%\nothers.forEach(function(other) {\n\n	if(other.files.length > 1) {\n		var tailleDossier = 0;\n\n		for(var i = 0; i < other.files.length; i++) {\n			tailleDossier += parseFloat(other.files[i].size);\n		}\n\n	}\n%>\n	<div data-id="<%- other._id %>" class="element list other clearfix" data-date-added="<%- new Date(other.dateAdded).getTime() %>">\n		<div class="pullLeft">\n			<% if(other.files.length > 1) {%>\n			<a href="/archive/<%- other._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n			<% } else {%>\n			<a href="/download/<%- other._id %>" title="Télécharger">\n			<% } %>\n				<div class="cover">\n					<div class="cover-hover">\n						<i class="entypo-play"></i>\n					</div>\n					<img src="/images/cover/other.png" />\n				</div>\n			</a>\n		</div>\n		<div class="list-infos">\n			<h1 class="league-gothic"><%- other.name %></h1>\n			<div class="button-group">\n				<% if(other.files.length > 1) {%>\n				<a href="/archive/<%- other._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n				<% } else {%>\n				<a href="/download/<%- other._id %>" title="Télécharger">\n				<% } %>\n					<i class="entypo-download"></i>\n				</a>\n\n				<a href="/delete/other/<%- other._id %>" class="delete-item" title="Supprimer">\n					<i class="entypo-trash"></i>\n				</a>\n\n				<a href="#" class="reset-item" title="Enlever de la base de données (il reviens)" data-type="other">\n					<i class="entypo-cancel"></i>\n				</a>\n			</div>\n			<hr />\n			<p class="infos">\n				<% if(other.files) {%>\n				Type : <%- other.files[0].type %> <br />\n					<% if(other.files.length == 1) { %>\n					Taille : <%- bytesToSize(other.files[0].size) %>\n					<% } else { %>\n					Taille : <%- bytesToSize(tailleDossier) %>\n					<% } %>\n				<% } %>\n			</p>\n		</div>\n		<% if(other.files.length > 1) { %>\n			<div class="showFiles">\n				<i class="entypo-attach"></i>Fichiers\n			</div>\n			<div class="files">\n				<table>\n					<thead>\n						<tr><th>#</th><th>Nom</th><th>Poids</th><th>Options</th></tr>\n					</thead>\n					<tbody>\n						<%	var i = 1;\n						other.files.sort(function (a, b) {\n						    if (a.name == b.name) {\n						        return 0;\n						    } else if (a.name > b.name) {\n						        return 1;\n						    }\n						    return -1;\n						});\n\n						other.files.forEach(function(file) {\n						%>\n						<tr>\n							<td><%- i %></td>\n							<td style="text-align:left"><%- file.name %></td>\n							<td><%- bytesToSize(file.size) %></td>\n							<td><a href="/download/<%-other._id%>/<%-file._id%>"><i class="entypo-download"></i></a></td>\n						</tr>			\n						<% \n							i++;\n						}); \n						%>\n					</tbody>\n					<tfoot>\n						<tr>\n							<td colspan="3" style="text-align:left">Taille totale : <%- bytesToSize(tailleDossier) %></td>\n							<td>\n								<a href="/archive/<%- other._id %>" data-full-size="<%- tailleDossier %>" class="archive">Télécharger le dossier</a>\n							</td>\n						</tr>\n					</tfoot>\n				</table>\n			</div>\n		<% } %>\n	</div>\n	<div data-id="<%- other._id %>" class="element miniature other clearfix" data-date-added="<%- new Date(other.dateAdded).getTime() %>">\n		<div class="titre"><h1 class="league-gothic" title="<%- other.name %>"><%- other.name %></h1></div>\n		<% if(other.files.length > 1) {%>\n		<a href="/archive/<%- other._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n		<% } else {%>\n		<a href="/download/<%- other._id %>" title="Télécharger">\n		<% } %>\n			<img src="/images/cover/other.png" />\n		</a>\n	</div>\n	<div data-id="<%- other._id %>" class="element table other" data-date-added="<%- new Date(other.dateAdded).getTime() %>">\n		<i class="entypo-box"></i> \n		<a href="/download/<%- other._id %>" class="table-link" title="Télécharger">\n			<%- other.name %>\n		</a>\n		<div class="button-group">\n			<% if(other.files.length > 1) {%>\n			<a href="/archive/<%- other._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n			<% } else {%>\n			<a href="/download/<%- other._id %>" title="Télécharger">\n			<% } %>\n				<i class="entypo-download"></i>\n			</a>\n\n			<a href="/delete/other/<%- other._id %>" class="delete-item" title="Supprimer">\n				<i class="entypo-trash"></i>\n			</a>\n		</div>\n	</div>\n	<%\n	});\n	%>'}),function(t){function e(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")}function i(t,e){var i=n(t,e)?a:r;i(t,e)}var n,r,a;"classList"in document.documentElement?(n=function(t,e){return t.classList.contains(e)},r=function(t,e){t.classList.add(e)},a=function(t,e){t.classList.remove(e)}):(n=function(t,i){return e(i).test(t.className)},r=function(t,e){n(t,e)||(t.className=t.className+" "+e)},a=function(t,i){t.className=t.className.replace(e(i)," ")});var s={hasClass:n,addClass:r,removeClass:a,toggleClass:i,has:n,add:r,remove:a,toggle:i};"function"==typeof define&&define.amd?define("classie/classie",s):t.classie=s}(window),function(t){function e(t){if(t){if("string"==typeof n[t])return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var e,r=0,a=i.length;a>r;r++)if(e=i[r]+t,"string"==typeof n[e])return e}}var i="Webkit Moz ms Ms O".split(" "),n=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return e}):"object"==typeof exports?module.exports=e:t.getStyleProperty=e}(window),function(t){function e(t){var e=parseFloat(t),i=-1===t.indexOf("%")&&!isNaN(e);return i&&e}function i(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0,i=o.length;i>e;e++){var n=o[e];t[n]=0}return t}function n(t){function n(t){if("string"==typeof t&&(t=document.querySelector(t)),t&&"object"==typeof t&&t.nodeType){var n=s(t);if("none"===n.display)return i();var a={};a.width=t.offsetWidth,a.height=t.offsetHeight;for(var c=a.isBorderBox=!(!u||!n[u]||"border-box"!==n[u]),f=0,h=o.length;h>f;f++){var d=o[f],p=n[d];p=r(t,p);var m=parseFloat(p);a[d]=isNaN(m)?0:m}var v=a.paddingLeft+a.paddingRight,y=a.paddingTop+a.paddingBottom,g=a.marginLeft+a.marginRight,b=a.marginTop+a.marginBottom,w=a.borderLeftWidth+a.borderRightWidth,k=a.borderTopWidth+a.borderBottomWidth,_=c&&l,T=e(n.width);T!==!1&&(a.width=T+(_?0:v+w));var I=e(n.height);return I!==!1&&(a.height=I+(_?0:y+k)),a.innerWidth=a.width-(v+w),a.innerHeight=a.height-(y+k),a.outerWidth=a.width+g,a.outerHeight=a.height+b,a}}function r(t,e){if(a||-1===e.indexOf("%"))return e;var i=t.style,n=i.left,r=t.runtimeStyle,s=r&&r.left;return s&&(r.left=t.currentStyle.left),i.left=e,e=i.pixelLeft,i.left=n,s&&(r.left=s),e}var l,u=t("boxSizing");return function(){if(u){var t=document.createElement("div");t.style.width="200px",t.style.padding="1px 2px 3px 4px",t.style.borderStyle="solid",t.style.borderWidth="1px 2px 3px 4px",t.style[u]="border-box";var i=document.body||document.documentElement;i.appendChild(t);var n=s(t);l=200===e(n.width),i.removeChild(t)}}(),n}var r=document.defaultView,a=r&&r.getComputedStyle,s=a?function(t){return r.getComputedStyle(t,null)}:function(t){return t.currentStyle},o=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],n):"object"==typeof exports?module.exports=n(require("get-style-property")):t.getSize=n(t.getStyleProperty)}(window),function(t){var e=document.documentElement,i=function(){};e.addEventListener?i=function(t,e,i){t.addEventListener(e,i,!1)}:e.attachEvent&&(i=function(e,i,n){e[i+n]=n.handleEvent?function(){var e=t.event;e.target=e.target||e.srcElement,n.handleEvent.call(n,e)}:function(){var i=t.event;i.target=i.target||i.srcElement,n.call(e,i)},e.attachEvent("on"+i,e[i+n])});var n=function(){};e.removeEventListener?n=function(t,e,i){t.removeEventListener(e,i,!1)}:e.detachEvent&&(n=function(t,e,i){t.detachEvent("on"+e,t[e+i]);
try{delete t[e+i]}catch(n){t[e+i]=void 0}});var r={bind:i,unbind:n};"function"==typeof define&&define.amd?define("eventie/eventie",r):t.eventie=r}(this),function(t){function e(t){"function"==typeof t&&(e.isReady?t():a.push(t))}function i(t){var i="readystatechange"===t.type&&"complete"!==r.readyState;if(!e.isReady&&!i){e.isReady=!0;for(var n=0,s=a.length;s>n;n++){var o=a[n];o()}}}function n(n){return n.bind(r,"DOMContentLoaded",i),n.bind(r,"readystatechange",i),n.bind(t,"load",i),e}var r=t.document,a=[];e.isReady=!1,"function"==typeof define&&define.amd?(e.isReady="function"==typeof requirejs,define("doc-ready/doc-ready",["eventie/eventie"],n)):t.docReady=n(t.eventie)}(this),function(){function t(){}function e(t,e){for(var i=t.length;i--;)if(t[i].listener===e)return i;return-1}function i(t){return function(){return this[t].apply(this,arguments)}}var n=t.prototype,r=this,a=r.EventEmitter;n.getListeners=function(t){var e,i,n=this._getEvents();if("object"==typeof t){e={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(e[i]=n[i])}else e=n[t]||(n[t]=[]);return e},n.flattenListeners=function(t){var e,i=[];for(e=0;e<t.length;e+=1)i.push(t[e].listener);return i},n.getListenersAsObject=function(t){var e,i=this.getListeners(t);return i instanceof Array&&(e={},e[t]=i),e||i},n.addListener=function(t,i){var n,r=this.getListenersAsObject(t),a="object"==typeof i;for(n in r)r.hasOwnProperty(n)&&-1===e(r[n],i)&&r[n].push(a?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(t){return this.getListeners(t),this},n.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},n.removeListener=function(t,i){var n,r,a=this.getListenersAsObject(t);for(r in a)a.hasOwnProperty(r)&&(n=e(a[r],i),-1!==n&&a[r].splice(n,1));return this},n.off=i("removeListener"),n.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},n.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},n.manipulateListeners=function(t,e,i){var n,r,a=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(n=i.length;n--;)a.call(this,e,i[n]);else for(n in e)e.hasOwnProperty(n)&&(r=e[n])&&("function"==typeof r?a.call(this,n,r):s.call(this,n,r));return this},n.removeEvent=function(t){var e,i=typeof t,n=this._getEvents();if("string"===i)delete n[t];else if("object"===i)for(e in n)n.hasOwnProperty(e)&&t.test(e)&&delete n[e];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(t,e){var i,n,r,a,s=this.getListenersAsObject(t);for(r in s)if(s.hasOwnProperty(r))for(n=s[r].length;n--;)i=s[r][n],i.once===!0&&this.removeListener(t,i.listener),a=i.listener.apply(this,e||[]),a===this._getOnceReturnValue()&&this.removeListener(t,i.listener);return this},n.trigger=i("emitEvent"),n.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},n.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return r.EventEmitter=a,t},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t}.call(this),function(t,e){function i(t,e){return t[o](e)}function n(t){if(!t.parentNode){var e=document.createDocumentFragment();e.appendChild(t)}}function r(t,e){n(t);for(var i=t.parentNode.querySelectorAll(e),r=0,a=i.length;a>r;r++)if(i[r]===t)return!0;return!1}function a(t,e){return n(t),i(t,e)}var s,o=function(){if(e.matchesSelector)return"matchesSelector";for(var t=["webkit","moz","ms","o"],i=0,n=t.length;n>i;i++){var r=t[i],a=r+"MatchesSelector";if(e[a])return a}}();if(o){var l=document.createElement("div"),u=i(l,"div");s=u?i:a}else s=r;"function"==typeof define&&define.amd?define("matches-selector/matches-selector",[],function(){return s}):window.matchesSelector=s}(this,Element.prototype),function(t){function e(t,e){for(var i in e)t[i]=e[i];return t}function i(t){for(var e in t)return!1;return e=null,!0}function n(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}function r(t,r,a){function o(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}var l=a("transition"),u=a("transform"),c=l&&u,f=!!a("perspective"),h={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[l],d=["transform","transition","transitionDuration","transitionProperty"],p=function(){for(var t={},e=0,i=d.length;i>e;e++){var n=d[e],r=a(n);r&&r!==n&&(t[n]=r)}return t}();e(o.prototype,t.prototype),o.prototype._create=function(){this._transition={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},o.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},o.prototype.getSize=function(){this.size=r(this.element)},o.prototype.css=function(t){var e=this.element.style;for(var i in t){var n=p[i]||i;e[n]=t[i]}},o.prototype.getPosition=function(){var t=s(this.element),e=this.layout.options,i=e.isOriginLeft,n=e.isOriginTop,r=parseInt(t[i?"left":"right"],10),a=parseInt(t[n?"top":"bottom"],10);r=isNaN(r)?0:r,a=isNaN(a)?0:a;var o=this.layout.size;r-=i?o.paddingLeft:o.paddingRight,a-=n?o.paddingTop:o.paddingBottom,this.position.x=r,this.position.y=a},o.prototype.layoutPosition=function(){var t=this.layout.size,e=this.layout.options,i={};e.isOriginLeft?(i.left=this.position.x+t.paddingLeft+"px",i.right=""):(i.right=this.position.x+t.paddingRight+"px",i.left=""),e.isOriginTop?(i.top=this.position.y+t.paddingTop+"px",i.bottom=""):(i.bottom=this.position.y+t.paddingBottom+"px",i.top=""),this.css(i),this.emitEvent("layout",[this])};var m=f?function(t,e){return"translate3d("+t+"px, "+e+"px, 0)"}:function(t,e){return"translate("+t+"px, "+e+"px)"};o.prototype._transitionTo=function(t,e){this.getPosition();var i=this.position.x,n=this.position.y,r=parseInt(t,10),a=parseInt(e,10),s=r===this.position.x&&a===this.position.y;if(this.setPosition(t,e),s&&!this.isTransitioning)return this.layoutPosition(),void 0;var o=t-i,l=e-n,u={},c=this.layout.options;o=c.isOriginLeft?o:-o,l=c.isOriginTop?l:-l,u.transform=m(o,l),this.transition({to:u,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})},o.prototype.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},o.prototype.moveTo=c?o.prototype._transitionTo:o.prototype.goTo,o.prototype.setPosition=function(t,e){this.position.x=parseInt(t,10),this.position.y=parseInt(e,10)},o.prototype._nonTransition=function(t){this.css(t.to),t.isCleaning&&this._removeStyles(t.to);for(var e in t.onTransitionEnd)t.onTransitionEnd[e].call(this)},o.prototype._transition=function(t){if(!parseFloat(this.layout.options.transitionDuration))return this._nonTransition(t),void 0;var e=this._transition;for(var i in t.onTransitionEnd)e.onEnd[i]=t.onTransitionEnd[i];for(i in t.to)e.ingProperties[i]=!0,t.isCleaning&&(e.clean[i]=!0);if(t.from){this.css(t.from);var n=this.element.offsetHeight;n=null}this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0};var v=u&&n(u)+",opacity";o.prototype.enableTransition=function(){this.isTransitioning||(this.css({transitionProperty:v,transitionDuration:this.layout.options.transitionDuration}),this.element.addEventListener(h,this,!1))},o.prototype.transition=o.prototype[l?"_transition":"_nonTransition"],o.prototype.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},o.prototype.onotransitionend=function(t){this.ontransitionend(t)};var y={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"};o.prototype.ontransitionend=function(t){if(t.target===this.element){var e=this._transition,n=y[t.propertyName]||t.propertyName;if(delete e.ingProperties[n],i(e.ingProperties)&&this.disableTransition(),n in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[n]),n in e.onEnd){var r=e.onEnd[n];r.call(this),delete e.onEnd[n]}this.emitEvent("transitionEnd",[this])}},o.prototype.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(h,this,!1),this.isTransitioning=!1},o.prototype._removeStyles=function(t){var e={};for(var i in t)e[i]="";this.css(e)};var g={transitionProperty:"",transitionDuration:""};return o.prototype.removeTransitionStyles=function(){this.css(g)},o.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element),this.emitEvent("remove",[this])},o.prototype.remove=function(){if(!l||!parseFloat(this.layout.options.transitionDuration))return this.removeElem(),void 0;var t=this;this.on("transitionEnd",function(){return t.removeElem(),!0}),this.hide()},o.prototype.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options;this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0})},o.prototype.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options;this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:{opacity:function(){this.css({display:"none"})}}})},o.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},o}var a=document.defaultView,s=a&&a.getComputedStyle?function(t){return a.getComputedStyle(t,null)}:function(t){return t.currentStyle};"function"==typeof define&&define.amd?define("outlayer/item",["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property"],r):(t.Outlayer={},t.Outlayer.Item=r(t.EventEmitter,t.getSize,t.getStyleProperty))}(window),function(t){function e(t,e){for(var i in e)t[i]=e[i];return t}function i(t){return"[object Array]"===f.call(t)}function n(t){var e=[];if(i(t))e=t;else if(t&&"number"==typeof t.length)for(var n=0,r=t.length;r>n;n++)e.push(t[n]);else e.push(t);return e}function r(t,e){var i=d(e,t);-1!==i&&e.splice(i,1)}function a(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()}function s(i,s,f,d,p,m){function v(t,i){if("string"==typeof t&&(t=o.querySelector(t)),!t||!h(t))return l&&l.error("Bad "+this.settings.namespace+" element: "+t),void 0;this.element=t,this.options=e({},this.options),this.option(i);var n=++g;this.element.outlayerGUID=n,b[n]=this,this._create(),this.options.isInitLayout&&this.layout()}function y(t,i){t.prototype[i]=e({},v.prototype[i])}var g=0,b={};return v.prototype.settings={namespace:"outlayer",item:m},v.prototype.options={containerStyle:{position:"relative"},isInitLayout:!0,isOriginLeft:!0,isOriginTop:!0,isResizeBound:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}},e(v.prototype,f.prototype),v.prototype.option=function(t){e(this.options,t)},v.prototype._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),e(this.element.style,this.options.containerStyle),this.options.isResizeBound&&this.bindResize()},v.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)},v.prototype._itemize=function(t){for(var e=this._filterFindItemElements(t),i=this.settings.item,n=[],r=0,a=e.length;a>r;r++){var s=e[r],o=new i(s,this);n.push(o)}return n},v.prototype._filterFindItemElements=function(t){t=n(t);for(var e=this.options.itemSelector,i=[],r=0,a=t.length;a>r;r++){var s=t[r];if(h(s))if(e){p(s,e)&&i.push(s);for(var o=s.querySelectorAll(e),l=0,u=o.length;u>l;l++)i.push(o[l])}else i.push(s)}return i},v.prototype.getItemElements=function(){for(var t=[],e=0,i=this.items.length;i>e;e++)t.push(this.items[e].element);return t},v.prototype.layout=function(){this._resetLayout(),this._manageStamps();var t=void 0!==this.options.isLayoutInstant?this.options.isLayoutInstant:!this._isLayoutInited;this.layoutItems(this.items,t),this._isLayoutInited=!0},v.prototype._init=v.prototype.layout,v.prototype._resetLayout=function(){this.getSize()},v.prototype.getSize=function(){this.size=d(this.element)},v.prototype._getMeasurement=function(t,e){var i,n=this.options[t];n?("string"==typeof n?i=this.element.querySelector(n):h(n)&&(i=n),this[t]=i?d(i)[e]:n):this[t]=0},v.prototype.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},v.prototype._getItemsForLayout=function(t){for(var e=[],i=0,n=t.length;n>i;i++){var r=t[i];r.isIgnored||e.push(r)}return e},v.prototype._layoutItems=function(t,e){if(!t||!t.length)return this.emitEvent("layoutComplete",[this,t]),void 0;this._itemsOn(t,"layout",function(){this.emitEvent("layoutComplete",[this,t])});for(var i=[],n=0,r=t.length;r>n;n++){var a=t[n],s=this._getItemLayoutPosition(a);s.item=a,s.isInstant=e,i.push(s)}this._processLayoutQueue(i)},v.prototype._getItemLayoutPosition=function(){return{x:0,y:0}},v.prototype._processLayoutQueue=function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];this._positionItem(n.item,n.x,n.y,n.isInstant)}},v.prototype._positionItem=function(t,e,i,n){n?t.goTo(e,i):t.moveTo(e,i)},v.prototype._postLayout=function(){var t=this._getContainerSize();t&&(this._setContainerMeasure(t.width,!0),this._setContainerMeasure(t.height,!1))},v.prototype._getContainerSize=c,v.prototype._setContainerMeasure=function(t,e){if(void 0!==t){var i=this.size;i.isBorderBox&&(t+=e?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},v.prototype._itemsOn=function(t,e,i){function n(){return r++,r===a&&i.call(s),!0}for(var r=0,a=t.length,s=this,o=0,l=t.length;l>o;o++){var u=t[o];u.on(e,n)}},v.prototype.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},v.prototype.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},v.prototype.stamp=function(t){if(t=this._find(t)){this.stamps=this.stamps.concat(t);for(var e=0,i=t.length;i>e;e++){var n=t[e];this.ignore(n)}}},v.prototype.unstamp=function(t){if(t=this._find(t))for(var e=0,i=t.length;i>e;e++){var n=t[e];r(n,this.stamps),this.unignore(n)}},v.prototype._find=function(t){return t?("string"==typeof t&&(t=this.element.querySelectorAll(t)),t=n(t)):void 0},v.prototype._manageStamps=function(){if(this.stamps&&this.stamps.length){this._getBoundingRect();for(var t=0,e=this.stamps.length;e>t;t++){var i=this.stamps[t];this._manageStamp(i)}}},v.prototype._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},v.prototype._manageStamp=c,v.prototype._getElementOffset=function(t){var e=t.getBoundingClientRect(),i=this._boundingRect,n=d(t),r={left:e.left-i.left-n.marginLeft,top:e.top-i.top-n.marginTop,right:i.right-e.right-n.marginRight,bottom:i.bottom-e.bottom-n.marginBottom};return r},v.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},v.prototype.bindResize=function(){this.isResizeBound||(i.bind(t,"resize",this),this.isResizeBound=!0)},v.prototype.unbindResize=function(){i.unbind(t,"resize",this),this.isResizeBound=!1},v.prototype.onresize=function(){function t(){e.resize(),delete e.resizeTimeout}this.resizeTimeout&&clearTimeout(this.resizeTimeout);var e=this;this.resizeTimeout=setTimeout(t,100)},v.prototype.resize=function(){var t=d(this.element),e=this.size&&t;e&&t.innerWidth===this.size.innerWidth||this.layout()},v.prototype.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},v.prototype.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},v.prototype.prepended=function(t){var e=this._itemize(t);if(e.length){var i=this.items.slice(0);this.items=e.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(i)}},v.prototype.reveal=function(t){if(t&&t.length)for(var e=0,i=t.length;i>e;e++){var n=t[e];n.reveal()}},v.prototype.hide=function(t){if(t&&t.length)for(var e=0,i=t.length;i>e;e++){var n=t[e];n.hide()}},v.prototype.getItem=function(t){for(var e=0,i=this.items.length;i>e;e++){var n=this.items[e];if(n.element===t)return n}},v.prototype.getItems=function(t){if(t&&t.length){for(var e=[],i=0,n=t.length;n>i;i++){var r=t[i],a=this.getItem(r);a&&e.push(a)}return e}},v.prototype.remove=function(t){t=n(t);var e=this.getItems(t);if(e&&e.length){this._itemsOn(e,"remove",function(){this.emitEvent("removeComplete",[this,e])});for(var i=0,a=e.length;a>i;i++){var s=e[i];s.remove(),r(s,this.items)}}},v.prototype.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="";for(var e=0,i=this.items.length;i>e;e++){var n=this.items[e];n.destroy()}this.unbindResize(),delete this.element.outlayerGUID,u&&u.removeData(this.element,this.settings.namespace)},v.data=function(t){var e=t&&t.outlayerGUID;return e&&b[e]},v.create=function(t,i){function n(){v.apply(this,arguments)}return e(n.prototype,v.prototype),y(n,"options"),y(n,"settings"),e(n.prototype.options,i),n.prototype.settings.namespace=t,n.data=v.data,n.Item=function(){m.apply(this,arguments)},n.Item.prototype=new m,n.prototype.settings.item=n.Item,s(function(){for(var e=a(t),i=o.querySelectorAll(".js-"+e),r="data-"+e+"-options",s=0,c=i.length;c>s;s++){var f,h=i[s],d=h.getAttribute(r);try{f=d&&JSON.parse(d)}catch(p){l&&l.error("Error parsing "+r+" on "+h.nodeName.toLowerCase()+(h.id?"#"+h.id:"")+": "+p);continue}var m=new n(h,f);u&&u.data(h,t,m)}}),u&&u.bridget&&u.bridget(t,n),n},v.Item=m,v}var o=t.document,l=t.console,u=t.jQuery,c=function(){},f=Object.prototype.toString,h="object"==typeof HTMLElement?function(t){return t instanceof HTMLElement}:function(t){return t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName},d=Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1};"function"==typeof define&&define.amd?define("outlayer/outlayer",["eventie/eventie","doc-ready/doc-ready","eventEmitter/EventEmitter","get-size/get-size","matches-selector/matches-selector","./item"],s):t.Outlayer=s(t.eventie,t.docReady,t.EventEmitter,t.getSize,t.matchesSelector,t.Outlayer.Item)}(window),function(t){function e(){function t(e){for(var i in t.defaults)this[i]=t.defaults[i];for(i in e)this[i]=e[i]}return i.Rect=t,t.defaults={x:0,y:0,width:0,height:0},t.prototype.contains=function(t){var e=t.width||0,i=t.height||0;return this.x<=t.x&&this.y<=t.y&&this.x+this.width>=t.x+e&&this.y+this.height>=t.y+i},t.prototype.overlaps=function(t){var e=this.x+this.width,i=this.y+this.height,n=t.x+t.width,r=t.y+t.height;return this.x<n&&e>t.x&&this.y<r&&i>t.y},t.prototype.getMaximalFreeRects=function(e){if(!this.overlaps(e))return!1;var i,n=[],r=this.x+this.width,a=this.y+this.height,s=e.x+e.width,o=e.y+e.height;return this.y<e.y&&(i=new t({x:this.x,y:this.y,width:this.width,height:e.y-this.y}),n.push(i)),r>s&&(i=new t({x:s,y:this.y,width:r-s,height:this.height}),n.push(i)),a>o&&(i=new t({x:this.x,y:o,width:this.width,height:a-o}),n.push(i)),this.x<e.x&&(i=new t({x:this.x,y:this.y,width:e.x-this.x,height:this.height}),n.push(i)),n},t.prototype.canFit=function(t){return this.width>=t.width&&this.height>=t.height},t}var i=t.Packery=function(){};"function"==typeof define&&define.amd?define("packery/rect",e):(t.Packery=t.Packery||{},t.Packery.Rect=e())}(window),function(t){function e(t){function e(t,e){this.width=t||0,this.height=e||0,this.reset()}return e.prototype.reset=function(){this.spaces=[],this.newSpaces=[];var e=new t({x:0,y:0,width:this.width,height:this.height});this.spaces.push(e)},e.prototype.pack=function(t){for(var e=0,i=this.spaces.length;i>e;e++){var n=this.spaces[e];if(n.canFit(t)){this.placeInSpace(t,n);break}}},e.prototype.placeInSpace=function(t,e){t.x=e.x,t.y=e.y,this.placed(t)},e.prototype.placed=function(t){for(var i=[],n=0,r=this.spaces.length;r>n;n++){var a=this.spaces[n],s=a.getMaximalFreeRects(t);s?i.push.apply(i,s):i.push(a)}this.spaces=i,e.mergeRects(this.spaces),this.spaces.sort(e.spaceSorterTopLeft)},e.mergeRects=function(t){for(var e=0,i=t.length;i>e;e++){var n=t[e];if(n){var r=t.slice(0);r.splice(e,1);for(var a=0,s=0,o=r.length;o>s;s++){var l=r[s],u=e>s?0:1;n.contains(l)&&(t.splice(s+u-a,1),a++)}}}return t},e.spaceSorterTopLeft=function(t,e){return t.y-e.y||t.x-e.x},e.spaceSorterLeftTop=function(t,e){return t.x-e.x||t.y-e.y},e}if("function"==typeof define&&define.amd)define("packery/packer",["./rect"],e);else{var i=t.Packery=t.Packery||{};i.Packer=e(i.Rect)}}(window),function(t){function e(t,e,i){var n=t("transform"),r=function(){e.Item.apply(this,arguments)};r.prototype=new e.Item;var a=r.prototype._create;return r.prototype._create=function(){a.call(this),this.rect=new i,this.placeRect=new i},r.prototype.dragStart=function(){this.getPosition(),this.removeTransitionStyles(),this.isTransitioning&&n&&(this.element.style[n]="none"),this.getSize(),this.isPlacing=!0,this.needsPositioning=!1,this.positionPlaceRect(this.position.x,this.position.y),this.isTransitioning=!1,this.didDrag=!1},r.prototype.dragMove=function(t,e){this.didDrag=!0;var i=this.layout.size;t-=i.paddingLeft,e-=i.paddingTop,this.positionPlaceRect(t,e)},r.prototype.dragStop=function(){this.getPosition();var t=this.position.x!==this.placeRect.x,e=this.position.y!==this.placeRect.y;this.needsPositioning=t||e,this.didDrag=!1},r.prototype.positionPlaceRect=function(t,e,i){this.placeRect.x=this.getPlaceRectCoord(t,!0),this.placeRect.y=this.getPlaceRectCoord(e,!1,i)},r.prototype.getPlaceRectCoord=function(t,e,i){var n=e?"Width":"Height",r=this.size["outer"+n],a=this.layout[e?"columnWidth":"rowHeight"],s=this.layout.size["inner"+n];e||(s=Math.max(s,this.layout.maxY),this.layout.rowHeight||(s-=this.layout.gutter));var o;if(a){a+=this.layout.gutter,s+=e?this.layout.gutter:0,t=Math.round(t/a);var l=Math[e?"floor":"ceil"](s/a);l-=Math.ceil(r/a),o=l}else o=s-r;return t=i?t:Math.min(t,o),t*=a||1,Math.max(0,t)},r.prototype.copyPlaceRectPosition=function(){this.rect.x=this.placeRect.x,this.rect.y=this.placeRect.y},r}"function"==typeof define&&define.amd?define("packery/item",["get-style-property/get-style-property","outlayer/outlayer","./rect"],e):t.Packery.Item=e(t.getStyleProperty,t.Outlayer,t.Packery.Rect)}(window),function(t){function e(t,e,i,n,r,a){var s=i.create("packery");return s.Item=s.prototype.settings.item=a,s.prototype._create=function(){i.prototype._create.call(this),this.packer=new r,this.stamp(this.options.stamped);var t=this;this.handleDraggabilly={dragStart:function(e){t.itemDragStart(e.element)},dragMove:function(e){t.itemDragMove(e.element,e.position.x,e.position.y)},dragEnd:function(e){t.itemDragEnd(e.element)}},this.handleUIDraggable={start:function(e){t.itemDragStart(e.currentTarget)},drag:function(e,i){t.itemDragMove(e.currentTarget,i.position.left,i.position.top)},stop:function(e){t.itemDragEnd(e.currentTarget)}}},s.prototype._resetLayout=function(){this.getSize(),this._getMeasurements(),this.packer.width=this.size.innerWidth+this.gutter,this.packer.height=Number.POSITIVE_INFINITY,this.packer.reset(),this.maxY=0},s.prototype._getMeasurements=function(){this._getMeasurement("columnWidth","width"),this._getMeasurement("rowHeight","height"),this._getMeasurement("gutter","width")},s.prototype._getItemLayoutPosition=function(t){return this._packItem(t),t.rect},s.prototype._packItem=function(t){this._setRectSize(t.element,t.rect),this.packer.pack(t.rect),this._setMaxY(t.rect)},s.prototype._setMaxY=function(t){this.maxY=Math.max(t.y+t.height,this.maxY)},s.prototype._setRectSize=function(t,i){var n=e(t),r=n.outerWidth,a=n.outerHeight,s=this.columnWidth+this.gutter,o=this.rowHeight+this.gutter;r=this.columnWidth?Math.ceil(r/s)*s:r+this.gutter,a=this.rowHeight?Math.ceil(a/o)*o:a+this.gutter,i.width=Math.min(r,this.packer.width),i.height=a},s.prototype._getContainerSize=function(){return{height:this.maxY-this.gutter}},s.prototype._manageStamp=function(t){var e,i=this.getItem(t);if(i&&i.isPlacing)e=i.placeRect;else{var r=this._getElementOffset(t);e=new n({x:this.options.isOriginLeft?r.left:r.right,y:this.options.isOriginTop?r.top:r.bottom})}this._setRectSize(t,e),this.packer.placed(e),this._setMaxY(e)},s.prototype.sortItemsByPosition=function(){this.items.sort(function(t,e){return t.position.y-e.position.y||t.position.x-e.position.x})},s.prototype.fit=function(t,e,i){var n=this.getItem(t);n&&(this._getMeasurements(),this.stamp(n.element),n.getSize(),n.isPlacing=!0,e=void 0===e?n.rect.x:e,i=void 0===i?n.rect.y:i,n.positionPlaceRect(e,i,!0),this._bindFitEvents(n),n.moveTo(n.placeRect.x,n.placeRect.y),this.layout(),this.unstamp(n.element),this.sortItemsByPosition(),n.isPlacing=!1,n.copyPlaceRectPosition())},s.prototype._bindFitEvents=function(t){function e(){n++,2===n&&i.emitEvent("fitComplete",[i,t])}var i=this,n=0;t.on("layout",function(){return e(),!0}),this.on("layoutComplete",function(){return e(),!0})},s.prototype.itemDragStart=function(t){this.stamp(t);var e=this.getItem(t);e&&e.dragStart()},s.prototype.itemDragMove=function(t,e,i){function n(){a.layout(),delete a.dragTimeout}var r=this.getItem(t);r&&r.dragMove(e,i);var a=this;this.clearDragTimeout(),this.dragTimeout=setTimeout(n,40)},s.prototype.clearDragTimeout=function(){this.dragTimeout&&clearTimeout(this.dragTimeout)},s.prototype.itemDragEnd=function(e){var i,n=this.getItem(e);if(n&&(i=n.didDrag,n.dragStop()),!n||!i&&!n.needsPositioning)return this.unstamp(e),void 0;t.add(n.element,"is-positioning-post-drag");var r=this._getDragEndLayoutComplete(e,n);n.needsPositioning?(n.on("layout",r),n.moveTo(n.placeRect.x,n.placeRect.y)):n&&n.copyPlaceRectPosition(),this.clearDragTimeout(),this.on("layoutComplete",r),this.layout()},s.prototype._getDragEndLayoutComplete=function(e,i){var n=i&&i.needsPositioning,r=0,a=n?2:1,s=this;return function(){return r++,r!==a?!0:(i&&(t.remove(i.element,"is-positioning-post-drag"),i.isPlacing=!1,i.copyPlaceRectPosition()),s.unstamp(e),s.sortItemsByPosition(),n&&s.emitEvent("dragItemPositioned",[s,i]),!0)}},s.prototype.bindDraggabillyEvents=function(t){t.on("dragStart",this.handleDraggabilly.dragStart),t.on("dragMove",this.handleDraggabilly.dragMove),t.on("dragEnd",this.handleDraggabilly.dragEnd)},s.prototype.bindUIDraggableEvents=function(t){t.on("dragstart",this.handleUIDraggable.start).on("drag",this.handleUIDraggable.drag).on("dragstop",this.handleUIDraggable.stop)},s.Rect=n,s.Packer=r,s}"function"==typeof define&&define.amd?define("packery/packery",["classie/classie","get-size/get-size","outlayer/outlayer","./rect","./packer","./item"],e):t.Packery=e(t.classie,t.getSize,t.Outlayer,t.Packery.Rect,t.Packery.Packer,t.Packery.Item)}(window),function(t){function e(t,e){for(var i in e)t[i]=e[i];return t}function i(t){return"[object Array]"===l.call(t)}function n(t){var e=[];if(i(t))e=t;else if("number"==typeof t.length)for(var n=0,r=t.length;r>n;n++)e.push(t[n]);else e.push(t);return e}function r(t,i){function r(t,i,s){if(!(this instanceof r))return new r(t,i);"string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=n(t),this.options=e({},this.options),"function"==typeof i?s=i:e(this.options,i),s&&this.on("always",s),this.getImages(),a&&(this.jqDeferred=new a.Deferred);var o=this;setTimeout(function(){o.check()})}function l(t){this.img=t}r.prototype=new t,r.prototype.options={},r.prototype.getImages=function(){this.images=[];for(var t=0,e=this.elements.length;e>t;t++){var i=this.elements[t];"IMG"===i.nodeName&&this.addImage(i);for(var n=i.querySelectorAll("img"),r=0,a=n.length;a>r;r++){var s=n[r];this.addImage(s)}}},r.prototype.addImage=function(t){var e=new l(t);this.images.push(e)},r.prototype.check=function(){function t(t,r){return e.options.debug&&o&&s.log("confirm",t,r),e.progress(t),i++,i===n&&e.complete(),!0}var e=this,i=0,n=this.images.length;if(this.hasAnyBroken=!1,!n)return this.complete(),void 0;for(var r=0;n>r;r++){var a=this.images[r];a.on("confirm",t),a.check()}},r.prototype.progress=function(t){this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded;var e=this;setTimeout(function(){e.emit("progress",e,t),e.jqDeferred&&e.jqDeferred.notify(e,t)})},r.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var e=this;setTimeout(function(){if(e.emit(t,e),e.emit("always",e),e.jqDeferred){var i=e.hasAnyBroken?"reject":"resolve";e.jqDeferred[i](e)}})},a&&(a.fn.imagesLoaded=function(t,e){var i=new r(this,t,e);return i.jqDeferred.promise(a(this))});var u={};return l.prototype=new t,l.prototype.check=function(){var t=u[this.img.src];if(t)return this.useCached(t),void 0;if(u[this.img.src]=this,this.img.complete&&void 0!==this.img.naturalWidth)return this.confirm(0!==this.img.naturalWidth,"naturalWidth"),void 0;var e=this.proxyImage=new Image;i.bind(e,"load",this),i.bind(e,"error",this),e.src=this.img.src},l.prototype.useCached=function(t){if(t.isConfirmed)this.confirm(t.isLoaded,"cached was confirmed");else{var e=this;t.on("confirm",function(t){return e.confirm(t.isLoaded,"cache emitted confirmed"),!0})}},l.prototype.confirm=function(t,e){this.isConfirmed=!0,this.isLoaded=t,this.emit("confirm",this,e)},l.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},l.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindProxyEvents()},l.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindProxyEvents()},l.prototype.unbindProxyEvents=function(){i.unbind(this.proxyImage,"load",this),i.unbind(this.proxyImage,"error",this)},r}var a=t.jQuery,s=t.console,o="undefined"!=typeof s,l=Object.prototype.toString;"function"==typeof define&&define.amd?define("imagesloaded",["eventEmitter/EventEmitter","eventie/eventie"],r):t.imagesLoaded=r(t.EventEmitter,t.eventie)}(window),function(){function t(t){var i=!1;return function(){if(i)throw new Error("Callback was already called.");i=!0,t.apply(e,arguments)}}var e,i,n={};e=this,null!=e&&(i=e.async),n.noConflict=function(){return e.async=i,n};var r=function(t,e){if(t.forEach)return t.forEach(e);for(var i=0;i<t.length;i+=1)e(t[i],i,t)},a=function(t,e){if(t.map)return t.map(e);var i=[];return r(t,function(t,n,r){i.push(e(t,n,r))}),i},s=function(t,e,i){return t.reduce?t.reduce(e,i):(r(t,function(t,n,r){i=e(i,t,n,r)}),i)},o=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e};"undefined"!=typeof process&&process.nextTick?(n.nextTick=process.nextTick,n.setImmediate="undefined"!=typeof setImmediate?setImmediate:n.nextTick):"function"==typeof setImmediate?(n.nextTick=function(t){setImmediate(t)},n.setImmediate=n.nextTick):(n.nextTick=function(t){setTimeout(t,0)},n.setImmediate=n.nextTick),n.each=function(e,i,n){if(n=n||function(){},!e.length)return n();var a=0;r(e,function(r){i(r,t(function(t){t?(n(t),n=function(){}):(a+=1,a>=e.length&&n(null))}))})},n.forEach=n.each,n.eachSeries=function(t,e,i){if(i=i||function(){},!t.length)return i();var n=0,r=function(){e(t[n],function(e){e?(i(e),i=function(){}):(n+=1,n>=t.length?i(null):r())})};r()},n.forEachSeries=n.eachSeries,n.eachLimit=function(t,e,i,n){var r=l(e);r.apply(null,[t,i,n])},n.forEachLimit=n.eachLimit;var l=function(t){return function(e,i,n){if(n=n||function(){},!e.length||0>=t)return n();var r=0,a=0,s=0;!function o(){if(r>=e.length)return n();for(;t>s&&a<e.length;)a+=1,s+=1,i(e[a-1],function(t){t?(n(t),n=function(){}):(r+=1,s-=1,r>=e.length?n():o())})}()}},u=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[n.each].concat(e))}},c=function(t,e){return function(){var i=Array.prototype.slice.call(arguments);return e.apply(null,[l(t)].concat(i))}},f=function(t){return function(){var e=Array.prototype.slice.call(arguments);
return t.apply(null,[n.eachSeries].concat(e))}},h=function(t,e,i,n){var r=[];e=a(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){i(t.value,function(i,n){r[t.index]=n,e(i)})},function(t){n(t,r)})};n.map=u(h),n.mapSeries=f(h),n.mapLimit=function(t,e,i,n){return d(e)(t,i,n)};var d=function(t){return c(t,h)};n.reduce=function(t,e,i,r){n.eachSeries(t,function(t,n){i(e,t,function(t,i){e=i,n(t)})},function(t){r(t,e)})},n.inject=n.reduce,n.foldl=n.reduce,n.reduceRight=function(t,e,i,r){var s=a(t,function(t){return t}).reverse();n.reduce(s,e,i,r)},n.foldr=n.reduceRight;var p=function(t,e,i,n){var r=[];e=a(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){i(t.value,function(i){i&&r.push(t),e()})},function(){n(a(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};n.filter=u(p),n.filterSeries=f(p),n.select=n.filter,n.selectSeries=n.filterSeries;var m=function(t,e,i,n){var r=[];e=a(e,function(t,e){return{index:e,value:t}}),t(e,function(t,e){i(t.value,function(i){i||r.push(t),e()})},function(){n(a(r.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};n.reject=u(m),n.rejectSeries=f(m);var v=function(t,e,i,n){t(e,function(t,e){i(t,function(i){i?(n(t),n=function(){}):e()})},function(){n()})};n.detect=u(v),n.detectSeries=f(v),n.some=function(t,e,i){n.each(t,function(t,n){e(t,function(t){t&&(i(!0),i=function(){}),n()})},function(){i(!1)})},n.any=n.some,n.every=function(t,e,i){n.each(t,function(t,n){e(t,function(t){t||(i(!1),i=function(){}),n()})},function(){i(!0)})},n.all=n.every,n.sortBy=function(t,e,i){n.map(t,function(t,i){e(t,function(e,n){e?i(e):i(null,{value:t,criteria:n})})},function(t,e){if(t)return i(t);var n=function(t,e){var i=t.criteria,n=e.criteria;return n>i?-1:i>n?1:0};i(null,a(e.sort(n),function(t){return t.value}))})},n.auto=function(t,e){e=e||function(){};var i=o(t);if(!i.length)return e(null);var a={},l=[],u=function(t){l.unshift(t)},c=function(t){for(var e=0;e<l.length;e+=1)if(l[e]===t)return l.splice(e,1),void 0},f=function(){r(l.slice(0),function(t){t()})};u(function(){o(a).length===i.length&&(e(null,a),e=function(){})}),r(i,function(i){var l=t[i]instanceof Function?[t[i]]:t[i],h=function(t){var s=Array.prototype.slice.call(arguments,1);if(s.length<=1&&(s=s[0]),t){var l={};r(o(a),function(t){l[t]=a[t]}),l[i]=s,e(t,l),e=function(){}}else a[i]=s,n.setImmediate(f)},d=l.slice(0,Math.abs(l.length-1))||[],p=function(){return s(d,function(t,e){return t&&a.hasOwnProperty(e)},!0)&&!a.hasOwnProperty(i)};if(p())l[l.length-1](h,a);else{var m=function(){p()&&(c(m),l[l.length-1](h,a))};u(m)}})},n.waterfall=function(t,e){if(e=e||function(){},t.constructor!==Array){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}if(!t.length)return e();var r=function(t){return function(i){if(i)e.apply(null,arguments),e=function(){};else{var a=Array.prototype.slice.call(arguments,1),s=t.next();s?a.push(r(s)):a.push(e),n.setImmediate(function(){t.apply(null,a)})}}};r(n.iterator(t))()};var y=function(t,e,i){if(i=i||function(){},e.constructor===Array)t.map(e,function(t,e){t&&t(function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e.call(null,t,i)})},i);else{var n={};t.each(o(e),function(t,i){e[t](function(e){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),n[t]=r,i(e)})},function(t){i(t,n)})}};n.parallel=function(t,e){y({map:n.map,each:n.each},t,e)},n.parallelLimit=function(t,e,i){y({map:d(e),each:l(e)},t,i)},n.series=function(t,e){if(e=e||function(){},t.constructor===Array)n.mapSeries(t,function(t,e){t&&t(function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),e.call(null,t,i)})},e);else{var i={};n.eachSeries(o(t),function(e,n){t[e](function(t){var r=Array.prototype.slice.call(arguments,1);r.length<=1&&(r=r[0]),i[e]=r,n(t)})},function(t){e(t,i)})}},n.iterator=function(t){var e=function(i){var n=function(){return t.length&&t[i].apply(null,arguments),n.next()};return n.next=function(){return i<t.length-1?e(i+1):null},n};return e(0)},n.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var g=function(t,e,i,n){var r=[];t(e,function(t,e){i(t,function(t,i){r=r.concat(i||[]),e(t)})},function(t){n(t,r)})};n.concat=u(g),n.concatSeries=f(g),n.whilst=function(t,e,i){t()?e(function(r){return r?i(r):(n.whilst(t,e,i),void 0)}):i()},n.doWhilst=function(t,e,i){t(function(r){return r?i(r):(e()?n.doWhilst(t,e,i):i(),void 0)})},n.until=function(t,e,i){t()?i():e(function(r){return r?i(r):(n.until(t,e,i),void 0)})},n.doUntil=function(t,e,i){t(function(r){return r?i(r):(e()?i():n.doUntil(t,e,i),void 0)})},n.queue=function(e,i){function a(t,e,a,s){e.constructor!==Array&&(e=[e]),r(e,function(e){var r={data:e,callback:"function"==typeof s?s:null};a?t.tasks.unshift(r):t.tasks.push(r),t.saturated&&t.tasks.length===i&&t.saturated(),n.setImmediate(t.process)})}void 0===i&&(i=1);var s=0,o={tasks:[],concurrency:i,saturated:null,empty:null,drain:null,push:function(t,e){a(o,t,!1,e)},unshift:function(t,e){a(o,t,!0,e)},process:function(){if(s<o.concurrency&&o.tasks.length){var i=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),s+=1;var n=function(){s-=1,i.callback&&i.callback.apply(i,arguments),o.drain&&o.tasks.length+s===0&&o.drain(),o.process()},r=t(n);e(i.data,r)}},length:function(){return o.tasks.length},running:function(){return s}};return o},n.cargo=function(t,e){var i=!1,s=[],o={tasks:s,payload:e,saturated:null,empty:null,drain:null,push:function(t,i){t.constructor!==Array&&(t=[t]),r(t,function(t){s.push({data:t,callback:"function"==typeof i?i:null}),o.saturated&&s.length===e&&o.saturated()}),n.setImmediate(o.process)},process:function l(){if(!i){if(0===s.length)return o.drain&&o.drain(),void 0;var n="number"==typeof e?s.splice(0,e):s.splice(0),u=a(n,function(t){return t.data});o.empty&&o.empty(),i=!0,t(u,function(){i=!1;var t=arguments;r(n,function(e){e.callback&&e.callback.apply(null,t)}),l()})}},length:function(){return s.length},running:function(){return i}};return o};var b=function(t){return function(e){var i=Array.prototype.slice.call(arguments,1);e.apply(null,i.concat([function(e){var i=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(e?console.error&&console.error(e):console[t]&&r(i,function(e){console[t](e)}))}]))}};n.log=b("log"),n.dir=b("dir"),n.memoize=function(t,e){var i={},n={};e=e||function(t){return t};var r=function(){var r=Array.prototype.slice.call(arguments),a=r.pop(),s=e.apply(null,r);s in i?a.apply(null,i[s]):s in n?n[s].push(a):(n[s]=[a],t.apply(null,r.concat([function(){i[s]=arguments;var t=n[s];delete n[s];for(var e=0,r=t.length;r>e;e++)t[e].apply(null,arguments)}])))};return r.memo=i,r.unmemoized=t,r},n.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},n.times=function(t,e,i){for(var r=[],a=0;t>a;a++)r.push(a);return n.map(r,e,i)},n.timesSeries=function(t,e,i){for(var r=[],a=0;t>a;a++)r.push(a);return n.mapSeries(r,e,i)},n.compose=function(){var t=Array.prototype.reverse.call(arguments);return function(){var e=this,i=Array.prototype.slice.call(arguments),r=i.pop();n.reduce(t,i,function(t,i,n){i.apply(e,t.concat([function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);n(t,e)}]))},function(t,i){r.apply(e,[t].concat(i))})}};var w=function(t,e){var i=function(){var i=this,n=Array.prototype.slice.call(arguments),r=n.pop();return t(e,function(t,e){t.apply(i,n.concat([e]))},r)};if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);return i.apply(this,n)}return i};n.applyEach=u(w),n.applyEachSeries=f(w),n.forever=function(t,e){function i(n){if(n){if(e)return e(n);throw n}t(i)}i()},"undefined"!=typeof define&&define.amd?define("async",[],function(){return n}):"undefined"!=typeof module&&module.exports?module.exports=n:e.async=n}(),function(){var t=this,e=t._,i={},n=Array.prototype,r=Object.prototype,a=Function.prototype,s=n.push,o=n.slice,l=n.concat,u=r.toString,c=r.hasOwnProperty,f=n.forEach,h=n.map,d=n.reduce,p=n.reduceRight,m=n.filter,v=n.every,y=n.some,g=n.indexOf,b=n.lastIndexOf,w=Array.isArray,k=Object.keys,_=a.bind,T=function(t){return t instanceof T?t:this instanceof T?(this._wrapped=t,void 0):new T(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=T),exports._=T):t._=T,T.VERSION="1.5.2";var I=T.each=T.forEach=function(t,e,n){if(null!=t)if(f&&t.forEach===f)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,a=t.length;a>r;r++)if(e.call(n,t[r],r,t)===i)return}else for(var s=T.keys(t),r=0,a=s.length;a>r;r++)if(e.call(n,t[s[r]],s[r],t)===i)return};T.map=T.collect=function(t,e,i){var n=[];return null==t?n:h&&t.map===h?t.map(e,i):(I(t,function(t,r,a){n.push(e.call(i,t,r,a))}),n)};var S="Reduce of empty array with no initial value";T.reduce=T.foldl=T.inject=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return n&&(e=T.bind(e,n)),r?t.reduce(e,i):t.reduce(e);if(I(t,function(t,a,s){r?i=e.call(n,i,t,a,s):(i=t,r=!0)}),!r)throw new TypeError(S);return i},T.reduceRight=T.foldr=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return n&&(e=T.bind(e,n)),r?t.reduceRight(e,i):t.reduceRight(e);var a=t.length;if(a!==+a){var s=T.keys(t);a=s.length}if(I(t,function(o,l,u){l=s?s[--a]:--a,r?i=e.call(n,i,t[l],l,u):(i=t[l],r=!0)}),!r)throw new TypeError(S);return i},T.find=T.detect=function(t,e,i){var n;return x(t,function(t,r,a){return e.call(i,t,r,a)?(n=t,!0):void 0}),n},T.filter=T.select=function(t,e,i){var n=[];return null==t?n:m&&t.filter===m?t.filter(e,i):(I(t,function(t,r,a){e.call(i,t,r,a)&&n.push(t)}),n)},T.reject=function(t,e,i){return T.filter(t,function(t,n,r){return!e.call(i,t,n,r)},i)},T.every=T.all=function(t,e,n){e||(e=T.identity);var r=!0;return null==t?r:v&&t.every===v?t.every(e,n):(I(t,function(t,a,s){return(r=r&&e.call(n,t,a,s))?void 0:i}),!!r)};var x=T.some=T.any=function(t,e,n){e||(e=T.identity);var r=!1;return null==t?r:y&&t.some===y?t.some(e,n):(I(t,function(t,a,s){return r||(r=e.call(n,t,a,s))?i:void 0}),!!r)};T.contains=T.include=function(t,e){return null==t?!1:g&&t.indexOf===g?-1!=t.indexOf(e):x(t,function(t){return t===e})},T.invoke=function(t,e){var i=o.call(arguments,2),n=T.isFunction(e);return T.map(t,function(t){return(n?e:t[e]).apply(t,i)})},T.pluck=function(t,e){return T.map(t,function(t){return t[e]})},T.where=function(t,e,i){return T.isEmpty(e)?i?void 0:[]:T[i?"find":"filter"](t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},T.findWhere=function(t,e){return T.where(t,e,!0)},T.max=function(t,e,i){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&T.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return I(t,function(t,r,a){var s=e?e.call(i,t,r,a):t;s>n.computed&&(n={value:t,computed:s})}),n.value},T.min=function(t,e,i){if(!e&&T.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&T.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return I(t,function(t,r,a){var s=e?e.call(i,t,r,a):t;s<n.computed&&(n={value:t,computed:s})}),n.value},T.shuffle=function(t){var e,i=0,n=[];return I(t,function(t){e=T.random(i++),n[i-1]=n[e],n[e]=t}),n},T.sample=function(t,e,i){return arguments.length<2||i?t[T.random(t.length-1)]:T.shuffle(t).slice(0,Math.max(0,e))};var P=function(t){return T.isFunction(t)?t:function(e){return e[t]}};T.sortBy=function(t,e,i){var n=P(e);return T.pluck(T.map(t,function(t,e,r){return{value:t,index:e,criteria:n.call(i,t,e,r)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index-e.index}),"value")};var E=function(t){return function(e,i,n){var r={},a=null==i?T.identity:P(i);return I(e,function(i,s){var o=a.call(n,i,s,e);t(r,o,i)}),r}};T.groupBy=E(function(t,e,i){(T.has(t,e)?t[e]:t[e]=[]).push(i)}),T.indexBy=E(function(t,e,i){t[e]=i}),T.countBy=E(function(t,e){T.has(t,e)?t[e]++:t[e]=1}),T.sortedIndex=function(t,e,i,n){i=null==i?T.identity:P(i);for(var r=i.call(n,e),a=0,s=t.length;s>a;){var o=a+s>>>1;i.call(n,t[o])<r?a=o+1:s=o}return a},T.toArray=function(t){return t?T.isArray(t)?o.call(t):t.length===+t.length?T.map(t,T.identity):T.values(t):[]},T.size=function(t){return null==t?0:t.length===+t.length?t.length:T.keys(t).length},T.first=T.head=T.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:o.call(t,0,e)},T.initial=function(t,e,i){return o.call(t,0,t.length-(null==e||i?1:e))},T.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:o.call(t,Math.max(t.length-e,0))},T.rest=T.tail=T.drop=function(t,e,i){return o.call(t,null==e||i?1:e)},T.compact=function(t){return T.filter(t,T.identity)};var C=function(t,e,i){return e&&T.every(t,T.isArray)?l.apply(i,t):(I(t,function(t){T.isArray(t)||T.isArguments(t)?e?s.apply(i,t):C(t,e,i):i.push(t)}),i)};T.flatten=function(t,e){return C(t,e,[])},T.without=function(t){return T.difference(t,o.call(arguments,1))},T.uniq=T.unique=function(t,e,i,n){T.isFunction(e)&&(n=i,i=e,e=!1);var r=i?T.map(t,i,n):t,a=[],s=[];return I(r,function(i,n){(e?n&&s[s.length-1]===i:T.contains(s,i))||(s.push(i),a.push(t[n]))}),a},T.union=function(){return T.uniq(T.flatten(arguments,!0))},T.intersection=function(t){var e=o.call(arguments,1);return T.filter(T.uniq(t),function(t){return T.every(e,function(e){return T.indexOf(e,t)>=0})})},T.difference=function(t){var e=l.apply(n,o.call(arguments,1));return T.filter(t,function(t){return!T.contains(e,t)})},T.zip=function(){for(var t=T.max(T.pluck(arguments,"length").concat(0)),e=new Array(t),i=0;t>i;i++)e[i]=T.pluck(arguments,""+i);return e},T.object=function(t,e){if(null==t)return{};for(var i={},n=0,r=t.length;r>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},T.indexOf=function(t,e,i){if(null==t)return-1;var n=0,r=t.length;if(i){if("number"!=typeof i)return n=T.sortedIndex(t,e),t[n]===e?n:-1;n=0>i?Math.max(0,r+i):i}if(g&&t.indexOf===g)return t.indexOf(e,i);for(;r>n;n++)if(t[n]===e)return n;return-1},T.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(b&&t.lastIndexOf===b)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var r=n?i:t.length;r--;)if(t[r]===e)return r;return-1},T.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=0,a=new Array(n);n>r;)a[r++]=t,t+=i;return a};var A=function(){};T.bind=function(t,e){var i,n;if(_&&t.bind===_)return _.apply(t,o.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return i=o.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(o.call(arguments)));A.prototype=t.prototype;var r=new A;A.prototype=null;var a=t.apply(r,i.concat(o.call(arguments)));return Object(a)===a?a:r}},T.partial=function(t){var e=o.call(arguments,1);return function(){return t.apply(this,e.concat(o.call(arguments)))}},T.bindAll=function(t){var e=o.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return I(e,function(e){t[e]=T.bind(t[e],t)}),t},T.memoize=function(t,e){var i={};return e||(e=T.identity),function(){var n=e.apply(this,arguments);return T.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},T.delay=function(t,e){var i=o.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},T.defer=function(t){return T.delay.apply(T,[t,1].concat(o.call(arguments,1)))},T.throttle=function(t,e,i){var n,r,a,s=null,o=0;i||(i={});var l=function(){o=i.leading===!1?0:new Date,s=null,a=t.apply(n,r)};return function(){var u=new Date;o||i.leading!==!1||(o=u);var c=e-(u-o);return n=this,r=arguments,0>=c?(clearTimeout(s),s=null,o=u,a=t.apply(n,r)):s||i.trailing===!1||(s=setTimeout(l,c)),a}},T.debounce=function(t,e,i){var n,r,a,s,o;return function(){a=this,r=arguments,s=new Date;var l=function(){var u=new Date-s;e>u?n=setTimeout(l,e-u):(n=null,i||(o=t.apply(a,r)))},u=i&&!n;return n||(n=setTimeout(l,e)),u&&(o=t.apply(a,r)),o}},T.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},T.wrap=function(t,e){return function(){var i=[t];return s.apply(i,arguments),e.apply(this,i)}},T.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},T.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},T.keys=k||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)T.has(t,i)&&e.push(i);return e},T.values=function(t){for(var e=T.keys(t),i=e.length,n=new Array(i),r=0;i>r;r++)n[r]=t[e[r]];return n},T.pairs=function(t){for(var e=T.keys(t),i=e.length,n=new Array(i),r=0;i>r;r++)n[r]=[e[r],t[e[r]]];return n},T.invert=function(t){for(var e={},i=T.keys(t),n=0,r=i.length;r>n;n++)e[t[i[n]]]=i[n];return e},T.functions=T.methods=function(t){var e=[];for(var i in t)T.isFunction(t[i])&&e.push(i);return e.sort()},T.extend=function(t){return I(o.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},T.pick=function(t){var e={},i=l.apply(n,o.call(arguments,1));return I(i,function(i){i in t&&(e[i]=t[i])}),e},T.omit=function(t){var e={},i=l.apply(n,o.call(arguments,1));for(var r in t)T.contains(i,r)||(e[r]=t[r]);return e},T.defaults=function(t){return I(o.call(arguments,1),function(e){if(e)for(var i in e)void 0===t[i]&&(t[i]=e[i])}),t},T.clone=function(t){return T.isObject(t)?T.isArray(t)?t.slice():T.extend({},t):t},T.tap=function(t,e){return e(t),t};var O=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof T&&(t=t._wrapped),e instanceof T&&(e=e._wrapped);var r=u.call(t);if(r!=u.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var a=i.length;a--;)if(i[a]==t)return n[a]==e;var s=t.constructor,o=e.constructor;if(s!==o&&!(T.isFunction(s)&&s instanceof s&&T.isFunction(o)&&o instanceof o))return!1;i.push(t),n.push(e);var l=0,c=!0;if("[object Array]"==r){if(l=t.length,c=l==e.length)for(;l--&&(c=O(t[l],e[l],i,n)););}else{for(var f in t)if(T.has(t,f)&&(l++,!(c=T.has(e,f)&&O(t[f],e[f],i,n))))break;if(c){for(f in e)if(T.has(e,f)&&!l--)break;c=!l}}return i.pop(),n.pop(),c};T.isEqual=function(t,e){return O(t,e,[],[])},T.isEmpty=function(t){if(null==t)return!0;if(T.isArray(t)||T.isString(t))return 0===t.length;for(var e in t)if(T.has(t,e))return!1;return!0},T.isElement=function(t){return!(!t||1!==t.nodeType)},T.isArray=w||function(t){return"[object Array]"==u.call(t)},T.isObject=function(t){return t===Object(t)},I(["Arguments","Function","String","Number","Date","RegExp"],function(t){T["is"+t]=function(e){return u.call(e)=="[object "+t+"]"}}),T.isArguments(arguments)||(T.isArguments=function(t){return!(!t||!T.has(t,"callee"))}),"function"!=typeof/./&&(T.isFunction=function(t){return"function"==typeof t}),T.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},T.isNaN=function(t){return T.isNumber(t)&&t!=+t},T.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==u.call(t)},T.isNull=function(t){return null===t},T.isUndefined=function(t){return void 0===t},T.has=function(t,e){return c.call(t,e)},T.noConflict=function(){return t._=e,this},T.identity=function(t){return t},T.times=function(t,e,i){for(var n=Array(Math.max(0,t)),r=0;t>r;r++)n[r]=e.call(i,r);return n},T.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var R={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};R.unescape=T.invert(R.escape);var L={escape:new RegExp("["+T.keys(R.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(R.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(t){T[t]=function(e){return null==e?"":(""+e).replace(L[t],function(e){return R[t][e]})}}),T.result=function(t,e){if(null==t)return void 0;var i=t[e];return T.isFunction(i)?i.call(t):i},T.mixin=function(t){I(T.functions(t),function(e){var i=T[e]=t[e];T.prototype[e]=function(){var t=[this._wrapped];return s.apply(t,arguments),B.call(this,i.apply(T,t))}})};var U=0;T.uniqueId=function(t){var e=++U+"";return t?t+e:e},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(t,e,i){var n;i=T.defaults({},i,T.templateSettings);var r=new RegExp([(i.escape||D).source,(i.interpolate||D).source,(i.evaluate||D).source].join("|")+"|$","g"),a=0,s="__p+='";t.replace(r,function(e,i,n,r,o){return s+=t.slice(a,o).replace(F,function(t){return"\\"+M[t]}),i&&(s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(s+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(s+="';\n"+r+"\n__p+='"),a=o+e.length,e}),s+="';\n",i.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(i.variable||"obj","_",s)}catch(o){throw o.source=s,o}if(e)return n(e,T);var l=function(t){return n.call(this,t,T)};return l.source="function("+(i.variable||"obj")+"){\n"+s+"}",l},T.chain=function(t){return T(t).chain()};var B=function(t){return this._chain?T(t).chain():t};T.mixin(T),I(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];T.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],B.call(this,i)}}),I(["concat","join","slice"],function(t){var e=n[t];T.prototype[t]=function(){return B.call(this,e.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(){}),function(t){function e(e,i){var n;return t.Notification?n=new t.Notification(e,{icon:g(i.icon)?i.icon:i.icon.x32,body:i.body||p,tag:i.tag||p}):t.webkitNotifications?(n=t.webkitNotifications.createNotification(i.icon,e,i.body),n.show()):navigator.mozNotification?(n=navigator.mozNotification.createNotification(e,i.body,i.icon),n.show()):t.external&&t.external.msIsSiteMode()&&(t.external.msSiteModeClearIconOverlay(),t.external.msSiteModeSetIconOverlay(g(i.icon)?i.icon:i.icon.x16,e),t.external.msSiteModeActivate(),n={ieVerification:v+1}),n}function i(e){return{close:function(){e&&(e.close?e.close():t.external&&t.external.msIsSiteMode()&&e.ieVerification===v&&t.external.msSiteModeClearIconOverlay())}}}function n(e){if(m){var i=y(e)?e:k;t.webkitNotifications&&t.webkitNotifications.checkPermission?t.webkitNotifications.requestPermission(i):t.Notification&&t.Notification.requestPermission&&t.Notification.requestPermission(i)}}function r(){var e;if(m)return t.Notification&&t.Notification.permissionLevel?e=t.Notification.permissionLevel():t.webkitNotifications&&t.webkitNotifications.checkPermission?e=f[t.webkitNotifications.checkPermission()]:navigator.mozNotification?e=u:t.Notification&&t.Notification.permission?e=t.Notification.permission:t.external&&void 0!==t.external.msIsSiteMode()&&(e=t.external.msIsSiteMode()?u:l),e}function a(t){return t&&b(t)&&w(_,t),_}function s(){return _.pageVisibility?document.hidden||document.msHidden||document.mozHidden||document.webkitHidden:!0}function o(n,a){var o,l;return m&&s()&&g(n)&&a&&(g(a.icon)||b(a.icon))&&r()===u&&(o=e(n,a)),l=i(o),_.autoClose&&o&&!o.ieVerification&&o.addEventListener&&o.addEventListener("show",function(){var e=l;t.setTimeout(function(){e.close()},_.autoClose)}),l}var l="default",u="granted",c="denied",f=[u,l,c],h={pageVisibility:!1,autoClose:0},d={},p="",m=function(){var e=!1;try{e=!!(t.Notification||t.webkitNotifications||navigator.mozNotification||t.external&&void 0!==t.external.msIsSiteMode())}catch(i){}return e}(),v=Math.floor(10*Math.random()+1),y=function(t){return t&&t.constructor===Function},g=function(t){return t&&t.constructor===String},b=function(t){return t&&t.constructor===Object},w=function(t,e){var i,n;for(i in e)n=e[i],i in t&&(t[i]===n||i in d&&d[i]===n)||(t[i]=n);return t},k=function(){},_=h;t.notify={PERMISSION_DEFAULT:l,PERMISSION_GRANTED:u,PERMISSION_DENIED:c,isSupported:m,config:a,createNotification:o,permissionLevel:r,requestPermission:n},y(Object.freeze)&&Object.freeze(t.notify)}(window),define("notify",function(){}),function(t){"function"==typeof define&&define.amd?define("cookie",["jquery"],t):t(jQuery)}(function(t){function e(t){return t}function i(t){return decodeURIComponent(t.replace(r," "))}function n(t){0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a.json?JSON.parse(t):t}catch(e){}}var r=/\+/g,a=t.cookie=function(r,s,o){if(void 0!==s){if(o=t.extend({},a.defaults,o),"number"==typeof o.expires){var l=o.expires,u=o.expires=new Date;u.setDate(u.getDate()+l)}return s=a.json?JSON.stringify(s):String(s),document.cookie=[a.raw?r:encodeURIComponent(r),"=",a.raw?s:encodeURIComponent(s),o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}for(var c=a.raw?e:i,f=document.cookie.split("; "),h=r?void 0:{},d=0,p=f.length;p>d;d++){var m=f[d].split("="),v=c(m.shift()),y=c(m.join("="));if(r&&r===v){h=n(y);break}r||(h[v]=n(y))}return h};a.defaults={},t.removeCookie=function(e,i){return void 0!==t.cookie(e)?(t.cookie(e,"",t.extend({},i,{expires:-1})),!0):!1}}),function(t){var e,i,n,r;return r="quickfit",n={min:18,max:20,tolerance:.02,truncate:!0,width:240,sample_number_of_letters:10,sample_font_size:12},i=function(){function e(e){this.options=e,this.item=t('<span id="meassure"></span>'),this.item.css({position:"absolute",left:"-1000px",top:"-1000px","font-size":""+this.options.sample_font_size+"px"}),t("body").append(this.item),this.meassures={}}var i;return i=null,e.instance=function(t){return i||(i=new e(t)),i},e.prototype.get_meassure=function(t){var e;return e=this.meassures[t],void 0===e&&(e=this.set_meassure(t)),e},e.prototype.set_meassure=function(t){var e,i,n,r,a;for(r="",n=" "===t?"&nbsp;":t,i=0,a=this.options.sample_number_of_letters-1;a>=0?a>=i:i>=a;a>=0?i++:i--)r+=n;return this.item.html(r),e=this.item.width()/this.options.sample_number_of_letters/this.options.sample_font_size,this.meassures[t]=e,e},e}(),e=function(){function e(e,a){this.element=e,this.options=t.extend({},n,a),this.element=t(this.element),this._defaults=n,this._name=r,this.quickfit_helper=i.instance(this.options)}return e.prototype.fit=function(){var t;return this.options.width||(t=this.element.width(),this.options.width=t-this.options.tolerance*t),(this.text=this.element.attr("data-quickfit"))?this.previously_truncated=!0:this.text=this.element.html(),this.calculate_font_size(),this.options.truncate&&this.truncate(),this.element.css("font-size",""+this.font_size+"px")},e.prototype.calculate_font_size=function(){var t,e,i,n,r;for(e=0,r=this.text,i=0,n=r.length;n>i;i++)t=r[i],e+=this.quickfit_helper.get_meassure(t);return this.target_font_size=parseInt(this.options.width/e),this.font_size=Math.max(this.options.min,Math.min(this.options.max,this.target_font_size))},e.prototype.truncate=function(){var t,e,i,n,r;if(this.font_size>this.target_font_size){for(n="",r=3*this.quickfit_helper.get_meassure(".")*this.font_size,t=0;r<this.options.width&&t<this.text.length;)i=this.text[t++],e&&(n+=e),r+=this.font_size*this.quickfit_helper.get_meassure(i),e=i;return n.length+1===this.text.length?n=this.text:n+="...",this.text_was_truncated=!0,this.element.attr("data-quickfit",this.text).html(n)}return this.previously_truncated?this.element.html(this.text):void 0},e}(),t.fn.quickfit=function(t){return this.each(function(){return new e(this,t).fit()})}}(jQuery,window),define("quickfit",function(){}),define("api",["jquery","underscore","notify","cookie","quickfit"],function(t){var e={last_update:0,interval:null,files:function(t){var e=this,i="/api/"+user.id+"/files";0!==e.last_update&&(i=i+"?t="+e.last_update),jQuery.getJSON(i,function(i,n){return i?i.paths.length?(e.desktop.append(i.paths),e.last_update=Date.now()):alert("Aucuns fichiers trouvés"):console.error(n,i),"function"==typeof t?t(null,i):!0})},size:function(){jQuery.getJSON("/api/"+user.id+"/size",function(e){e?(t("#diskSpace #usedBar").css("width",e.percent),t("#diskSpace .used").text(e.pretty),t("#diskSpace .left").text(" / "+e.left)):console.error("No size")})},fetchRemove:function(t){var e=this;jQuery.getJSON("/api/"+user.id+"/files/to_remove",function(i){return e.desktop.remove(i),"function"==typeof t?t(null,i):!0})},setInterval:function(){var t=this;t.interval=setInterval(function(){clearInterval(t.interval),t.fetchRemove(function(){t.files(function(){t.setInterval()})})},config.fetchTime)},init:function(t){var e=this;this.desktop=t,this.size(),this.files(function(){e.setInterval()})}};return e}),!function(t,e){var i,n=t.document;i=function(){var i,r,a,s,o,l,u,c,f,h,d,p,m,v={},y={},g=!1,b={ENTER:13,ESC:27,SPACE:32},w=[];return y={buttons:{holder:'<nav class="alertify-buttons">{{buttons}}</nav>',submit:'<button type="submit" class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',ok:'<button class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',cancel:'<button class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}</button>'},input:'<div class="alertify-text-wrapper"><input type="text" class="alertify-text" id="alertify-text"></div>',message:'<p class="alertify-message">{{message}}</p>',log:'<article class="alertify-log{{class}}">{{message}}</article>'},m=function(){var t,i,r=!1,a=n.createElement("fakeelement"),s={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"};for(t in s)if(a.style[t]!==e){i=s[t],r=!0;break}return{type:i,supported:r}},i=function(t){return n.getElementById(t)},v={labels:{ok:"OK",cancel:"Cancel"},delay:5e3,buttonReverse:!1,buttonFocus:"ok",transition:e,addListeners:function(t){var e,i,l,u,c,f="undefined"!=typeof a,h="undefined"!=typeof r,d="undefined"!=typeof p,m="",v=this;e=function(e){return"undefined"!=typeof e.preventDefault&&e.preventDefault(),l(e),"undefined"!=typeof p&&(m=p.value),"function"==typeof t&&("undefined"!=typeof p?t(!0,m):t(!0)),!1},i=function(e){return"undefined"!=typeof e.preventDefault&&e.preventDefault(),l(e),"function"==typeof t&&t(!1),!1},l=function(){v.hide(),v.unbind(n.body,"keyup",u),v.unbind(s,"focus",c),f&&v.unbind(a,"click",e),h&&v.unbind(r,"click",i)},u=function(t){var n=t.keyCode;(n===b.SPACE&&!d||d&&n===b.ENTER)&&e(t),n===b.ESC&&h&&i(t)},c=function(){d?p.focus():!h||v.buttonReverse?a.focus():r.focus()},this.bind(s,"focus",c),this.bind(o,"focus",c),f&&this.bind(a,"click",e),h&&this.bind(r,"click",i),this.bind(n.body,"keyup",u),this.transition.supported||this.setFocus()},bind:function(t,e,i){"function"==typeof t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i)},handleErrors:function(){if("undefined"!=typeof t.onerror){var e=this;return t.onerror=function(t,i,n){e.error("["+t+" on line "+n+" of "+i+"]",0)},!0}return!1},appendButtons:function(t,e){return this.buttonReverse?e+t:t+e},build:function(t){var e="",i=t.type,n=t.message,r=t.cssClass||"";switch(e+='<div class="alertify-dialog">',e+='<a id="alertify-resetFocusBack" class="alertify-resetFocus" href="#">Reset Focus</a>',"none"===v.buttonFocus&&(e+='<a href="#" id="alertify-noneFocus" class="alertify-hidden"></a>'),"prompt"===i&&(e+='<div id="alertify-form">'),e+='<article class="alertify-inner">',e+=y.message.replace("{{message}}",n),"prompt"===i&&(e+=y.input),e+=y.buttons.holder,e+="</article>","prompt"===i&&(e+="</div>"),e+='<a id="alertify-resetFocus" class="alertify-resetFocus" href="#">Reset Focus</a>',e+="</div>",i){case"confirm":e=e.replace("{{buttons}}",this.appendButtons(y.buttons.cancel,y.buttons.ok)),e=e.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);
break;case"prompt":e=e.replace("{{buttons}}",this.appendButtons(y.buttons.cancel,y.buttons.submit)),e=e.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case"alert":e=e.replace("{{buttons}}",y.buttons.ok),e=e.replace("{{ok}}",this.labels.ok)}return f.className="alertify alertify-"+i+" "+r,c.className="alertify-cover",e},close:function(t,e){var i,n,r=e&&!isNaN(e)?+e:this.delay,a=this;this.bind(t,"click",function(){i(t)}),n=function(t){t.stopPropagation(),a.unbind(this,a.transition.type,n),h.removeChild(this),h.hasChildNodes()||(h.className+=" alertify-logs-hidden")},i=function(t){"undefined"!=typeof t&&t.parentNode===h&&(a.transition.supported?(a.bind(t,a.transition.type,n),t.className+=" alertify-log-hide"):(h.removeChild(t),h.hasChildNodes()||(h.className+=" alertify-logs-hidden")))},0!==e&&setTimeout(function(){i(t)},r)},dialog:function(t,e,i,r,a){u=n.activeElement;var s=function(){h&&null!==h.scrollTop&&c&&null!==c.scrollTop||s()};if("string"!=typeof t)throw new Error("message must be a string");if("string"!=typeof e)throw new Error("type must be a string");if("undefined"!=typeof i&&"function"!=typeof i)throw new Error("fn must be a function");return this.init(),s(),w.push({type:e,message:t,callback:i,placeholder:r,cssClass:a}),g||this.setup(),this},extend:function(t){if("string"!=typeof t)throw new Error("extend method must have exactly one paramter");return function(e,i){return this.log(e,t,i),this}},hide:function(){var t,e=this;w.splice(0,1),w.length>0?this.setup(!0):(g=!1,t=function(i){i.stopPropagation(),e.unbind(f,e.transition.type,t)},this.transition.supported?(this.bind(f,this.transition.type,t),f.className="alertify alertify-hide alertify-hidden"):f.className="alertify alertify-hide alertify-hidden alertify-isHidden",c.className="alertify-cover alertify-cover-hidden",u.focus())},init:function(){n.createElement("nav"),n.createElement("article"),n.createElement("section"),null==i("alertify-cover")&&(c=n.createElement("div"),c.setAttribute("id","alertify-cover"),c.className="alertify-cover alertify-cover-hidden",n.body.appendChild(c)),null==i("alertify")&&(g=!1,w=[],f=n.createElement("section"),f.setAttribute("id","alertify"),f.className="alertify alertify-hidden",n.body.appendChild(f)),null==i("alertify-logs")&&(h=n.createElement("section"),h.setAttribute("id","alertify-logs"),h.className="alertify-logs alertify-logs-hidden",n.body.appendChild(h)),n.body.setAttribute("tabindex","0"),this.transition=m()},log:function(t,e,i){var n=function(){h&&null!==h.scrollTop||n()};return this.init(),n(),h.className="alertify-logs",this.notify(t,e,i),this},notify:function(t,e,i){var r=n.createElement("article");r.className="alertify-log"+("string"==typeof e&&""!==e?" alertify-log-"+e:""),r.innerHTML=t,h.appendChild(r),setTimeout(function(){r.className=r.className+" alertify-log-show"},50),this.close(r,i)},set:function(t){var e;if("object"!=typeof t&&t instanceof Array)throw new Error("args must be an object");for(e in t)t.hasOwnProperty(e)&&(this[e]=t[e])},setFocus:function(){p?(p.focus(),p.select()):l.focus()},setup:function(t){var n,u=w[0],c=this;g=!0,n=function(t){t.stopPropagation(),c.setFocus(),c.unbind(f,c.transition.type,n)},this.transition.supported&&!t&&this.bind(f,this.transition.type,n),f.innerHTML=this.build(u),s=i("alertify-resetFocus"),o=i("alertify-resetFocusBack"),a=i("alertify-ok")||e,r=i("alertify-cancel")||e,l="cancel"===v.buttonFocus?r:"none"===v.buttonFocus?i("alertify-noneFocus"):a,p=i("alertify-text")||e,d=i("alertify-form")||e,"string"==typeof u.placeholder&&""!==u.placeholder&&(p.value=u.placeholder),t&&this.setFocus(),this.addListeners(u.callback)},unbind:function(t,e,i){"function"==typeof t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent&&t.detachEvent("on"+e,i)}},{alert:function(t,e,i){return v.dialog(t,"alert",e,"",i),this},confirm:function(t,e,i){return v.dialog(t,"confirm",e,"",i),this},extend:v.extend,init:v.init,log:function(t,e,i){return v.log(t,e,i),this},prompt:function(t,e,i,n){return v.dialog(t,"prompt",e,i,n),this},success:function(t,e){return v.log(t,"success",e),this},error:function(t,e){return v.log(t,"error",e),this},set:function(t){v.set(t)},labels:v.labels,debug:v.handleErrors}},"function"==typeof define?define("alertify",[],function(){return new i}):"undefined"==typeof t.alertify&&(t.alertify=new i)}(this),define("desktop",["text!../views/albums.ejs","text!../views/movies.ejs","text!../views/others.ejs","packery/packery","imagesloaded","async","jquery","api","alertify","underscore","cookie","quickfit"],function(t,e,i,n,r,a,s,o,l){s.expr[":"].contains=s.expr.createPseudo(function(t){return function(e){return s(e).text().toLowerCase().indexOf(t.toLowerCase())>=0}}),s.expr[":"].startsWith=s.expr.createPseudo(function(t){return function(e){return s(e).text().replace(/\s+/g,"").charAt(0).toUpperCase()==t.toUpperCase()}}),s.expr[":"].match=s.expr.createPseudo(function(t){return function(e){var i=s(e).text().replace(/\s+/g,"").charAt(0);return i.match(new RegExp(t,"ig"))}});var u={firstLoad:!0,$container:s("section#desktop"),itemSelector:".element",displaySelector:null,pckry:null,hasLayout:!1,socket:null,hasLayout:function(){},alphabet:{A:0,B:0,C:0,D:0,E:0,F:0,G:0,H:0,I:0,J:0,K:0,L:0,M:0,N:0,O:0,P:0,Q:0,R:0,S:0,T:0,U:0,V:0,W:0,X:0,Y:0,Z:0,"#":0},loader:function(){var t=s("#loader");t.is(":visible")?t.fadeOut():t.fadeIn()},showNotification:function(){},init:function(){var t=this;return null===t.pckry&&1==isDesktop&&(t.pckry=new n(document.querySelector("section#desktop"),{itemSelector:".element",transitionDuration:"0"})),null===t.socket&&(t.socket=io.connect("wss://"+document.domain+":3001")),user&&isDesktop&&o.init(t),t},template:function(t,e){var i=function(t){var e=["Bytes","KB","MB","GB","TB"];if(0==t)return"n/a";var i=parseInt(Math.floor(Math.log(t)/Math.log(1024)));return 0==i?t+" "+e[i]:(t/Math.pow(1024,i)).toFixed(1)+" "+e[i]};return _.template(t,_.extend(e,{bytesToSize:i}))},render:{files:function(t,e){var i=this;a.map(t,i.path,function(t,i){var n=i.length-1,r="";do i[n]&&(r+=i[n].movies+i[n].albums+i[n].others);while(n--);0==r.length&&(t="Aucun fichiers"),e(t,r)})},path:function(n,r){u.render;a.parallel({movies:function(t){n.movies.length?t(null,u.template(e,{movies:n.movies})):t(null,"")},albums:function(e){n.albums.length?e(null,u.template(t,{albums:n.albums})):e(null,"")},others:function(t){n.others.length?t(null,u.template(i,{others:n.others})):t(null,"")}},function(t,e){r(t,e)})}},remove:function(t){var e=this,i=[];t.length&&(_.each(t,function(t){var n=s(e.itemSelector+'[data-id="'+t.item+'"]'),r=n.find('tr[data-id="'+file+'"]');r.length?(i.push(r.find("td.file_name").text()),r.remove()):(i.push(n.find("h1:first").text()),e.pckry.remove(n))}),l.log("Fichier(s) supprimé(s)",i.join("<br>")),e.layout())},append:function(t){var e=this;firstLoad||e.loader();var i=void 0===s.cookie("display")?".list":s.cookie("display");s("#displayFilters li").each(function(t,e){s(e).attr("data-display",i)}),e.render.files(t,function(t,n){if(t&&console.error(t),n.length>0){var r=s.parseHTML(n),a=[];_.each(r,function(t){var e=t instanceof Text;e||a.push(t)}),r=a,delete a,r.sort(function(t,e){return t=s(t),e=s(e),t.data("date-added")==e.data("date-added")?0:t.data("date-added")<e.data("date-added")?1:-1}),e.firstLoad?(e.$container.addClass("notransition").css("visibility","hidden").append(r),e.pckry.appended(r)):(e.$container.addClass("notransition").css("visibility","hidden").prepend(r),e.pckry.prepended(r)),e.displaySelector=i,e.layout(i,function(){if(e.loader(),e.firstLoad)e.firstLoad=!1;else{var t=0,i=[];if(_.each(r,function(t){s(t).hasClass("list")&&i.push(s(t))}),t=i.length,1==t){i[0].find("h1").text()}}e.$container.removeClass("notransition").css("visibility","visible")})}})},countElementsByLetter:function(){var t=this,e=t.$container.find(t.itemSelector+".list");e.each(function(){var e=s(this).find("h1").text().charAt(0).toUpperCase();e.match(/\d/g)&&(e="#"),t.alphabet[e]++})},layout:function(t,e){var i=this;t=t?t:i.displaySelector,i.displaySelector=t,s(i.itemSelector+".miniature").css("visibility","hidden");var n=document.querySelector("#"+i.$container.attr("id")+" .miniature");null!==n&&n.length&&r(n,function(){i.pckry.layout(),s(i.itemSelector+".miniature h1").quickfit(),s(i.itemSelector+".miniature").css("visibility","visible")}),i.firstLoad||i.loader(),s(i.itemSelector).css("display","none"),s(i.itemSelector+t).each(function(){s(this).css("display","block")}),i.pckry.layout(),i.firstLoad||i.loader(),i.countElementsByLetter(),i.hasLayout(),"function"==typeof e&&e()}};return u.init()}),define("theme",["jquery","desktop","alertify","underscore"],function(t,e,i){$section=e.$container,t(".select-on-click").on("click",function(){t(this).select()}),t("#alert .entypo-cross").on("click",function(){t(this).parent().empty()}),t(window).load(function(){var e=notify.permissionLevel();switch(e){case notify.PERMISSION_DEFAULT:t("#alert").append('<p class="warning"><i class="entypo-warning"></i> <a href="#" class="allow-notify">Cliquez ici pour activer les notifications de bureau.</a></p>');break;case notify.PERMISSION_DENIED:}var n=t("#alert").find(".msg");n.length&&(n.hasClass("error")?i.error(n.text()):n.hasClass("success")?i.success(n.text()):i.log(n.text()))}).on("scroll",function(){var e=t("body").scrollTop()||t("html").scrollTop();e>t("header").height()+7?r():r(!1)}),t("body").on("click",".delete-item",function(n){n.preventDefault();var r=t(this).attr("href");i.confirm("Attention cette fonction ne supprime pas le torrent, il est conseillé de supprimer torrent et données depuis votre client ! Êtes-vous sûr de vouloir effectuer cette action ?",function(i){return i?(t.get(r,function(t){e.remove(t.id,!1)},"json"),void 0):!1})}),t("body").on("click",".reset-db",function(e){e.preventDefault();var n=t(this).attr("href");i.confirm("Cette fonction réindexe la base de données des fichiers ! L'opération peut-être longue ! Êtes-vous sûr de vouloir effectuer cette action ?",function(t){return t?(window.location=n,void 0):!1})}),t("body").on("click",".allow-notify",function(){notify.requestPermission(function(){t("#alert").empty()})}),t("body").on("click",".reset-item",function(){var i=t(this).closest(".element"),n=i.attr("data-id"),r=t(this).attr("data-type");t.get("/reset/"+r+"/"+n,function(){e.remove(n,!1)},"json")});var n=function(e){var e=void 0===e?!1:e,i=t("body").scrollTop()||t("html").scrollTop();i>t("header").height()+7&&(e!==!0?t("body, html").animate({scrollTop:t("header").height()+10}):t("body, html").animate({scrollTop:0}))},r=function(e){var e=void 0===e?!0:e;e?t("nav#display").hasClass("fixed")||(t("nav#display").addClass("fixed").css("opacity","0.7"),$section.css("marginTop","80px"),t("#toTop").stop().animate({opacity:"0.8"})):(t("nav#display").removeClass("fixed").css("opacity","1"),$section.css("marginTop","20px"),t("#toTop").stop().animate({opacity:"0"}))};t("#toTop").on("click",function(){n(!0)}),t("body").on("click",".showFiles",function(){$button=t(this),void 0===$button.data("text")&&$button.data("text",$button.text()),$files=t(this).next(".files"),$element=t(this).parent();var i=$files.height()+20;$files.hasClass("open")?($button.html('<i class="entypo-attach"></i>'+$button.data("text")),$element.toggleClass("notransition").css({"margin-bottom":"20px"}),$files.css({visibility:"hidden",opacity:"0"}),e.layout(null,function(){$element.toggleClass("notransition")})):($button.html('<i class="entypo-attach"></i>Cacher'),$element.toggleClass("notransition").css({"margin-bottom":"+"+i+"px"}),e.layout(null,function(){$files.css({top:$element.height()+20+"px",visibility:"visible",opacity:1}),$element.toggleClass("notransition")})),$files.toggleClass("open")}),t("body").on({mouseenter:function(){t(this).css("opacity","1")},mouseleave:function(){t(this).css("opacity","0.7")}},"nav#display.fixed"),t("#search input").on("keyup",function(){n();var i="",r=t("#displayFilters li:first-child").attr("data-display");if(t("#displayFilters li.active").length&&(i=t("#displayFilters li.active").attr("data-filter")),t(this).val().length>2){var a=$section.find(e.itemSelector+':contains("'+t(this).val()+'")');a.each(function(i,n){if(!t(n).hasClass("highlight")){var r=t(n).attr("data-id");$section.find(e.itemSelector+'[data-id="'+r+'"]').addClass("highlight")}}),e.layout(r+i+".highlight")}else $section.find(".highlight").toggleClass("highlight"),e.layout(r+i)}),t("body").on("click","#displayFilters li",function(){if(n(),t(this).hasClass("active"))t(this).removeClass("active"),e.layout(t(this).attr("data-display"));else{var i=t(this).attr("data-filter"),r=t(this).attr("data-display");t("#displayFilters li.active").removeClass("active"),t(this).addClass("active"),e.layout(r+i)}return!1}),t("body").on("click","#displayOptions i",function(){var i=t(this).attr("data-filter"),r="";return t(this).hasClass("active")||(t(this).parent().find(".active").removeClass("active"),t(this).addClass("active"),t.cookie("display",i),n(),t("#displayFilters li.active").length&&(r=t("#displayFilters li.active").attr("data-filter")),e.layout(i+r),t("#displayFilters li").each(function(){t(this).attr("data-display",i)})),!1}),e=_.extend(e,{hasLayout:function(){var i=150,n=100,r=0,a=0;_.each(e.alphabet,function(t){a=t>a?t:a,r=r>t?t:r});var s=(i-n)/(a-r);t("#alpha-nav li a").each(function(){var i=t(this).attr("href").substr(1),o=e.alphabet[i];if(0/0!==parseInt(o)){var l=n+(a-(a-(o-r)))*s+"%";t(this).css("font-size",l)}})}}),t("#alpha-nav li a").on("click",function(i){i.preventDefault(),n();var r=t(this),a=t(this).parent().hasClass("active")?"":r.attr("href").substr(1);$section.find(".startsWith").toggleClass("startsWith"),t(this).closest("ul").find("li.active").removeClass("active");var s="",o=t("#displayFilters li:first-child").attr("data-display");if(t("#displayFilters li.active").length&&(s=t("#displayFilters li.active").attr("data-filter")),a.length||"#"===a){var l;l="#"==a?$section.find(e.itemSelector+':match("\\d+")'):$section.find(e.itemSelector+':startsWith("'+a+'")'),l.each(function(i,n){if(!t(n).hasClass("startsWith")){var r=t(n).attr("data-id");$section.find(e.itemSelector+'[data-id="'+r+'"]').addClass("startsWith")}}),e.layout(o+s+".startsWith",function(){r.parent().addClass("active")})}else e.layout(o+s)});var a,s=e.socket;s.on("compressing",function(e){var i=t(".element.list[data-id="+e.id+"]"),n=t("#archiving"),r=i.find("a.archive").attr("data-full-size"),s=parseInt(e.done)/parseInt(r)*100;s=Math.round(100*s)/100,s=100>s?s:100,100==s&&void 0==a&&(a=setTimeout(n.find(".progress").text("En attente..."),750)),n.find(".percent").text(s+"%"),n.find(".progress").css("width",s+"%")}),$section.on("click",".archive",function(e){e.preventDefault();var i=t(this).closest(".element"),n=i.attr("data-id"),r=i.find("h1").text(),a=t("#archiving");s.emit("archive",n),a.find(".name").text(r),a.show(),t(window).bind("beforeunload",function(){return"Une compression est en cours"}),t.get(t(this).attr("href"),function(e){null==e.error?(t(window).unbind("beforeunload"),window.location.href="/download/archive/"+n,a.find(".percent").text("Téléchargement en cours..."),a.find(".progress").css("width","100%"),setTimeout(function(){a.fadeOut("800"),a.find(".percent").delay("800").text("0%")},3e3)):(a.find(".percent").text(e.error),a.find(".progress").css("width","100%"),console.log(e.error))},"json")})}),function(t){function e(e,n){n=n||{};var r=this,a=n.query||"> :even";t.extend(r,{$el:e,options:n,sections:[],isAccordion:n.accordion||!1,db:n.persist?jQueryCollapseStorage(e[0].id):!1}),r.states=r.db?r.db.read():[],r.$el.find(a).each(function(){var e=new i(t(this),r);r.sections.push(e);var n=r.states[e._index()];0===n&&e.$summary.removeClass("open"),1===n&&e.$summary.addClass("open"),e.$summary.hasClass("open")?e.open(!0):e.close(!0)}),function(e){r.$el.on("click","[data-collapse-summary]",t.proxy(r.handleClick,e))}(r)}function i(e,i){t.extend(this,{isOpen:!1,$summary:e.attr("data-collapse-summary","").wrapInner('<a href="#"/>'),$details:e.next(),options:i.options,parent:i})}e.prototype={handleClick:function(e){e.preventDefault();for(var i=this.sections,n=i.length;n--;)if(t.contains(i[n].$summary[0],e.target)){i[n].toggle();break}},open:function(e){return isFinite(e)?this.sections[e].open():(t.each(this.sections,function(){this.open()}),void 0)},close:function(e){return isFinite(e)?this.sections[e].close():(t.each(this.sections,function(){this.close()}),void 0)}},i.prototype={toggle:function(){this.isOpen?this.close():this.open()},close:function(t){this._changeState("close",t)},open:function(e){var i=this;i.options.accordion&&!e&&t.each(i.parent.sections,function(){this.close()}),i._changeState("open",e)},_index:function(){return t.inArray(this,this.parent.sections)},_changeState:function(e,i){var n=this;n.isOpen="open"==e,t.isFunction(n.options[e])&&!i?n.options[e].apply(n.$details):n.isOpen?n.$details.show():n.$details.hide(),n.$summary.removeClass("open close").addClass(e),n.$details.attr("aria-hidden","close"==e),n.parent.$el.trigger(e,n),n.parent.db&&n.parent.db.write(n._index(),n.isOpen)}},t.fn.extend({collapse:function(i,n){var r=n?t("body").find("[data-collapse]"):t(this);return r.each(function(){var r=n?{}:i,a=t(this).attr("data-collapse")||"";t.each(a.split(" "),function(t,e){e&&(r[e]=!0)}),new e(t(this),r)})}}),t(function(){t.fn.collapse(!1,!0)}),jQueryCollapse=e}(window.jQuery),define("collapse",function(){}),function(t){function e(e){var n;try{n=window.localStorage||t.fn.collapse.cookieStorage}catch(r){n=!1}return n?new i(e,n):!1}function i(t,e){this.id=t,this.db=e,this.data=[]}var n="jQuery-Collapse";i.prototype={write:function(e,i){var r=this;r.data[e]=i?1:0,t.each(r.data,function(t){"undefined"==typeof r.data[t]&&(r.data[t]=0)});var a=this.getDataObject();a[this.id]=this.data,this.db.setItem(n,JSON.stringify(a))},read:function(){var t=this.getDataObject();return t[this.id]||[]},getDataObject:function(){var t=this.db.getItem(n);return t?JSON.parse(t):{}}},jQueryCollapseStorage=e}(jQuery),define("collapse_storage",function(){}),function(t){t.fn.extend({customSelect:function(e){if("undefined"==typeof document.body.style.maxHeight)return this;var i={customClass:"customSelect",mapClass:!0,mapStyle:!0,loaded:function(){console.log("loaded")}},e=t.extend(i,e),n=e.customClass,r=function(e,i){var n=e.find(":selected"),r=i.children(":first"),s=n.html()||"&nbsp;";r.html(s),n.attr("disabled")?i.addClass(a("DisabledOption")):i.removeClass(a("DisabledOption")),setTimeout(function(){i.removeClass(a("Open")),t(document).off("mouseup."+a("Open"))},60)},a=function(t){return n+t};return this.each(function(){var i=t(this),s=t("<span />").addClass(a("Inner")),o=t("<span />");i.after(o.append(s)),o.addClass(n),e.mapClass&&o.addClass(i.attr("class")),e.mapStyle&&o.attr("style",i.attr("style")),i.addClass("hasCustomSelect").on("update",function(){r(i,o);var t=parseInt(i.outerWidth(),10)-(parseInt(o.outerWidth(),10)-parseInt(o.width(),10));o.css({display:"inline-block"});var n=o.outerHeight();i.attr("disabled")?o.addClass(a("Disabled")):o.removeClass(a("Disabled")),s.css({width:t,display:"inline-block"}),i.css({"-webkit-appearance":"menulist-button",width:o.outerWidth(),position:"absolute",opacity:0,height:n,fontSize:o.css("font-size")}),e.loaded()}).on("change",function(){o.addClass(a("Changed")),r(i,o)}).on("keyup",function(t){o.hasClass(a("Open"))?(13==t.which||27==t.which)&&r(i,o):(i.blur(),i.focus())}).on("mousedown",function(){o.removeClass(a("Changed"))}).on("mouseup",function(e){o.hasClass(a("Open"))||(t("."+a("Open")).not(o).length>0&&"undefined"!=typeof InstallTrigger?i.focus():(o.addClass(a("Open")),e.stopPropagation(),t(document).one("mouseup."+a("Open"),function(e){e.target!=i.get(0)&&t.inArray(e.target,i.find("*").get())<0?i.blur():r(i,o)})))}).focus(function(){o.removeClass(a("Changed")).addClass(a("Focus"))}).blur(function(){o.removeClass(a("Focus")+" "+a("Open"))}).hover(function(){o.addClass(a("Hover"))},function(){o.removeClass(a("Hover"))}).trigger("update")})}})}(jQuery),define("customselect",function(){}),define("admin",["jquery","alertify","collapse","collapse_storage","customselect"],function(t,e){var i,n=function(){t("#admin.collapse").collapse({open:function(){this.slideDown(100)},close:function(){this.slideUp(100)},accordion:!0,persist:!0})};t("select").customSelect({loaded:function(){void 0!==i&&clearTimeout(i),i=setTimeout(function(){n()},10)}}),t('#change-theme input[type="submit"]').on("click",function(i){i.preventDefault(),e.confirm("Pas encore tout à fais au point, si vous avez une erreur 502 ou que ça charge dans le vide c'est normal, actualisez :)",function(e){return e?t("#change-theme").submit():!1})}),t('a[href="#more"]').click(function(){t(this).closest("li").find(".user-more").slideToggle()})}),define("text!../../plugins/chat/public/views/message.ejs",[],function(){return"<%\nvar l = messages.length;\n\nfor(var i = 0; i < l - 1; i++) {\n	var m = messages[i], prev = i >= 1 ? messages[i-1] : null;\n\n	if(prev !== null && m.user == prev.user) {\n\n		print(m.message);\n\n	} else {\n%>\n	<%= prev === null ? '<li>' : '</li><li>' %>\n		<span class=\"pseudo\" data-user=\"<%= m.user %>\"><%= m.user %></span><%= m.message %>\n<%\n	}\n%>\n\n\n<%= i == l - 2 ? '</li>': '' %>\n\n\n<% \n\n} //end loop\n\n%>"}),define("chat-chat",["jquery","desktop","text!../../plugins/chat/public/views/message.ejs"],function(t,e,i){if(user){var n=e.socket,r=t("#chat .messages");t("#chat").on("keydown","#textarea",function(e){13!=e.keyCode||e.shiftKey||(e.preventDefault(),n.emit("chat:message",user.username,t(this).text()),t(this).empty())}),t(document).ready(function(){t.cookie("chatclosed")||(t("#chat").css({height:"350px"}).toggleClass("closed"),t('#chat i[class*="entypo"]').toggleClass("entypo-minus-squared").toggleClass("entypo-plus-squared"))}),t("#chat .top").on("click",function(){var e=t("#chat");e.hasClass("closed")?(e.animate({height:"350px"}).toggleClass("closed"),t.cookie("chatclosed",!1)):(e.animate({height:"20px"}).toggleClass("closed"),t.cookie("chatclosed",!0)),t(this).find('i[class*="entypo"]').toggleClass("entypo-minus-squared").toggleClass("entypo-plus-squared")}),n.on("connect",function(){n.emit("chat:join",user.username)}),n.on("chat:init",function(t){r.prepend(_.template(i,{messages:t})),r.scrollTop(r[0].scrollHeight)}),n.on("chat:message",function(t){var e=r.find("li:last .pseudo").attr("data-user"),i=r.find("li:last");e==t.user?i.append(t.message):r.append('<li><span class="pseudo" data-user="'+t.user+'">'+t.user+"</span>"+t.message+"</li>"),r.scrollTop(r[0].scrollHeight)}),n.on("chat:joined",function(e){var i=e.length,e=e.join(", ");4>i?t("#chat .users").text(e):t("#chat .users").html('<span title="'+e+'">'+i+" utilisateurs")})}}),define("checkforupdates-checkforupdates",["jquery","desktop","alertify"],function(t,e){if(user){var i=e.socket;i.emit("ckecker:launch",user),i.on("checker:available",function(t){alertify.error("Ezseed à besoin d'un coup de neuf ! La version "+t+" est sortie !",0)})}}),function(){function t(t,e,i,n,r){this.fromSampleRate=t,this.toSampleRate=e,this.channels=0|i,this.outputBufferSize=n,this.noReturn=!!r,this.initialize()}function e(t){this.stream=t,this.sync=!1,this.freerate=0,this.this_frame=t.stream.offset,this.next_frame=t.stream.offset,this.main_data=new Uint8Array(q),this.md_len=0;for(var e in t)"function"==typeof t[e]&&(this[e]=t[e].bind(t))}function i(){this.layer=0,this.mode=0,this.mode_extension=0,this.emphasis=0,this.bitrate=0,this.samplerate=0,this.crc_check=0,this.crc_target=0,this.flags=0,this.private_bits=0}function n(){this.header=null,this.options=0,this.sbsample=r([2,36,32]),this.overlap=r([2,32,18]),this.decoders=[]}function r(t,e){if(e||(e=Float64Array),1===t.length)return new e(t[0]);for(var i=[],n=t[0],a=0;n>a;a++)i[a]=r(t.slice(1),e);return i}function a(){this.filter=r([2,2,2,16,8]),this.phase=0,this.pcm={samplerate:0,channels:0,length:0,samples:[new Float64Array(1152),new Float64Array(1152)]}}function s(){this.allocation=r([2,32],Uint8Array),this.scalefactor=r([2,32],Uint8Array)}function o(){this.samples=new Float64Array(3),this.allocation=r([2,32],Uint8Array),this.scfsi=r([2,32],Uint8Array),this.scalefactor=r([2,32,3],Uint8Array)}function l(t,e,i){this.table=t,this.linbits=e,this.startbits=i}function u(){this.main_data_begin=null,this.private_bits=null,this.gr=[new c,new c],this.scfsi=new Uint8Array(2)}function c(){this.ch=[new h,new h]}function h(){this.part2_3_length=null,this.big_values=null,this.global_gain=null,this.scalefac_compress=null,this.flags=null,this.block_type=null,this.table_select=new Uint8Array(3),this.subblock_gain=new Uint8Array(3),this.region0_count=null,this.region1_count=null,this.scalefac=new Uint8Array(39)}function d(){this.imdct=new Ni,this.si=new u,this.xr=[new Float64Array(576),new Float64Array(576)],this._exponents=new Int32Array(39),this.reqcache=new Float64Array(16),this.modes=new Int16Array(39),this.output=new Float64Array(36),this.tmp=r([32,3,6]),this.tmp2=new Float64Array(576)}var p;p=this;var m;m={};var v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};m.Base=function(){function t(){}var e;return e=/\b_super\b/,t.extend=function(t){var i,n,r,a,s,o,l;if(i=function(t){function e(){return s=e.__super__.constructor.apply(this,arguments)}return y(e,t),e}(this),"function"==typeof t){a=Object.keys(i.prototype),t.call(i,i),t={},o=i.prototype;for(r in o)n=o[r],g.call(a,r)<0&&(t[r]=n)}l=i.__super__;for(r in t)n=t[r],"function"==typeof n&&e.test(n)?!function(t,e){return i.prototype[t]=function(){var i,n;return n=this._super,this._super=l[t],i=e.apply(this,arguments),this._super=n,i}}(r,n):i.prototype[r]=n;return i},t}(),m.Buffer=function(){function t(t){var e;if(t instanceof Uint8Array)this.data=t;else if(t instanceof ArrayBuffer||Array.isArray(t)||"number"==typeof t||m.isNode&&(null!=(e=p.Buffer)?e.isBuffer(t):void 0))this.data=new Uint8Array(t);else if(t.buffer instanceof ArrayBuffer)this.data=new Uint8Array(t.buffer,t.byteOffset,t.length*t.BYTES_PER_ELEMENT);else{if(!(t instanceof m.Buffer))throw new Error("Constructing buffer with unknown type.");this.data=t.data}this.length=this.data.length,this.next=null,this.prev=null}var e,i;return t.allocate=function(t){return new m.Buffer(t)},t.prototype.copy=function(){return new m.Buffer(new Uint8Array(this.data))},t.prototype.slice=function(t,e){return null==e&&(e=this.length),0===t&&e>=this.length?new m.Buffer(this.data):new m.Buffer(this.data.subarray(t,t+e))},e=p.BlobBuilder||p.MozBlobBuilder||p.WebKitBlobBuilder,i=p.URL||p.webkitURL||p.mozURL,t.makeBlob=function(t,i){var n;null==i&&(i="application/octet-stream");try{return new Blob([t],{type:i})}catch(r){}return null!=e?(n=new e,n.append(t),n.getBlob(i)):null},t.makeBlobURL=function(t,e){return null!=i?i.createObjectURL(this.makeBlob(t,e)):void 0},t.revokeBlobURL=function(t){return null!=i?i.revokeObjectURL(t):void 0},t.prototype.toBlob=function(){return t.makeBlob(this.data.buffer)},t.prototype.toBlobURL=function(){return t.makeBlobURL(this.data.buffer)},t}(),m.BufferList=function(){function t(){this.first=null,this.last=null,this.numBuffers=0,this.availableBytes=0,this.availableBuffers=0}return t.prototype.copy=function(){var t;return t=new m.BufferList,t.first=this.first,t.last=this.last,t.numBuffers=this.numBuffers,t.availableBytes=this.availableBytes,t.availableBuffers=this.availableBuffers,t},t.prototype.append=function(t){var e;return t.prev=this.last,null!=(e=this.last)&&(e.next=t),this.last=t,null==this.first&&(this.first=t),this.availableBytes+=t.length,this.availableBuffers++,this.numBuffers++},t.prototype.advance=function(){return this.first?(this.availableBytes-=this.first.length,this.availableBuffers--,this.first=this.first.next,null!=this.first):!1},t.prototype.rewind=function(){var t;return this.first&&!this.first.prev?!1:(this.first=(null!=(t=this.first)?t.prev:void 0)||this.last,this.first&&(this.availableBytes+=this.first.length,this.availableBuffers++),null!=this.first)},t.prototype.reset=function(){var t;for(t=[];this.rewind(););return t},t}();var v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.Stream=function(){function t(t){this.list=t,this.localOffset=0,this.offset=0}var e,i,n,r,a,s,o,l,u,c,f,h,d;return e=new ArrayBuffer(16),d=new Uint8Array(e),u=new Int8Array(e),f=new Uint16Array(e),o=new Int16Array(e),h=new Uint32Array(e),l=new Int32Array(e),n=new Float32Array(e),"undefined"!=typeof Float64Array&&null!==Float64Array&&(r=new Float64Array(e)),c=13330===new Uint16Array(new Uint8Array([18,52]).buffer)[0],m.UnderflowError=function(t){function e(){this.name="AV.UnderflowError"}return y(e,t),e}(Error),t.fromBuffer=function(t){var e;return e=new m.BufferList,e.append(t),new m.Stream(e)},t.prototype.copy=function(){var t;return t=new m.Stream(this.list.copy()),t.localOffset=this.localOffset,t.offset=this.offset,t},t.prototype.available=function(t){return t<=this.list.availableBytes-this.localOffset},t.prototype.remainingBytes=function(){return this.list.availableBytes-this.localOffset},t.prototype.advance=function(t){if(!this.available(t))throw new m.UnderflowError;for(this.localOffset+=t,this.offset+=t;this.list.first&&this.localOffset>=this.list.first.length;)this.localOffset-=this.list.first.length,this.list.advance();return this},t.prototype.rewind=function(t){if(t>this.offset)throw new m.UnderflowError;for(this.list.first||(this.list.rewind(),this.localOffset=this.list.first.length),this.localOffset-=t,this.offset-=t;this.list.first.prev&&this.localOffset<0;)this.list.rewind(),this.localOffset+=this.list.first.length;return this},t.prototype.seek=function(t){return t>this.offset?this.advance(t-this.offset):t<this.offset?this.rewind(this.offset-t):void 0},t.prototype.readUInt8=function(){var t;if(!this.available(1))throw new m.UnderflowError;return t=this.list.first.data[this.localOffset],this.localOffset+=1,this.offset+=1,this.localOffset===this.list.first.length&&(this.localOffset=0,this.list.advance()),t},t.prototype.peekUInt8=function(t){var e;if(null==t&&(t=0),!this.available(t+1))throw new m.UnderflowError;for(t=this.localOffset+t,e=this.list.first;e;){if(e.length>t)return e.data[t];t-=e.length,e=e.next}return 0},t.prototype.read=function(t,e){var i,n,r,a;if(null==e&&(e=!1),e===c)for(i=n=0;t>n;i=n+=1)d[i]=this.readUInt8();else for(i=r=a=t-1;r>=0;i=r+=-1)d[i]=this.readUInt8()},t.prototype.peek=function(t,e,i){var n,r,a;if(null==i&&(i=!1),i===c)for(n=r=0;t>r;n=r+=1)d[n]=this.peekUInt8(e+n);else for(n=a=0;t>a;n=a+=1)d[t-n-1]=this.peekUInt8(e+n)},t.prototype.readInt8=function(){return this.read(1),u[0]},t.prototype.peekInt8=function(t){return null==t&&(t=0),this.peek(1,t),u[0]},t.prototype.readUInt16=function(t){return this.read(2,t),f[0]},t.prototype.peekUInt16=function(t,e){return null==t&&(t=0),this.peek(2,t,e),f[0]},t.prototype.readInt16=function(t){return this.read(2,t),o[0]},t.prototype.peekInt16=function(t,e){return null==t&&(t=0),this.peek(2,t,e),o[0]},t.prototype.readUInt24=function(t){return t?this.readUInt16(!0)+(this.readUInt8()<<16):(this.readUInt16()<<8)+this.readUInt8()},t.prototype.peekUInt24=function(t,e){return null==t&&(t=0),e?this.peekUInt16(t,!0)+(this.peekUInt8(t+2)<<16):(this.peekUInt16(t)<<8)+this.peekUInt8(t+2)},t.prototype.readInt24=function(t){return t?this.readUInt16(!0)+(this.readInt8()<<16):(this.readInt16()<<8)+this.readUInt8()},t.prototype.peekInt24=function(t,e){return null==t&&(t=0),e?this.peekUInt16(t,!0)+(this.peekInt8(t+2)<<16):(this.peekInt16(t)<<8)+this.peekUInt8(t+2)},t.prototype.readUInt32=function(t){return this.read(4,t),h[0]},t.prototype.peekUInt32=function(t,e){return null==t&&(t=0),this.peek(4,t,e),h[0]
},t.prototype.readInt32=function(t){return this.read(4,t),l[0]},t.prototype.peekInt32=function(t,e){return null==t&&(t=0),this.peek(4,t,e),l[0]},t.prototype.readFloat32=function(t){return this.read(4,t),n[0]},t.prototype.peekFloat32=function(t,e){return null==t&&(t=0),this.peek(4,t,e),n[0]},t.prototype.readFloat64=function(t){return this.read(8,t),r?r[0]:a()},a=function(){var t,e,i,n,r,a;return n=h[0],i=h[1],i&&2147483648!==i?(a=1-2*(i>>>31),t=i>>>20&2047,e=1048575&i,2047===t?e?0/0:1/0*a:(t-=1023,r=(1048576|e)*Math.pow(2,t-20),r+=n*Math.pow(2,t-52),a*r)):0},t.prototype.peekFloat64=function(t,e){return null==t&&(t=0),this.peek(8,t,e),r?r[0]:a()},t.prototype.readFloat80=function(t){return this.read(10,t),s()},s=function(){var t,e,i,n,r,a,s;return n=h[0],r=h[1],t=d[9],e=d[8],s=1-2*(t>>>7),i=(127&t)<<8|e,0===i&&0===r&&0===n?0:32767===i?0===r&&0===n?1/0*s:0/0:(i-=16383,a=r*Math.pow(2,i-31),a+=n*Math.pow(2,i-63),s*a)},t.prototype.peekFloat80=function(t,e){return null==t&&(t=0),this.peek(10,t,e),s()},t.prototype.readBuffer=function(t){var e,i,n,r;for(i=m.Buffer.allocate(t),n=i.data,e=r=0;t>r;e=r+=1)n[e]=this.readUInt8();return i},t.prototype.peekBuffer=function(t,e){var i,n,r,a;for(null==t&&(t=0),n=m.Buffer.allocate(e),r=n.data,i=a=0;e>a;i=a+=1)r[i]=this.peekUInt8(t+i);return n},t.prototype.readSingleBuffer=function(t){var e;return e=this.list.first.slice(this.localOffset,t),this.advance(e.length),e},t.prototype.peekSingleBuffer=function(t,e){var i;return i=this.list.first.slice(this.localOffset+t,e)},t.prototype.readString=function(t,e){return null==e&&(e="ascii"),i.call(this,0,t,e,!0)},t.prototype.peekString=function(t,e,n){return null==t&&(t=0),null==n&&(n="ascii"),i.call(this,t,e,n,!1)},i=function(t,e,i,n){var r,a,s,o,l,u,c,f,h,d,p,m,v;switch(i=i.toLowerCase(),h=null===e?0:-1,null==e&&(e=1/0),c=t+e,p="",i){case"ascii":case"latin1":for(;c>t&&(u=this.peekUInt8(t++))!==h;)p+=String.fromCharCode(u);break;case"utf8":case"utf-8":for(;c>t&&(r=this.peekUInt8(t++))!==h;)0===(128&r)?p+=String.fromCharCode(r):192===(224&r)?(a=63&this.peekUInt8(t++),p+=String.fromCharCode((31&r)<<6|a)):224===(240&r)?(a=63&this.peekUInt8(t++),s=63&this.peekUInt8(t++),p+=String.fromCharCode((15&r)<<12|a<<6|s)):240===(248&r)&&(a=63&this.peekUInt8(t++),s=63&this.peekUInt8(t++),o=63&this.peekUInt8(t++),d=((15&r)<<18|a<<12|s<<6|o)-65536,p+=String.fromCharCode(55296+(d>>10),56320+(1023&d)));break;case"utf16-be":case"utf16be":case"utf16le":case"utf16-le":case"utf16bom":case"utf16-bom":switch(i){case"utf16be":case"utf16-be":f=!1;break;case"utf16le":case"utf16-le":f=!0;break;case"utf16bom":case"utf16-bom":if(2>e||(l=this.peekUInt16(t))===h)return n&&this.advance(t+=2),p;f=65534===l,t+=2}for(;c>t&&(m=this.peekUInt16(t,f))!==h;)if(t+=2,55296>m||m>57343)p+=String.fromCharCode(m);else{if(m>56319)throw new Error("Invalid utf16 sequence.");if(v=this.peekUInt16(t,f),56320>v||v>57343)throw new Error("Invalid utf16 sequence.");p+=String.fromCharCode(m,v),t+=2}m===h&&(t+=2);break;default:throw new Error("Unknown encoding: "+i)}return n&&this.advance(t),p},t}(),m.Bitstream=function(){function t(t){this.stream=t,this.bitPosition=0}return t.prototype.copy=function(){var t;return t=new m.Bitstream(this.stream.copy()),t.bitPosition=this.bitPosition,t},t.prototype.offset=function(){return 8*this.stream.offset+this.bitPosition},t.prototype.available=function(t){return this.stream.available((t+8-this.bitPosition)/8)},t.prototype.advance=function(t){var e;return e=this.bitPosition+t,this.stream.advance(e>>3),this.bitPosition=7&e},t.prototype.rewind=function(t){var e;return e=this.bitPosition-t,this.stream.rewind(Math.abs(e>>3)),this.bitPosition=7&e},t.prototype.seek=function(t){var e;return e=this.offset(),t>e?this.advance(t-e):e>t?this.rewind(e-t):void 0},t.prototype.align=function(){return 0!==this.bitPosition?(this.bitPosition=0,this.stream.advance(1)):void 0},t.prototype.read=function(t,e){var i,n,r,a,s,o,l;if(0===t)return 0;if(l=t+this.bitPosition,8>=l)i=(this.stream.peekUInt8()<<this.bitPosition&255)>>>8-t;else if(16>=l)i=(this.stream.peekUInt16()<<this.bitPosition&65535)>>>16-t;else if(24>=l)i=(this.stream.peekUInt24()<<this.bitPosition&16777215)>>>24-t;else if(32>=l)i=this.stream.peekUInt32()<<this.bitPosition>>>32-t;else{if(!(40>=l))throw new Error("Too many bits!");n=4294967296*this.stream.peekUInt8(0),r=this.stream.peekUInt8(1)<<24>>>0,a=this.stream.peekUInt8(2)<<16,s=this.stream.peekUInt8(3)<<8,o=this.stream.peekUInt8(4),i=n+r+a+s+o,i%=Math.pow(2,40-this.bitPosition),i=Math.floor(i/Math.pow(2,40-this.bitPosition-t))}return e&&(32>l?i>>>t-1&&(i=-1*((1<<t>>>0)-i)):i/Math.pow(2,t-1)|0&&(i=-1*(Math.pow(2,t)-i))),this.advance(t),i},t.prototype.peek=function(t,e){var i,n,r,a,s,o,l;if(0===t)return 0;if(l=t+this.bitPosition,8>=l)i=(this.stream.peekUInt8()<<this.bitPosition&255)>>>8-t;else if(16>=l)i=(this.stream.peekUInt16()<<this.bitPosition&65535)>>>16-t;else if(24>=l)i=(this.stream.peekUInt24()<<this.bitPosition&16777215)>>>24-t;else if(32>=l)i=this.stream.peekUInt32()<<this.bitPosition>>>32-t;else{if(!(40>=l))throw new Error("Too many bits!");n=4294967296*this.stream.peekUInt8(0),r=this.stream.peekUInt8(1)<<24>>>0,a=this.stream.peekUInt8(2)<<16,s=this.stream.peekUInt8(3)<<8,o=this.stream.peekUInt8(4),i=n+r+a+s+o,i%=Math.pow(2,40-this.bitPosition),i=Math.floor(i/Math.pow(2,40-this.bitPosition-t))}return e&&(32>l?i>>>t-1&&(i=-1*((1<<t>>>0)-i)):i/Math.pow(2,t-1)|0&&(i=-1*(Math.pow(2,t)-i))),i},t.prototype.readLSB=function(t,e){var i,n;if(0===t)return 0;if(t>40)throw new Error("Too many bits!");return n=t+this.bitPosition,i=this.stream.peekUInt8(0)>>>this.bitPosition,n>8&&(i|=this.stream.peekUInt8(1)<<8-this.bitPosition),n>16&&(i|=this.stream.peekUInt8(2)<<16-this.bitPosition),n>24&&(i+=this.stream.peekUInt8(3)<<24-this.bitPosition>>>0),n>32&&(i+=this.stream.peekUInt8(4)*Math.pow(2,32-this.bitPosition)),n>=32?i%=Math.pow(2,t):i&=(1<<t)-1,e&&(32>n?i>>>t-1&&(i=-1*((1<<t>>>0)-i)):i/Math.pow(2,t-1)|0&&(i=-1*(Math.pow(2,t)-i))),this.advance(t),i},t.prototype.peekLSB=function(t,e){var i,n;if(0===t)return 0;if(t>40)throw new Error("Too many bits!");return n=t+this.bitPosition,i=this.stream.peekUInt8(0)>>>this.bitPosition,n>8&&(i|=this.stream.peekUInt8(1)<<8-this.bitPosition),n>16&&(i|=this.stream.peekUInt8(2)<<16-this.bitPosition),n>24&&(i+=this.stream.peekUInt8(3)<<24-this.bitPosition>>>0),n>32&&(i+=this.stream.peekUInt8(4)*Math.pow(2,32-this.bitPosition)),n>=32?i%=Math.pow(2,t):i&=(1<<t)-1,e&&(32>n?i>>>t-1&&(i=-1*((1<<t>>>0)-i)):i/Math.pow(2,t-1)|0&&(i=-1*(Math.pow(2,t)-i))),i},t}();var b,v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},w=[].slice;m.EventEmitter=function(t){function e(){return b=e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.on=function(t,e){var i;return null==this.events&&(this.events={}),null==(i=this.events)[t]&&(i[t]=[]),this.events[t].push(e)},e.prototype.off=function(t,e){var i,n;if(null!=(n=this.events)?n[t]:void 0)return i=this.events[t].indexOf(e),~i?this.events[t].splice(i,1):void 0},e.prototype.once=function(t,e){var i;return this.on(t,i=function(){return this.off(t,i),e.apply(this,arguments)})},e.prototype.emit=function(){var t,e,i,n,r,a,s;if(e=arguments[0],t=2<=arguments.length?w.call(arguments,1):[],null!=(a=this.events)?a[e]:void 0)for(s=this.events[e].slice(),n=0,r=s.length;r>n;n++)i=s[n],i.apply(this,t)},e}(m.Base);var k=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.BufferSource=function(t){function e(t){this.loop=k(this.loop,this),t instanceof m.BufferList?this.list=t:(this.list=new m.BufferList,this.list.append(new m.Buffer(t))),this.paused=!0}var i,n;return y(e,t),n=p.setImmediate||function(t){return p.setTimeout(t,0)},i=p.clearImmediate||function(t){return p.clearTimeout(t)},e.prototype.start=function(){return this.paused=!1,this._timer=n(this.loop)},e.prototype.loop=function(){return this.emit("progress",(this.list.numBuffers-this.list.availableBuffers+1)/this.list.numBuffers*100|0),this.emit("data",this.list.first),this.list.advance()?n(this.loop):this.emit("end")},e.prototype.pause=function(){return i(this._timer),this.paused=!0},e.prototype.reset=function(){return this.pause(),this.list.rewind()},e}(m.EventEmitter);var v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.Demuxer=function(t){function e(t,e){var i,n,r=this;i=new m.BufferList,i.append(e),this.stream=new m.Stream(i),n=!1,t.on("data",function(t){return n=!0,i.append(t),r.readChunk(t)}),t.on("error",function(t){return r.emit("error",t)}),t.on("end",function(){return n||r.readChunk(e),r.emit("end")}),this.seekPoints=[],this.init()}var i;return y(e,t),e.probe=function(){return!1},e.prototype.init=function(){},e.prototype.readChunk=function(){},e.prototype.addSeekPoint=function(t,e){var i;return i=this.searchTimestamp(e),this.seekPoints.splice(i,0,{offset:t,timestamp:e})},e.prototype.searchTimestamp=function(t){var e,i,n,r;if(i=0,e=this.seekPoints.length,e>0&&this.seekPoints[e-1].timestamp<t)return e;for(;e>i;)n=i+e>>1,r=this.seekPoints[n].timestamp,t>r?i=n+1:r>=t&&(e=n);return e>this.seekPoints.length&&(e=this.seekPoints.length),e},e.prototype.seek=function(t){var e,i;return this.format&&this.format.framesPerPacket>0&&this.format.bytesPerPacket>0?i={timestamp:t,offset:this.format.bytesPerPacket*t/this.format.framesPerPacket}:(e=this.searchTimestamp(t),this.seekPoints[e])},i=[],e.register=function(t){return i.push(t)},e.find=function(t){var e,n,r,a;for(n=m.Stream.fromBuffer(t),r=0,a=i.length;a>r;r++)if(e=i[r],e.probe(n))return e;return null},e}(m.EventEmitter);var v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.Decoder=function(t){function e(t,e){var i,n=this;this.demuxer=t,this.format=e,i=new m.BufferList,this.stream=new m.Stream(i),this.bitstream=new m.Bitstream(this.stream),this.receivedFinalBuffer=!1,this.waiting=!1,this.demuxer.on("cookie",function(t){var e;try{return n.setCookie(t)}catch(i){return e=i,n.emit("error",e)}}),this.demuxer.on("data",function(t){return i.append(t),n.waiting?n.decode():void 0}),this.demuxer.on("end",function(){return n.receivedFinalBuffer=!0,n.waiting?n.decode():void 0}),this.init()}var i;return y(e,t),e.prototype.init=function(){},e.prototype.setCookie=function(){},e.prototype.readChunk=function(){},e.prototype.decode=function(){var t,e,i;this.waiting=!1,e=this.bitstream.offset();try{i=this.readChunk()}catch(n){if(t=n,!(t instanceof m.UnderflowError))return this.emit("error",t),!1}return i?(this.emit("data",i),!0):(this.receivedFinalBuffer?this.emit("end"):(this.bitstream.seek(e),this.waiting=!0),!1)},e.prototype.seek=function(t){var e;return e=this.demuxer.seek(t),this.stream.seek(e.offset),e.timestamp},i={},e.register=function(t,e){return i[t]=e},e.find=function(t){return i[t]||null},e}(m.EventEmitter);var k=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.Queue=function(t){function e(t){var e=this;this.asset=t,this.write=k(this.write,this),this.readyMark=64,this.finished=!1,this.buffering=!0,this.ended=!1,this.buffers=[],this.asset.on("data",this.write),this.asset.on("end",function(){return e.ended=!0}),this.asset.decodePacket()}return y(e,t),e.prototype.write=function(t){return t&&this.buffers.push(t),this.buffering?this.buffers.length>=this.readyMark||this.ended?(this.buffering=!1,this.emit("ready")):this.asset.decodePacket():void 0},e.prototype.read=function(){return 0===this.buffers.length?null:(this.asset.decodePacket(),this.buffers.shift())},e.prototype.reset=function(){return this.buffers.length=0,this.buffering=!0,this.asset.decodePacket()},e}(m.EventEmitter);var k=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.AudioDevice=function(t){function e(t,e){this.sampleRate=t,this.channels=e,this.updateTime=k(this.updateTime,this),this.playing=!1,this.currentTime=0,this._lastTime=0}var i;return y(e,t),e.prototype.start=function(){var t=this;if(!this.playing){if(this.playing=!0,null==this.device&&(this.device=m.AudioDevice.create(this.sampleRate,this.channels)),!this.device)throw new Error("No supported audio device found.");return this._lastTime=this.device.getDeviceTime(),this._timer=setInterval(this.updateTime,200),this.device.on("refill",this.refill=function(e){return t.emit("refill",e)})}},e.prototype.stop=function(){return this.playing?(this.playing=!1,this.device.off("refill",this.refill),clearInterval(this._timer)):void 0},e.prototype.destroy=function(){return this.stop(),this.device.destroy()},e.prototype.seek=function(t){return this.currentTime=t,this.playing&&(this._lastTime=this.device.getDeviceTime()),this.emit("timeUpdate",this.currentTime)},e.prototype.updateTime=function(){var t;return t=this.device.getDeviceTime(),this.currentTime+=(t-this._lastTime)/this.device.sampleRate*1e3|0,this._lastTime=t,this.emit("timeUpdate",this.currentTime)},i=[],e.register=function(t){return i.push(t)},e.create=function(t,e){var n,r,a;for(r=0,a=i.length;a>r;r++)if(n=i[r],n.supported)return new n(t,e);return null},e}(m.EventEmitter);var k=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.Asset=function(t){function e(t){var e=this;this.source=t,this._decode=k(this._decode,this),this.findDecoder=k(this.findDecoder,this),this.probe=k(this.probe,this),this.buffered=0,this.duration=null,this.format=null,this.metadata=null,this.active=!1,this.demuxer=null,this.decoder=null,this.source.once("data",this.probe),this.source.on("error",function(t){return e.emit("error",t),e.stop()}),this.source.on("progress",function(t){return e.buffered=t,e.emit("buffer",e.buffered)})}return y(e,t),e.fromURL=function(t){return new m.Asset(new m.HTTPSource(t))},e.fromFile=function(t){return new m.Asset(new m.FileSource(t))},e.fromBuffer=function(t){return new m.Asset(new m.BufferSource(t))},e.prototype.start=function(t){return this.active?void 0:(null!=t&&(this.shouldDecode=t),null==this.shouldDecode&&(this.shouldDecode=!0),this.active=!0,this.source.start(),this.decoder&&this.shouldDecode?this._decode():void 0)},e.prototype.stop=function(){return this.active?(this.active=!1,this.source.pause()):void 0},e.prototype.get=function(t,e){var i=this;if("format"===t||"duration"===t||"metadata"===t)return null!=this[t]?e(this[t]):(this.once(t,function(t){return i.stop(),e(t)}),this.start())},e.prototype.decodePacket=function(){return this.decoder.decode()},e.prototype.decodeToBuffer=function(t){var e,i,n;return n=0,e=[],this.on("data",i=function(t){return n+=t.length,e.push(t)}),this.once("end",function(){var r,a,s,o,l;for(r=new Float32Array(n),s=0,o=0,l=e.length;l>o;o++)a=e[o],r.set(a,s),s+=a.length;return this.off("data",i),t(r)}),this.start()},e.prototype.probe=function(t){var e,i=this;if(this.active)return(e=m.Demuxer.find(t))?(this.demuxer=new e(this.source,t),this.demuxer.on("format",this.findDecoder),this.demuxer.on("duration",function(t){return i.duration=t,i.emit("duration",i.duration)}),this.demuxer.on("metadata",function(t){return i.metadata=t,i.emit("metadata",i.metadata)}),this.demuxer.on("error",function(t){return i.emit("error",t),i.stop()})):this.emit("error","A demuxer for this container was not found.")},e.prototype.findDecoder=function(t){var e,i,n=this;return this.format=t,this.active?(this.emit("format",this.format),(e=m.Decoder.find(this.format.formatID))?(this.decoder=new e(this.demuxer,this.format),this.format.floatingPoint?this.decoder.on("data",function(t){return n.emit("data",t)}):(i=Math.pow(2,this.format.bitsPerChannel-1),this.decoder.on("data",function(t){var e,r,a,s,o;for(e=new Float32Array(t.length),r=s=0,o=t.length;o>s;r=++s)a=t[r],e[r]=a/i;return n.emit("data",e)})),this.decoder.on("error",function(t){return n.emit("error",t),n.stop()}),this.decoder.on("end",function(){return n.emit("end")}),this.emit("decodeStart"),this.shouldDecode?this._decode():void 0):this.emit("error","A decoder for "+this.format.formatID+" was not found.")):void 0},e.prototype._decode=function(){for(;this.decoder.decode()&&this.active;);return this.active?this.decoder.once("data",this._decode):void 0},e}(m.EventEmitter);var k=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.Player=function(t){function e(t){var e=this;this.asset=t,this.startPlaying=k(this.startPlaying,this),this.playing=!1,this.buffered=0,this.currentTime=0,this.duration=0,this.volume=100,this.pan=0,this.metadata={},this.filters=[new m.VolumeFilter(this,"volume"),new m.BalanceFilter(this,"pan")],this.asset.on("buffer",function(t){return e.buffered=t,e.emit("buffer",e.buffered)}),this.asset.on("decodeStart",function(){return e.queue=new m.Queue(e.asset),e.queue.once("ready",e.startPlaying)}),this.asset.on("format",function(t){return e.format=t,e.emit("format",e.format)}),this.asset.on("metadata",function(t){return e.metadata=t,e.emit("metadata",e.metadata)}),this.asset.on("duration",function(t){return e.duration=t,e.emit("duration",e.duration)}),this.asset.on("error",function(t){return e.emit("error",t)})}return y(e,t),e.fromURL=function(t){return new m.Player(m.Asset.fromURL(t))},e.fromFile=function(t){return new m.Player(m.Asset.fromFile(t))},e.fromBuffer=function(t){return new m.Player(m.Asset.fromBuffer(t))},e.prototype.preload=function(){return this.asset?(this.startedPreloading=!0,this.asset.start(!1)):void 0},e.prototype.play=function(){var t;if(!this.playing)return this.startedPreloading||this.preload(),this.playing=!0,null!=(t=this.device)?t.start():void 0},e.prototype.pause=function(){var t;if(this.playing)return this.playing=!1,null!=(t=this.device)?t.stop():void 0},e.prototype.togglePlayback=function(){return this.playing?this.pause():this.play()},e.prototype.stop=function(){var t;return this.pause(),this.asset.stop(),null!=(t=this.device)?t.destroy():void 0},e.prototype.seek=function(t){var e,i=this;return null!=(e=this.device)&&e.stop(),this.queue.once("ready",function(){var t,e;return null!=(t=i.device)&&t.seek(i.currentTime),i.playing?null!=(e=i.device)?e.start():void 0:void 0}),t=t/1e3*this.format.sampleRate,t=this.asset.decoder.seek(t),this.currentTime=t/this.format.sampleRate*1e3|0,this.queue.reset(),this.currentTime},e.prototype.startPlaying=function(){var t,e,i=this;return t=this.queue.read(),e=0,this.device=new m.AudioDevice(this.format.sampleRate,this.format.channelsPerFrame),this.device.on("timeUpdate",function(t){return i.currentTime=t,i.emit("progress",i.currentTime)}),this.refill=function(n){var r,a,s,o,l,u,c,f;if(i.playing){for(t||(t=i.queue.read(),e=0),r=0;t&&r<n.length;){for(o=Math.min(t.length-e,n.length-r),s=l=0;o>l;s=l+=1)n[r++]=t[e++];e===t.length&&(t=i.queue.read(),e=0)}for(f=i.filters,u=0,c=f.length;c>u;u++)a=f[u],a.process(n);t||(i.queue.ended?(i.currentTime=i.duration,i.emit("progress",i.currentTime),i.emit("end"),i.stop()):i.device.stop())}},this.device.on("refill",this.refill),this.playing&&this.device.start(),this.emit("ready")},e}(m.EventEmitter),m.Filter=function(){function t(t,e){t&&e&&Object.defineProperty(this,"value",{get:function(){return t[e]}})}return t.prototype.process=function(){},t}();var b,v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.VolumeFilter=function(t){function e(){return b=e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.process=function(t){var e,i,n,r;if(!(this.value>=100))for(i=Math.max(0,Math.min(100,this.value))/100,e=n=0,r=t.length;r>n;e=n+=1)t[e]*=i},e}(m.Filter);var b,v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.BalanceFilter=function(t){function e(){return b=e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.process=function(t){var e,i,n,r;if(0!==this.value)for(i=Math.max(-50,Math.min(50,this.value)),e=n=0,r=t.length;r>n;e=n+=2)t[e]*=Math.min(1,(50-i)/50),t[e+1]*=Math.min(1,(50+i)/50)},e}(m.Filter);var _,b,v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};_=function(t){function e(){return b=e.__super__.constructor.apply(this,arguments)}return y(e,t),m.Demuxer.register(e),e.probe=function(t){return"caff"===t.peekString(0,4)},e.prototype.readChunk=function(){var t,e,i,n,r,a,s,o,l,u,c,f,h,d;if(!this.format&&this.stream.available(64)){if("caff"!==this.stream.readString(4))return this.emit("error","Invalid CAF, does not begin with 'caff'");if(this.stream.advance(4),"desc"!==this.stream.readString(4))return this.emit("error","Invalid CAF, 'caff' is not followed by 'desc'");if(0!==this.stream.readUInt32()||32!==this.stream.readUInt32())return this.emit("error","Invalid 'desc' size, should be 32");this.format={},this.format.sampleRate=this.stream.readFloat64(),this.format.formatID=this.stream.readString(4),r=this.stream.readUInt32(),"lpcm"===this.format.formatID&&(this.format.floatingPoint=Boolean(1&r),this.format.littleEndian=Boolean(2&r)),this.format.bytesPerPacket=this.stream.readUInt32(),this.format.framesPerPacket=this.stream.readUInt32(),this.format.channelsPerFrame=this.stream.readUInt32(),this.format.bitsPerChannel=this.stream.readUInt32(),this.emit("format",this.format)}for(;this.stream.available(1);){if(!this.headerCache&&(this.headerCache={type:this.stream.readString(4),oversize:0!==this.stream.readUInt32(),size:this.stream.readUInt32()},this.headerCache.oversize))return this.emit("error","Holy Shit, an oversized file, not supported in JS");switch(this.headerCache.type){case"kuki":this.stream.available(this.headerCache.size)&&("aac "===this.format.formatID?(l=this.stream.offset+this.headerCache.size,(i=T.readEsds(this.stream))&&this.emit("cookie",i),this.stream.seek(l)):(t=this.stream.readBuffer(this.headerCache.size),this.emit("cookie",t)),this.headerCache=null);break;case"pakt":if(this.stream.available(this.headerCache.size)){if(0!==this.stream.readUInt32())return this.emit("error","Sizes greater than 32 bits are not supported.");if(this.numPackets=this.stream.readUInt32(),0!==this.stream.readUInt32())return this.emit("error","Sizes greater than 32 bits are not supported.");for(this.numFrames=this.stream.readUInt32(),this.primingFrames=this.stream.readUInt32(),this.remainderFrames=this.stream.readUInt32(),this.emit("duration",this.numFrames/this.format.sampleRate*1e3|0),this.sentDuration=!0,e=0,u=0,a=f=0,d=this.numPackets;d>f;a=f+=1)this.addSeekPoint(e,u),e+=this.format.bytesPerPacket||T.readDescrLen(this.stream),u+=this.format.framesPerPacket||T.readDescrLen(this.stream);this.headerCache=null}break;case"info":for(n=this.stream.readUInt32(),o={},a=h=0;n>=0?n>h:h>n;a=n>=0?++h:--h)s=this.stream.readString(null),c=this.stream.readString(null),o[s]=c;this.emit("metadata",o),this.headerCache=null;break;case"data":this.sentFirstDataChunk||(this.stream.advance(4),this.headerCache.size-=4,0===this.format.bytesPerPacket||this.sentDuration||(this.numFrames=this.headerCache.size/this.format.bytesPerPacket,this.emit("duration",this.numFrames/this.format.sampleRate*1e3|0)),this.sentFirstDataChunk=!0),t=this.stream.readSingleBuffer(this.headerCache.size),this.headerCache.size-=t.length,this.emit("data",t),this.headerCache.size<=0&&(this.headerCache=null);break;default:this.stream.available(this.headerCache.size)&&(this.stream.advance(this.headerCache.size),this.headerCache=null)}}},e}(m.Demuxer);var T,b,v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},g=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};T=function(t){function e(){return b=e.__super__.constructor.apply(this,arguments)}var i,n,r,a,s,o,l,u,c,f,h;return y(e,t),m.Demuxer.register(e),n=["M4A ","M4P ","M4B ","M4V ","isom","mp42","qt  "],e.probe=function(t){var e;return"ftyp"===t.peekString(4,4)&&(e=t.peekString(8,4),g.call(n,e)>=0)},e.prototype.init=function(){return this.atoms=[],this.offsets=[],this.track=null,this.tracks=[]},s={},l={},a=function(t,e){var i,n,r,a,o;for(i=[],o=t.split(".").slice(0,-1),r=0,a=o.length;a>r;r++)n=o[r],i.push(n),l[i.join(".")]=!0;return null==s[t]&&(s[t]={}),s[t].fn=e},r=function(t,e){return null==s[t]&&(s[t]={}),s[t].after=e},e.prototype.readChunk=function(){var t,e,i;for(this["break"]=!1;this.stream.available(1)&&!this["break"];){if(!this.readHeaders){if(!this.stream.available(8))return;if(this.len=this.stream.readUInt32()-8,this.type=this.stream.readString(4),0===this.len)continue;this.atoms.push(this.type),this.offsets.push(this.stream.offset+this.len),this.readHeaders=!0}if(e=this.atoms.join("."),t=s[e],null!=t?t.fn:void 0){if(!this.stream.available(this.len)&&"mdat"!==e)return;t.fn.call(this),e in l&&(this.readHeaders=!1)}else if(e in l)this.readHeaders=!1;else{if(!this.stream.available(this.len))return;this.stream.advance(this.len)}for(;this.stream.offset>=this.offsets[this.offsets.length-1];)t=s[this.atoms.join(".")],(null!=t?t.after:void 0)&&t.after.call(this),i=this.atoms.pop(),this.offsets.pop(),this.readHeaders=!1}},a("ftyp",function(){var t;return t=this.stream.readString(4),g.call(n,t)<0?this.emit("error","Not a valid M4A file."):this.stream.advance(this.len-4)}),a("moov.trak",function(){return this.track={},this.tracks.push(this.track)}),a("moov.trak.tkhd",function(){return this.stream.advance(4),this.stream.advance(8),this.track.id=this.stream.readUInt32(),this.stream.advance(this.len-16)}),a("moov.trak.mdia.hdlr",function(){return this.stream.advance(4),this.stream.advance(4),this.track.type=this.stream.readString(4),this.stream.advance(12),this.stream.advance(this.len-24)}),a("moov.trak.mdia.mdhd",function(){return this.stream.advance(4),this.stream.advance(8),this.track.timeScale=this.stream.readUInt32(),this.track.duration=this.stream.readUInt32(),this.stream.advance(4)}),i={ulaw:8,alaw:8,in24:24,in32:32,fl32:32,fl64:64},a("moov.trak.mdia.minf.stbl.stsd",function(){var t,e,n,r,a;return this.stream.advance(4),e=this.stream.readUInt32(),"soun"!==this.track.type?this.stream.advance(this.len-8):1!==e?this.emit("error","Only expecting one entry in sample description atom!"):(this.stream.advance(4),t=this.track.format={},t.formatID=this.stream.readString(4),this.stream.advance(6),this.stream.advance(2),n=this.stream.readUInt16(),this.stream.advance(6),t.channelsPerFrame=this.stream.readUInt16(),t.bitsPerChannel=this.stream.readUInt16(),this.stream.advance(4),t.sampleRate=this.stream.readUInt16(),this.stream.advance(2),1===n?(t.framesPerPacket=this.stream.readUInt32(),this.stream.advance(4),t.bytesPerFrame=this.stream.readUInt32(),this.stream.advance(4)):0!==n&&this.emit("error","Unknown version in stsd atom"),null!=i[t.formatID]&&(t.bitsPerChannel=i[t.formatID]),t.floatingPoint="fl32"===(r=t.formatID)||"fl64"===r,t.littleEndian="sowt"===t.formatID&&t.bitsPerChannel>8,"twos"===(a=t.formatID)||"sowt"===a||"in24"===a||"in32"===a||"fl32"===a||"fl64"===a||"raw "===a||"NONE"===a?t.formatID="lpcm":void 0)}),a("moov.trak.mdia.minf.stbl.stsd.alac",function(){return this.stream.advance(4),this.track.cookie=this.stream.readBuffer(this.len-4)}),a("moov.trak.mdia.minf.stbl.stsd.esds",function(){var t;return t=this.stream.offset+this.len,this.track.cookie=e.readEsds(this.stream),this.stream.seek(t)}),a("moov.trak.mdia.minf.stbl.stsd.wave.enda",function(){return this.track.format.littleEndian=!!this.stream.readUInt16()}),e.readDescrLen=function(t){var e,i,n;for(n=0,i=4;i--&&(e=t.readUInt8(),n=n<<7|127&e,128&e););return n},e.readEsds=function(t){var i,n,r,a;return t.advance(4),a=t.readUInt8(),r=e.readDescrLen(t),3===a?(t.advance(2),n=t.readUInt8(),128&n&&t.advance(2),64&n&&t.advance(t.readUInt8()),32&n&&t.advance(2)):t.advance(2),a=t.readUInt8(),r=e.readDescrLen(t),4===a&&(i=t.readUInt8(),t.advance(1),t.advance(3),t.advance(4),t.advance(4),a=t.readUInt8(),r=e.readDescrLen(t),5===a)?t.readBuffer(r):null},a("moov.trak.mdia.minf.stbl.stts",function(){var t,e,i;for(this.stream.advance(4),t=this.stream.readUInt32(),this.track.stts=[],e=i=0;t>i;e=i+=1)this.track.stts[e]={count:this.stream.readUInt32(),duration:this.stream.readUInt32()};return this.setupSeekPoints()}),a("moov.trak.mdia.minf.stbl.stsc",function(){var t,e,i;for(this.stream.advance(4),t=this.stream.readUInt32(),this.track.stsc=[],e=i=0;t>i;e=i+=1)this.track.stsc[e]={first:this.stream.readUInt32(),count:this.stream.readUInt32(),id:this.stream.readUInt32()};return this.setupSeekPoints()}),a("moov.trak.mdia.minf.stbl.stsz",function(){var t,e,i;if(this.stream.advance(4),this.track.sampleSize=this.stream.readUInt32(),t=this.stream.readUInt32(),0===this.track.sampleSize&&t>0)for(this.track.sampleSizes=[],e=i=0;t>i;e=i+=1)this.track.sampleSizes[e]=this.stream.readUInt32();return this.setupSeekPoints()}),a("moov.trak.mdia.minf.stbl.stco",function(){var t,e,i;for(this.stream.advance(4),t=this.stream.readUInt32(),this.track.chunkOffsets=[],e=i=0;t>i;e=i+=1)this.track.chunkOffsets[e]=this.stream.readUInt32();return this.setupSeekPoints()}),a("moov.trak.tref.chap",function(){var t,e,i;for(t=this.len>>2,this.track.chapterTracks=[],e=i=0;t>i;e=i+=1)this.track.chapterTracks[e]=this.stream.readUInt32()}),e.prototype.setupSeekPoints=function(){var t,e,i,n,r,a,s,o,l,u,c,f,h,d,p,m;if(null!=this.track.chunkOffsets&&null!=this.track.stsc&&null!=this.track.sampleSize&&null!=this.track.stts){for(s=0,o=0,o=0,l=0,r=0,i=0,u=0,this.track.seekPoints=[],d=this.track.chunkOffsets,m=[],t=c=0,h=d.length;h>c;t=++c){for(n=d[t],e=f=0,p=this.track.stsc[s].count;p>f;e=f+=1)this.track.seekPoints.push({offset:i,position:n,timestamp:u}),a=this.track.sampleSize||this.track.sampleSizes[r++],i+=a,n+=a,u+=this.track.stts[o].duration,o+1<this.track.stts.length&&++l===this.track.stts[o].count&&(l=0,o++);s+1<this.track.stsc.length&&t+1===this.track.stsc[s+1].first?m.push(s++):m.push(void 0)}return m}},r("moov",function(){var t,e,i,n;for(null!=this.mdatOffset&&this.stream.seek(this.mdatOffset-8),n=this.tracks,e=0,i=n.length;i>e;e++)if(t=n[e],"soun"===t.type){this.track=t;break}return"soun"!==this.track.type?(this.track=null,this.emit("error","No audio tracks in m4a file.")):(this.emit("format",this.track.format),this.emit("duration",this.track.duration/this.track.timeScale*1e3|0),this.track.cookie&&this.emit("cookie",this.track.cookie),this.seekPoints=this.track.seekPoints)}),a("mdat",function(){var t,e,i,n,r,a,s,o;if(!this.startedData){if(null==this.mdatOffset&&(this.mdatOffset=this.stream.offset),0===this.tracks.length)return t=Math.min(this.stream.remainingBytes(),this.len),this.stream.advance(t),this.len-=t,void 0;this.chunkIndex=0,this.stscIndex=0,this.sampleIndex=0,this.tailOffset=0,this.tailSamples=0,this.startedData=!0
}if(!this.readChapters){if(this.readChapters=this.parseChapters(),this["break"]=!this.readChapters)return;this.stream.seek(this.mdatOffset)}if(r=this.track.chunkOffsets[this.chunkIndex]+this.tailOffset,i=0,!this.stream.available(r-this.stream.offset))return this["break"]=!0,void 0;for(this.stream.seek(r);this.chunkIndex<this.track.chunkOffsets.length;){for(n=this.track.stsc[this.stscIndex].count-this.tailSamples,e=0,a=o=0;n>o&&(s=this.track.sampleSize||this.track.sampleSizes[this.sampleIndex],this.stream.available(i+s));a=o+=1)i+=s,e+=s,this.sampleIndex++;if(n>a){this.tailOffset+=e,this.tailSamples+=a;break}if(this.chunkIndex++,this.tailOffset=0,this.tailSamples=0,this.stscIndex+1<this.track.stsc.length&&this.chunkIndex+1===this.track.stsc[this.stscIndex+1].first&&this.stscIndex++,r+i!==this.track.chunkOffsets[this.chunkIndex])break}return i>0?(this.emit("data",this.stream.readBuffer(i)),this["break"]=this.chunkIndex===this.track.chunkOffsets.length):this["break"]=!0}),e.prototype.parseChapters=function(){var t,e,i,n,r,a,s,o,l,u,c,f,h;if(!((null!=(u=this.track.chapterTracks)?u.length:void 0)>0))return!0;for(e=this.track.chapterTracks[0],c=this.tracks,o=0,l=c.length;l>o&&(s=c[o],s.id!==e);o++);for(s.id!==e&&this.emit("error","Chapter track does not exist."),null==this.chapters&&(this.chapters=[]);this.chapters.length<s.seekPoints.length;){if(r=s.seekPoints[this.chapters.length],!this.stream.available(r.position-this.stream.offset+32))return!1;if(this.stream.seek(r.position),i=this.stream.readUInt16(),a=null,!this.stream.available(i))return!1;i>2&&(t=this.stream.peekUInt16(),(65279===t||65534===t)&&(a=this.stream.readString(i,"utf16-bom"))),null==a&&(a=this.stream.readString(i,"utf8")),n=null!=(f=null!=(h=s.seekPoints[this.chapters.length+1])?h.timestamp:void 0)?f:s.duration,this.chapters.push({title:a,timestamp:r.timestamp/s.timeScale*1e3|0,duration:(n-r.timestamp)/s.timeScale*1e3|0})}return this.emit("chapters",this.chapters),!0},a("moov.udta.meta",function(){return this.metadata={},this.stream.advance(4)}),r("moov.udta.meta",function(){return this.emit("metadata",this.metadata)}),f=function(t,e,i){return a("moov.udta.meta.ilst."+t+".data",function(){return this.stream.advance(8),this.len-=8,i.call(this,e)})},h=function(t){return this.metadata[t]=this.stream.readString(this.len,"utf8")},f("©alb","album",h),f("©arg","arranger",h),f("©art","artist",h),f("©ART","artist",h),f("aART","albumArtist",h),f("catg","category",h),f("©com","composer",h),f("©cpy","copyright",h),f("cprt","copyright",h),f("©cmt","comments",h),f("©day","releaseDate",h),f("desc","description",h),f("©gen","genre",h),f("©grp","grouping",h),f("©isr","ISRC",h),f("keyw","keywords",h),f("©lab","recordLabel",h),f("ldes","longDescription",h),f("©lyr","lyrics",h),f("©nam","title",h),f("©phg","recordingCopyright",h),f("©prd","producer",h),f("©prf","performers",h),f("purd","purchaseDate",h),f("purl","podcastURL",h),f("©swf","songwriter",h),f("©too","encoder",h),f("©wrt","composer",h),f("covr","coverArt",function(t){return this.metadata[t]=this.stream.readBuffer(this.len)}),c=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychadelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Capella","Euro-House","Dance Hall"],f("gnre","genre",function(t){return this.metadata[t]=c[this.stream.readUInt16()-1]}),f("tmpo","tempo",function(t){return this.metadata[t]=this.stream.readUInt16()}),f("rtng","rating",function(t){var e;return e=this.stream.readUInt8(),this.metadata[t]=2===e?"Clean":0!==e?"Explicit":"None"}),u=function(t){return this.stream.advance(2),this.metadata[t]=this.stream.readUInt16()+" of "+this.stream.readUInt16(),this.stream.advance(this.len-6)},f("disk","diskNumber",u),f("trkn","trackNumber",u),o=function(t){return this.metadata[t]=1===this.stream.readUInt8()},f("cpil","compilation",o),f("pcst","podcast",o),f("pgap","gapless",o),e}(m.Demuxer);var I,b,v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};I=function(t){function e(){return b=e.__super__.constructor.apply(this,arguments)}return y(e,t),m.Demuxer.register(e),e.probe=function(t){var e;return"FORM"===t.peekString(0,4)&&("AIFF"===(e=t.peekString(8,4))||"AIFC"===e)},e.prototype.readChunk=function(){var t,e,i,n;if(!this.readStart&&this.stream.available(12)){if("FORM"!==this.stream.readString(4))return this.emit("error","Invalid AIFF.");if(this.fileSize=this.stream.readUInt32(),this.fileType=this.stream.readString(4),this.readStart=!0,"AIFF"!==(n=this.fileType)&&"AIFC"!==n)return this.emit("error","Invalid AIFF.")}for(;this.stream.available(1);){switch(!this.readHeaders&&this.stream.available(8)&&(this.type=this.stream.readString(4),this.len=this.stream.readUInt32()),this.type){case"COMM":if(!this.stream.available(this.len))return;this.format={formatID:"lpcm",channelsPerFrame:this.stream.readUInt16(),sampleCount:this.stream.readUInt32(),bitsPerChannel:this.stream.readUInt16(),sampleRate:this.stream.readFloat80(),framesPerPacket:1,littleEndian:!1,floatingPoint:!1},this.format.bytesPerPacket=this.format.bitsPerChannel/8*this.format.channelsPerFrame,"AIFC"===this.fileType&&(e=this.stream.readString(4),this.format.littleEndian="sowt"===e&&this.format.bitsPerChannel>8,this.format.floatingPoint="fl32"===e||"fl64"===e,("twos"===e||"sowt"===e||"fl32"===e||"fl64"===e||"NONE"===e)&&(e="lpcm"),this.format.formatID=e,this.len-=4),this.stream.advance(this.len-18),this.emit("format",this.format),this.emit("duration",this.format.sampleCount/this.format.sampleRate*1e3|0);break;case"SSND":this.readSSNDHeader&&this.stream.available(4)||(i=this.stream.readUInt32(),this.stream.advance(4),this.stream.advance(i),this.readSSNDHeader=!0),t=this.stream.readSingleBuffer(this.len),this.len-=t.length,this.readHeaders=this.len>0,this.emit("data",t);break;default:if(!this.stream.available(this.len))return;this.stream.advance(this.len)}"SSND"!==this.type&&(this.readHeaders=!1)}},e}(m.Demuxer);var S,b,v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};S=function(t){function e(){return b=e.__super__.constructor.apply(this,arguments)}var i;return y(e,t),m.Demuxer.register(e),e.probe=function(t){return"RIFF"===t.peekString(0,4)&&"WAVE"===t.peekString(8,4)},i={1:"lpcm",3:"lpcm",6:"alaw",7:"ulaw"},e.prototype.readChunk=function(){var t,e,n;if(!this.readStart&&this.stream.available(12)){if("RIFF"!==this.stream.readString(4))return this.emit("error","Invalid WAV file.");if(this.fileSize=this.stream.readUInt32(!0),this.readStart=!0,"WAVE"!==this.stream.readString(4))return this.emit("error","Invalid WAV file.")}for(;this.stream.available(1);){switch(!this.readHeaders&&this.stream.available(8)&&(this.type=this.stream.readString(4),this.len=this.stream.readUInt32(!0)),this.type){case"fmt ":if(n=this.stream.readUInt16(!0),!(n in i))return this.emit("error","Unsupported format in WAV file.");this.format={formatID:i[n],floatingPoint:3===n,littleEndian:"lpcm"===i[n],channelsPerFrame:this.stream.readUInt16(!0),sampleRate:this.stream.readUInt32(!0),framesPerPacket:1},this.stream.advance(4),this.stream.advance(2),this.format.bitsPerChannel=this.stream.readUInt16(!0),this.format.bytesPerPacket=this.format.bitsPerChannel/8*this.format.channelsPerFrame,this.emit("format",this.format),this.stream.advance(this.len-16);break;case"data":this.sentDuration||(e=this.format.bitsPerChannel/8,this.emit("duration",this.len/e/this.format.channelsPerFrame/this.format.sampleRate*1e3|0),this.sentDuration=!0),t=this.stream.readSingleBuffer(this.len),this.len-=t.length,this.readHeaders=this.len>0,this.emit("data",t);break;default:if(!this.stream.available(this.len))return;this.stream.advance(this.len)}"data"!==this.type&&(this.readHeaders=!1)}},e}(m.Demuxer);var x,b,v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};x=function(t){function e(){return b=e.__super__.constructor.apply(this,arguments)}var i,n;return y(e,t),m.Demuxer.register(e),e.probe=function(t){return".snd"===t.peekString(0,4)},i=[8,8,16,24,32,32,64],i[26]=8,n={1:"ulaw",27:"alaw"},e.prototype.readChunk=function(){var t,e,r,a;if(!this.readHeader&&this.stream.available(24)){if(".snd"!==this.stream.readString(4))return this.emit("error","Invalid AU file.");if(a=this.stream.readUInt32(),e=this.stream.readUInt32(),r=this.stream.readUInt32(),this.format={formatID:n[r]||"lpcm",littleEndian:!1,floatingPoint:6===r||7===r,bitsPerChannel:i[r-1],sampleRate:this.stream.readUInt32(),channelsPerFrame:this.stream.readUInt32(),framesPerPacket:1},null==this.format.bitsPerChannel)return this.emit("error","Unsupported encoding in AU file.");this.format.bytesPerPacket=this.format.bitsPerChannel/8*this.format.channelsPerFrame,4294967295!==e&&(t=this.format.bitsPerChannel/8,this.emit("duration",e/t/this.format.channelsPerFrame/this.format.sampleRate*1e3|0)),this.emit("format",this.format),this.readHeader=!0}if(this.readHeader)for(;this.stream.available(1);)this.emit("data",this.stream.readSingleBuffer(this.stream.remainingBytes()))},e}(m.Demuxer);var P,b,k=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};P=function(t){function e(){return this.readChunk=k(this.readChunk,this),b=e.__super__.constructor.apply(this,arguments)}return y(e,t),m.Decoder.register("lpcm",e),e.prototype.readChunk=function(){var t,e,i,n,r,a,s,o,l,u,c,f;if(a=this.stream,i=this.format.littleEndian,t=Math.min(4096,a.remainingBytes()),r=t/(this.format.bitsPerChannel/8)|0,t<this.format.bitsPerChannel/8)return null;if(this.format.floatingPoint)switch(this.format.bitsPerChannel){case 32:for(n=new Float32Array(r),e=s=0;r>s;e=s+=1)n[e]=a.readFloat32(i);break;case 64:for(n=new Float64Array(r),e=o=0;r>o;e=o+=1)n[e]=a.readFloat64(i);break;default:throw new Error("Unsupported bit depth.")}else switch(this.format.bitsPerChannel){case 8:for(n=new Int8Array(r),e=l=0;r>l;e=l+=1)n[e]=a.readInt8();break;case 16:for(n=new Int16Array(r),e=u=0;r>u;e=u+=1)n[e]=a.readInt16(i);break;case 24:for(n=new Int32Array(r),e=c=0;r>c;e=c+=1)n[e]=a.readInt24(i);break;case 32:for(n=new Int32Array(r),e=f=0;r>f;e=f+=1)n[e]=a.readInt32(i);break;default:throw new Error("Unsupported bit depth.")}return n},e}(m.Decoder);var E,b,k=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};E=function(t){function e(){return this.readChunk=k(this.readChunk,this),b=e.__super__.constructor.apply(this,arguments)}var i,n,r,a,s;return y(e,t),m.Decoder.register("ulaw",e),m.Decoder.register("alaw",e),s=128,n=15,a=4,r=112,i=132,e.prototype.init=function(){var t,e,o,l,u,c,f;if(this.format.bitsPerChannel=16,this.table=l=new Int16Array(256),"ulaw"===this.format.formatID)for(t=c=0;256>c;t=++c)u=~t,o=((u&n)<<3)+i,o<<=(u&r)>>>a,l[t]=u&s?i-o:o-i;else for(t=f=0;256>f;t=++f)u=85^t,o=u&n,e=(u&r)>>>a,o=e?o+o+1+32<<e+2:o+o+1<<3,l[t]=u&s?o:-o},e.prototype.readChunk=function(){var t,e,i,n,r,a;if(n=this.stream,r=this.table,i=Math.min(4096,this.stream.remainingBytes()),0!==i){for(e=new Int16Array(i),t=a=0;i>a;t=a+=1)e[t]=r[n.readUInt8()];return e}},e}(m.Decoder);var v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.HTTPSource=function(t){function e(t){this.url=t,this.chunkSize=1<<20,this.inflight=!1,this.reset()}return y(e,t),e.prototype.start=function(){var t=this;return this.length&&!this.inflight?this.loop():(this.inflight=!0,this.xhr=new XMLHttpRequest,this.xhr.onload=function(){return t.length=parseInt(t.xhr.getResponseHeader("Content-Length")),t.inflight=!1,t.loop()},this.xhr.onerror=function(e){return t.pause(),t.emit("error",e)},this.xhr.onabort=function(){return t.inflight=!1},this.xhr.open("HEAD",this.url,!0),this.xhr.send(null))},e.prototype.loop=function(){var t,e=this;return this.inflight||!this.length?this.emit("error","Something is wrong in HTTPSource.loop"):(this.inflight=!0,this.xhr=new XMLHttpRequest,this.xhr.onload=function(){var t,i,n,r,a,s;if(e.xhr.response)t=new Uint8Array(e.xhr.response);else for(r=e.xhr.responseText,t=new Uint8Array(r.length),n=a=0,s=r.length;s>=0?s>a:a>s;n=s>=0?++a:--a)t[n]=255&r.charCodeAt(n);return i=new m.Buffer(t),e.offset+=i.length,e.emit("data",i),e.offset>=e.length&&e.emit("end"),e.inflight=!1,e.offset>=e.length?void 0:e.loop()},this.xhr.onprogress=function(t){return e.emit("progress",(e.offset+t.loaded)/e.length*100)},this.xhr.onerror=function(t){return e.emit("error",t),e.pause()},this.xhr.onabort=function(){return e.inflight=!1},this.xhr.open("GET",this.url,!0),this.xhr.responseType="arraybuffer",t=Math.min(this.offset+this.chunkSize,this.length),this.xhr.setRequestHeader("Range","bytes="+this.offset+"-"+t),this.xhr.overrideMimeType("text/plain; charset=x-user-defined"),this.xhr.send(null))},e.prototype.pause=function(){var t;return this.inflight=!1,null!=(t=this.xhr)?t.abort():void 0},e.prototype.reset=function(){return this.pause(),this.offset=0},e}(m.EventEmitter);var v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};m.FileSource=function(t){function e(t){return this.file=t,"undefined"==typeof FileReader||null===FileReader?this.emit("error","This browser does not have FileReader support."):(this.offset=0,this.length=this.file.size,this.chunkSize=1<<20,this.file[this.slice="slice"]||this.file[this.slice="webkitSlice"]||this.file[this.slice="mozSlice"],void 0)}return y(e,t),e.prototype.start=function(){var t=this;return this.reader&&!this.active?this.loop():(this.reader=new FileReader,this.active=!0,this.reader.onload=function(e){var i;return i=new m.Buffer(new Uint8Array(e.target.result)),t.offset+=i.length,t.emit("data",i),t.active=!1,t.offset<t.length?t.loop():void 0},this.reader.onloadend=function(){return t.offset===t.length?(t.emit("end"),t.reader=null):void 0},this.reader.onerror=function(e){return t.emit("error",e)},this.reader.onprogress=function(e){return t.emit("progress",(t.offset+e.loaded)/t.length*100)},this.loop())},e.prototype.loop=function(){var t,e;return this.active=!0,e=Math.min(this.offset+this.chunkSize,this.length),t=this.file[this.slice](this.offset,e),this.reader.readAsArrayBuffer(t)},e.prototype.pause=function(){var t;return this.active=!1,null!=(t=this.reader)?t.abort():void 0},e.prototype.reset=function(){return this.pause(),this.offset=0},e}(m.EventEmitter),t.prototype.initialize=function(){if(!(this.fromSampleRate>0&&this.toSampleRate>0&&this.channels>0))throw new Error("Invalid settings specified for the resampler.");this.fromSampleRate==this.toSampleRate?(this.resampler=this.bypassResampler,this.ratioWeight=1):(this.fromSampleRate<this.toSampleRate?(this.compileLinearInterpolationFunction(),this.lastWeight=1):(this.compileMultiTapFunction(),this.tailExists=!1,this.lastWeight=0),this.ratioWeight=this.fromSampleRate/this.toSampleRate,this.initializeBuffers())},t.prototype.compileLinearInterpolationFunction=function(){for(var t="var bufferLength = buffer.length;  var outLength = this.outputBufferSize;  if ((bufferLength % "+this.channels+") == 0) {    if (bufferLength > 0) {     var ratioWeight = this.ratioWeight;     var weight = this.lastWeight;     var firstWeight = 0;      var secondWeight = 0;     var sourceOffset = 0;     var outputOffset = 0;     var outputBuffer = this.outputBuffer;     for (; weight < 1; weight += ratioWeight) {       secondWeight = weight % 1;        firstWeight = 1 - secondWeight;",e=0;e<this.channels;++e)t+="outputBuffer[outputOffset++] = (this.lastOutput["+e+"] * firstWeight) + (buffer["+e+"] * secondWeight);";t+="}      weight -= 1;      for (bufferLength -= "+this.channels+", sourceOffset = Math.floor(weight) * "+this.channels+"; outputOffset < outLength && sourceOffset < bufferLength;) {        secondWeight = weight % 1;        firstWeight = 1 - secondWeight;";for(var e=0;e<this.channels;++e)t+="outputBuffer[outputOffset++] = (buffer[sourceOffset"+(e>0?" + "+e:"")+"] * firstWeight) + (buffer[sourceOffset + "+(this.channels+e)+"] * secondWeight);";t+="weight += ratioWeight;        sourceOffset = Math.floor(weight) * "+this.channels+";      }";for(var e=0;e<this.channels;++e)t+="this.lastOutput["+e+"] = buffer[sourceOffset++];";t+='this.lastWeight = weight % 1;     return this.bufferSlice(outputOffset);    }   else {      return (this.noReturn) ? 0 : [];    } } else {    throw(new Error("Buffer was of incorrect sample length.")); }',this.resampler=Function("buffer",t)},t.prototype.compileMultiTapFunction=function(){for(var t="var bufferLength = buffer.length; var outLength = this.outputBufferSize;  if ((bufferLength % "+this.channels+") == 0) {    if (bufferLength > 0) {     var ratioWeight = this.ratioWeight;     var weight = 0;",e=0;e<this.channels;++e)t+="var output"+e+" = 0;";for(t+="var actualPosition = 0;     var amountToNext = 0;     var alreadyProcessedTail = !this.tailExists;      this.tailExists = false;      var outputBuffer = this.outputBuffer;     var outputOffset = 0;     var currentPosition = 0;      do {        if (alreadyProcessedTail) {         weight = ratioWeight;",e=0;e<this.channels;++e)t+="output"+e+" = 0;";for(t+="}       else {          weight = this.lastWeight;",e=0;e<this.channels;++e)t+="output"+e+" = this.lastOutput["+e+"];";for(t+="alreadyProcessedTail = true;       }       while (weight > 0 && actualPosition < bufferLength) {         amountToNext = 1 + actualPosition - currentPosition;          if (weight >= amountToNext) {",e=0;e<this.channels;++e)t+="output"+e+" += buffer[actualPosition++] * amountToNext;";for(t+="currentPosition = actualPosition;            weight -= amountToNext;         }         else {",e=0;e<this.channels;++e)t+="output"+e+" += buffer[actualPosition"+(e>0?" + "+e:"")+"] * weight;";for(t+="currentPosition += weight;            weight = 0;           break;          }       }       if (weight == 0) {",e=0;e<this.channels;++e)t+="outputBuffer[outputOffset++] = output"+e+" / ratioWeight;";for(t+="}       else {          this.lastWeight = weight;",e=0;e<this.channels;++e)t+="this.lastOutput["+e+"] = output"+e+";";t+='this.tailExists = true;          break;        }     } while (actualPosition < bufferLength && outputOffset < outLength);      return this.bufferSlice(outputOffset);    }   else {      return (this.noReturn) ? 0 : [];    } } else {    throw(new Error("Buffer was of incorrect sample length.")); }',this.resampler=Function("buffer",t)},t.prototype.bypassResampler=function(t){return this.noReturn?(this.outputBuffer=t,t.length):t},t.prototype.bufferSlice=function(t){if(this.noReturn)return t;try{return this.outputBuffer.subarray(0,t)}catch(e){try{return this.outputBuffer.length=t,this.outputBuffer}catch(e){return this.outputBuffer.slice(0,t)}}},t.prototype.initializeBuffers=function(){try{this.outputBuffer=new Float32Array(this.outputBufferSize),this.lastOutput=new Float32Array(this.channels)}catch(t){this.outputBuffer=[],this.lastOutput=[]}};var C,k=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};C=function(e){function i(e,i){this.sampleRate=e,this.channels=i,this.refill=k(this.refill,this),this.context=null!=a?a:a=new n,this.deviceSampleRate=this.context.sampleRate,this.bufferSize=Math.ceil(4096/(this.deviceSampleRate/this.sampleRate)*this.channels),this.bufferSize+=this.bufferSize%this.channels,this.deviceSampleRate!==this.sampleRate&&(this.resampler=new t(this.sampleRate,this.deviceSampleRate,this.channels,4096*this.channels)),this.node=this.context[r](4096,this.channels,this.channels),this.node.onaudioprocess=this.refill,this.node.connect(this.context.destination)}var n,r,a;return y(i,e),m.AudioDevice.register(i),n=p.AudioContext||p.webkitAudioContext,i.supported=n&&("function"==typeof n.prototype[r="createScriptProcessor"]||"function"==typeof n.prototype[r="createJavaScriptNode"]),a=null,i.prototype.refill=function(t){var e,i,n,r,a,s,o,l,u,c;for(s=t.outputBuffer,e=s.numberOfChannels,i=new Array(e),r=o=0;e>o;r=o+=1)i[r]=s.getChannelData(r);for(n=new Float32Array(this.bufferSize),this.emit("refill",n),this.resampler&&(n=this.resampler.resampler(n)),r=l=0,c=s.length;c>l;r=l+=1)for(a=u=0;e>u;a=u+=1)i[a][r]=n[r*e+a]},i.prototype.destroy=function(){return this.node.disconnect(0)},i.prototype.getDeviceTime=function(){return this.context.currentTime*this.sampleRate},i}(m.EventEmitter);var A,k=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,y=function(t,e){function i(){this.constructor=t}for(var n in e)v.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};A=function(t){function e(t,e){this.sampleRate=t,this.channels=e,this.refill=k(this.refill,this),this.audio=new Audio,this.audio.mozSetup(this.channels,this.sampleRate),this.writePosition=0,this.prebufferSize=this.sampleRate/2,this.tail=null,this.timer=i(this.refill,100)}var i,n;return y(e,t),m.AudioDevice.register(e),e.supported="undefined"!=typeof Audio&&null!==Audio&&"mozWriteAudio"in new Audio,e.prototype.refill=function(){var t,e,i,n;this.tail&&(n=this.audio.mozWriteAudio(this.tail),this.writePosition+=n,this.tail=this.writePosition<this.tail.length?this.tail.subarray(n):null),i=this.audio.mozCurrentSampleOffset(),t=i+this.prebufferSize-this.writePosition,t>0&&(e=new Float32Array(t),this.emit("refill",e),n=this.audio.mozWriteAudio(e),n<e.length&&(this.tail=e.subarray(n)),this.writePosition+=n)},e.prototype.destroy=function(){return n(this.timer)},e.prototype.getDeviceTime=function(){return this.audio.mozCurrentSampleOffset()/this.channels},i=function(t,e){var i,n;return i=m.Buffer.makeBlobURL("setInterval(function() { postMessage('ping'); }, "+e+");"),null==i?setInterval(t,e):(n=new Worker(i),n.onmessage=t,n.url=i,n)},n=function(t){return t.terminate?(t.terminate(),URL.revokeObjectURL(t.url)):clearInterval(t)},e}(m.EventEmitter);const O=["latin1","utf16-bom","utf16-be","utf8"];var R=m.Base.extend({constructor:function(t,e){this.header=t,this.stream=e,this.offset=0},read:function(){if(!this.data){this.data={};for(var t;t=this.readFrame();)t.key in this.data?(Array.isArray(this.data[t.key])||(this.data[t.key]=[this.data[t.key]]),this.data[t.key].push(t.value)):this.data[t.key]=t.value}return this.data},readFrame:function(){if(this.offset>=this.header.length)return null;var t=this.readHeader(),e=t.identifier;if(0===t.identifier.charCodeAt(0))return this.offset+=this.header.length+1,null;if(!this.frameTypes[e])for(var i in this.map)if(-1!==this.map[i].indexOf(e)){e=i;break}if(this.frameTypes[e]){var n=this.decodeFrame(t,this.frameTypes[e]),r=Object.keys(n);1===r.length&&(n=n[r[0]]);var a={value:n}}else var a={value:this.stream.readBuffer(Math.min(t.length,this.header.length-this.offset))};return a.key=this.names[t.identifier]?this.names[t.identifier]:t.identifier,"coverArt"===a.key&&(a.value=a.value.data),this.offset+=10+t.length,a},decodeFrame:function(t,e){var i=this.stream,n=i.offset,r=0,a={},s=Object.keys(e).length,o=0;for(var l in e){var u=e[l],c=t.length-(i.offset-n);switch(o++,l){case"encoding":r=i.readUInt8();continue;case"language":a.language=i.readString(3);continue}switch(u){case"latin1":a[l]=i.readString(o===s?c:null,"latin1");break;case"string":a[l]=i.readString(o===s?c:null,O[r]);break;case"binary":a[l]=i.readBuffer(c);break;case"int16":a[l]=i.readInt16();break;case"int8":a[l]=i.readInt8();break;case"int24":a[l]=i.readInt24();break;case"int32":a[l]=i.readInt32();break;case"int32+":if(a[l]=i.readInt32(),c>4)throw new Error("Seriously dude? Stop playing this song and get a life!");break;case"date":var f=i.readString(8);a[l]=new Date(f.slice(0,4),f.slice(4,6)-1,f.slice(6,8));break;case"frame_id":a[l]=i.readString(4);break;default:throw new Error("Unknown key type "+u)}}var c=t.length-(i.offset-n);return c>0&&i.advance(c),a}}),L=R.extend({readHeader:function(){var t=this.stream.readString(4),e=0;if(4===this.header.major)for(var i=0;4>i;i++)e=(e<<7)+(127&this.stream.readUInt8());else e=this.stream.readUInt32();return{identifier:t,length:e,flags:this.stream.readUInt16()}},map:{text:["TIT1","TIT2","TIT3","TALB","TOAL","TRCK","TPOS","TSST","TSRC","TPE1","TPE2","TPE3","TPE4","TOPE","TEXT","TOLY","TCOM","TMCL","TIPL","TENC","TBPM","TLEN","TKEY","TLAN","TCON","TFLT","TMED","TMOO","TCOP","TPRO","TPUB","TOWN","TRSN","TRSO","TOFN","TDLY","TDEN","TDOR","TDRC","TDRL","TDTG","TSSE","TSOA","TSOP","TSOT","TDAT","TIME","TORY","TRDA","TSIZ","TYER","TCMP","TSO2","TSOC"],url:["WCOM","WCOP","WOAF","WOAR","WOAS","WORS","WPAY","WPUB"]},frameTypes:{text:{encoding:1,value:"string"},url:{value:"latin1"},TXXX:{encoding:1,description:"string",value:"string"},WXXX:{encoding:1,description:"string",value:"latin1"},USLT:{encoding:1,language:1,description:"string",value:"string"},COMM:{encoding:1,language:1,description:"string",value:"string"},APIC:{encoding:1,mime:"latin1",type:"int8",description:"string",data:"binary"},UFID:{owner:"latin1",identifier:"binary"},MCDI:{value:"binary"},PRIV:{owner:"latin1",value:"binary"},GEOB:{encoding:1,mime:"latin1",filename:"string",description:"string",data:"binary"},PCNT:{value:"int32+"},POPM:{email:"latin1",rating:"int8",counter:"int32+"},AENC:{owner:"latin1",previewStart:"int16",previewLength:"int16",encryptionInfo:"binary"},ETCO:{format:"int8",data:"binary"},MLLT:{framesBetweenReference:"int16",bytesBetweenReference:"int24",millisecondsBetweenReference:"int24",bitsForBytesDeviation:"int8",bitsForMillisecondsDev:"int8",data:"binary"},SYTC:{format:"int8",tempoData:"binary"},SYLT:{encoding:1,language:1,format:"int8",contentType:"int8",description:"string",data:"binary"},RVA2:{identification:"latin1",data:"binary"},EQU2:{interpolationMethod:"int8",identification:"latin1",data:"binary"},RVRB:{left:"int16",right:"int16",bouncesLeft:"int8",bouncesRight:"int8",feedbackLL:"int8",feedbackLR:"int8",feedbackRR:"int8",feedbackRL:"int8",premixLR:"int8",premixRL:"int8"},RBUF:{size:"int24",flag:"int8",offset:"int32"},LINK:{identifier:"frame_id",url:"latin1",data:"binary"},POSS:{format:"int8",position:"binary"},USER:{encoding:1,language:1,value:"string"},OWNE:{encoding:1,price:"latin1",purchaseDate:"date",seller:"string"},COMR:{encoding:1,price:"latin1",validUntil:"date",contactURL:"latin1",receivedAs:"int8",seller:"string",description:"string",logoMime:"latin1",logo:"binary"},ENCR:{owner:"latin1",methodSymbol:"int8",data:"binary"},GRID:{owner:"latin1",groupSymbol:"int8",data:"binary"},SIGN:{groupSymbol:"int8",signature:"binary"},SEEK:{value:"int32"},ASPI:{dataStart:"int32",dataLength:"int32",numPoints:"int16",bitsPerPoint:"int8",data:"binary"},IPLS:{encoding:1,value:"string"},RVAD:{adjustment:"int8",bits:"int8",data:"binary"},EQUA:{adjustmentBits:"int8",data:"binary"}},names:{TIT1:"grouping",TIT2:"title",TIT3:"subtitle",TALB:"album",TOAL:"originalAlbumTitle",TRCK:"trackNumber",TPOS:"diskNumber",TSST:"setSubtitle",TSRC:"ISRC",TPE1:"artist",TPE2:"albumArtist",TPE3:"conductor",TPE4:"modifiedBy",TOPE:"originalArtist",TEXT:"lyricist",TOLY:"originalLyricist",TCOM:"composer",TMCL:"musicianCreditsList",TIPL:"involvedPeopleList",TENC:"encodedBy",TBPM:"tempo",TLEN:"length",TKEY:"initialKey",TLAN:"language",TCON:"genre",TFLT:"fileType",TMED:"mediaType",TMOO:"mood",TCOP:"copyright",TPRO:"producedNotice",TPUB:"publisher",TOWN:"fileOwner",TRSN:"internetRadioStationName",TRSO:"internetRadioStationOwner",TOFN:"originalFilename",TDLY:"playlistDelay",TDEN:"encodingTime",TDOR:"originalReleaseTime",TDRC:"recordingTime",TDRL:"releaseTime",TDTG:"taggingTime",TSSE:"encodedWith",TSOA:"albumSortOrder",TSOP:"performerSortOrder",TSOT:"titleSortOrder",TXXX:"userText",USLT:"lyrics",APIC:"coverArt",UFID:"uniqueIdentifier",MCDI:"CDIdentifier",COMM:"comments",WCOM:"commercialInformation",WCOP:"copyrightInformation",WOAF:"officialAudioFileWebpage",WOAR:"officialArtistWebpage",WOAS:"officialAudioSourceWebpage",WORS:"officialInternetRadioStationHomepage",WPAY:"payment",WPUB:"officialPublisherWebpage",WXXX:"url",PRIV:"private",GEOB:"generalEncapsulatedObject",PCNT:"playCount",POPM:"rating",AENC:"audioEncryption",ETCO:"eventTimingCodes",MLLT:"MPEGLocationLookupTable",SYTC:"synchronisedTempoCodes",SYLT:"synchronisedLyrics",RVA2:"volumeAdjustment",EQU2:"equalization",RVRB:"reverb",RBUF:"recommendedBufferSize",LINK:"link",POSS:"positionSynchronisation",USER:"termsOfUse",OWNE:"ownership",COMR:"commercial",ENCR:"encryption",GRID:"groupIdentifier",SIGN:"signature",SEEK:"seek",ASPI:"audioSeekPointIndex",TDAT:"date",TIME:"time",TORY:"originalReleaseYear",TRDA:"recordingDates",TSIZ:"size",TYER:"year",IPLS:"involvedPeopleList",RVAD:"volumeAdjustment",EQUA:"equalization",TCMP:"compilation",TSO2:"albumArtistSortOrder",TSOC:"composerSortOrder"}}),U=L.extend({readHeader:function(){var t=this.stream.readString(3);return this.frameReplacements[t]&&!this.frameTypes[t]&&(this.frameTypes[t]=this.frameReplacements[t]),{identifier:this.replacements[t]||t,length:this.stream.readUInt24()}},replacements:{UFI:"UFID",TT1:"TIT1",TT2:"TIT2",TT3:"TIT3",TP1:"TPE1",TP2:"TPE2",TP3:"TPE3",TP4:"TPE4",TCM:"TCOM",TXT:"TEXT",TLA:"TLAN",TCO:"TCON",TAL:"TALB",TPA:"TPOS",TRK:"TRCK",TRC:"TSRC",TYE:"TYER",TDA:"TDAT",TIM:"TIME",TRD:"TRDA",TMT:"TMED",TFT:"TFLT",TBP:"TBPM",TCR:"TCOP",TPB:"TPUB",TEN:"TENC",TSS:"TSSE",TOF:"TOFN",TLE:"TLEN",TSI:"TSIZ",TDY:"TDLY",TKE:"TKEY",TOT:"TOAL",TOA:"TOPE",TOL:"TOLY",TOR:"TORY",TXX:"TXXX",WAF:"WOAF",WAR:"WOAR",WAS:"WOAS",WCM:"WCOM",WCP:"WCOP",WPB:"WPUB",WXX:"WXXX",IPL:"IPLS",MCI:"MCDI",ETC:"ETCO",MLL:"MLLT",STC:"SYTC",ULT:"USLT",SLT:"SYLT",COM:"COMM",RVA:"RVAD",EQU:"EQUA",REV:"RVRB",GEO:"GEOB",CNT:"PCNT",POP:"POPM",BUF:"RBUF",CRA:"AENC",LNK:"LINK",TST:"TSOT",TSP:"TSOP",TSA:"TSOA",TCP:"TCMP",TS2:"TSO2",TSC:"TSOC"},frameReplacements:{PIC:{encoding:1,format:"int24",type:"int8",description:"string",data:"binary"},CRM:{owner:"latin1",description:"latin1",data:"binary"}}}),D=m.Demuxer.extend(function(){m.Demuxer.register(this),this.probe=function(t){var n=t.offset,r=D.getID3v2Header(t);r&&t.advance(10+r.length);var a=new e(new m.Bitstream(t)),s=null;
try{s=i.decode(a)}catch(o){}return t.seek(n),!!s},this.getID3v2Header=function(t){if("ID3"==t.peekString(0,3)){t=m.Stream.fromBuffer(t.peekBuffer(0,10)),t.advance(3);var e=t.readUInt8(),i=t.readUInt8(),n=t.readUInt8(),r=t.readBuffer(4).data,a=r[0]<<21|r[1]<<14|r[2]<<7|r[3];return{version:"2."+e+"."+i,major:e,minor:i,flags:n,length:a}}return null};const t=[[32,17],[17,9]];this.prototype.parseDuration=function(e){var i,n=this.stream,r=n.offset;if(!e||3!==e.layer)return!1;n.advance(t[e.flags&B.LSF_EXT?1:0][1===e.nchannels()?1:0]);var a=n.readString(4);if("Xing"===a||"Info"===a){var s=n.readUInt32();if(1&s&&(i=n.readUInt32()),2&s)var o=n.readUInt32();if(4&s&&i&&o)for(var l=0;100>l;l++){var u=n.readUInt8(),c=u/256*o|0,f=l/100*i*e.nbsamples()*32|0;this.addSeekPoint(c,f)}8&s&&n.advance(4)}else if(n.seek(r+4+32),a=n.readString(4),"VBRI"==a&&1===n.readUInt16()){n.advance(4),n.advance(4),i=n.readUInt32();for(var h=n.readUInt16(),d=(n.readUInt16(),n.readUInt16()),p=n.readUInt16(),m="readUInt"+8*d,c=0,l=0;h>l;l++)this.addSeekPoint(c,p*l),c+=n[m]()}return i?(this.emit("duration",i*e.nbsamples()*32/e.samplerate*1e3|0),!0):!1},this.prototype.readChunk=function(){var t=this.stream;if(!this.sentInfo){var n=D.getID3v2Header(t);if(n){if(t.advance(10),n.major>2)var r=new L(n,t);else var r=new U(n,t);this.emit("metadata",r.read())}var a=t.offset,s=new e(new m.Bitstream(t)),o=i.decode(s);if(!o)return this.emit("error","Could not find first frame.");this.emit("format",{formatID:"mp3",sampleRate:o.samplerate,channelsPerFrame:o.nchannels(),bitrate:o.bitrate,floatingPoint:!0});var l=this.parseDuration(o);t.advance(a-t.offset),this.dataSize=0,l||this.on("end",function(){this.emit("duration",8*this.dataSize/o.bitrate*1e3|0)}),this.sentInfo=!0}for(;t.available(1);){var u=t.readSingleBuffer(t.remainingBytes());this.dataSize+=u.length,this.emit("data",u)}}});e.prototype.getU8=function(t){var e=this.stream.stream;return e.peekUInt8(t-e.offset)},e.prototype.nextByte=function(){var t=this.stream;return 0===t.bitPosition?t.stream.offset:t.stream.offset+1},e.prototype.doSync=function(){var t=this.stream.stream;for(this.align();this.available(16)&&(255!==t.peekUInt8(0)||224!==(224&t.peekUInt8(1)));)this.advance(8);return this.available(j)?!0:!1},e.prototype.reset=function(t){this.seek(8*t),this.next_frame=t,this.sync=!0};const M=[[0,32e3,64e3,96e3,128e3,16e4,192e3,224e3,256e3,288e3,32e4,352e3,384e3,416e3,448e3],[0,32e3,48e3,56e3,64e3,8e4,96e3,112e3,128e3,16e4,192e3,224e3,256e3,32e4,384e3],[0,32e3,4e4,48e3,56e3,64e3,8e4,96e3,112e3,128e3,16e4,192e3,224e3,256e3,32e4],[0,32e3,48e3,56e3,64e3,8e4,96e3,112e3,128e3,144e3,16e4,176e3,192e3,224e3,256e3],[0,8e3,16e3,24e3,32e3,4e4,48e3,56e3,64e3,8e4,96e3,112e3,128e3,144e3,16e4]],F=[44100,48e3,32e3],B={NPRIVATE_III:7,INCOMPLETE:8,PROTECTION:16,COPYRIGHT:32,ORIGINAL:64,PADDING:128,I_STEREO:256,MS_STEREO:512,FREEFORMAT:1024,LSF_EXT:4096,MC_EXT:8192,MPEG_2_5_EXT:16384},z={HEADER:256,III:31},N={SINGLE_CHANNEL:0,DUAL_CHANNEL:1,JOINT_STEREO:2,STEREO:3},j=8,q=2567;i.prototype.copy=function(){var t=new i,e=Object.keys(this);for(var n in e)t[n]=this[n];return t},i.prototype.nchannels=function(){return 0===this.mode?1:2},i.prototype.nbsamples=function(){return 1===this.layer?12:3===this.layer&&this.flags&B.LSF_EXT?18:36},i.prototype.framesize=function(){if(0===this.bitrate)return null;var t=this.flags&B.PADDING?1:0;switch(this.layer){case 1:var e=12*this.bitrate/this.samplerate|0;return 4*(e+t);case 2:var e=144*this.bitrate/this.samplerate|0;return e+t;case 3:default:var i=this.flags&B.LSF_EXT?1:0,e=144*this.bitrate/(this.samplerate<<i)|0;return e+t}},i.prototype.decode=function(t){if(this.flags=0,this.private_bits=0,t.advance(11),0===t.read(1)&&(this.flags|=B.MPEG_2_5_EXT),0===t.read(1))this.flags|=B.LSF_EXT;else if(this.flags&B.MPEG_2_5_EXT)throw new m.UnderflowError;if(this.layer=4-t.read(2),4===this.layer)throw new Error("Invalid layer");0===t.read(1)&&(this.flags|=B.PROTECTION);var e=t.read(4);if(15===e)throw new Error("Invalid bitrate");if(this.bitrate=this.flags&B.LSF_EXT?M[3+(this.layer>>1)][e]:M[this.layer-1][e],e=t.read(2),3===e)throw new Error("Invalid sampling frequency");this.samplerate=F[e],this.flags&B.LSF_EXT&&(this.samplerate/=2,this.flags&B.MPEG_2_5_EXT&&(this.samplerate/=2)),t.read(1)&&(this.flags|=B.PADDING),t.read(1)&&(this.private_bits|=z.HEADER),this.mode=3-t.read(2),this.mode_extension=t.read(2),t.read(1)&&(this.flags|=B.COPYRIGHT),t.read(1)&&(this.flags|=B.ORIGINAL),this.emphasis=t.read(2),this.flags&B.PROTECTION&&(this.crc_target=t.read(16))},i.decode=function(t){for(var e=t.next_frame,n=!0,r=null;n;){if(n=!1,t.sync){if(!t.available(j))throw t.next_frame=e,new m.UnderflowError;if(255!==t.getU8(e)||224!==(224&t.getU8(e+1)))throw t.this_frame=e,t.next_frame=e+1,new m.UnderflowError}else{if(t.seek(8*e),!t.doSync())throw new m.UnderflowError;e=t.nextByte()}t.this_frame=e,t.next_frame=e+1,t.seek(8*t.this_frame),r=new i,r.decode(t),0===r.bitrate&&((0===t.freerate||!t.sync||3===r.layer&&t.freerate>64e4)&&i.free_bitrate(t,r),r.bitrate=t.freerate,r.flags|=B.FREEFORMAT);var a=r.flags&B.PADDING?1:0;if(1===r.layer)var s=4*((12*r.bitrate/r.samplerate<<0)+a);else var o=3===r.layer&&r.flags&B.LSF_EXT?72:144,s=(o*r.bitrate/r.samplerate<<0)+a;if(!t.available(s+j))throw t.next_frame=t.this_frame,new m.UnderflowError;if(t.next_frame=t.this_frame+s,!t.sync){if(e=t.next_frame,255!==t.getU8(e)||224!==(224&t.getU8(e+1))){e=t.next_frame=t.this_frame+1,n=!0;continue}t.sync=!0}}return r.flags|=B.INCOMPLETE,r},i.free_bitrate=function(t,e){for(var i=e.flags&B.PADDING?1:0,n=3===e.layer&&e.flags&B.LSF_EXT?72:144,r=t.offset(),a=0;t.doSync();){var s=e.copy(),o=t.copy();if(s.decode(o)&&s.layer===e.layer&&s.samplerate===e.samplerate){var l=t.nextByte()-t.this_frame;if(a=1===e.layer?e.samplerate*(l-4*i+4)/48/1e3|0:e.samplerate*(l-i+1)/n/1e3|0,a>=8)break}t.advance(8)}if(t.seek(r),8>a||3===e.layer&&a>640)throw new m.UnderflowError;t.freerate=1e3*a},n.layers=[],n.prototype.decode=function(t){this.header&&this.header.flags&B.INCOMPLETE||(this.header=i.decode(t)),this.header.flags&=~B.INCOMPLETE;var e=this.decoders[this.header.layer-1];if(!e){var r=n.layers[this.header.layer];if(!r)throw new Error("Layer "+this.header.layer+" is not supported.");e=this.decoders[this.header.layer-1]=new r}e.decode(t,this)};const W=.998795456,H=.995184727,X=.98917651,G=.98078528,V=.970031253,$=.956940336,Y=.941544065,Q=.923879533,K=.903989293,J=.881921264,Z=.85772861,te=.831469612,ee=.803207531,ie=.773010453,ne=.740951125,re=.707106781,ae=.671558955,se=.634393284,oe=.595699304,le=.555570233,ue=.514102744,ce=.471396737,fe=.427555093,he=.382683432,de=.336889853,pe=.290284677,me=.24298018,ve=.195090322,ye=.146730474,ge=.09801714,be=.049067674;a.dct32=function(t,e,i,n){var r,a,s,o,l,u,c,f,h,d,p,m,v,y,g,b,w,k,_,T,I,S,x,P,E,C,A,O,R,L,U,D,M,F,B,z,N,j,q,we,ke,_e,Te,Ie,Se,xe,Pe,Ee,Ce,Ae,Oe,Re,Le,Ue,De,Me,Fe,Be,ze,Ne,je,qe,We,He,Xe,Ge,Ve,$e,Ye,Qe,Ke,Je,Ze,ti,ei,ii,ni,ri,ai,si,oi,li,ui,ci,fi,hi,di,pi,mi,vi,yi,gi,bi,wi,ki,_i,Ti,Ii,Si,xi,Pi,Ei,Ci,Ai,Oi,Ri,Li,Ui,Di,Mi,Fi,Bi,zi,Ni,ji,qi,Wi,Hi,Xi,Gi,Vi,$i,Yi,Qi,Ki,Ji,Zi,tn,en,nn,rn,an,sn,on,ln,un,cn,fn,hn,dn,pn,mn,vn,yn,gn,bn,wn,kn,_n,Tn,In,Sn,xn,Pn,En,Cn,An,On,Rn,Ln,Un,Dn,Mn,Fn,Bn,zn,Nn,jn,qn,Wn,Hn,Xn,Gn,Vn,$n,Yn,Qn;r=t[0]+t[31],w=(t[0]-t[31])*W,a=t[15]+t[16],k=(t[15]-t[16])*be,_e=w+k,Ne=(w-k)*H,F=r+a,Oe=(r-a)*H,s=t[7]+t[24],_=(t[7]-t[24])*ne,o=t[8]+t[23],T=(t[8]-t[23])*ae,Te=_+T,je=(_-T)*ge,B=s+o,Re=(s-o)*ge,l=t[3]+t[28],I=(t[3]-t[28])*Y,u=t[12]+t[19],S=(t[12]-t[19])*de,Ie=I+S,qe=(I-S)*ie,z=l+u,Le=(l-u)*ie,c=t[4]+t[27],x=(t[4]-t[27])*K,f=t[11]+t[20],P=(t[11]-t[20])*fe,Se=x+P,We=(x-P)*se,N=c+f,Ue=(c-f)*se,h=t[1]+t[30],E=(t[1]-t[30])*X,d=t[14]+t[17],C=(t[14]-t[17])*ye,xe=E+C,He=(E-C)*$,j=h+d,De=(h-d)*$,p=t[6]+t[25],A=(t[6]-t[25])*ee,m=t[9]+t[22],O=(t[9]-t[22])*oe,Pe=A+O,Xe=(A-O)*pe,q=p+m,Me=(p-m)*pe,v=t[2]+t[29],R=(t[2]-t[29])*V,y=t[13]+t[18],L=(t[13]-t[18])*me,Ee=R+L,Ge=(R-L)*J,we=v+y,Fe=(v-y)*J,g=t[5]+t[26],U=(t[5]-t[26])*Z,b=t[10]+t[21],D=(t[10]-t[21])*ue,Ce=U+D,Ve=(U-D)*ce,ke=g+b,Be=(g-b)*ce,Qe=F+B,vi=(F-B)*G,Ke=z+N,yi=(z-N)*ve,Je=j+q,gi=(j-q)*te,Ze=we+ke,bi=(we-ke)*le,ti=_e+Te,ki=(_e-Te)*G,ei=Ie+Se,_i=(Ie-Se)*ve,ii=xe+Pe,Ti=(xe-Pe)*te,ni=Ee+Ce,Ii=(Ee-Ce)*le,ai=Oe+Re,Pi=(Oe-Re)*G,si=Le+Ue,Ei=(Le-Ue)*ve,oi=De+Me,Ci=(De-Me)*te,li=Fe+Be,Ai=(Fe-Be)*le,ci=Ne+je,Li=(Ne-je)*G,fi=qe+We,Ui=(qe-We)*ve,hi=He+Xe,Di=(He-Xe)*te,di=Ge+Ve,Mi=(Ge-Ve)*le,Ni=Qe+Ke,ji=Je+Ze,n[15][e]=Ni+ji,i[0][e]=(Ni-ji)*re,qi=ti+ei,Wi=ii+ni,M=qi+Wi,n[14][e]=M,Xi=ai+si,Gi=oi+li,ze=Xi+Gi,n[13][e]=ze,$i=ci+fi,Yi=hi+di,$e=$i+Yi,Ae=2*$e-M,n[12][e]=Ae,Ji=vi+yi,Zi=gi+bi,wi=Ji+Zi,n[11][e]=wi,en=ki+_i,nn=Ti+Ii,Si=en+nn,Ye=2*Si-Ae,n[10][e]=Ye,sn=Pi+Ei,on=Ci+Ai,Oi=sn+on,ui=2*Oi-ze,n[9][e]=ui,cn=Li+Ui,fn=Di+Mi,Fi=cn+fn,pi=2*Fi-$e,ri=2*pi-Ye,n[8][e]=ri,mn=(Qe-Ke)*Q,vn=(Je-Ze)*he,yn=mn+vn,n[7][e]=yn,i[8][e]=(mn-vn)*re*2-yn,gn=(ti-ei)*Q,bn=(ii-ni)*he,wn=gn+bn,mi=2*wn-ri,n[6][e]=mi,_n=(ai-si)*Q,Tn=(oi-li)*he,In=_n+Tn,Ri=2*In-ui,n[5][e]=Ri,xn=(ci-fi)*Q,Pn=(hi-di)*he,En=xn+Pn,Bi=2*En-pi,xi=2*Bi-mi,n[4][e]=xi,On=(vi-yi)*Q,Rn=(gi-bi)*he,Ln=On+Rn,tn=2*Ln-wi,n[3][e]=tn,Un=(Ji-Zi)*re*2-tn,i[4][e]=Un,i[12][e]=2*((On-Rn)*re*2-Ln)-Un,Dn=(ki-_i)*Q,Mn=(Ti-Ii)*he,Fn=Dn+Mn,rn=2*Fn-Si,zi=2*rn-xi,n[2][e]=zi,Bn=(en-nn)*re*2-rn,Nn=(Pi-Ei)*Q,jn=(Ci-Ai)*he,qn=Nn+jn,ln=2*qn-Oi,Vi=2*ln-Ri,n[1][e]=Vi,un=(Xi-Gi)*re*2-Vi,i[2][e]=un,Wn=(sn-on)*re*2-ln,Sn=2*Wn-un,i[6][e]=Sn,Hn=2*((_n-Tn)*re*2-In)-Sn,i[10][e]=Hn,i[14][e]=2*(2*((Nn-jn)*re*2-qn)-Wn)-Hn,Xn=(Li-Ui)*Q,Gn=(Di-Mi)*he,Vn=Xn+Gn,hn=2*Vn-Fi,Qi=2*hn-Bi,dn=($i-Yi)*re*2-Qi,Hi=2*Qi-zi,n[0][e]=Hi,Ki=(qi-Wi)*re*2-Hi,i[1][e]=Ki,an=2*dn-Ki,i[3][e]=an,pn=2*Bn-an,i[5][e]=pn,$n=(cn-fn)*re*2-hn,Cn=2*$n-dn,kn=2*Cn-pn,i[7][e]=kn,An=2*((gn-bn)*re*2-wn)-kn,i[9][e]=An,Yn=2*((xn-Pn)*re*2-En)-Cn,zn=2*Yn-An,i[11][e]=zn,Qn=2*(2*((Dn-Mn)*re*2-Fn)-Bn)-zn,i[13][e]=Qn,i[15][e]=2*(2*(2*((Xn-Gn)*re*2-Vn)-$n)-Yn)-Qn};const we=[[0,-442505e-9,.003250122,-.007003784,.031082153,-.07862854,.100311279,-.572036743,1.144989014,.572036743,.100311279,.07862854,.031082153,.007003784,.003250122,442505e-9,0,-442505e-9,.003250122,-.007003784,.031082153,-.07862854,.100311279,-.572036743,1.144989014,.572036743,.100311279,.07862854,.031082153,.007003784,.003250122,442505e-9],[-15259e-9,-473022e-9,.003326416,-.007919312,.030517578,-.084182739,.090927124,-.600219727,1.144287109,.543823242,.108856201,.073059082,.031478882,.006118774,.003173828,396729e-9,-15259e-9,-473022e-9,.003326416,-.007919312,.030517578,-.084182739,.090927124,-.600219727,1.144287109,.543823242,.108856201,.073059082,.031478882,.006118774,.003173828,396729e-9],[-15259e-9,-534058e-9,.003387451,-.008865356,.029785156,-.089706421,.080688477,-.628295898,1.142211914,.515609741,.116577148,.067520142,.031738281,.0052948,.003082275,366211e-9,-15259e-9,-534058e-9,.003387451,-.008865356,.029785156,-.089706421,.080688477,-.628295898,1.142211914,.515609741,.116577148,.067520142,.031738281,.0052948,.003082275,366211e-9],[-15259e-9,-579834e-9,.003433228,-.009841919,.028884888,-.095169067,.069595337,-.656219482,1.138763428,.487472534,.123474121,.06199646,.031845093,.004486084,.002990723,320435e-9,-15259e-9,-579834e-9,.003433228,-.009841919,.028884888,-.095169067,.069595337,-.656219482,1.138763428,.487472534,.123474121,.06199646,.031845093,.004486084,.002990723,320435e-9],[-15259e-9,-62561e-8,.003463745,-.010848999,.027801514,-.100540161,.057617187,-.683914185,1.133926392,.459472656,.129577637,.056533813,.031814575,.003723145,.00289917,289917e-9,-15259e-9,-62561e-8,.003463745,-.010848999,.027801514,-.100540161,.057617187,-.683914185,1.133926392,.459472656,.129577637,.056533813,.031814575,.003723145,.00289917,289917e-9],[-15259e-9,-686646e-9,.003479004,-.011886597,.026535034,-.105819702,.044784546,-.71131897,1.127746582,.431655884,.134887695,.051132202,.031661987,.003005981,.002792358,259399e-9,-15259e-9,-686646e-9,.003479004,-.011886597,.026535034,-.105819702,.044784546,-.71131897,1.127746582,.431655884,.134887695,.051132202,.031661987,.003005981,.002792358,259399e-9],[-15259e-9,-747681e-9,.003479004,-.012939453,.025085449,-.110946655,.031082153,-.738372803,1.120223999,.404083252,.139450073,.045837402,.031387329,.002334595,.002685547,244141e-9,-15259e-9,-747681e-9,.003479004,-.012939453,.025085449,-.110946655,.031082153,-.738372803,1.120223999,.404083252,.139450073,.045837402,.031387329,.002334595,.002685547,244141e-9],[-30518e-9,-808716e-9,.003463745,-.014022827,.023422241,-.115921021,.01651001,-.765029907,1.111373901,.376800537,.143264771,.040634155,.031005859,.001693726,.002578735,213623e-9,-30518e-9,-808716e-9,.003463745,-.014022827,.023422241,-.115921021,.01651001,-.765029907,1.111373901,.376800537,.143264771,.040634155,.031005859,.001693726,.002578735,213623e-9],[-30518e-9,-88501e-8,.003417969,-.01512146,.021575928,-.120697021,.001068115,-.791213989,1.101211548,.349868774,.146362305,.035552979,.030532837,.001098633,.002456665,198364e-9,-30518e-9,-88501e-8,.003417969,-.01512146,.021575928,-.120697021,.001068115,-.791213989,1.101211548,.349868774,.146362305,.035552979,.030532837,.001098633,.002456665,198364e-9],[-30518e-9,-961304e-9,.003372192,-.016235352,.01953125,-.125259399,-.015228271,-.816864014,1.089782715,.323318481,.148773193,.030609131,.029937744,549316e-9,.002349854,167847e-9,-30518e-9,-961304e-9,.003372192,-.016235352,.01953125,-.125259399,-.015228271,-.816864014,1.089782715,.323318481,.148773193,.030609131,.029937744,549316e-9,.002349854,167847e-9],[-30518e-9,-.001037598,.00328064,-.017349243,.01725769,-.129562378,-.03237915,-.841949463,1.07711792,.297210693,.150497437,.025817871,.029281616,30518e-9,.002243042,152588e-9,-30518e-9,-.001037598,.00328064,-.017349243,.01725769,-.129562378,-.03237915,-.841949463,1.07711792,.297210693,.150497437,.025817871,.029281616,30518e-9,.002243042,152588e-9],[-45776e-9,-.001113892,.003173828,-.018463135,.014801025,-.133590698,-.050354004,-.866363525,1.063217163,.271591187,.151596069,.021179199,.028533936,-442505e-9,.002120972,137329e-9,-45776e-9,-.001113892,.003173828,-.018463135,.014801025,-.133590698,-.050354004,-.866363525,1.063217163,.271591187,.151596069,.021179199,.028533936,-442505e-9,.002120972,137329e-9],[-45776e-9,-.001205444,.003051758,-.019577026,.012115479,-.137298584,-.069168091,-.890090942,1.048156738,.246505737,.152069092,.016708374,.02772522,-869751e-9,.00201416,12207e-8,-45776e-9,-.001205444,.003051758,-.019577026,.012115479,-.137298584,-.069168091,-.890090942,1.048156738,.246505737,.152069092,.016708374,.02772522,-869751e-9,.00201416,12207e-8],[-61035e-9,-.001296997,.002883911,-.020690918,.009231567,-.140670776,-.088775635,-.91305542,1.031936646,.221984863,.15196228,.012420654,.02684021,-.001266479,.001907349,106812e-9,-61035e-9,-.001296997,.002883911,-.020690918,.009231567,-.140670776,-.088775635,-.91305542,1.031936646,.221984863,.15196228,.012420654,.02684021,-.001266479,.001907349,106812e-9],[-61035e-9,-.00138855,.002700806,-.021789551,.006134033,-.143676758,-.109161377,-.935195923,1.01461792,.198059082,.151306152,.00831604,.025909424,-.001617432,.001785278,106812e-9,-61035e-9,-.00138855,.002700806,-.021789551,.006134033,-.143676758,-.109161377,-.935195923,1.01461792,.198059082,.151306152,.00831604,.025909424,-.001617432,.001785278,106812e-9],[-76294e-9,-.001480103,.002487183,-.022857666,.002822876,-.146255493,-.130310059,-.956481934,.996246338,.174789429,.150115967,.004394531,.024932861,-.001937866,.001693726,91553e-9,-76294e-9,-.001480103,.002487183,-.022857666,.002822876,-.146255493,-.130310059,-.956481934,.996246338,.174789429,.150115967,.004394531,.024932861,-.001937866,.001693726,91553e-9],[-76294e-9,-.001586914,.002227783,-.023910522,-686646e-9,-.148422241,-.152206421,-.976852417,.976852417,.152206421,.148422241,686646e-9,.023910522,-.002227783,.001586914,76294e-9,-76294e-9,-.001586914,.002227783,-.023910522,-686646e-9,-.148422241,-.152206421,-.976852417,.976852417,.152206421,.148422241,686646e-9,.023910522,-.002227783,.001586914,76294e-9]];a.prototype.full=function(t,e,i){for(var n,r,s,o=0;e>o;++o)for(var l=t.sbsample[o],u=this.filter[o],c=this.phase,f=this.pcm.samples[o],h=0,d=0,p=0;i>p;++p){a.dct32(l[p],c>>1,u[0][1&c],u[1][1&c]);var m=-2&c,v=c-1&15|1,y=u[0][1&c],g=u[0][1&~c],b=u[1][1&~c],w=0,k=0,_=0;n=0,s=we[n],_fx=g[k],_fe=y[w],r=_fx[0]*s[v+0],r+=_fx[1]*s[v+14],r+=_fx[2]*s[v+12],r+=_fx[3]*s[v+10],r+=_fx[4]*s[v+8],r+=_fx[5]*s[v+6],r+=_fx[6]*s[v+4],r+=_fx[7]*s[v+2],r=-r,r+=_fe[0]*s[m+0],r+=_fe[1]*s[m+14],r+=_fe[2]*s[m+12],r+=_fe[3]*s[m+10],r+=_fe[4]*s[m+8],r+=_fe[5]*s[m+6],r+=_fe[6]*s[m+4],r+=_fe[7]*s[m+2],f[h++]=r,d=h+30;for(var T=1;16>T;++T)++w,++n,s=we[n],_fo=b[_],_fe=y[w],r=_fo[0]*s[v+0],r+=_fo[1]*s[v+14],r+=_fo[2]*s[v+12],r+=_fo[3]*s[v+10],r+=_fo[4]*s[v+8],r+=_fo[5]*s[v+6],r+=_fo[6]*s[v+4],r+=_fo[7]*s[v+2],r=-r,r+=_fe[7]*s[m+2],r+=_fe[6]*s[m+4],r+=_fe[5]*s[m+6],r+=_fe[4]*s[m+8],r+=_fe[3]*s[m+10],r+=_fe[2]*s[m+12],r+=_fe[1]*s[m+14],r+=_fe[0]*s[m+0],f[h++]=r,r=_fe[0]*s[-m+31-16],r+=_fe[1]*s[-m+31-14],r+=_fe[2]*s[-m+31-12],r+=_fe[3]*s[-m+31-10],r+=_fe[4]*s[-m+31-8],r+=_fe[5]*s[-m+31-6],r+=_fe[6]*s[-m+31-4],r+=_fe[7]*s[-m+31-2],r+=_fo[7]*s[-v+31-2],r+=_fo[6]*s[-v+31-4],r+=_fo[5]*s[-v+31-6],r+=_fo[4]*s[-v+31-8],r+=_fo[3]*s[-v+31-10],r+=_fo[2]*s[-v+31-12],r+=_fo[1]*s[-v+31-14],r+=_fo[0]*s[-v+31-16],f[d--]=r,++_;++n,s=we[n],_fo=b[_],r=_fo[0]*s[v+0],r+=_fo[1]*s[v+14],r+=_fo[2]*s[v+12],r+=_fo[3]*s[v+10],r+=_fo[4]*s[v+8],r+=_fo[5]*s[v+6],r+=_fo[6]*s[v+4],r+=_fo[7]*s[v+2],f[h]=-r,h+=16,c=(c+1)%16}},a.prototype.frame=function(t){var e=t.header.nchannels(),i=t.header.nbsamples();this.pcm.samplerate=t.header.samplerate,this.pcm.channels=e,this.pcm.length=32*i,this.full(t,e,i),this.phase=(this.phase+i)%16};const ke=new Float32Array([2,1.587401051968,1.259921049895,1,.793700525984,.629960524947,.5,.396850262992,.314980262474,.25,.198425131496,.157490131237,.125,.099212565748,.078745065618,.0625,.049606282874,.039372532809,.03125,.024803141437,.019686266405,.015625,.012401570719,.009843133202,.0078125,.006200785359,.004921566601,.00390625,.00310039268,.002460783301,.001953125,.00155019634,.00123039165,.0009765625,.00077509817,.000615195825,.00048828125,.000387549085,.000307597913,.000244140625,.000193774542,.000153798956,.000122070313,96887271e-12,76899478e-12,61035156e-12,48443636e-12,38449739e-12,30517578e-12,24221818e-12,1922487e-11,15258789e-12,12110909e-12,9612435e-12,7629395e-12,6055454e-12,4806217e-12,3814697e-12,3027727e-12,2403109e-12,1907349e-12,1513864e-12,1201554e-12,0]),_e=new Uint8Array([4,4,4,4,4,4,6,6,6,8,10,12,16,18,22,28,34,40,46,54,54,192]),Te=new Uint8Array([4,4,4,4,4,4,6,6,8,8,10,12,16,20,24,28,34,42,50,54,76,158]),Ie=new Uint8Array([4,4,4,4,4,4,6,6,8,10,12,16,20,24,30,38,46,56,68,84,102,26]),Se=new Uint8Array([4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,6,6,6,10,10,10,12,12,12,14,14,14,16,16,16,20,20,20,26,26,26,66,66,66]),xe=new Uint8Array([4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,22,22,22,30,30,30,56,56,56]),Pe=new Uint8Array([4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,12,12,12,16,16,16,20,20,20,26,26,26,34,34,34,42,42,42,12,12,12]),Ee=new Uint8Array([4,4,4,4,4,4,6,6,4,4,4,6,6,6,6,6,6,10,10,10,12,12,12,14,14,14,16,16,16,20,20,20,26,26,26,66,66,66]),Ce=new Uint8Array([4,4,4,4,4,4,6,6,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,22,22,22,30,30,30,56,56,56]),Ae=new Uint8Array([4,4,4,4,4,4,6,6,4,4,4,6,6,6,8,8,8,12,12,12,16,16,16,20,20,20,26,26,26,34,34,34,42,42,42,12,12,12]),Oe=new Uint8Array([6,6,6,6,6,6,8,10,12,14,16,18,22,26,32,38,46,54,62,70,76,36]),Re=new Uint8Array([6,6,6,6,6,6,8,10,12,14,16,20,24,28,32,38,46,52,60,68,58,54]),Le=Re,Ue=new Uint8Array([4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,32,32,32,44,44,44,12,12,12]),De=new Uint8Array([4,4,4,4,4,4,4,4,4,6,6,6,6,6,6,8,8,8,10,10,10,14,14,14,18,18,18,26,26,26,32,32,32,42,42,42,18,18,18]),Me=new Uint8Array([4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,30,30,30,40,40,40,18,18,18]),Fe=new Uint8Array([6,6,6,6,6,6,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,32,32,32,44,44,44,12,12,12]),Be=new Uint8Array([6,6,6,6,6,6,6,6,6,6,6,6,8,8,8,10,10,10,14,14,14,18,18,18,26,26,26,32,32,32,42,42,42,18,18,18]),ze=new Uint8Array([6,6,6,6,6,6,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,30,30,30,40,40,40,18,18,18]),Ne=Le,je=Ne,qe=new Uint8Array([12,12,12,12,12,12,16,20,24,28,32,40,48,56,64,76,90,2,2,2,2,2]),We=Me,He=We,Xe=new Uint8Array([8,8,8,8,8,8,8,8,8,12,12,12,16,16,16,20,20,20,24,24,24,28,28,28,36,36,36,2,2,2,2,2,2,2,2,2,26,26,26]),Ge=ze,Ve=Ge,$e=new Uint8Array([12,12,12,4,4,4,8,8,8,12,12,12,16,16,16,20,20,20,24,24,24,28,28,28,36,36,36,2,2,2,2,2,2,2,2,2,26,26,26]),Ye=[{l:_e,s:Se,m:Ee},{l:Te,s:xe,m:Ce},{l:Ie,s:Pe,m:Ae},{l:Oe,s:Ue,m:Fe},{l:Re,s:De,m:Be},{l:Le,s:Me,m:ze},{l:Ne,s:We,m:Ge},{l:je,s:He,m:Ve},{l:qe,s:Xe,m:$e}],Qe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0]),Ke=new Float32Array([.59460355750136,.70710678118655,.84089641525371,1,1.18920711500272,1.4142135623731,1.68179283050743]),Je=new Float32Array([.857492926,.881741997,.949628649,.983314592,.995517816,.999160558,.999899195,.999993155]),Ze=new Float32Array([-.514495755,-.471731969,-.313377454,-.1819132,-.094574193,-.040965583,-.014198569,-.003699975]),ti=1,ei=2,ii=4,ni=8,ri=1,ai=2,si=new Float32Array([.043619387,.130526192,.216439614,.3007058,.382683432,.461748613,.537299608,.608761429,.675590208,.737277337,.79335334,.843391446,.887010833,.923879533,.953716951,.976296007,.991444861,.999048222,.999048222,.991444861,.976296007,.953716951,.923879533,.887010833,.843391446,.79335334,.737277337,.675590208,.608761429,.537299608,.461748613,.382683432,.3007058,.216439614,.130526192,.043619387]),oi=new Float32Array([.130526192,.382683432,.608761429,.79335334,.923879533,.991444861,.991444861,.923879533,.79335334,.608761429,.382683432,.130526192]),li=new Float32Array([0,.211324865,.366025404,.5,.633974596,.788675135,1]),ui=[new Float32Array([.840896415,.707106781,.594603558,.5,.420448208,.353553391,.297301779,.25,.210224104,.176776695,.148650889,.125,.105112052,.088388348,.074325445]),new Float32Array([.707106781,.5,.353553391,.25,.176776695,.125,.088388348,.0625,.044194174,.03125,.022097087,.015625,.011048543,.0078125,.005524272])],ci=[{slen1:0,slen2:0},{slen1:0,slen2:1},{slen1:0,slen2:2},{slen1:0,slen2:3},{slen1:3,slen2:0},{slen1:1,slen2:1},{slen1:1,slen2:2},{slen1:1,slen2:3},{slen1:2,slen2:1},{slen1:2,slen2:2},{slen1:2,slen2:3},{slen1:3,slen2:1},{slen1:3,slen2:2},{slen1:3,slen2:3},{slen1:4,slen2:2},{slen1:4,slen2:3}],fi=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];n.layers[1]=s;const hi=new Float32Array([1.33333333333333,1.14285714285714,1.06666666666667,1.03225806451613,1.01587301587302,1.00787401574803,1.00392156862745,1.00195694716243,1.00097751710655,1.00048851978505,1.0002442002442,1.00012208521548,1.00006103888177,1.00003051850948]);s.prototype.decode=function(t,e){var i=e.header,n=i.nchannels(),r=32;i.mode===N.JOINT_STEREO&&(i.flags|=B.I_STEREO,r=4+4*i.mode_extension),i.flags&B.PROTECTION;for(var a=this.allocation,s=0;r>s;s++)for(var o=0;n>o;o++){var l=t.read(4);if(15===l)throw new Error("forbidden bit allocation value");a[o][s]=l?l+1:0}for(var s=r;32>s;s++){var l=t.read(4);if(15===l)throw new Error("forbidden bit allocation value");a[0][s]=a[1][s]=l?l+1:0}for(var u=this.scalefactor,s=0;32>s;s++)for(var o=0;n>o;o++)a[o][s]&&(u[o][s]=t.read(6));for(var c=0;12>c;c++){for(var s=0;r>s;s++)for(var o=0;n>o;o++){var l=a[o][s];e.sbsample[o][c][s]=l?this.sample(t,l)*ke[u[o][s]]:0}for(var s=r;32>s;s++){var l=a[0][s];if(l)for(var f=this.sample(t,l),o=0;n>o;o++)e.sbsample[o][c][s]=f*ke[u[o][s]];else for(var o=0;n>o;o++)e.sbsample[o][c][s]=0}}},s.prototype.sample=function(t,e){var i=t.read(e);return i^=1<<e-1,i|=-(i&1<<e-1),i/=1<<e-1,i+=1>>e-1,i*hi[e-2]},n.layers[2]=o;const di=[{sblimit:27,offsets:[7,7,7,6,6,6,6,6,6,6,6,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0]},{sblimit:30,offsets:[7,7,7,6,6,6,6,6,6,6,6,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0]},{sblimit:8,offsets:[5,5,2,2,2,2,2,2]},{sblimit:12,offsets:[5,5,2,2,2,2,2,2,2,2,2,2]},{sblimit:30,offsets:[4,4,4,4,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}],pi=[{nbal:2,offset:0},{nbal:2,offset:3},{nbal:3,offset:3},{nbal:3,offset:1},{nbal:4,offset:2},{nbal:4,offset:3},{nbal:4,offset:4},{nbal:4,offset:5}],mi=[[0,1,16],[0,1,2,3,4,5,16],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],[0,1,3,4,5,6,7,8,9,10,11,12,13,14,15],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,16],[0,2,4,5,6,7,8,9,10,11,12,13,14,15,16]],vi=[{nlevels:3,group:2,bits:5,C:1.33333333333,D:.5},{nlevels:5,group:3,bits:7,C:1.6,D:.5},{nlevels:7,group:0,bits:3,C:1.14285714286,D:.25},{nlevels:9,group:4,bits:10,C:1.77777777777,D:.5},{nlevels:15,group:0,bits:4,C:1.06666666666,D:.125},{nlevels:31,group:0,bits:5,C:1.03225806452,D:.0625},{nlevels:63,group:0,bits:6,C:1.01587301587,D:.03125},{nlevels:127,group:0,bits:7,C:1.00787401575,D:.015625},{nlevels:255,group:0,bits:8,C:1.00392156863,D:.0078125},{nlevels:511,group:0,bits:9,C:1.00195694716,D:.00390625},{nlevels:1023,group:0,bits:10,C:1.00097751711,D:.001953125},{nlevels:2047,group:0,bits:11,C:1.00048851979,D:.0009765625},{nlevels:4095,group:0,bits:12,C:1.00024420024,D:.00048828125},{nlevels:8191,group:0,bits:13,C:1.00012208522,D:.00024414063},{nlevels:16383,group:0,bits:14,C:1.00006103888,D:.00012207031},{nlevels:32767,group:0,bits:15,C:1.00003051851,D:6103516e-11},{nlevels:65535,group:0,bits:16,C:1.00001525902,D:3051758e-11}];o.prototype.decode=function(t,e){var i,n=e.header,r=n.nchannels();if(n.flags&B.LSF_EXT)i=4;else if(n.flags&B.FREEFORMAT)i=48e3===n.samplerate?0:1;else{var a=n.bitrate;if(2===r)a/=2;else if(a>192e3)throw new Error("bad bitrate/mode combination");i=48e3>=a?32e3===n.samplerate?3:2:8e4>=a?0:48e3===n.samplerate?0:1}var s=di[i].sblimit,o=di[i].offsets,l=32;n.mode===N.JOINT_STEREO&&(n.flags|=B.I_STEREO,l=4+4*n.mode_extension),l>s&&(l=s);for(var u=this.allocation,c=0;l>c;c++)for(var f=pi[o[c]].nbal,h=0;r>h;h++)u[h][c]=t.read(f);for(var c=l;s>c;c++){var f=pi[o[c]].nbal;u[0][c]=u[1][c]=t.read(f)}for(var d=this.scfsi,c=0;s>c;c++)for(var h=0;r>h;h++)u[h][c]&&(d[h][c]=t.read(2));n.flags&B.PROTECTION;for(var p=this.scalefactor,c=0;s>c;c++)for(var h=0;r>h;h++)if(u[h][c]){switch(p[h][c][0]=t.read(6),d[h][c]){case 2:p[h][c][2]=p[h][c][1]=p[h][c][0];break;case 0:p[h][c][1]=t.read(6);case 1:case 3:p[h][c][2]=t.read(6)}1&d[h][c]&&(p[h][c][1]=p[h][c][d[h][c]-1])}for(var m=0;12>m;m++){for(var c=0;l>c;c++)for(var h=0;r>h;h++)if(i=u[h][c]){i=mi[pi[o[c]].offset][i-1],this.decodeSamples(t,vi[i]);for(var v=ke[p[h][c][m>>2]],y=0;3>y;y++)e.sbsample[h][3*m+y][c]=this.samples[y]*v}else for(var y=0;3>y;y++)e.sbsample[h][3*m+y][c]=0;for(var c=l;s>c;c++)if(i=u[0][c]){i=mi[pi[o[c]].offset][i-1],this.decodeSamples(t,vi[i]);for(var h=0;r>h;h++)for(var v=ke[p[h][c][m>>2]],y=0;3>y;y++)e.sbsample[h][3*m+y][c]=this.samples[y]*v}else for(var h=0;r>h;h++)for(var y=0;3>y;y++)e.sbsample[h][3*m+y][c]=0;for(var h=0;r>h;h++)for(var y=0;3>y;y++)for(var c=s;32>c;c++)e.sbsample[h][3*m+y][c]=0}},o.prototype.decodeSamples=function(t,e){var i=this.samples,n=e.group;if(n)for(var r=t.read(e.bits),a=e.nlevels,s=0;3>s;s++)i[s]=r%a,r=r/a|0;else{n=e.bits;for(var s=0;3>s;s++)i[s]=t.read(n)}for(var s=0;3>s;s++){var o=i[s]^1<<n-1;o|=-(o&1<<n-1),o/=1<<n-1,i[s]=(o+e.D)*e.C}};var yi=function(t,e){return{"final":0,ptr:{bits:e,offset:t}}},gi=function(t,e,i,n){return{"final":1,value:{v:t,w:e,x:i,y:n}}};const bi=[yi(16,2),yi(20,2),yi(24,1),yi(26,1),gi(0,0,1,0,4),gi(0,0,0,1,4),gi(0,1,0,0,4),gi(1,0,0,0,4),gi(0,0,0,0,1),gi(0,0,0,0,1),gi(0,0,0,0,1),gi(0,0,0,0,1),gi(0,0,0,0,1),gi(0,0,0,0,1),gi(0,0,0,0,1),gi(0,0,0,0,1),gi(1,0,1,1,2),gi(1,1,1,1,2),gi(1,1,0,1,2),gi(1,1,1,0,2),gi(0,1,1,1,2),gi(0,1,0,1,2),gi(1,0,0,1,1),gi(1,0,0,1,1),gi(0,1,1,0,1),gi(0,0,1,1,1),gi(1,0,1,0,1),gi(1,1,0,0,1)],wi=[gi(1,1,1,1,4),gi(1,1,1,0,4),gi(1,1,0,1,4),gi(1,1,0,0,4),gi(1,0,1,1,4),gi(1,0,1,0,4),gi(1,0,0,1,4),gi(1,0,0,0,4),gi(0,1,1,1,4),gi(0,1,1,0,4),gi(0,1,0,1,4),gi(0,1,0,0,4),gi(0,0,1,1,4),gi(0,0,1,0,4),gi(0,0,0,1,4),gi(0,0,0,0,4)];var ki=function(t,e,i){return{"final":1,value:{x:t,y:e,hlen:i}}};const _i=[ki(0,0,0)],Ti=[ki(1,1,3),ki(0,1,3),ki(1,0,2),ki(1,0,2),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1)],Ii=[yi(8,3),ki(1,1,3),ki(0,1,3),ki(1,0,3),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(2,2,3),ki(0,2,3),ki(1,2,2),ki(1,2,2),ki(2,1,2),ki(2,1,2),ki(2,0,2),ki(2,0,2)],Si=[yi(8,3),ki(1,0,3),ki(1,1,2),ki(1,1,2),ki(0,1,2),ki(0,1,2),ki(0,0,2),ki(0,0,2),ki(2,2,3),ki(0,2,3),ki(1,2,2),ki(1,2,2),ki(2,1,2),ki(2,1,2),ki(2,0,2),ki(2,0,2)],xi=[yi(8,4),ki(1,1,3),ki(0,1,3),ki(1,0,3),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),yi(24,1),ki(3,2,4),ki(3,1,3),ki(3,1,3),ki(1,3,4),ki(0,3,4),ki(3,0,4),ki(2,2,4),ki(1,2,3),ki(1,2,3),ki(2,1,3),ki(2,1,3),ki(0,2,3),ki(0,2,3),ki(2,0,3),ki(2,0,3),ki(3,3,1),ki(2,3,1)],Pi=[yi(16,3),yi(24,1),yi(26,1),ki(1,2,4),ki(2,1,4),ki(2,0,4),ki(0,1,3),ki(0,1,3),ki(1,1,2),ki(1,1,2),ki(1,1,2),ki(1,1,2),ki(1,0,3),ki(1,0,3),ki(0,0,3),ki(0,0,3),ki(3,3,3),ki(0,3,3),ki(2,3,2),ki(2,3,2),ki(3,2,2),ki(3,2,2),ki(3,0,2),ki(3,0,2),ki(1,3,1),ki(3,1,1),ki(2,2,1),ki(0,2,1)],Ei=[yi(16,4),yi(32,4),yi(48,2),ki(1,1,4),ki(0,1,3),ki(0,1,3),ki(1,0,3),ki(1,0,3),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),yi(52,2),yi(56,1),yi(58,1),ki(1,5,4),ki(5,1,4),yi(60,1),ki(5,0,4),yi(62,1),ki(2,4,4),ki(4,2,4),ki(1,4,3),ki(1,4,3),ki(4,1,3),ki(4,1,3),ki(4,0,3),ki(4,0,3),ki(0,4,4),ki(2,3,4),ki(3,2,4),ki(0,3,4),ki(1,3,3),ki(1,3,3),ki(3,1,3),ki(3,1,3),ki(3,0,3),ki(3,0,3),ki(2,2,3),ki(2,2,3),ki(1,2,2),ki(1,2,2),ki(1,2,2),ki(1,2,2),ki(2,1,1),ki(2,1,1),ki(0,2,2),ki(2,0,2),ki(5,5,2),ki(4,5,2),ki(5,4,2),ki(5,3,2),ki(3,5,1),ki(4,4,1),ki(2,5,1),ki(5,2,1),ki(0,5,1),ki(3,4,1),ki(4,3,1),ki(3,3,1)],Ci=[yi(16,4),yi(32,4),ki(1,2,4),ki(2,1,4),ki(1,1,2),ki(1,1,2),ki(1,1,2),ki(1,1,2),ki(0,1,3),ki(0,1,3),ki(1,0,3),ki(1,0,3),ki(0,0,2),ki(0,0,2),ki(0,0,2),ki(0,0,2),yi(48,3),yi(56,2),yi(60,1),ki(1,5,4),ki(5,1,4),yi(62,1),yi(64,1),ki(2,4,4),ki(4,2,4),ki(1,4,4),ki(4,1,3),ki(4,1,3),ki(0,4,4),ki(4,0,4),ki(2,3,4),ki(3,2,4),ki(1,3,4),ki(3,1,4),ki(0,3,4),ki(3,0,4),ki(2,2,2),ki(2,2,2),ki(2,2,2),ki(2,2,2),ki(0,2,2),ki(0,2,2),ki(0,2,2),ki(0,2,2),ki(2,0,2),ki(2,0,2),ki(2,0,2),ki(2,0,2),ki(5,5,3),ki(5,4,3),ki(4,5,2),ki(4,5,2),ki(5,3,1),ki(5,3,1),ki(5,3,1),ki(5,3,1),ki(3,5,2),ki(4,4,2),ki(2,5,1),ki(2,5,1),ki(5,2,1),ki(0,5,1),ki(3,4,1),ki(4,3,1),ki(5,0,1),ki(3,3,1)],Ai=[yi(16,4),yi(32,3),yi(40,2),yi(44,2),yi(48,1),ki(1,2,4),ki(2,1,4),ki(2,0,4),ki(1,1,3),ki(1,1,3),ki(0,1,3),ki(0,1,3),ki(1,0,3),ki(1,0,3),ki(0,0,3),ki(0,0,3),yi(50,1),ki(3,5,4),ki(5,3,4),yi(52,1),ki(4,4,4),ki(2,5,4),ki(5,2,4),ki(1,5,4),ki(5,1,3),ki(5,1,3),ki(3,4,3),ki(3,4,3),ki(4,3,3),ki(4,3,3),ki(5,0,4),ki(0,4,4),ki(2,4,3),ki(4,2,3),ki(3,3,3),ki(4,0,3),ki(1,4,2),ki(1,4,2),ki(4,1,2),ki(4,1,2),ki(2,3,2),ki(3,2,2),ki(1,3,1),ki(1,3,1),ki(3,1,1),ki(3,1,1),ki(0,3,2),ki(3,0,2),ki(2,2,1),ki(0,2,1),ki(5,5,1),ki(4,5,1),ki(5,4,1),ki(0,5,1)],Oi=[yi(16,4),yi(32,4),yi(48,2),ki(1,1,4),ki(0,1,3),ki(0,1,3),ki(1,0,3),ki(1,0,3),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),yi(52,3),yi(60,2),yi(64,3),yi(72,1),yi(74,2),yi(78,2),yi(82,2),ki(1,7,4),ki(7,1,4),yi(86,1),yi(88,2),yi(92,2),ki(1,6,4),ki(6,1,4),ki(6,0,4),yi(96,1),yi(98,1),yi(100,1),ki(1,4,4),ki(4,1,4),ki(4,0,4),ki(2,3,4),ki(3,2,4),ki(0,3,4),ki(1,3,3),ki(1,3,3),ki(3,1,3),ki(3,1,3),ki(3,0,3),ki(3,0,3),ki(2,2,3),ki(2,2,3),ki(1,2,2),ki(2,1,2),ki(0,2,2),ki(2,0,2),ki(7,7,3),ki(6,7,3),ki(7,6,3),ki(5,7,3),ki(7,5,3),ki(6,6,3),ki(4,7,2),ki(4,7,2),ki(7,4,2),ki(5,6,2),ki(6,5,2),ki(3,7,2),ki(7,3,2),ki(7,3,2),ki(4,6,2),ki(4,6,2),ki(5,5,3),ki(5,4,3),ki(6,3,2),ki(6,3,2),ki(2,7,1),ki(7,2,1),ki(6,4,2),ki(0,7,2),ki(7,0,1),ki(7,0,1),ki(6,2,1),ki(6,2,1),ki(4,5,2),ki(3,5,2),ki(0,6,1),ki(0,6,1),ki(5,3,2),ki(4,4,2),ki(3,6,1),ki(2,6,1),ki(2,5,2),ki(5,2,2),ki(1,5,1),ki(1,5,1),ki(5,1,1),ki(5,1,1),ki(3,4,2),ki(4,3,2),ki(0,5,1),ki(5,0,1),ki(2,4,1),ki(4,2,1),ki(3,3,1),ki(0,4,1)],Ri=[yi(16,4),yi(32,4),yi(48,4),yi(64,3),ki(1,2,4),yi(72,1),ki(1,1,3),ki(1,1,3),ki(0,1,3),ki(0,1,3),ki(1,0,3),ki(1,0,3),ki(0,0,2),ki(0,0,2),ki(0,0,2),ki(0,0,2),yi(74,2),yi(78,3),yi(86,2),yi(90,1),yi(92,2),ki(2,7,4),ki(7,2,4),yi(96,1),ki(7,1,3),ki(7,1,3),ki(1,7,4),ki(7,0,4),ki(3,6,4),ki(6,3,4),ki(6,0,4),yi(98,1),yi(100,1),ki(1,5,4),ki(6,2,3),ki(6,2,3),ki(2,6,4),ki(0,6,4),ki(1,6,3),ki(1,6,3),ki(6,1,3),ki(6,1,3),ki(5,1,4),ki(3,4,4),ki(5,0,4),yi(102,1),ki(2,4,4),ki(4,2,4),ki(1,4,4),ki(4,1,4),ki(0,4,4),ki(4,0,4),ki(2,3,3),ki(2,3,3),ki(3,2,3),ki(3,2,3),ki(1,3,2),ki(1,3,2),ki(1,3,2),ki(1,3,2),ki(3,1,2),ki(3,1,2),ki(3,1,2),ki(3,1,2),ki(0,3,3),ki(3,0,3),ki(2,2,2),ki(2,2,2),ki(2,1,1),ki(2,1,1),ki(2,1,1),ki(2,1,1),ki(0,2,1),ki(2,0,1),ki(7,7,2),ki(6,7,2),ki(7,6,2),ki(7,5,2),ki(6,6,2),ki(6,6,2),ki(4,7,2),ki(4,7,2),ki(7,4,2),ki(7,4,2),ki(5,7,3),ki(5,5,3),ki(5,6,2),ki(6,5,2),ki(3,7,1),ki(3,7,1),ki(7,3,1),ki(4,6,1),ki(4,5,2),ki(5,4,2),ki(3,5,2),ki(5,3,2),ki(6,4,1),ki(0,7,1),ki(4,4,1),ki(2,5,1),ki(5,2,1),ki(0,5,1),ki(4,3,1),ki(3,3,1)],Li=[yi(16,4),yi(32,4),yi(48,4),yi(64,2),yi(68,3),yi(76,1),ki(1,2,4),ki(2,1,4),yi(78,1),ki(0,0,4),ki(1,1,3),ki(1,1,3),ki(0,1,3),ki(0,1,3),ki(1,0,3),ki(1,0,3),yi(80,2),yi(84,1),yi(86,1),yi(88,1),ki(5,6,4),ki(3,7,4),yi(90,1),ki(2,7,4),ki(7,2,4),ki(4,6,4),ki(6,4,4),ki(1,7,4),ki(7,1,4),yi(92,1),ki(3,6,4),ki(6,3,4),ki(4,5,4),ki(5,4,4),ki(4,4,4),yi(94,1),ki(2,6,3),ki(2,6,3),ki(6,2,3),ki(6,2,3),ki(6,1,3),ki(6,1,3),ki(1,6,4),ki(6,0,4),ki(3,5,4),ki(5,3,4),ki(2,5,4),ki(5,2,4),ki(1,5,3),ki(1,5,3),ki(5,1,3),ki(5,1,3),ki(3,4,3),ki(3,4,3),ki(4,3,3),ki(4,3,3),ki(5,0,4),ki(0,4,4),ki(2,4,3),ki(2,4,3),ki(4,2,3),ki(4,2,3),ki(1,4,3),ki(1,4,3),ki(3,3,2),ki(4,1,2),ki(2,3,2),ki(3,2,2),ki(4,0,3),ki(0,3,3),ki(3,0,2),ki(3,0,2),ki(1,3,1),ki(1,3,1),ki(1,3,1),ki(1,3,1),ki(3,1,1),ki(2,2,1),ki(0,2,1),ki(2,0,1),ki(7,7,2),ki(6,7,2),ki(7,6,1),ki(7,6,1),ki(5,7,1),ki(7,5,1),ki(6,6,1),ki(4,7,1),ki(7,4,1),ki(6,5,1),ki(7,3,1),ki(5,5,1),ki(0,7,1),ki(7,0,1),ki(0,6,1),ki(0,5,1)],Ui=[yi(16,4),yi(32,4),yi(48,4),yi(64,2),ki(1,1,4),ki(0,1,4),ki(1,0,3),ki(1,0,3),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),yi(68,4),yi(84,4),yi(100,4),yi(116,4),yi(132,4),yi(148,4),yi(164,3),yi(172,3),yi(180,3),yi(188,3),yi(196,3),yi(204,3),yi(212,1),yi(214,2),yi(218,3),yi(226,1),yi(228,2),yi(232,2),yi(236,2),yi(240,2),ki(8,1,4),yi(244,1),yi(246,1),yi(248,1),yi(250,2),yi(254,1),ki(1,5,4),ki(5,1,4),yi(256,1),yi(258,1),yi(260,1),ki(1,4,4),ki(4,1,3),ki(4,1,3),ki(0,4,4),ki(4,0,4),ki(2,3,4),ki(3,2,4),ki(1,3,3),ki(1,3,3),ki(3,1,3),ki(3,1,3),ki(0,3,3),ki(0,3,3),ki(3,0,3),ki(3,0,3),ki(2,2,3),ki(2,2,3),ki(1,2,2),ki(2,1,2),ki(0,2,2),ki(2,0,2),yi(262,4),yi(278,4),yi(294,4),yi(310,3),yi(318,2),yi(322,2),yi(326,3),yi(334,2),yi(338,1),yi(340,2),yi(344,2),yi(348,2),yi(352,2),yi(356,2),ki(1,15,4),ki(15,1,4),ki(15,0,4),yi(360,1),yi(362,1),yi(364,1),ki(14,2,4),yi(366,1),ki(1,14,4),ki(14,1,4),yi(368,1),yi(370,1),yi(372,1),yi(374,1),yi(376,1),yi(378,1),ki(12,6,4),ki(3,13,4),yi(380,1),ki(2,13,4),ki(13,2,4),ki(1,13,4),ki(11,7,4),yi(382,1),yi(384,1),ki(12,3,4),yi(386,1),ki(4,11,4),ki(13,1,3),ki(13,1,3),ki(0,13,4),ki(13,0,4),ki(8,10,4),ki(10,8,4),ki(4,12,4),ki(12,4,4),ki(6,11,4),ki(11,6,4),ki(3,12,3),ki(3,12,3),ki(2,12,3),ki(2,12,3),ki(12,2,3),ki(12,2,3),ki(5,11,3),ki(5,11,3),ki(11,5,4),ki(8,9,4),ki(1,12,3),ki(1,12,3),ki(12,1,3),ki(12,1,3),ki(9,8,4),ki(0,12,4),ki(12,0,3),ki(12,0,3),ki(11,4,4),ki(6,10,4),ki(10,6,4),ki(7,9,4),ki(3,11,3),ki(3,11,3),ki(11,3,3),ki(11,3,3),ki(8,8,4),ki(5,10,4),ki(2,11,3),ki(2,11,3),ki(10,5,4),ki(6,9,4),ki(10,4,3),ki(10,4,3),ki(7,8,4),ki(8,7,4),ki(9,4,3),ki(9,4,3),ki(7,7,4),ki(7,6,4),ki(11,2,2),ki(11,2,2),ki(11,2,2),ki(11,2,2),ki(1,11,2),ki(1,11,2),ki(11,1,2),ki(11,1,2),ki(0,11,3),ki(11,0,3),ki(9,6,3),ki(4,10,3),ki(3,10,3),ki(10,3,3),ki(5,9,3),ki(9,5,3),ki(2,10,2),ki(2,10,2),ki(10,2,2),ki(10,2,2),ki(1,10,2),ki(1,10,2),ki(10,1,2),ki(10,1,2),ki(0,10,3),ki(6,8,3),ki(10,0,2),ki(10,0,2),ki(8,6,3),ki(4,9,3),ki(9,3,2),ki(9,3,2),ki(3,9,3),ki(5,8,3),ki(8,5,3),ki(6,7,3),ki(2,9,2),ki(2,9,2),ki(9,2,2),ki(9,2,2),ki(5,7,3),ki(7,5,3),ki(3,8,2),ki(3,8,2),ki(8,3,2),ki(8,3,2),ki(6,6,3),ki(4,7,3),ki(7,4,3),ki(5,6,3),ki(6,5,3),ki(7,3,3),ki(1,9,1),ki(9,1,1),ki(0,9,2),ki(9,0,2),ki(4,8,2),ki(8,4,2),ki(7,2,2),ki(7,2,2),ki(4,6,3),ki(6,4,3),ki(2,8,1),ki(2,8,1),ki(2,8,1),ki(2,8,1),ki(8,2,1),ki(1,8,1),ki(3,7,2),ki(2,7,2),ki(1,7,1),ki(1,7,1),ki(7,1,1),ki(7,1,1),ki(5,5,2),ki(0,7,2),ki(7,0,2),ki(3,6,2),ki(6,3,2),ki(4,5,2),ki(5,4,2),ki(2,6,2),ki(6,2,2),ki(3,5,2),ki(0,8,1),ki(8,0,1),ki(1,6,1),ki(6,1,1),ki(0,6,1),ki(6,0,1),ki(5,3,2),ki(4,4,2),ki(2,5,1),ki(2,5,1),ki(5,2,1),ki(0,5,1),ki(3,4,1),ki(4,3,1),ki(5,0,1),ki(2,4,1),ki(4,2,1),ki(3,3,1),yi(388,3),ki(15,15,4),ki(14,15,4),ki(13,15,4),ki(14,14,4),ki(12,15,4),ki(13,14,4),ki(11,15,4),ki(15,11,4),ki(12,14,4),ki(13,12,4),yi(396,1),ki(14,12,3),ki(14,12,3),ki(13,13,3),ki(13,13,3),ki(15,10,4),ki(12,13,4),ki(11,14,3),ki(11,14,3),ki(14,11,3),ki(14,11,3),ki(9,15,3),ki(9,15,3),ki(15,9,3),ki(15,9,3),ki(14,10,3),ki(14,10,3),ki(11,13,3),ki(11,13,3),ki(13,11,3),ki(13,11,3),ki(8,15,3),ki(8,15,3),ki(15,8,3),ki(15,8,3),ki(12,12,3),ki(12,12,3),ki(10,14,4),ki(9,14,4),ki(8,14,3),ki(8,14,3),ki(7,15,4),ki(7,14,4),ki(15,7,2),ki(15,7,2),ki(15,7,2),ki(15,7,2),ki(13,10,2),ki(13,10,2),ki(10,13,3),ki(11,12,3),ki(12,11,3),ki(15,6,3),ki(6,15,2),ki(6,15,2),ki(14,8,2),ki(5,15,2),ki(9,13,2),ki(13,9,2),ki(15,5,2),ki(14,7,2),ki(10,12,2),ki(11,11,2),ki(4,15,2),ki(4,15,2),ki(15,4,2),ki(15,4,2),ki(12,10,3),ki(14,6,3),ki(15,3,2),ki(15,3,2),ki(3,15,1),ki(3,15,1),ki(8,13,2),ki(13,8,2),ki(2,15,1),ki(15,2,1),ki(6,14,2),ki(9,12,2),ki(0,15,1),ki(0,15,1),ki(12,9,2),ki(5,14,2),ki(10,11,1),ki(10,11,1),ki(7,13,2),ki(13,7,2),ki(4,14,1),ki(4,14,1),ki(12,8,2),ki(13,6,2),ki(3,14,1),ki(3,14,1),ki(11,9,1),ki(11,9,1),ki(9,11,2),ki(10,10,2),ki(11,10,1),ki(14,5,1),ki(14,4,1),ki(8,12,1),ki(6,13,1),ki(14,3,1),ki(2,14,1),ki(0,14,1),ki(14,0,1),ki(5,13,1),ki(13,5,1),ki(7,12,1),ki(12,7,1),ki(4,13,1),ki(8,11,1),ki(11,8,1),ki(13,4,1),ki(9,10,1),ki(10,9,1),ki(6,12,1),ki(13,3,1),ki(7,11,1),ki(5,12,1),ki(12,5,1),ki(9,9,1),ki(7,10,1),ki(10,7,1),ki(9,7,1),ki(15,14,3),ki(15,12,3),ki(15,13,2),ki(15,13,2),ki(14,13,1),ki(14,13,1),ki(14,13,1),ki(14,13,1),ki(10,15,1),ki(14,9,1)],Di=[yi(16,4),yi(32,4),yi(48,4),yi(64,4),yi(80,4),yi(96,3),yi(104,3),yi(112,2),yi(116,1),yi(118,1),ki(1,1,3),ki(1,1,3),ki(0,1,4),ki(1,0,4),ki(0,0,3),ki(0,0,3),yi(120,4),yi(136,4),yi(152,4),yi(168,4),yi(184,4),yi(200,3),yi(208,3),yi(216,4),yi(232,3),yi(240,3),yi(248,3),yi(256,3),yi(264,2),yi(268,3),yi(276,3),yi(284,2),yi(288,2),yi(292,2),yi(296,2),yi(300,2),yi(304,2),yi(308,2),yi(312,2),yi(316,2),yi(320,1),yi(322,1),yi(324,1),yi(326,2),yi(330,1),yi(332,1),yi(334,2),yi(338,1),yi(340,1),yi(342,1),ki(9,1,4),yi(344,1),yi(346,1),yi(348,1),yi(350,1),yi(352,1),ki(2,8,4),ki(8,2,4),ki(1,8,4),ki(8,1,4),yi(354,1),yi(356,1),yi(358,1),yi(360,1),ki(2,7,4),ki(7,2,4),ki(6,4,4),ki(1,7,4),ki(5,5,4),ki(7,1,4),yi(362,1),ki(3,6,4),ki(6,3,4),ki(4,5,4),ki(5,4,4),ki(2,6,4),ki(6,2,4),ki(1,6,4),yi(364,1),ki(3,5,4),ki(6,1,3),ki(6,1,3),ki(5,3,4),ki(4,4,4),ki(2,5,3),ki(2,5,3),ki(5,2,3),ki(5,2,3),ki(1,5,3),ki(1,5,3),ki(5,1,3),ki(5,1,3),ki(0,5,4),ki(5,0,4),ki(3,4,3),ki(3,4,3),ki(4,3,3),ki(2,4,3),ki(4,2,3),ki(3,3,3),ki(4,1,2),ki(4,1,2),ki(1,4,3),ki(0,4,3),ki(2,3,2),ki(2,3,2),ki(3,2,2),ki(3,2,2),ki(4,0,3),ki(0,3,3),ki(1,3,2),ki(1,3,2),ki(3,1,2),ki(3,0,2),ki(2,2,1),ki(2,2,1),ki(1,2,1),ki(2,1,1),ki(0,2,1),ki(2,0,1),yi(366,1),yi(368,1),ki(14,14,4),yi(370,1),yi(372,1),yi(374,1),ki(15,11,4),yi(376,1),ki(13,13,4),ki(10,15,4),ki(15,10,4),ki(11,14,4),ki(14,11,4),ki(12,13,4),ki(13,12,4),ki(9,15,4),ki(15,9,4),ki(14,10,4),ki(11,13,4),ki(13,11,4),ki(8,15,4),ki(15,8,4),ki(12,12,4),ki(9,14,4),ki(14,9,4),ki(7,15,4),ki(15,7,4),ki(10,13,4),ki(13,10,4),ki(11,12,4),ki(6,15,4),yi(378,1),ki(12,11,3),ki(12,11,3),ki(15,6,3),ki(15,6,3),ki(8,14,4),ki(14,8,4),ki(5,15,4),ki(9,13,4),ki(15,5,3),ki(15,5,3),ki(7,14,3),ki(7,14,3),ki(14,7,3),ki(14,7,3),ki(10,12,3),ki(10,12,3),ki(12,10,3),ki(12,10,3),ki(11,11,3),ki(11,11,3),ki(13,9,4),ki(8,13,4),ki(4,15,3),ki(4,15,3),ki(15,4,3),ki(15,4,3),ki(3,15,3),ki(3,15,3),ki(15,3,3),ki(15,3,3),ki(13,8,3),ki(13,8,3),ki(14,6,3),ki(14,6,3),ki(2,15,3),ki(2,15,3),ki(15,2,3),ki(15,2,3),ki(6,14,4),ki(15,0,4),ki(1,15,3),ki(1,15,3),ki(15,1,3),ki(15,1,3),ki(9,12,3),ki(9,12,3),ki(12,9,3),ki(12,9,3),ki(5,14,3),ki(10,11,3),ki(11,10,3),ki(14,5,3),ki(7,13,3),ki(13,7,3),ki(4,14,3),ki(14,4,3),ki(8,12,3),ki(12,8,3),ki(3,14,3),ki(6,13,3),ki(13,6,3),ki(14,3,3),ki(9,11,3),ki(11,9,3),ki(2,14,3),ki(2,14,3),ki(10,10,3),ki(10,10,3),ki(14,2,3),ki(14,2,3),ki(1,14,3),ki(1,14,3),ki(14,1,3),ki(14,1,3),ki(0,14,4),ki(14,0,4),ki(5,13,3),ki(5,13,3),ki(13,5,3),ki(13,5,3),ki(7,12,3),ki(12,7,3),ki(4,13,3),ki(8,11,3),ki(13,4,2),ki(13,4,2),ki(11,8,3),ki(9,10,3),ki(10,9,3),ki(6,12,3),ki(12,6,3),ki(3,13,3),ki(13,3,2),ki(13,3,2),ki(13,2,2),ki(13,2,2),ki(2,13,3),ki(0,13,3),ki(1,13,2),ki(1,13,2),ki(7,11,2),ki(7,11,2),ki(11,7,2),ki(11,7,2),ki(13,1,2),ki(13,1,2),ki(5,12,3),ki(13,0,3),ki(12,5,2),ki(12,5,2),ki(8,10,2),ki(8,10,2),ki(10,8,2),ki(4,12,2),ki(12,4,2),ki(6,11,2),ki(11,6,2),ki(11,6,2),ki(9,9,3),ki(0,12,3),ki(3,12,2),ki(3,12,2),ki(12,3,2),ki(12,3,2),ki(7,10,2),ki(7,10,2),ki(10,7,2),ki(10,7,2),ki(10,6,2),ki(10,6,2),ki(12,0,3),ki(0,11,3),ki(12,2,1),ki(12,2,1),ki(2,12,2),ki(5,11,2),ki(11,5,2),ki(1,12,2),ki(8,9,2),ki(9,8,2),ki(12,1,2),ki(4,11,2),ki(11,4,2),ki(6,10,2),ki(3,11,2),ki(7,9,2),ki(11,3,1),ki(11,3,1),ki(9,7,2),ki(8,8,2),ki(2,11,2),ki(5,10,2),ki(11,2,1),ki(11,2,1),ki(10,5,2),ki(1,11,2),ki(11,1,1),ki(11,1,1),ki(11,0,2),ki(6,9,2),ki(9,6,2),ki(4,10,2),ki(10,4,2),ki(7,8,2),ki(8,7,2),ki(3,10,2),ki(10,3,1),ki(10,3,1),ki(5,9,1),ki(9,5,1),ki(2,10,1),ki(10,2,1),ki(1,10,1),ki(10,1,1),ki(0,10,2),ki(10,0,2),ki(6,8,1),ki(6,8,1),ki(8,6,1),ki(4,9,1),ki(9,4,1),ki(3,9,1),ki(9,3,1),ki(9,3,1),ki(7,7,2),ki(0,9,2),ki(5,8,1),ki(8,5,1),ki(2,9,1),ki(6,7,1),ki(7,6,1),ki(9,2,1),ki(1,9,1),ki(9,0,1),ki(4,8,1),ki(8,4,1),ki(5,7,1),ki(7,5,1),ki(3,8,1),ki(8,3,1),ki(6,6,1),ki(4,7,1),ki(7,4,1),ki(0,8,1),ki(8,0,1),ki(5,6,1),ki(6,5,1),ki(3,7,1),ki(7,3,1),ki(4,6,1),ki(0,7,1),ki(7,0,1),ki(0,6,1),ki(6,0,1),ki(15,15,1),ki(14,15,1),ki(15,14,1),ki(13,15,1),ki(15,13,1),ki(12,15,1),ki(15,12,1),ki(13,14,1),ki(14,13,1),ki(11,15,1),ki(12,14,1),ki(14,12,1),ki(10,14,1),ki(0,15,1)],Mi=[yi(16,4),yi(32,4),yi(48,4),yi(64,2),ki(1,1,4),ki(0,1,4),ki(1,0,3),ki(1,0,3),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),ki(0,0,1),yi(68,3),yi(76,3),yi(84,2),ki(15,15,4),yi(88,2),yi(92,1),yi(94,4),ki(15,2,4),yi(110,1),ki(1,15,4),ki(15,1,4),yi(112,4),yi(128,4),yi(144,4),yi(160,4),yi(176,4),yi(192,4),yi(208,3),yi(216,3),yi(224,3),yi(232,3),yi(240,3),yi(248,3),yi(256,3),yi(264,2),yi(268,2),yi(272,1),yi(274,2),yi(278,2),yi(282,1),ki(5,1,4),yi(284,1),yi(286,1),yi(288,1),yi(290,1),ki(1,4,4),ki(4,1,4),yi(292,1),ki(2,3,4),ki(3,2,4),ki(1,3,3),ki(1,3,3),ki(3,1,3),ki(3,1,3),ki(0,3,4),ki(3,0,4),ki(2,2,3),ki(2,2,3),ki(1,2,2),ki(2,1,2),ki(0,2,2),ki(2,0,2),ki(14,15,3),ki(15,14,3),ki(13,15,3),ki(15,13,3),ki(12,15,3),ki(15,12,3),ki(11,15,3),ki(15,11,3),ki(10,15,2),ki(10,15,2),ki(15,10,3),ki(9,15,3),ki(15,9,3),ki(15,8,3),ki(8,15,2),ki(8,15,2),ki(7,15,2),ki(15,7,2),ki(6,15,2),ki(15,6,2),ki(5,15,2),ki(15,5,2),ki(4,15,1),ki(4,15,1),ki(15,4,1),ki(15,3,1),ki(15,0,1),ki(15,0,1),ki(15,0,1),ki(15,0,1),ki(15,0,1),ki(15,0,1),ki(15,0,1),ki(15,0,1),ki(3,15,2),ki(3,15,2),ki(3,15,2),ki(3,15,2),yi(294,4),yi(310,3),yi(318,3),yi(326,3),ki(2,15,1),ki(0,15,1),yi(334,2),yi(338,2),yi(342,2),yi(346,1),yi(348,2),yi(352,2),yi(356,1),yi(358,2),yi(362,2),yi(366,2),yi(370,2),ki(14,3,4),yi(374,1),yi(376,1),yi(378,1),yi(380,1),yi(382,1),yi(384,1),yi(386,1),ki(0,13,4),yi(388,1),yi(390,1),yi(392,1),ki(3,12,4),yi(394,1),ki(1,12,4),ki(12,0,4),yi(396,1),ki(14,2,3),ki(14,2,3),ki(2,14,4),ki(1,14,4),ki(13,3,4),ki(2,13,4),ki(13,2,4),ki(13,1,4),ki(3,11,4),yi(398,1),ki(1,13,3),ki(1,13,3),ki(12,4,4),ki(6,11,4),ki(12,3,4),ki(10,7,4),ki(2,12,3),ki(2,12,3),ki(12,2,4),ki(11,5,4),ki(12,1,4),ki(0,12,4),ki(4,11,4),ki(11,4,4),ki(6,10,4),ki(10,6,4),ki(11,3,3),ki(11,3,3),ki(5,10,4),ki(10,5,4),ki(2,11,3),ki(2,11,3),ki(11,2,3),ki(11,2,3),ki(1,11,3),ki(1,11,3),ki(11,1,3),ki(11,1,3),ki(0,11,4),ki(11,0,4),ki(6,9,4),ki(9,6,4),ki(4,10,4),ki(10,4,4),ki(7,8,4),ki(8,7,4),ki(10,3,3),ki(10,3,3),ki(3,10,4),ki(5,9,4),ki(2,10,3),ki(2,10,3),ki(9,5,4),ki(6,8,4),ki(10,1,3),ki(10,1,3),ki(8,6,4),ki(7,7,4),ki(9,4,3),ki(9,4,3),ki(4,9,4),ki(5,7,4),ki(6,7,3),ki(6,7,3),ki(10,2,2),ki(10,2,2),ki(10,2,2),ki(10,2,2),ki(1,10,2),ki(1,10,2),ki(0,10,3),ki(10,0,3),ki(3,9,3),ki(9,3,3),ki(5,8,3),ki(8,5,3),ki(2,9,2),ki(2,9,2),ki(9,2,2),ki(9,2,2),ki(7,6,3),ki(0,9,3),ki(1,9,2),ki(1,9,2),ki(9,1,2),ki(9,1,2),ki(9,0,3),ki(4,8,3),ki(8,4,3),ki(7,5,3),ki(3,8,3),ki(8,3,3),ki(6,6,3),ki(2,8,3),ki(8,2,2),ki(8,2,2),ki(4,7,3),ki(7,4,3),ki(1,8,2),ki(1,8,2),ki(8,1,2),ki(8,1,2),ki(8,0,2),ki(8,0,2),ki(0,8,3),ki(5,6,3),ki(3,7,2),ki(3,7,2),ki(7,3,2),ki(7,3,2),ki(6,5,3),ki(4,6,3),ki(2,7,2),ki(2,7,2),ki(7,2,2),ki(7,2,2),ki(6,4,3),ki(5,5,3),ki(0,7,2),ki(0,7,2),ki(1,7,1),ki(1,7,1),ki(1,7,1),ki(1,7,1),ki(7,1,1),ki(7,1,1),ki(7,0,2),ki(3,6,2),ki(6,3,2),ki(4,5,2),ki(5,4,2),ki(2,6,2),ki(6,2,1),ki(1,6,1),ki(6,1,1),ki(6,1,1),ki(0,6,2),ki(6,0,2),ki(5,3,1),ki(5,3,1),ki(3,5,2),ki(4,4,2),ki(2,5,1),ki(5,2,1),ki(1,5,1),ki(0,5,1),ki(3,4,1),ki(4,3,1),ki(5,0,1),ki(2,4,1),ki(4,2,1),ki(3,3,1),ki(0,4,1),ki(4,0,1),ki(12,14,4),yi(400,1),ki(13,14,3),ki(13,14,3),ki(14,9,3),ki(14,9,3),ki(14,10,4),ki(13,9,4),ki(14,14,2),ki(14,14,2),ki(14,14,2),ki(14,14,2),ki(14,13,3),ki(14,13,3),ki(14,11,3),ki(14,11,3),ki(11,14,2),ki(11,14,2),ki(12,13,2),ki(12,13,2),ki(13,12,3),ki(13,11,3),ki(10,14,2),ki(10,14,2),ki(12,12,2),ki(12,12,2),ki(10,13,3),ki(13,10,3),ki(7,14,3),ki(10,12,3),ki(12,10,2),ki(12,10,2),ki(12,9,3),ki(7,13,3),ki(5,14,2),ki(5,14,2),ki(11,13,1),ki(11,13,1),ki(11,13,1),ki(11,13,1),ki(9,14,1),ki(9,14,1),ki(11,12,2),ki(12,11,2),ki(8,14,2),ki(14,8,2),ki(9,13,2),ki(14,7,2),ki(11,11,2),ki(8,13,2),ki(13,8,2),ki(6,14,2),ki(14,6,1),ki(9,12,1),ki(10,11,2),ki(11,10,2),ki(14,5,2),ki(13,7,2),ki(4,14,1),ki(4,14,1),ki(14,4,2),ki(8,12,2),ki(12,8,1),ki(3,14,1),ki(6,13,1),ki(6,13,1),ki(13,6,2),ki(9,11,2),ki(11,9,2),ki(10,10,2),ki(14,1,1),ki(14,1,1),ki(13,4,1),ki(13,4,1),ki(11,8,2),ki(10,9,2),ki(7,11,1),ki(7,11,1),ki(11,7,2),ki(13,0,2),ki(0,14,1),ki(14,0,1),ki(5,13,1),ki(13,5,1),ki(7,12,1),ki(12,7,1),ki(4,13,1),ki(8,11,1),ki(9,10,1),ki(6,12,1),ki(12,6,1),ki(3,13,1),ki(5,12,1),ki(12,5,1),ki(8,10,1),ki(10,8,1),ki(9,9,1),ki(4,12,1),ki(11,6,1),ki(7,10,1),ki(5,11,1),ki(8,9,1),ki(9,8,1),ki(7,9,1),ki(9,7,1),ki(8,8,1),ki(14,12,1),ki(13,13,1)],Fi=[yi(16,4),yi(32,4),yi(48,4),ki(15,15,4),yi(64,4),yi(80,4),yi(96,4),yi(112,4),yi(128,4),yi(144,4),yi(160,3),yi(168,2),ki(1,1,4),ki(0,1,4),ki(1,0,4),ki(0,0,4),ki(14,15,4),ki(15,14,4),ki(13,15,4),ki(15,13,4),ki(12,15,4),ki(15,12,4),ki(11,15,4),ki(15,11,4),ki(15,10,3),ki(15,10,3),ki(10,15,4),ki(9,15,4),ki(15,9,3),ki(15,9,3),ki(15,8,3),ki(15,8,3),ki(8,15,4),ki(7,15,4),ki(15,7,3),ki(15,7,3),ki(6,15,3),ki(6,15,3),ki(15,6,3),ki(15,6,3),ki(5,15,3),ki(5,15,3),ki(15,5,3),ki(15,5,3),ki(4,15,3),ki(4,15,3),ki(15,4,3),ki(15,4,3),ki(3,15,3),ki(3,15,3),ki(15,3,3),ki(15,3,3),ki(2,15,3),ki(2,15,3),ki(15,2,3),ki(15,2,3),ki(15,1,3),ki(15,1,3),ki(1,15,4),ki(15,0,4),yi(172,3),yi(180,3),yi(188,3),yi(196,3),yi(204,4),yi(220,3),yi(228,3),yi(236,3),yi(244,2),yi(248,2),yi(252,2),yi(256,2),yi(260,2),yi(264,2),yi(268,2),yi(272,2),yi(276,2),yi(280,3),yi(288,2),yi(292,2),yi(296,2),yi(300,3),yi(308,2),yi(312,3),yi(320,1),yi(322,2),yi(326,2),yi(330,1),yi(332,2),yi(336,1),yi(338,1),yi(340,1),yi(342,1),yi(344,1),yi(346,1),yi(348,1),yi(350,1),yi(352,1),yi(354,1),yi(356,1),yi(358,1),yi(360,1),yi(362,1),yi(364,1),yi(366,1),yi(368,1),yi(370,2),yi(374,1),yi(376,2),ki(7,3,4),yi(380,1),ki(7,2,4),ki(4,6,4),ki(6,4,4),ki(5,5,4),ki(7,1,4),ki(3,6,4),ki(6,3,4),ki(4,5,4),ki(5,4,4),ki(2,6,4),ki(6,2,4),ki(1,6,4),ki(6,1,4),yi(382,1),ki(3,5,4),ki(5,3,4),ki(4,4,4),ki(2,5,4),ki(5,2,4),ki(1,5,4),yi(384,1),ki(5,1,3),ki(5,1,3),ki(3,4,4),ki(4,3,4),ki(2,4,3),ki(2,4,3),ki(4,2,3),ki(4,2,3),ki(3,3,3),ki(3,3,3),ki(1,4,3),ki(1,4,3),ki(4,1,3),ki(4,1,3),ki(0,4,4),ki(4,0,4),ki(2,3,3),ki(2,3,3),ki(3,2,3),ki(3,2,3),ki(1,3,2),ki(1,3,2),ki(1,3,2),ki(1,3,2),ki(3,1,2),ki(3,1,2),ki(3,1,2),ki(3,1,2),ki(0,3,3),ki(3,0,3),ki(2,2,2),ki(2,2,2),ki(1,2,1),ki(1,2,1),ki(1,2,1),ki(1,2,1),ki(2,1,1),ki(2,1,1),ki(0,2,2),ki(2,0,2),ki(0,15,1),ki(0,15,1),ki(0,15,1),ki(0,15,1),ki(14,14,3),ki(13,14,3),ki(14,13,3),ki(12,14,3),ki(14,12,3),ki(13,13,3),ki(11,14,3),ki(14,11,3),ki(12,13,3),ki(13,12,3),ki(10,14,3),ki(14,10,3),ki(11,13,3),ki(13,11,3),ki(12,12,3),ki(9,14,3),ki(14,9,3),ki(10,13,3),ki(13,10,3),ki(11,12,3),ki(12,11,3),ki(8,14,3),ki(14,8,3),ki(9,13,3),ki(13,9,3),ki(7,14,3),ki(14,7,3),ki(10,12,3),ki(12,10,3),ki(12,10,3),ki(11,11,3),ki(11,11,3),ki(8,13,3),ki(8,13,3),ki(13,8,3),ki(13,8,3),ki(0,14,4),ki(14,0,4),ki(0,13,3),ki(0,13,3),ki(14,6,2),ki(14,6,2),ki(14,6,2),ki(14,6,2),ki(6,14,3),ki(9,12,3),ki(12,9,2),ki(12,9,2),ki(5,14,2),ki(5,14,2),ki(11,10,2),ki(11,10,2),ki(14,5,2),ki(14,5,2),ki(10,11,3),ki(7,13,3),ki(13,7,2),ki(13,7,2),ki(14,4,2),ki(14,4,2),ki(8,12,2),ki(8,12,2),ki(12,8,2),ki(12,8,2),ki(4,14,3),ki(2,14,3),ki(3,14,2),ki(3,14,2),ki(6,13,2),ki(13,6,2),ki(14,3,2),ki(9,11,2),ki(11,9,2),ki(10,10,2),ki(14,2,2),ki(1,14,2),ki(14,1,2),ki(5,13,2),ki(13,5,2),ki(7,12,2),ki(12,7,2),ki(4,13,2),ki(8,11,2),ki(11,8,2),ki(13,4,2),ki(9,10,2),ki(10,9,2),ki(6,12,2),ki(12,6,2),ki(3,13,2),ki(13,3,2),ki(2,13,2),ki(13,2,2),ki(1,13,2),ki(7,11,2),ki(11,7,2),ki(13,1,2),ki(5,12,2),ki(12,5,2),ki(8,10,2),ki(10,8,2),ki(9,9,2),ki(4,12,2),ki(12,4,2),ki(6,11,2),ki(6,11,2),ki(11,6,2),ki(11,6,2),ki(13,0,3),ki(0,12,3),ki(3,12,2),ki(3,12,2),ki(12,3,2),ki(7,10,2),ki(10,7,2),ki(2,12,2),ki(12,2,2),ki(5,11,2),ki(11,5,2),ki(1,12,2),ki(8,9,2),ki(9,8,2),ki(12,1,2),ki(4,11,2),ki(12,0,3),ki(0,11,3),ki(3,11,2),ki(3,11,2),ki(11,0,3),ki(0,10,3),ki(1,10,2),ki(1,10,2),ki(11,4,1),ki(11,4,1),ki(6,10,2),ki(10,6,2),ki(7,9,2),ki(7,9,2),ki(9,7,2),ki(9,7,2),ki(10,0,3),ki(0,9,3),ki(9,0,2),ki(9,0,2),ki(11,3,1),ki(8,8,1),ki(2,11,2),ki(5,10,2),ki(11,2,1),ki(11,2,1),ki(10,5,2),ki(1,11,2),ki(11,1,2),ki(6,9,2),ki(9,6,1),ki(10,4,1),ki(4,10,2),ki(7,8,2),ki(8,7,1),ki(8,7,1),ki(3,10,1),ki(10,3,1),ki(5,9,1),ki(9,5,1),ki(2,10,1),ki(10,2,1),ki(10,1,1),ki(6,8,1),ki(8,6,1),ki(7,7,1),ki(4,9,1),ki(9,4,1),ki(3,9,1),ki(9,3,1),ki(5,8,1),ki(8,5,1),ki(2,9,1),ki(6,7,1),ki(7,6,1),ki(9,2,1),ki(1,9,1),ki(9,1,1),ki(4,8,1),ki(8,4,1),ki(5,7,1),ki(7,5,1),ki(3,8,1),ki(8,3,1),ki(6,6,1),ki(2,8,1),ki(8,2,1),ki(1,8,1),ki(4,7,1),ki(7,4,1),ki(8,1,1),ki(8,1,1),ki(0,8,2),ki(8,0,2),ki(5,6,1),ki(6,5,1),ki(1,7,1),ki(1,7,1),ki(0,7,2),ki(7,0,2),ki(3,7,1),ki(2,7,1),ki(0,6,1),ki(6,0,1),ki(0,5,1),ki(5,0,1)],Bi=[bi,wi],zi=[new l(_i,0,0),new l(Ti,0,3),new l(Ii,0,3),new l(Si,0,3),null,new l(xi,0,3),new l(Pi,0,4),new l(Ei,0,4),new l(Ci,0,4),new l(Ai,0,4),new l(Oi,0,4),new l(Ri,0,4),new l(Li,0,4),new l(Ui,0,4),null,new l(Di,0,4),new l(Mi,1,4),new l(Mi,2,4),new l(Mi,3,4),new l(Mi,4,4),new l(Mi,6,4),new l(Mi,8,4),new l(Mi,10,4),new l(Mi,13,4),new l(Fi,4,4),new l(Fi,5,4),new l(Fi,6,4),new l(Fi,7,4),new l(Fi,8,4),new l(Fi,9,4),new l(Fi,11,4),new l(Fi,13,4)];
var Ni=function(){function t(){this.tmp_imdct36=new Float64Array(18),this.tmp_dctIV=new Float64Array(18),this.tmp_sdctII=new Float64Array(9)}function e(t,e,i){var n,r,h,d,p,m,v,y,g,b,w,k,_,T,I,S,x,P,E,C,A,O,R,L,U,D,M,F,B,z,N,j,q,W;n=t[3]+t[5],r=t[3]-t[5],h=t[6]+t[2],d=t[6]-t[2],p=t[1]+t[7],m=t[1]-t[7],v=t[8]+t[0],y=t[8]-t[0],g=n+h,b=n-h,w=n-v,k=h-v,_=g+v,T=r-d,I=T+y,S=d+y,x=r-y,P=r+d,M=P*-l,F=x*-a,B=S*-u,z=I*-s,N=m*-s,j=k*-f,q=w*-c,W=b*-o,E=t[4]+p,C=2*t[4]-p,A=C+j,O=C-j,R=C+q,L=N+B,U=N-B,D=N+F,e[i+0]=E+_,e[i+2]=M-D,e[i+4]=W-A,e[i+6]=z,e[i+8]=O-q,e[i+10]=U-F,e[i+12]=_-2*E,e[i+14]=L+M,e[i+16]=R+W}t.prototype.imdct36=function(t,e){var i=this.tmp_imdct36;this.dctIV(t,i);for(var n=0;9>n;++n)e[n]=i[9+n];for(var n=9;27>n;++n)e[n]=-i[36-(9+n)-1];for(var n=27;36>n;++n)e[n]=-i[n-27]};var i=[];for(r=0;18>r;r++)i[r]=2*Math.cos(Math.PI*(2*r+1)/72);t.prototype.dctIV=function(t,e){for(var n=this.tmp_dctIV,r=0;18>r;++r)n[r]=t[r]*i[r];this.sdctII(n,e),e[0]/=2;for(var r=1;18>r;++r)e[r]=e[r]/2-e[r-1]};for(var n=[],r=0;9>r;++r)n[r]=2*Math.cos(Math.PI*(2*r+1)/36);t.prototype.sdctII=function(t,i){for(var r=this.tmp_sdctII,a=0;9>a;++a)r[a]=t[a]+t[18-a-1];e(r,i,0);for(var a=0;9>a;++a)r[a]=(t[a]-t[18-a-1])*n[a];e(r,i,1);for(var a=3;18>a;a+=2)i[a]-=i[a-2]};var a=2*Math.cos(1*Math.PI/18),s=2*Math.cos(3*Math.PI/18),o=2*Math.cos(4*Math.PI/18),l=2*Math.cos(5*Math.PI/18),u=2*Math.cos(7*Math.PI/18),c=2*Math.cos(8*Math.PI/18),f=2*Math.cos(16*Math.PI/18);return t}();const ji=[[.608761429,-.923879533,-.130526192,.991444861,-.382683432,-.79335334],[-.79335334,.382683432,.991444861,.130526192,-.923879533,-.608761429],[.382683432,-.923879533,.923879533,-.382683432,-.382683432,.923879533],[-.923879533,-.382683432,.382683432,.923879533,.923879533,.382683432],[.130526192,-.382683432,.608761429,-.79335334,.923879533,-.991444861],[-.991444861,-.923879533,-.79335334,-.608761429,-.382683432,-.130526192]];n.layers[3]=d,d.prototype.decode=function(t,e){var i=e.header,n=0,r=0,a=i.nchannels(),s=i.flags&B.LSF_EXT?1===a?9:17:1===a?17:32;if(t.next_frame-t.nextByte()<s)throw t.md_len=0,new Error("Bad frame length");i.flags&B.PROTECTION;var o=this.sideInfo(t,a,i.flags&B.LSF_EXT),l=o.si,u=(o.data_bitlen,o.priv_bitlen);i.flags|=u,i.private_bits|=l.private_bits;var c=t.copy();c.seek(8*t.next_frame);var f=c.read(16);65506===(65510&f)&&(0===(1&f)&&c.advance(16),c.advance(16),n=c.read(8&f?9:8));var h=t.next_frame-t.nextByte();n>l.main_data_begin+h&&(n=0);var d,r=l.main_data_begin+h-n,p=0;if(0===l.main_data_begin)d=t.stream,t.md_len=0,p=r;else{if(l.main_data_begin>t.md_len)throw new Error("bad main_data_begin pointer");var v=t.md_len;if(r>l.main_data_begin){if(t.md_len+r-l.main_data_begin>q)throw new Error("Assertion failed: (stream.md_len + md_len - si.main_data_begin <= MAD_BUFFER_MDLEN)");p=r-l.main_data_begin,this.memcpy(t.main_data,t.md_len,t.stream.stream,t.nextByte(),p),t.md_len+=p}d=new m.Bitstream(m.Stream.fromBuffer(new m.Buffer(t.main_data))),d.advance(8*(v-l.main_data_begin))}var y=h-p;if(this.decodeMainData(d,e,l,a),y>=n)this.memcpy(t.main_data,0,t.stream.stream,t.next_frame-n,n),t.md_len=n;else{if(r<l.main_data_begin){var g=l.main_data_begin-r;g+y>n&&(g=n-y),g<t.md_len&&(this.memcpy(t.main_data,0,t.main_data,t.md_len-g,g),t.md_len=g)}else t.md_len=0;this.memcpy(t.main_data,t.md_len,t.stream.stream,t.next_frame-y,y),t.md_len+=y}},d.prototype.memcpy=function(t,e,i,n,r){var a;return a=i.subarray?i.subarray(n,n+r):i.peekBuffer(n-i.offset,r).data,t.set(a,e),t},d.prototype.sideInfo=function(t,e,i){var n=this.si,r=0,a=i?1===e?1:2:1===e?5:3;n.main_data_begin=t.read(i?8:9),n.private_bits=t.read(a);var s=1;if(!i){s=2;for(var o=0;e>o;++o)n.scfsi[o]=t.read(4)}for(var l=0;s>l;l++)for(var u=n.gr[l],o=0;e>o;o++){var c=u.ch[o];if(c.part2_3_length=t.read(12),c.big_values=t.read(9),c.global_gain=t.read(8),c.scalefac_compress=t.read(i?9:4),r+=c.part2_3_length,c.big_values>288)throw new Error("bad big_values count");if(c.flags=0,t.read(1)){if(c.block_type=t.read(2),0===c.block_type)throw new Error("reserved block_type");if(!i&&2===c.block_type&&n.scfsi[o])throw new Error("bad scalefactor selection info");c.region0_count=7,c.region1_count=36,t.read(1)?c.flags|=ni:2===c.block_type&&(c.region0_count=8);for(var f=0;2>f;f++)c.table_select[f]=t.read(5);for(var f=0;3>f;f++)c.subblock_gain[f]=t.read(3)}else{c.block_type=0;for(var f=0;3>f;f++)c.table_select[f]=t.read(5);c.region0_count=t.read(4),c.region1_count=t.read(3)}c.flags|=t.read(i?2:3)}return{si:n,data_bitlen:r,priv_bitlen:a}},d.prototype.decodeMainData=function(t,e,i,n){var r=e.header,a=r.samplerate;r.flags&B.MPEG_2_5_EXT&&(a*=2);var s=(a>>7&15)+(a>>15&1)-8;r.flags&B.MPEG_2_5_EXT&&(s+=3);for(var o=r.flags&B.LSF_EXT?1:2,l=this.xr,u=0;o>u;++u){for(var c=i.gr[u],f=[],h=0,d=0;n>d;++d){var p,m=c.ch[d];f[d]=Ye[s].l,2===m.block_type&&(f[d]=m.flags&ni?Ye[s].m:Ye[s].s),p=r.flags&B.LSF_EXT?this.scalefactors_lsf(t,m,0===d?0:i.gr[1].ch[1],r.mode_extension):this.scalefactors(t,m,i.gr[0].ch[d],0===u?0:i.scfsi[d]),this.huffmanDecode(t,l[d],m,f[d],p)}r.mode===N.JOINT_STEREO&&0!==r.mode_extension&&this.stereo(l,i.gr,u,r,f[0]);for(var d=0;n>d;d++){var v,y,g,m=c.ch[d],b=e.sbsample[d].slice(18*u),h=0,w=this.output;if(2===m.block_type?(this.reorder(l[d],m,f[d]),m.flags&ni&&this.aliasreduce(l[d],36)):this.aliasreduce(l[d],576),2!==m.block_type||m.flags&ni){var k=m.block_type;m.flags&ni&&(k=0);for(var v=0;2>v;++v,h+=18)this.imdct_l(l[d].subarray(h,h+18),w,k),this.overlap(w,e.overlap[d][v],b,v)}else for(var v=0;2>v;++v,h+=18)this.imdct_s(l[d].subarray(h,h+18),w),this.overlap(w,e.overlap[d][v],b,v);this.freqinver(b,1);for(var y=576;y>36&&0===l[d][y-1];)--y;if(g=32-((576-y)/18<<0),2!==m.block_type)for(var v=2;g>v;++v,h+=18)this.imdct_l(l[d].subarray(h,h+18),w,m.block_type),this.overlap(w,e.overlap[d][v],b,v),1&v&&this.freqinver(b,v);else for(var v=2;g>v;++v,h+=18)this.imdct_s(l[d].subarray(h,h+18),w),this.overlap(w,e.overlap[d][v],b,v),1&v&&this.freqinver(b,v);for(var v=g;32>v;++v)this.overlap_z(e.overlap[d][v],b,v),1&v&&this.freqinver(b,v)}}},d.prototype.scalefactors=function(t,e,i,n){var r,a=t.offset(),s=ci[e.scalefac_compress].slen1,o=ci[e.scalefac_compress].slen2;if(2===e.block_type){r=0;for(var l=e.flags&ni?17:18;l--;)e.scalefac[r++]=t.read(s);for(l=18;l--;)e.scalefac[r++]=t.read(o);for(l=3;l--;)e.scalefac[r++]=0}else{if(8&n)for(var r=0;6>r;++r)e.scalefac[r]=i.scalefac[r];else for(var r=0;6>r;++r)e.scalefac[r]=t.read(s);if(4&n)for(var r=6;11>r;++r)e.scalefac[r]=i.scalefac[r];else for(var r=6;11>r;++r)e.scalefac[r]=t.read(s);if(2&n)for(var r=11;16>r;++r)e.scalefac[r]=i.scalefac[r];else for(var r=11;16>r;++r)e.scalefac[r]=t.read(o);if(1&n)for(var r=16;21>r;++r)e.scalefac[r]=i.scalefac[r];else for(var r=16;21>r;++r)e.scalefac[r]=t.read(o);e.scalefac[21]=0}return t.offset()-a},d.prototype.scalefactors_lsf=function(t,e,i,n){var r,a=t.offset(),s=e.scalefac_compress,o=2===e.block_type?e.flags&ni?2:1:0,l=new Int32Array(4);if(n&ri&&i){s>>>=1,180>s?(l[0]=s/36,l[1]=s%36/6,l[2]=s%36%6,l[3]=0,r=fi[3][o]):244>s?(s-=180,l[0]=s%64>>>4,l[1]=s%16>>>2,l[2]=s%4,l[3]=0,r=fi[4][o]):(s-=244,l[0]=s/3,l[1]=s%3,l[2]=0,l[3]=0,r=fi[5][o]);for(var u=0,c=0;4>c;++c)for(var f=(1<<l[c])-1,h=0;h<r[c];++h){var d=t.read(l[c]);e.scalefac[u]=d,i.scalefac[u++]=d===f?1:0}for(;39>u;)e.scalefac[u]=0,i.scalefac[u++]=0}else{400>s?(l[0]=(s>>>4)/5,l[1]=(s>>>4)%5,l[2]=s%16>>>2,l[3]=s%4,r=fi[0][o]):500>s?(s-=400,l[0]=(s>>>2)/5,l[1]=(s>>>2)%5,l[2]=s%4,l[3]=0,r=fi[1][o]):(s-=500,l[0]=s/3,l[1]=s%3,l[2]=0,l[3]=0,e.flags|=ii,r=fi[2][o]);for(var u=0,c=0;4>c;c++)for(var h=0;h<r[c];h++)e.scalefac[u++]=t.read(l[c]);for(;39>u;)e.scalefac[u++]=0}return t.offset()-a},d.prototype.huffmanDecode=function(t,e,i,n,r){var a=this._exponents,s=0,o=i.part2_3_length-r;if(0>o)throw new Error("bad audio data length");this.exponents(i,n,a);var l=t.copy();t.advance(o);var u=8-l.bitPosition;u+=7+(24-u)&-8;var c=l.read(u);o-=u;var f=0,h=0,d=this.reqcache,p=f+n[s++],m=i.region0_count+1,v=zi[i.table_select[h]],y=v.table,g=v.linbits,b=v.startbits;if("undefined"==typeof y)throw new Error("bad Huffman table select");for(var w=0,k=a[w++],_=0,T=i.big_values;T--&&u+o>0;){if(f===p){if(p+=n[s++],0===--m&&(m=0===h?i.region1_count+1:0,v=zi[i.table_select[++h]],y=v.table,g=v.linbits,b=v.startbits,"undefined"==typeof y))throw new Error("bad Huffman table select");k!==a[w]&&(k=a[w],_=0),++w}if(21>u){var I=10+(21-u)&-8;c=c<<I|l.read(I),u+=I,o-=I}for(var S=b,x=y[c>>u-S&(1<<S)-1];!x.final;)u-=S,S=x.ptr.bits,x=y[x.ptr.offset+(c>>u-S&(1<<S)-1)];if(u-=x.value.hlen,g){var P=x.value.x,E=!1;switch(P){case 0:e[f]=0;break;case 15:g+2>u&&(c=c<<16|l.read(16),u+=16,o-=16),P+=c>>u-g&(1<<g)-1,u-=g,A=this.requantize(P,k),E=!0;break;default:_&1<<P?A=d[P]:(_|=1<<P,A=d[P]=this.requantize(P,k)),E=!0}E&&(e[f]=c&1<<u-- -1?-A:A),P=x.value.y;var C=!1;switch(P){case 0:e[f+1]=0;break;case 15:g+1>u&&(c=c<<16|l.read(16),u+=16,o-=16),P+=c>>u-g&(1<<g)-1,u-=g,A=this.requantize(P,k),C=!0;break;default:_&1<<P?A=d[P]:(_|=1<<P,d[P]=this.requantize(P,k),A=d[P]),C=!0}C&&(e[f+1]=c&1<<u-- -1?-A:A)}else{var P=x.value.x;0===P?e[f]=0:(_&1<<P?A=d[P]:(_|=1<<P,A=d[P]=this.requantize(P,k)),e[f]=c&1<<u-- -1?-A:A),P=x.value.y,0===P?e[f+1]=0:(_&1<<P?A=d[P]:(_|=1<<P,A=d[P]=this.requantize(P,k)),e[f+1]=c&1<<u-- -1?-A:A)}f+=2}if(0>u+o)throw new Error("Huffman data overrun");for(var y=Bi[i.flags&ti],A=this.requantize(1,k);u+o>0&&572>=f;){10>u&&(c=c<<16|l.read(16),u+=16,o-=16);var O=y[c>>u-4&15];O.final||(u-=4,O=y[O.ptr.offset+(c>>u-O.ptr.bits&(1<<O.ptr.bits)-1)]),u-=O.value.hlen,f===p&&(p+=n[s++],k!==a[w]&&(k=a[w],A=this.requantize(1,k)),++w),e[f]=O.value.v?c&1<<u-- -1?-A:A:0,e[f+1]=O.value.w?c&1<<u-- -1?-A:A:0,f+=2,f===p&&(p+=n[s++],k!==a[w]&&(k=a[w],A=this.requantize(1,k)),++w),e[f]=O.value.x?c&1<<u-- -1?-A:A:0,e[f+1]=O.value.y?c&1<<u-- -1?-A:A:0,f+=2,0>u+o&&(f-=4)}if(-o>64)throw new Error("assertion failed: (-bits_left <= BUFFER_GUARD * CHAR_BIT)");for(;576>f;)e[f]=0,e[f+1]=0,f+=2},d.prototype.requantize=function(t,e){var i=e%4>>0;e=e/4>>0;var n=Math.pow(t,4/3);return n*=Math.pow(2,e/4),i&&(n*=Math.pow(2,i/4)),0>e&&(n/=Math.pow(2,.75*-e)),n},d.prototype.exponents=function(t,e,i){var n=t.global_gain-210,r=t.flags&ei?2:1;if(2===t.block_type){var a=0,s=0;if(t.flags&ni)for(var o=t.flags&ii?-1:0;36>s;)i[a]=n-(t.scalefac[a]+(Qe[a]&o)<<r),s+=e[a++];for(var l=n-8*t.subblock_gain[0],u=n-8*t.subblock_gain[1],c=n-8*t.subblock_gain[2];576>s;)i[a+0]=l-(t.scalefac[a+0]<<r),i[a+1]=u-(t.scalefac[a+1]<<r),i[a+2]=c-(t.scalefac[a+2]<<r),s+=3*e[a],a+=3}else if(t.flags&ii)for(var a=0;22>a;a++)i[a]=n-(t.scalefac[a]+Qe[a]<<r);else for(var a=0;22>a;a++)i[a]=n-(t.scalefac[a]<<r)},d.prototype.stereo=function(t,e,i,n,r){var a,s,o,l,u=e[i],c=this.modes;if(u.ch[0].block_type!==u.ch[1].block_type||(u.ch[0].flags&ni)!==(u.ch[1].flags&ni))throw new Error("incompatible stereo block_type");for(var l=0;39>l;l++)c[l]=n.mode_extension;if(n.mode_extension&ri){var f=u.ch[1],h=t[1];if(n.flags|=B.I_STEREO,2===f.block_type){var d,p,m,v,y=new Uint32Array(3);if(d=p=m=y[0]=y[1]=y[2]=0,a=s=0,f.flags&ni){for(;36>s;){o=r[a++];for(var l=0;o>l;++l)if(h[l]){d=a;break}h+=o,s+=o}p=a}for(var v=0;576>s;){for(o=r[a++],l=0;o>l;++l)if(h[l]){m=y[v]=a;break}h+=o,s+=o,v=(v+1)%3}for(m&&(d=p),l=0;d>l;++l)c[l]=-2&n.mode_extension;for(v=0,l=p;m>l;++l)l<y[v]&&(c[l]=-2&n.mode_extension),v=(v+1)%3}else{var y=0;for(a=s=0;576>s;s+=o){for(o=r[a++],l=0;o>l;++l)if(h[l]){y=a;break}h+=o}for(l=0;y>l;++l)c[l]=-2&n.mode_extension}if(n.flags&B.LSF_EXT){var g=e[i+1].ch[1].scalefac,b=ui[1&f.scalefac_compress];for(a=s=0;576>s;++a,s+=o)if(o=r[a],c[a]&ri)if(g[a])c[a]&=-2;else for(is_pos=f.scalefac[a],l=0;o>l;++l){var w=t[0][s+l];if(0===is_pos)t[1][s+l]=w;else{var k=w*b[(is_pos-1)/2];1&is_pos?(t[0][s+l]=k,t[1][s+l]=w):t[1][s+l]=k}}}else for(a=s=0;576>s;++a,s+=o)if(o=r[a],c[a]&ri)if(is_pos=f.scalefac[a],is_pos>=7)c[a]&=-2;else for(l=0;o>l;++l){var w=t[0][s+l];t[0][s+l]=w*li[is_pos],t[1][s+l]=w*li[6-is_pos]}}if(n.mode_extension&ai){n.flags|=B.MS_STEREO;var _=Ke[1];for(a=s=0;576>s;++a,s+=o)if(o=r[a],c[a]===ai)for(l=0;o>l;++l){var T=t[0][s+l],I=t[1][s+l];t[0][s+l]=(T+I)*_,t[1][s+l]=(T-I)*_}}},d.prototype.aliasreduce=function(t,e){for(var i=18;e>i;i+=18)for(var n=0;8>n;++n){var r=t[i-n-1],a=t[i+n];t[i-n-1]=r*Je[n]-a*Ze[n],t[i+n]=a*Je[n]+r*Ze[n]}},d.prototype.imdct_l=function(t,e,i){switch(this.imdct.imdct36(t,e),i){case 0:for(var n=0;36>n;++n)e[n]=e[n]*si[n];break;case 1:for(var n=0;18>n;++n)e[n]=e[n]*si[n];for(var n=24;30>n;++n)e[n]=e[n]*oi[n-18];for(var n=30;36>n;++n)e[n]=0;break;case 3:for(var n=0;6>n;++n)e[n]=0;for(var n=6;12>n;++n)e[n]=e[n]*oi[n-6];for(var n=18;36>n;++n)e[n]=e[n]*si[n]}},d.prototype.imdct_s=function(t,e){for(var i,n,r=0,a=0,s=new Float64Array(36),o=0;3>o;++o){for(var l=0,u=0;3>u;++u)n=t[a+0]*ji[l][0]+t[a+1]*ji[l][1]+t[a+2]*ji[l][2]+t[a+3]*ji[l][3]+t[a+4]*ji[l][4]+t[a+5]*ji[l][5],s[r+u+0]=n,s[r+5-u]=-s[r+u+0],++l,n=t[a+0]*ji[l][0]+t[a+1]*ji[l][1]+t[a+2]*ji[l][2]+t[a+3]*ji[l][3]+t[a+4]*ji[l][4]+t[a+5]*ji[l][5],s[r+u+6]=n,s[r+11-u]=s[r+u+6],++l;r+=12,a+=6}r=0;for(var i=0,u=0;6>u;++u)e[u+0]=0,e[u+6]=s[r+0+0]*oi[i+0],n=s[r+0+6]*oi[i+6]+s[r+12+0]*oi[i+0],e[u+12]=n,n=s[r+12+6]*oi[i+6]+s[r+24+0]*oi[i+0],e[u+18]=n,e[u+24]=s[r+24+6]*oi[i+6],e[u+30]=0,++r,++i},d.prototype.overlap=function(t,e,i,n){for(var r=0;18>r;++r)i[r][n]=t[r]+e[r],e[r]=t[r+18]},d.prototype.freqinver=function(t,e){for(var i=1;18>i;i+=2)t[i][e]=-t[i][e]},d.prototype.overlap_z=function(t,e,i){for(var n=0;18>n;++n)e[n][i]=t[n],t[n]=0},d.prototype.reorder=function(t,e,i){var n=0,r=this.tmp,a=new Uint32Array(3),s=new Uint32Array(3),o=0;if(e.flags&ni)for(var o=2,l=0;36>l;)l+=i[n++];for(var u=0;3>u;++u)a[u]=o,s[u]=0;f=i[n++],u=0;for(var l=18*o;576>l;++l)0===f--&&(f=i[n++]-1,u=(u+1)%3),r[a[u]][u][s[u]++]=t[l],6===s[u]&&(s[u]=0,++a[u]);for(var c=this.tmp2,h=0,d=0;32>d;d++)for(var p=0;3>p;p++)for(var m=0;6>m;m++)c[h++]=r[d][p][m];for(var v=576-18*o,d=0;v>d;d++)t[18*o+d]=c[o+d]};m.Decoder.extend(function(){m.Decoder.register("mp3",this),this.prototype.init=function(){this.mp3_stream=new e(this.bitstream),this.frame=new n,this.synth=new a,this.seeking=!1},this.prototype.readChunk=function(){var t=this.mp3_stream,e=this.frame,i=this.synth;if(this.seeking){for(;;)try{e.decode(t);break}catch(n){if(n instanceof m.UnderflowError)throw n}this.seeking=!1}else e.decode(t);i.frame(e);for(var r=i.pcm.samples,a=i.pcm.channels,s=i.pcm.length,o=new Float32Array(s*a),l=0,u=0;s>u;u++)for(var c=0;a>c;c++)o[l++]=r[c][u];return o},this.prototype.seek=function(t){var e;this.demuxer.seekPoints.length>0?(t=this._super(t),e=this.stream.offset):e=t*this.format.bitrate/8/this.format.sampleRate,this.mp3_stream.reset(e);for(var n=0;4096>n;n++){for(var r=e+n,a=0;3>a;a++){this.mp3_stream.reset(r);try{var s=i.decode(this.mp3_stream)}catch(o){break}var l=s.framesize();if(null==l)break;r+=l}if(3===a)break}return 3!==a&&(n=0),this.mp3_stream.reset(e+n),0===this.demuxer.seekPoints.length&&(t=this.stream.offset/(this.format.bitrate/8)*this.format.sampleRate),this.seeking=!0,t}}),m.Demuxer.extend(function(){m.Demuxer.register(this),this.probe=function(t){return"fLaC"===t.peekString(0,4)};const t=0,e=3,i=4,n=6,r=34;this.prototype.readChunk=function(){var a=this.stream;if(!this.readHeader&&a.available(4)){if("fLaC"!==a.readString(4))return this.emit("error","Invalid FLAC file.");this.readHeader=!0}for(;a.available(1)&&!this.last;){if(!this.readBlockHeaders){var s=a.readUInt8();this.last=128===(128&s),this.type=127&s,this.size=a.readUInt24()}if(!this.foundStreamInfo&&this.type!==t)return this.emit("error","STREAMINFO must be the first block");if(!a.available(this.size))return;switch(this.type){case t:if(this.foundStreamInfo)return this.emit("error","STREAMINFO can only occur once.");if(this.size!==r)return this.emit("error","STREAMINFO size is wrong.");this.foundStreamInfo=!0;var o=new m.Bitstream(a),l={minBlockSize:o.read(16),maxBlockSize:o.read(16),minFrameSize:o.read(24),maxFrameSize:o.read(24)};this.format={formatID:"flac",sampleRate:o.read(20),channelsPerFrame:o.read(3)+1,bitsPerChannel:o.read(5)+1},this.emit("format",this.format),this.emit("cookie",l);var u=o.read(36);this.emit("duration",u/this.format.sampleRate*1e3|0),a.advance(16),this.readBlockHeaders=!1;break;case e:for(var c=0;c<this.size/18;c++)if(4294967295==a.peekUInt32(0)&&4294967295==a.peekUInt32(1))a.advance(18);else{a.readUInt32()>0&&this.emit("error","Seek points with sample number >UInt32 not supported");var f=a.readUInt32();a.readUInt32()>0&&this.emit("error","Seek points with stream offset >UInt32 not supported");var h=a.readUInt32();a.advance(2),this.addSeekPoint(h,f)}break;case i:this.metadata||(this.metadata={});var d=a.readUInt32(!0);this.metadata.vendor=a.readString(d);for(var p=a.readUInt32(!0),v=0;p>v;v++){d=a.readUInt32(!0);var y=a.readString(d,"utf8"),g=y.indexOf("=");this.metadata[y.slice(0,g).toLowerCase()]=y.slice(g+1)}break;case n:var b=a.readUInt32();if(3!==b)a.advance(this.size-4);else{var w=a.readUInt32(),k=(a.readString(w),a.readUInt32()),p=(a.readString(k),a.readUInt32(),a.readUInt32(),a.readUInt32(),a.readUInt32(),a.readUInt32()),_=a.readBuffer(p);this.metadata||(this.metadata={}),this.metadata.coverArt=_}break;default:a.advance(this.size),this.readBlockHeaders=!1}this.last&&this.metadata&&this.emit("metadata",this.metadata)}for(;a.available(1)&&this.last;){var T=a.readSingleBuffer(a.remainingBytes());this.emit("data",T)}}}),m.Decoder.extend(function(){function t(t){for(var e=0,i=0;;){if(i=t>>>24)break;if(e+=8,i=t>>>16,255&i)break;if(e+=8,i=t>>>8,255&i)break;if(e+=8,i=t,255&i)break;return e+=8}return 240&i?i>>>=4:e+=4,8&i?e:4&i?e+1:2&i?e+2:1&i?e+3:e+4}m.Decoder.register("flac",this),this.prototype.setCookie=function(t){this.cookie=t,this.decoded=[];for(var e=0;e<this.format.channelsPerFrame;e++)this.decoded[e]=new Int32Array(t.maxBlockSize)};const e=new Int16Array([0,192,576,1152,2304,4608,0,0,256,512,1024,2048,4096,8192,16384,32768]),i=new Int32Array([0,88200,176400,192e3,8e3,16e3,22050,24e3,32e3,44100,48e3,96e3,0,0,0,0]),n=new Int8Array([0,8,12,0,16,20,24,0]),r=8,a=0,s=8,o=9,l=10;this.prototype.readChunk=function(){var t=this.bitstream;if(t.available(32)){if(32764!==(32767&t.read(15)))throw new Error("Invalid sync code");var u=(t.read(1),t.read(4)),c=t.read(4),f=t.read(4),h=t.read(3);t.advance(1),this.chMode=f;var d;if(r>f)d=f+1,this.chMode=a;else{if(!(l>=f))throw new Error("Invalid channel mode");d=2}if(d!==this.format.channelsPerFrame)throw new Error("Switching channel layout mid-stream not supported.");if(3===h||7===h)throw new Error("Invalid sample size code");if(this.bps=n[h],this.bps!==this.format.bitsPerChannel)throw new Error("Switching bits per sample mid-stream not supported.");var p,m;this.bps>16?(p=32-this.bps,m=!0):(p=16-this.bps,m=!1);for(var v=0;1===t.read(1);)v++;for(var y=t.read(7-v);v>1;v--)t.advance(2),y=y<<6|t.read(6);if(0===u)throw new Error("Reserved blocksize code");this.blockSize=6===u?t.read(8)+1:7===u?t.read(16)+1:e[u];var g;if(12>c)g=i[c];else if(12===c)g=1e3*t.read(8);else if(13===c)g=t.read(16);else{if(14!==c)throw new Error("Invalid sample rate code");g=10*t.read(16)}t.advance(8);for(var b=0;d>b;b++)this.decodeSubframe(b);t.align(),t.advance(16);var w=new ArrayBuffer(this.blockSize*d*this.bps/8),k=m?new Int32Array(w):new Int16Array(w),_=this.blockSize,T=this.decoded,I=0;switch(this.chMode){case a:for(var S=0;_>S;S++)for(var b=0;d>b;b++)k[I++]=T[b][S]<<p;break;case s:for(var b=0;_>b;b++){var x=T[0][b],P=T[1][b];k[I++]=x<<p,k[I++]=x-P<<p}break;case o:for(var b=0;_>b;b++){var x=T[0][b],P=T[1][b];k[I++]=x+P<<p,k[I++]=P<<p}break;case l:for(var b=0;_>b;b++){var x=T[0][b],P=T[1][b];x-=P>>1,k[I++]=x+P<<p,k[I++]=x<<p}}return k}},this.prototype.decodeSubframe=function(t){var e=0,i=this.bitstream,n=this.blockSize,r=this.decoded;if(this.curr_bps=this.bps,0===t?this.chMode===o&&this.curr_bps++:(this.chMode===s||this.chMode===l)&&this.curr_bps++,i.read(1))throw new Error("Invalid subframe padding");var a=i.read(6);if(i.read(1)){for(e=1;!i.read(1);)e++;this.curr_bps-=e}if(this.curr_bps>32)throw new Error("decorrelated bit depth > 32 ("+this.curr_bps+")");if(0===a)for(var u=i.read(this.curr_bps,!0),c=0;n>c;c++)r[t][c]=u;else if(1===a)for(var f=this.curr_bps,c=0;n>c;c++)r[t][c]=i.read(f,!0);else if(a>=8&&12>=a)this.decode_subframe_fixed(t,-9&a);else{if(!(a>=32))throw new Error("Invalid coding type");this.decode_subframe_lpc(t,(-33&a)+1)}if(e)for(var c=0;n>c;c++)r[t][c]<<=e},this.prototype.decode_subframe_fixed=function(t,e){for(var i=this.decoded[t],n=this.bitstream,r=this.curr_bps,a=0;e>a;a++)i[a]=n.read(r,!0);this.decode_residuals(t,e);var s=0,o=0,l=0,u=0;switch(e>0&&(s=i[e-1]),e>1&&(o=s-i[e-2]),e>2&&(l=o-i[e-2]+i[e-3]),e>3&&(u=l-i[e-2]+2*i[e-3]-i[e-4]),e){case 0:break;case 1:case 2:case 3:case 4:for(var c=new Int32Array([s,o,l,u]),f=this.blockSize,a=e;f>a;a++){c[e-1]+=i[a];for(var h=e-2;h>=0;h--)c[h]+=c[h+1];i[a]=c[0]}break;default:throw new Error("Invalid Predictor Order "+e)}},this.prototype.decode_subframe_lpc=function(t,e){for(var i=this.bitstream,n=this.decoded[t],r=this.curr_bps,a=this.blockSize,s=0;e>s;s++)n[s]=i.read(r,!0);var o=i.read(4)+1;if(16===o)throw new Error("Invalid coefficient precision");var l=i.read(5,!0);if(0>l)throw new Error("Negative qlevel, maybe buggy stream");for(var u=new Int32Array(32),s=0;e>s;s++)u[s]=i.read(o,!0);if(this.decode_residuals(t,e),this.bps>16)throw new Error("no 64-bit integers in JS, could probably use doubles though");for(var s=e;a-1>s;s+=2){for(var c,f=n[s-e],h=0,d=0,p=e-1;p>0;p--)c=u[p],h+=c*f,f=n[s-p],d+=c*f;c=u[0],h+=c*f,f=n[s]+=h>>l,d+=c*f,n[s+1]+=d>>l}if(a>s){for(var m=0,p=0;e>p;p++)m+=u[p]*n[s-p-1];n[s]+=m>>l}};const u=32767;this.prototype.decode_residuals=function(t,e){var i=this.bitstream,n=i.read(2);if(n>1)throw new Error("Illegal residual coding method "+n);var r=i.read(4),a=this.blockSize>>>r;if(e>a)throw new Error("Invalid predictor order "+e+" > "+a);for(var s=this.decoded[t],o=e,l=e,c=0;1<<r>c;c++){var f=i.read(0===n?4:5);if(f===(0===n?15:31))for(f=i.read(5);a>l;l++)s[o++]=i.read(f,!0);else for(;a>l;l++)s[o++]=this.golomb(f,u,0);l=0}};this.prototype.golomb=function(e,i,n){var r=this.bitstream,a=r.bitPosition,s=r.peek(32-a)<<a,o=0,l=31-t(1|s);if(l-e>=7&&i>32-l)s>>>=l-e,s+=30-l<<e,r.advance(32+e-l),o=s;else{for(var u=0;0===r.read(1);u++)s=r.peek(32-a)<<a;i-1>u?(s=e?r.read(e):0,o=s+(u<<e)):u===i-1?(s=r.read(n),o=s+1):o=-1}return o>>1^-(1&o)}});return p.AV=m}(),define("listen-aurora.min",function(){}),"classList"in document.documentElement||!Object.defineProperty||"undefined"==typeof HTMLElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){function t(t){return function(i){var n=e.className.split(/\s+/),r=n.indexOf(i);t(n,r,i),e.className=n.join(" ")}}var e=this,i={add:t(function(t,e,i){~e||t.push(i)}),remove:t(function(t,e){~e&&t.splice(e,1)}),toggle:t(function(t,e,i){~e?t.splice(e,1):t.push(i)}),contains:function(t){return!!~e.className.split(/\s+/).indexOf(t)},item:function(t){return e.className.split(/\s+/)[t]||null}};return Object.defineProperty(i,"length",{get:function(){return e.className.split(/\s+/).length}}),i}}),define("listen-classlist",function(){}),UNKNOWN_ART="img/avatar.jpeg",define("listen-DGAuroraPlayer",function(){}),define("listen-player",function(){}),define("listen-listen",["jquery","desktop"],function(t,e){!function(){var t=window.AudioContext||window.webkitAudioContext;return t?(new t).sampleRate:44100}();t(window).load(function(){DGPlayer=DGPlayer(document.getElementById("dgplayer")),DGPlayer.album={},DGPlayer.volume=100;var i,n;DGPlayer.on("play",n=function(){i&&i.disconnect(),i=new DGAuroraPlayer(AV.Player.fromURL(DGPlayer.current.url),DGPlayer),DGPlayer.off("play",n)}),DGPlayer.on("playlist",onplaylist=function(){i&&(i.disconnect(),DGPlayer.state="paused"),i=new DGAuroraPlayer(AV.Player.fromURL(DGPlayer.current.url),DGPlayer)}),t(e.$container).on("click",".listen",function(i){i.preventDefault();var n=t(this).closest(e.itemSelector);t.get("/plugins/listen/"+n.attr("data-id"),function(e){DGPlayer.album=e.album,t("#dgplayer").is(":hidden")&&t("#dgplayer").fadeIn().find(".button").click()},"json")})})}),require.config({baseUrl:"/javascripts",paths:{async:"helpers/async",underscore:"helpers/underscore",notify:"modules/desktop-notify",cookie:"modules/jquery.cookie",quickfit:"modules/quickfit",collapse:"modules/jquery.collapse",collapse_storage:"modules/jquery.collapse_storage",customselect:"modules/customselect",text:"text",classie:"packery/classie",eventie:"packery/eventie","doc-ready":"packery/doc-ready",eventEmitter:"packery/eventEmitter","get-style-property":"packery/get-style-property","get-size":"packery/get-size","matches-selector":"packery/matches-selector",outlayer:"packery/outlayer",imagesloaded:"packery/imagesloaded/imagesloaded",packery:"packery/packery/js",desktop:"desktop",api:"api",alertify:"alertify",theme:"../js/theme",admin:"../js/admin","chat-chat":"/Users/soyuka/Sites/ezseed2/app/plugins/chat/public/js/chat","checkforupdates-checkforupdates":"/Users/soyuka/Sites/ezseed2/app/plugins/checkforupdates/public/js/checkforupdates","listen-DGAuroraPlayer":"/Users/soyuka/Sites/ezseed2/app/plugins/listen/public/js/DGAuroraPlayer","listen-classlist":"/Users/soyuka/Sites/ezseed2/app/plugins/listen/public/js/classlist","listen-listen":"/Users/soyuka/Sites/ezseed2/app/plugins/listen/public/js/listen","listen-player":"/Users/soyuka/Sites/ezseed2/app/plugins/listen/public/js/player","listen-aurora.min":"/Users/soyuka/Sites/ezseed2/app/plugins/listen/public/audiocogs/aurora.min"},shim:{notify:["jquery"],cookie:["jquery"],quickfit:["jquery"],collapse:["jquery"],collapse_storage:["collapse","jquery"],customselect:["jquery"],theme:{deps:["desktop"]},admin:{deps:["collapse","collapse_storage","customselect"]}},waitSeconds:25}),require(["desktop","theme","admin","chat-chat","checkforupdates-checkforupdates","listen-aurora.min","listen-classlist","listen-DGAuroraPlayer","listen-player","listen-listen"],function(t){var e=t.socket;e.on("remove",function(e){t.remove(e)})}),define("main.build",function(){});