/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*!
 * classie - class helper functions
 * from bonzo https://github.com/ded/bonzo
 * 
 * classie.has( elem, 'my-class' ) -> true/false
 * classie.add( elem, 'my-new-class' )
 * classie.remove( elem, 'my-unwanted-class' )
 * classie.toggle( elem, 'my-class' )
 */

/*!
 * getStyleProperty v1.0.3
 * original by kangax
 * http://perfectionkills.com/feature-testing-css-properties/
 */

/*!
 * eventie v1.0.3
 * event binding helper
 *   eventie.bind( elem, 'click', myFn )
 *   eventie.unbind( elem, 'click', myFn )
 */

/*!
 * docReady
 * Cross browser DOMContentLoaded event emitter
 */

/*!
 * EventEmitter v4.2.5 - git.io/ee
 * Oliver Caldwell
 * MIT license
 * @preserve
 */

/*!
 * Outlayer v1.1.8
 * the brains and guts of a layout library
 */

/*!
 * Packery v1.1.2
 * bin-packing layout library
 * http://packery.metafizzy.co
 *
 * Commercial use requires one-time purchase of a commercial license
 * http://packery.metafizzy.co/license.html
 *
 * Non-commercial use is licensed under the GPL v3 License
 *
 * Copyright 2013 Metafizzy
 */

/*!
 * imagesLoaded v3.0.4
 * JavaScript is all like "You images are done yet or what?"
 */

//     Underscore.js 1.5.2
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

/*!
 * jQuery Cookie Plugin v1.3.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */

/*! alertify - v0.3.11 - 2013-10-08 */

/*
 * Collapse plugin for jQuery
 * --
 * source: http://github.com/danielstocks/jQuery-Collapse/
 * site: http://webcloud.se/jQuery-Collapse
 *
 * @author Daniel Stocks (http://webcloud.se)
 * Copyright 2013, Daniel Stocks
 * Released under the MIT, BSD, and GPL Licenses.
 */

/*
 * Storage for jQuery Collapse
 * --
 * source: http://github.com/danielstocks/jQuery-Collapse/
 * site: http://webcloud.se/jQuery-Collapse
 *
 * @author Daniel Stocks (http://webcloud.se)
 * Copyright 2013, Daniel Stocks
 * Released under the MIT, BSD, and GPL Licenses.
 */

/*!
 * jquery.customSelect() - v0.4.1
 * http://adam.co/lab/jquery/customselect/
 * 2013-05-13
 *
 * Copyright 2013 Adam Coulombe
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 * @license http://www.gnu.org/licenses/gpl.html GPL2 License 
 */

function DGAuroraPlayer(e,t){this.player=e,this.ui=t,t.seekTime=0,t.duration=0,t.bufferProgress=0;var n,r,i,s,o,u,a,f;t.on("play",n=function(){e.play(),t.state="playing"}),t.on("pause",r=function(){e.pause(),t.state="paused"}),t.on("volume",i=function(t){e.volume=t}),e.on("buffer",o=function(e){t.bufferProgress=e}),e.on("progress",u=function(e){t.seekTime=e}),e.on("duration",a=function(e){t.duration=e}),e.on("metadata",f=function(e){t.songTitle=e.title,t.album=e,t.current.picture?t.coverArt=t.current.picture:e.coverArt?t.coverArt=e.coverArt.toBlobURL():t.coverArt=UNKNOWN_ART});var l=t.fileDescription;e.on("error",onerror=function(e){console.log(e),t.state="paused",t.duration=0,t.bufferProgress=0,t.seekTime=0,t.coverArt=UNKNOWN_ART,t.songTitle="Unknown Title",t.songArtist="Unknown Artist"}),e.volume=t.volume,e.play(),t.state="playing",this.disconnect=function(){e&&e.stop(),t.off("play",n),t.off("pause",r),t.off("volume",i),e.off("buffer",o),e.off("format",s),e.off("progress",u),e.off("duration",a),e.off("metadata",f)}}function DGPlayer(e){function o(e){if(!t[e])return;var n=Array.prototype.slice.call(arguments,1),r=t[e];for(var i=0,s=r.length;i<s;i++)r[i].apply(null,n)}var t={},n="paused";e.onselectstart=function(){return!1};var r=function(){function c(e){return("00"+e).slice(-2)}var t=e.querySelector(".seek .track .loaded"),n=e.querySelector(".seek .track .progress"),r=e.querySelector(".seek span:first-child"),i=e.querySelector(".seek span:last-child"),s=t.parentNode.offsetWidth-2,u=0,a=0,f=0,l=0;return{getTrackLength:function(){return f},setTrackLength:function(e){f=e,this.seekTime=a},getCurrentTime:function(){return a},setCurrentTime:function(e){l=Math.floor(a/1e3%60),a=e,a>=f&&f>0&&(o("pause"),o("trackends"));var t=a/1e3,u=Math.floor(t%60),h=Math.floor((t/=60)%60);if(u===l)return;r.innerHTML=h+":"+c(u);if(f>0){var p=(f-a)/1e3,d=Math.floor(p%60),v=Math.floor((p/=60)%60);i.innerHTML="-"+v+":"+c(d),position=Math.max(0,Math.min(1,a/f)),n.style.width=s*position+"px"}else i.innerHTML="-0:00"},getAmountLoaded:function(){return u},setAmountLoaded:function(e){u=Math.max(0,Math.min(100,e)),t.style.width=s*(u/100)+"px"}}}(),i=function(){function s(e){(i=e)?(n.classList.remove("entypo-play"),n.classList.add("entypo-pause")):(n.classList.remove("entypo-pause"),n.classList.add("entypo-play"))}var t=e.querySelector(".button"),n=t.querySelector("i"),r=null,i=!1;return t.onclick=function(){o(i?"pause":"play")},e.addEventListener("keyup",function(e){e.which===32&&o(i?"pause":"play")}),{setPlaying:s,getPlaying:function(){return i}}}(),s=function(){function p(e){"webkitTransform"in t.style?t.style.webkitTransform="translate3d("+c+"px,0, 0)":t.style.left=c+"px",n.style.width=c+"px",h=Math.round((c-f)/(l-f)*100),e||o("volume",h)}function d(e){var t=e.targetTouches?e.targetTouches[0].pageX:e.clientX,n=Math.max(f,Math.min(l,c+t-i));if(!s||n===c)return;c=n,i=t,p()}function v(e){if(!s)return;s=!1,t.classList.remove("active")}function m(){t.classList.add("animatable"),n.classList.add("animatable"),p(),setTimeout(function(){t.classList.remove("animatable"),n.classList.remove("animatable")},250)}var t=e.querySelector(".volume .handle"),n=e.querySelector(".volume .progress"),r=e.querySelector(".volume .track");volumeLeft=e.querySelector(".volume img:last-child"),volumeRight=e.querySelector(".volume img:first-child");var i=0,s=!1,u=70,a=20,f=0,l=u-a/2-3,c=Math.floor(u/2-a/2),h=50;return p(),t.onmousedown=t.ontouchstart=function(e){i=e.targetTouches?e.targetTouches[0].pageX:e.clientX,s=!0,e.stopPropagation(),t.classList.add("active"),e.preventDefault()},document.addEventListener("mousemove",d,!1),document.addEventListener("touchmove",d,!1),document.addEventListener("mouseup",v,!1),document.addEventListener("touchend",v,!1),volumeLeft.onclick=function(){c=l,m()},volumeRight.onclick=function(){c=f,m()},r.onmousedown=r.ontouchstart=function(e){var n=e.targetTouches?e.targetTouches[0].pageX:e.clientX,i=0,s=r;while(s)i+=s.offsetLeft,s=s.offsetParent;c=Math.max(f,Math.min(l,n-i-(a+f))),t.onmousedown(e),p()},{getValue:function(){return h},setValue:function(e){e=Math.max(0,Math.min(100,e)),curY=l-e/100*(l-f),p(!0)}}}(),u={on:function(e,n){t[e]||(t[e]=[]),t[e].push(n)},off:function(e,n){var r=t[e],i=r.indexOf(n);~i&&r.splice(i,1)}};Object.defineProperty||(Object.defineProperty=function(e,t,n){n.get&&e.__defineGetter__&&e.__defineGetter__(t,n.get),n.set&&e.__defineSetter__&&e.__defineSetter__(t,n.set)}),Object.defineProperty(u,"bufferProgress",{get:r.getAmountLoaded,set:r.setAmountLoaded}),Object.defineProperty(u,"state",{set:function(e){i.setPlaying(e=="playing"||e=="buffering"),n=e},get:function(){return n}}),Object.defineProperty(u,"duration",{get:r.getTrackLength,set:r.setTrackLength}),Object.defineProperty(u,"seekTime",{get:r.getCurrentTime,set:r.setCurrentTime}),Object.defineProperty(u,"volume",{get:s.getValue,set:s.setValue});var a=e.querySelector(".avatar img");Object.defineProperty(u,"coverArt",{get:function(){return a.src},set:function(e){a.src=e}});var f=e.querySelector("span.title"),l=e.querySelector("span.artist");Object.defineProperty(u,"songTitle",{get:function(){return f.innerHTML},set:function(e){f.innerHTML=e}}),Object.defineProperty(u,"songArtist",{get:function(){return l.innerHTML},set:function(e){l.innerHTML=e}});var c=[],h,p,d=!1,v=e.querySelector("#playlist"),m=function(e){e.preventDefault();var t=e.target.parentElement.dataset.no,n=v.querySelector("li.active");n&&n.classList.remove("active"),e.target.parentElement.classList.add("active"),u.current=t,o("playlist")},g=function(){var e=v.querySelector("li.active");e&&e.classList.remove("active"),c.length&&v.querySelector("li[data-no='"+p+"']").classList.add("active")},y=function(){var t=e.querySelector(".button-prev"),n=e.querySelector(".button-next"),r=e.querySelector(".button-playlist"),i="<ol><% for(var i in songs) {  var song = songs[i];%><li data-no='<%= i %>'><a href=''><%= song.name %></a></li><% } %></ol>",s=function(){var e=v.querySelectorAll("li");for(var t=0;t<e.length;t++)e[t].onclick=m;d=!0};return u.on("play",g),u.on("trackends",function(){var e=u.current;u.current=p+1<c.length?p+1:p,u.current==e?o("pause"):(g(),o("playlist"))}),t.onclick=function(e){u.current=p-1>=0?p-1:p,g(),o("playlist")},n.onclick=function(e){u.current=p+1<c.length?p+1:p,g(),o("playlist")},r.onclick=function(e){this.classList.toggle("active"),v.classList.toggle("show")},{getValue:function(){return c},setValue:function(e){var t=c.length;c=_.union(c,e),v.innerHTML=_.template(i,{songs:c}),s(),t!==0&&c.length>t?(p=t,h=c[p],o("playlist")):t!=c.length&&(p=0,h=c[p]),g()}}}();Object.defineProperty(u,"playlist",{get:y.getValue,set:y.setValue});var b={artist:null,album:null,picture:null};return Object.defineProperty(u,"album",{get:function(){return album},set:function(e){e=_.extend(b,e),b=e,e.artist&&e.album?u.songArtist=e.artist+" - "+e.album:e.artist&&!e.album?u.songArtist=e.artist:u.songArtist=e.album,e.picture&&(u.coverArt=e.picture),e.songs&&(u.playlist=e.songs)}}),Object.defineProperty(u,"current",{get:function(){return h},set:function(e){p=e,h=c[e]}}),Object.defineProperty(u,"addSong",{get:function(){return!1},set:function(e){c.push(e);var t=c.length-1,n="<li data-no='<%= i %>'><a href=''><%= song.name %></a></li>",r=document.createElement("div");r.innerHTML=_.template(n,{i:t,song:e}),r=r.firstChild,r.onclick=m,v.querySelector("ol").appendChild(r),delete r}}),Object.defineProperty(u,"removeSong",{get:function(){return!1},set:function(e){if(c[e]){h==c[e]&&o("pause"),c.splice(e,1);var t=v.querySelector("li[data-no='"+e+"']");t.removeEventListener("click",m),v.querySelector("ol").removeChild(t);var n=v.querySelectorAll("ol > li");for(var r in n)n[r].dataset&&(n[r].dataset.no=r)}else console.error("Song doesn't exist")}}),u}define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.10",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}d.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!../views/albums.ejs",[],function(){return'<%\nalbums.forEach(function(album) {\n\n	album.title = \'\';\n	album.title += (album.artist !== undefined && album.artist !== null) ? album.artist : \'\';\n	album.title += (album.album !== undefined && album.album !== null) ? \' - \' + album.album : \'\';\n	if(album.title.length == 0) {\n		var t = album.prevDir.split(\'/\');\n		t = t[t.length-1];\n\n		album.title += t;\n	}\n	if(album.songs.length > 1) {\n		var tailleDossier = 0;\n\n		for(var i = 0; i < album.songs.length; i++) {\n			tailleDossier += parseFloat(album.songs[i].size);\n		}\n\n	}\n	%>\n	<div data-id="<%- album._id %>" class="element list audio clearfix" data-date-added="<%- new Date(album.dateAdded).getTime() %>">\n		<div class="pullLeft">\n			<a href="#/listen/<%- album._id %>" title="Écouter" class="listen">\n				<div class="cover">\n					<div class="cover-hover">\n						<i class="entypo-play"></i>\n					</div>\n					<% if(album.picture == undefined || album.picture === null) {%>\n						<img src="/images/cover/audio.png" />\n					<% } else { %>\n						<img src="<%- album.picture %>" />\n					<% } %>\n				</div>\n			</a>\n		</div>\n		<div class="list-infos">\n			<h1 class="league-gothic"><%- album.title %></h1>\n\n			<div class="button-group">\n				<a href="#/listen/<%- album._id %>" title="Écouter" class="listen">\n					<i class="entypo-note-beamed"></i>\n				</a>\n				<% if(album.songs.length > 1) {%>\n				<a href="/archive/<%- album._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n				<% } else {%>\n				<a href="/download/<%- album._id %>" title="Télécharger">\n				<% } %>\n					<i class="entypo-download"></i>\n				</a>\n				<a href="/delete/album/<%- album._id %>" class="delete-item" title="Supprimer">\n					<i class="entypo-trash"></i>\n				</a>\n				<a href="#" class="reset-item" title="Enlever de la base de données (il reviens)" data-type="album">\n					<i class="entypo-cancel"></i>\n				</a>\n			</div>\n\n			<hr />\n			<p class="infos">\n				<% if(!_.isEmpty(album.artist)) { %>\n					Artiste : <%- album.artist %><br />\n				<% } %>\n				<% if(!_.isEmpty(album.album)) { %>\n					Album : <%- album.album %><br />\n				<% } %>\n\n				<% if(!_.isEmpty(album.genre)) { %>\n					Genre : <%- album.genre %><br />\n				<% } %>\n\n				<% if(!_.isEmpty(album.year)) { %>\n					Année : <%- album.year %><br />\n				<% } %>\n			</p>\n\n		</div>\n\n		<% if(album.songs.length) { %>\n			<div class="showFiles">\n				<i class="entypo-attach"></i>Fichiers\n			</div>\n			<div class="files">\n				<table>\n					<thead>\n						<tr><th>#</th><th>Nom</th><th>Poids</th></tr>\n					</thead>\n					<tbody>\n						<%	\n						var i = 1, songs, hasDiscs = false;\n\n						if(album.songs[0].disc !== undefined) {\n							songs = _.groupBy(album.songs, function(e) { return e.disc; });\n							hasDiscs = true;\n						} else\n							songs = [album.songs];\n\n\n						_.each(songs, function(disk, i) {\n							songs[i] = disk.sort(function(a, b) {\n								if (a.name == b.name)\n							        return 0;\n							    else if (a.name > b.name)\n							        return 1;\n							   	else\n								    return -1;\n							});\n						});\n\n\n						_.each(songs, function(disc, noDisc) {\n							if(hasDiscs) {\n								%>\n								<tr>\n									<td colspan="3" style="text-align:center">Disque n°<%= noDisc %></td>\n								</tr>\n								<%\n							}\n\n							_.each(disc, function(file) {\n						%>\n							<tr>\n								<td><%- i %></td>\n								<td style="text-align:left"><a href="/download/<%- album._id %>/<%- file._id%>"><%- file.name %></a></td>\n								<td><%- bytesToSize(file.size) %></td>\n							</tr>			\n						<% \n								i++;\n							});\n							i = 1;\n							\n						}); \n						%>\n					</tbody>\n					<tfoot>\n						<tr>\n						<td colspan="2" style="text-align:left">Taille totale : <%- bytesToSize(tailleDossier) %></td>\n						<td>\n							<a href="/archive/<%- album._id %>" data-full-size="<%- tailleDossier %>" class="archive">Télécharger le dossier</a>\n						</td>\n						</tr>\n					</tfoot>\n				</table>\n			</div>\n		<% } %>\n	</div>\n	<div data-id="<%- album._id %>" class="element miniature audio clearfix" data-date-added="<%- new Date(album.dateAdded).getTime() %>">\n		<div class="titre"><h1 class="league-gothic" title="<%- album.title %>"><%- album.title %></h1></div>\n\n		<a href="#/listen/<%- album._id %>" title="Écouter" class="listen">\n			<% if(album.picture == undefined || album.picture === null) {%>\n				<img src="/images/cover/audio.png" />\n			<% } else { %>\n				<img src="<%- album.picture %>" />\n			<% } %>\n		</a>\n	</div>\n	<div data-id="<%- album._id %>" class="element table audio" data-date-added="<%- new Date(album.dateAdded).getTime() %>">\n		<i class="entypo-music"></i>\n		<a href="#/listen/<%- album._id %>" title="Écouter" class="listen table-link">\n			<%- album.title %>\n		</a>\n		<div class="button-group">\n			<a href="#/listen/<%- album._id %>" title="Écouter" class="listen">\n				<i class="entypo-note-beamed"></i>\n			</a>\n			<% if(album.songs.length > 1) {%>\n			<a href="/archive/<%- album._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n			<% } else {%>\n			<a href="/download/<%- album._id %>" title="Télécharger">\n			<% } %>\n				<i class="entypo-download"></i>\n			</a>\n			<a href="/delete/album/<%- album._id %>" class="delete-item" title="Supprimer">\n				<i class="entypo-trash"></i>\n			</a>\n		</div>\n	</div>\n<%\n});\n%>'}),define("text!../views/movies.ejs",[],function(){return'<%\nmovies.forEach(function(movie) {\n	var tailleDossier = 0;\n\n	if(movie.videos.length > 1)\n		for(var i = 0; i < movie.videos.length; i++)\n			tailleDossier += parseFloat(movie.videos[i].size);\n\n%>\n	<div data-id="<%- movie._id %>" class="element list video clearfix" data-date-added="<%- new Date(movie.dateAdded).getTime() %>">\n		<div class="pullLeft">\n			<a href="/watch/<%- movie._id %>" title="Visionner">\n				<div class="cover">\n					<div class="cover-hover">\n						<i class="entypo-play"></i>\n					</div>\n					<% if(movie.infos.picture == undefined) {%>\n						<img src="/images/cover/video.png" />\n					<% } else { %>\n						<img src="<%- movie.infos.picture %>" />\n					<% } %>\n				</div>\n			</a>\n		</div>\n		<div class="list-infos">\n			<h1 class="league-gothic"><%- movie.infos.title %><% if(movie.infos.season != undefined) { %> - S<%- movie.infos.season%><% if(movie.videos[0].episode != undefined && movie.videos.length <= 1) { %>E<%- movie.videos[0].episode%><% } } %></h1>\n\n			<div class="button-group">\n				<a href="/watch/<%- movie._id %>" title="Visionner">\n					<i class="entypo-eye"></i>\n				</a>\n\n				<% if(movie.videos.length > 1 ) { %>\n				<a href="/archive/<%- movie._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n				<% } else {%>\n				<a href="/download/<%- movie._id %>" title="Télécharger">\n				<% } %>\n					<i class="entypo-download"></i>\n				</a>\n\n				<a href="/delete/movie/<%- movie._id %>" class="delete-item" title="Supprimer">\n					<i class="entypo-trash"></i>\n				</a>\n\n				<a href="#" class="reset-item" title="Enlever de la base de données (il reviens)" data-type="movie">\n					<i class="entypo-cancel"></i>\n				</a>\n			</div>\n\n			<hr />\n			<p class="infos">\n				<%- movie.infos.synopsis %><br>\n				<% if(movie.infos.trailer != undefined) { %>\n					<a href="<%- movie.infos.trailer %>" target="_blank">Voir le trailer</a>\n				<% } %>\n			</p>\n\n			<% if(movie.quality != undefined && movie.quality.length > 0) { %>\n				<p class="info"><i class="entypo-monitor"></i><%- movie.quality %></p>\n			<% } %>\n			<% if(movie.format != undefined && movie.format.length > 0) { %>\n				<p class="info"><i class="entypo-doc-landscape"></i><%- movie.format %></p>\n			<% } %>\n			<% if(movie.language != undefined && movie.language.length > 0) { %>\n				<p class="info"><i class="entypo-sound"></i><%- movie.language %></p>\n			<% } %>\n			<% if(movie.subtitles != undefined && movie.subtitles.length > 0) { %>\n				<p class="info"><i class="entypo-text-doc"></i><%- movie.subtitles %></p>\n			<% } %>\n\n			<% if(movie.audio != undefined && movie.audio.length > 0 ) { %>\n				<p class="info"><i class="entypo-sound"></i><%- movie.audio %></p>\n			<% } %>\n\n		</div>\n		<% if(movie.videos.length > 1) { %>\n			<div class="showFiles">\n				<i class="entypo-attach"></i><% if(movie.type == \'tvseries\') { %>Episodes<%} else {%>Fichiers<%}%>\n			</div>\n			<div class="files">\n				<table>\n					<thead>\n						<tr><th>#</th><th>Nom</th><th>Poids</th><th>Options</th></tr>\n					</thead>\n					<tbody>\n						<%	var i = 1;\n\n						if(movie.movieType == "tvseries") {\n							movie.videos.sort(function (a, b) {\n								if(a.episode == b.episode)\n									return 0;\n								else if(a.episode > b.episode)\n									return 1;\n\n								return -1;\n							});\n						} else {\n							movie.videos.sort(function (a, b) {\n							    if (a.name == b.name) {\n							        return 0;\n							    } else if (a.name > b.name) {\n							        return 1;\n							    }\n							    return -1;\n							});\n						}\n\n						movie.videos.forEach(function(file) {\n						%>\n						<tr data-id="<%if(file.episode !== undefined){%><%-file._id%><%} %>">\n							<td><%- i %></td>\n							<td style="text-align:left"><%- file.name %> <%= (file.episode !== null && file.episode.length) ? \'- E\' + file.episode : \'\' %></td>\n							<td><%- bytesToSize(file.size) %></td>\n							<td>\n								<a href="/download/<%-movie._id%>/<%-file._id%>"><i class="entypo-download"></i></a>\n								<a href="/watch/<%-movie._id%>/<%-file._id%>"><i class="entypo-eye"></i></a>\n							</td>\n						</tr>			\n						<% \n							i++;\n						}); \n						%>\n					</tbody>\n					<tfoot>\n						<tr>\n							<% if(movie.videos[0].episode === null ) { %> \n								<td colspan="3" style="text-align:left">Taille totale : <%- bytesToSize(tailleDossier) %></td>\n								<td>\n									<a href="/archive/<%- movie._id %>" data-full-size="<%- tailleDossier %>" class="archive">Télécharger le dossier</a>\n								</td>\n							<% } %>\n						</tr>\n					</tfoot>\n				</table>\n			</div>\n		<% } %>\n	</div>\n	<div data-id="<%- movie._id %>" class="element miniature video" data-date-added="<%- new Date(movie.dateAdded).getTime() %>">\n		<div class="titre"><h1 class="league-gothic"><%- movie.infos.title %><% if(movie.infos.season != undefined) { %> - S<%- movie.infos.season%><% if(movie.videos[0].episode != undefined && movie.videos.length <= 1) { %>E<%- movie.videos[0].episode%><% } } %></h1></div>\n	\n		<a href="/watch/<%- movie._id %>">\n 			<% if(movie.infos.picture == undefined) {%>\n				<img src="/images/cover/video.png" />\n			<% } else { %>\n				<img src="<%- movie.infos.picture %>" />\n			<% } %>\n		</a>\n	</div>\n	<div data-id="<%- movie._id %>" class="element table video" data-date-added="<%- new Date(movie.dateAdded).getTime() %>">\n		<i class="entypo-video"></i>\n\n		<a href="/watch/<%- movie._id %>" class="table-link">\n			<%- movie.infos.title %><% if(movie.infos.season != undefined) { %> - S<%- movie.infos.season%><% if(movie.videos[0].episode != undefined && movie.videos.length <= 1) { %>E<%- movie.videos[0].episode%><% } } %>\n		</a>\n\n		<div class="button-group">\n			<a href="/watch/<%- movie._id %>" title="Visionner">\n				<i class="entypo-eye"></i>\n			</a>\n\n			<% if(movie.videos.length > 1 ) { %>\n			<a href="/archive/<%- movie._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n			<% } else {%>\n			<a href="/download/<%- movie._id %>" title="Télécharger">\n			<% } %>\n				<i class="entypo-download"></i>\n			</a>\n\n			<a href="/delete/movie/<%- movie._id %>" class="delete-item" title="Supprimer">\n				<i class="entypo-trash"></i>\n			</a>\n		</div>\n	</div>\n<%\n});\n%>'}),define("text!../views/others.ejs",[],function(){return'<%\nothers.forEach(function(other) {\n\n	if(other.files.length > 1) {\n		var tailleDossier = 0;\n\n		for(var i = 0; i < other.files.length; i++) {\n			tailleDossier += parseFloat(other.files[i].size);\n		}\n\n	}\n%>\n	<div data-id="<%- other._id %>" class="element list other clearfix" data-date-added="<%- new Date(other.dateAdded).getTime() %>">\n		<div class="pullLeft">\n			<% if(other.files.length > 1) {%>\n			<a href="/archive/<%- other._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n			<% } else {%>\n			<a href="/download/<%- other._id %>" title="Télécharger">\n			<% } %>\n				<div class="cover">\n					<div class="cover-hover">\n						<i class="entypo-play"></i>\n					</div>\n					<img src="/images/cover/other.png" />\n				</div>\n			</a>\n		</div>\n		<div class="list-infos">\n			<h1 class="league-gothic"><%- other.name %></h1>\n			<div class="button-group">\n				<% if(other.files.length > 1) {%>\n				<a href="/archive/<%- other._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n				<% } else {%>\n				<a href="/download/<%- other._id %>" title="Télécharger">\n				<% } %>\n					<i class="entypo-download"></i>\n				</a>\n\n				<a href="/delete/other/<%- other._id %>" class="delete-item" title="Supprimer">\n					<i class="entypo-trash"></i>\n				</a>\n\n				<a href="#" class="reset-item" title="Enlever de la base de données (il reviens)" data-type="other">\n					<i class="entypo-cancel"></i>\n				</a>\n			</div>\n			<hr />\n			<p class="infos">\n				<% if(other.files) {%>\n				Type : <%- other.files[0].type %> <br />\n					<% if(other.files.length == 1) { %>\n					Taille : <%- bytesToSize(other.files[0].size) %>\n					<% } else { %>\n					Taille : <%- bytesToSize(tailleDossier) %>\n					<% } %>\n				<% } %>\n			</p>\n		</div>\n		<% if(other.files.length > 1) { %>\n			<div class="showFiles">\n				<i class="entypo-attach"></i>Fichiers\n			</div>\n			<div class="files">\n				<table>\n					<thead>\n						<tr><th>#</th><th>Nom</th><th>Poids</th><th>Options</th></tr>\n					</thead>\n					<tbody>\n						<%	var i = 1;\n						other.files.sort(function (a, b) {\n						    if (a.name == b.name) {\n						        return 0;\n						    } else if (a.name > b.name) {\n						        return 1;\n						    }\n						    return -1;\n						});\n\n						other.files.forEach(function(file) {\n						%>\n						<tr>\n							<td><%- i %></td>\n							<td style="text-align:left"><%- file.name %></td>\n							<td><%- bytesToSize(file.size) %></td>\n							<td><a href="/download/<%-other._id%>/<%-file._id%>"><i class="entypo-download"></i></a></td>\n						</tr>			\n						<% \n							i++;\n						}); \n						%>\n					</tbody>\n					<tfoot>\n						<tr>\n							<td colspan="3" style="text-align:left">Taille totale : <%- bytesToSize(tailleDossier) %></td>\n							<td>\n								<a href="/archive/<%- other._id %>" data-full-size="<%- tailleDossier %>" class="archive">Télécharger le dossier</a>\n							</td>\n						</tr>\n					</tfoot>\n				</table>\n			</div>\n		<% } %>\n	</div>\n	<div data-id="<%- other._id %>" class="element miniature other clearfix" data-date-added="<%- new Date(other.dateAdded).getTime() %>">\n		<div class="titre"><h1 class="league-gothic" title="<%- other.name %>"><%- other.name %></h1></div>\n		<% if(other.files.length > 1) {%>\n		<a href="/archive/<%- other._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n		<% } else {%>\n		<a href="/download/<%- other._id %>" title="Télécharger">\n		<% } %>\n			<img src="/images/cover/other.png" />\n		</a>\n	</div>\n	<div data-id="<%- other._id %>" class="element table other" data-date-added="<%- new Date(other.dateAdded).getTime() %>">\n		<i class="entypo-box"></i> \n		<a href="/download/<%- other._id %>" class="table-link" title="Télécharger">\n			<%- other.name %>\n		</a>\n		<div class="button-group">\n			<% if(other.files.length > 1) {%>\n			<a href="/archive/<%- other._id %>" data-full-size="<%- tailleDossier %>" class="archive" title="Télécharger">\n			<% } else {%>\n			<a href="/download/<%- other._id %>" title="Télécharger">\n			<% } %>\n				<i class="entypo-download"></i>\n			</a>\n\n			<a href="/delete/other/<%- other._id %>" class="delete-item" title="Supprimer">\n				<i class="entypo-trash"></i>\n			</a>\n		</div>\n	</div>\n	<%\n	});\n	%>'}),function(e){function t(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")}function s(e,t){var s=n(e,t)?i:r;s(e,t)}var n,r,i;"classList"in document.documentElement?(n=function(e,t){return e.classList.contains(t)},r=function(e,t){e.classList.add(t)},i=function(e,t){e.classList.remove(t)}):(n=function(e,n){return t(n).test(e.className)},r=function(e,t){n(e,t)||(e.className=e.className+" "+t)},i=function(e,n){e.className=e.className.replace(t(n)," ")});var o={hasClass:n,addClass:r,removeClass:i,toggleClass:s,has:n,add:r,remove:i,toggle:s};typeof define=="function"&&define.amd?define("classie/classie",o):e.classie=o}(window),function(e){function r(e){if(!e)return;if(typeof n[e]=="string")return e;e=e.charAt(0).toUpperCase()+e.slice(1);var r;for(var i=0,s=t.length;i<s;i++){r=t[i]+e;if(typeof n[r]=="string")return r}}var t="Webkit Moz ms Ms O".split(" "),n=document.documentElement.style;typeof define=="function"&&define.amd?define("get-style-property/get-style-property",[],function(){return r}):typeof exports=="object"?module.exports=r:e.getStyleProperty=r}(window),function(e,t){function s(e){var t=parseFloat(e),n=e.indexOf("%")===-1&&!isNaN(t);return n&&t}function u(){var e={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0};for(var t=0,n=o.length;t<n;t++){var r=o[t];e[r]=0}return e}function a(e){function a(e){typeof e=="string"&&(e=document.querySelector(e));if(!e||typeof e!="object"||!e.nodeType)return;var r=i(e);if(r.display==="none")return u();var a={};a.width=e.offsetWidth,a.height=e.offsetHeight;var l=a.isBorderBox=!!t&&!!r[t]&&r[t]==="border-box";for(var c=0,h=o.length;c<h;c++){var p=o[c],d=r[p];d=f(e,d);var v=parseFloat(d);a[p]=isNaN(v)?0:v}var m=a.paddingLeft+a.paddingRight,g=a.paddingTop+a.paddingBottom,y=a.marginLeft+a.marginRight,b=a.marginTop+a.marginBottom,w=a.borderLeftWidth+a.borderRightWidth,E=a.borderTopWidth+a.borderBottomWidth,S=l&&n,x=s(r.width);x!==!1&&(a.width=x+(S?0:m+w));var T=s(r.height);return T!==!1&&(a.height=T+(S?0:g+E)),a.innerWidth=a.width-(m+w),a.innerHeight=a.height-(g+E),a.outerWidth=a.width+y,a.outerHeight=a.height+b,a}function f(e,t){if(r||t.indexOf("%")===-1)return t;var n=e.style,i=n.left,s=e.runtimeStyle,o=s&&s.left;return o&&(s.left=e.currentStyle.left),n.left=t,t=n.pixelLeft,n.left=i,o&&(s.left=o),t}var t=e("boxSizing"),n;return function(){if(!t)return;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style[t]="border-box";var r=document.body||document.documentElement;r.appendChild(e);var o=i(e);n=s(o.width)===200,r.removeChild(e)}(),a}var n=document.defaultView,r=n&&n.getComputedStyle,i=r?function(e){return n.getComputedStyle(e,null)}:function(e){return e.currentStyle},o=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];typeof define=="function"&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],a):typeof exports=="object"?module.exports=a(require("get-style-property")):e.getSize=a(e.getStyleProperty)}(window),function(e){var t=document.documentElement,n=function(){};t.addEventListener?n=function(e,t,n){e.addEventListener(t,n,!1)}:t.attachEvent&&(n=function(t,n,r){t[n+r]=r.handleEvent?function(){var t=e.event;t.target=t.target||t.srcElement,r.handleEvent.call(r,t)}:function(){var n=e.event;n.target=n.target||n.srcElement,r.call(t,n)},t.attachEvent("on"+n,t[n+r])});var r=function(){};t.removeEventListener?r=function(e,t,n){e.removeEventListener(t,n,!1)}:t.detachEvent&&(r=function(e,t,n){e.detachEvent("on"+t,e[t+n]);try{delete e[t+n]}catch(r){e[t+n]=undefined}});var i={bind:n,unbind:r};typeof define=="function"&&define.amd?define("eventie/eventie",i):e.eventie=i}(this),function(e){function r(e){if(typeof e!="function")return;r.isReady?e():n.push(e)}function i(e){var i=e.type==="readystatechange"&&t.readyState!=="complete";if(r.isReady||i)return;r.isReady=!0;for(var s=0,o=n.length;s<o;s++){var u=n[s];u()}}function s(n){return n.bind(t,"DOMContentLoaded",i),n.bind(t,"readystatechange",i),n.bind(e,"load",i),r}var t=e.document,n=[];r.isReady=!1,typeof define=="function"&&define.amd?(r.isReady=typeof requirejs=="function",define("doc-ready/doc-ready",["eventie/eventie"],s)):e.docReady=s(e.eventie)}(this),function(){function e(){}function i(e,t){var n=e.length;while(n--)if(e[n].listener===t)return n;return-1}function s(e){return function(){return this[e].apply(this,arguments)}}var t=e.prototype,n=this,r=n.EventEmitter;t.getListeners=function(t){var n=this._getEvents(),r,i;if(typeof t=="object"){r={};for(i in n)n.hasOwnProperty(i)&&t.test(i)&&(r[i]=n[i])}else r=n[t]||(n[t]=[]);return r},t.flattenListeners=function(t){var n=[],r;for(r=0;r<t.length;r+=1)n.push(t[r].listener);return n},t.getListenersAsObject=function(t){var n=this.getListeners(t),r;return n instanceof Array&&(r={},r[t]=n),r||n},t.addListener=function(t,n){var r=this.getListenersAsObject(t),s=typeof n=="object",o;for(o in r)r.hasOwnProperty(o)&&i(r[o],n)===-1&&r[o].push(s?n:{listener:n,once:!1});return this},t.on=s("addListener"),t.addOnceListener=function(t,n){return this.addListener(t,{listener:n,once:!0})},t.once=s("addOnceListener"),t.defineEvent=function(t){return this.getListeners(t),this},t.defineEvents=function(t){for(var n=0;n<t.length;n+=1)this.defineEvent(t[n]);return this},t.removeListener=function(t,n){var r=this.getListenersAsObject(t),s,o;for(o in r)r.hasOwnProperty(o)&&(s=i(r[o],n),s!==-1&&r[o].splice(s,1));return this},t.off=s("removeListener"),t.addListeners=function(t,n){return this.manipulateListeners(!1,t,n)},t.removeListeners=function(t,n){return this.manipulateListeners(!0,t,n)},t.manipulateListeners=function(t,n,r){var i,s,o=t?this.removeListener:this.addListener,u=t?this.removeListeners:this.addListeners;if(typeof n!="object"||n instanceof RegExp){i=r.length;while(i--)o.call(this,n,r[i])}else for(i in n)n.hasOwnProperty(i)&&(s=n[i])&&(typeof s=="function"?o.call(this,i,s):u.call(this,i,s));return this},t.removeEvent=function(t){var n=typeof t,r=this._getEvents(),i;if(n==="string")delete r[t];else if(n==="object")for(i in r)r.hasOwnProperty(i)&&t.test(i)&&delete r[i];else delete this._events;return this},t.removeAllListeners=s("removeEvent"),t.emitEvent=function(t,n){var r=this.getListenersAsObject(t),i,s,o,u;for(o in r)if(r.hasOwnProperty(o)){s=r[o].length;while(s--)i=r[o][s],i.once===!0&&this.removeListener(t,i.listener),u=i.listener.apply(this,n||[]),u===this._getOnceReturnValue()&&this.removeListener(t,i.listener)}return this},t.trigger=s("emitEvent"),t.emit=function(t){var n=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,n)},t.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},t._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},t._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return n.EventEmitter=r,e},typeof define=="function"&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):typeof module=="object"&&module.exports?module.exports=e:this.EventEmitter=e}.call(this),function(e,t){function r(e,t){return e[n](t)}function i(e){if(e.parentNode)return;var t=document.createDocumentFragment();t.appendChild(e)}function s(e,t){i(e);var n=e.parentNode.querySelectorAll(t);for(var r=0,s=n.length;r<s;r++)if(n[r]===e)return!0;return!1}function o(e,t){return i(e),r(e,t)}var n=function(){if(t.matchesSelector)return"matchesSelector";var e=["webkit","moz","ms","o"];for(var n=0,r=e.length;n<r;n++){var i=e[n],s=i+"MatchesSelector";if(t[s])return s}}(),u;if(n){var a=document.createElement("div"),f=r(a,"div");u=f?r:o}else u=s;typeof define=="function"&&define.amd?define("matches-selector/matches-selector",[],function(){return u}):window.matchesSelector=u}(this,Element.prototype),function(e){function r(e,t){for(var n in t)e[n]=t[n];return e}function i(e){for(var t in e)return!1;return t=null,!0}function s(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})}function o(e,t,o){function d(e,t){if(!e)return;this.element=e,this.layout=t,this.position={x:0,y:0},this._create()}var u=o("transition"),a=o("transform"),f=u&&a,l=!!o("perspective"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"}[u],h=["transform","transition","transitionDuration","transitionProperty"],p=function(){var e={};for(var t=0,n=h.length;t<n;t++){var r=h[t],i=o(r);i&&i!==r&&(e[r]=i)}return e}();r(d.prototype,e.prototype),d.prototype._create=function(){this._transition={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},d.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},d.prototype.getSize=function(){this.size=t(this.element)},d.prototype.css=function(e){var t=this.element.style;for(var n in e){var r=p[n]||n;t[r]=e[n]}},d.prototype.getPosition=function(){var e=n(this.element),t=this.layout.options,r=t.isOriginLeft,i=t.isOriginTop,s=parseInt(e[r?"left":"right"],10),o=parseInt(e[i?"top":"bottom"],10);s=isNaN(s)?0:s,o=isNaN(o)?0:o;var u=this.layout.size;s-=r?u.paddingLeft:u.paddingRight,o-=i?u.paddingTop:u.paddingBottom,this.position.x=s,this.position.y=o},d.prototype.layoutPosition=function(){var e=this.layout.size,t=this.layout.options,n={};t.isOriginLeft?(n.left=this.position.x+e.paddingLeft+"px",n.right=""):(n.right=this.position.x+e.paddingRight+"px",n.left=""),t.isOriginTop?(n.top=this.position.y+e.paddingTop+"px",n.bottom=""):(n.bottom=this.position.y+e.paddingBottom+"px",n.top=""),this.css(n),this.emitEvent("layout",[this])};var v=l?function(e,t){return"translate3d("+e+"px, "+t+"px, 0)"}:function(e,t){return"translate("+e+"px, "+t+"px)"};d.prototype._transitionTo=function(e,t){this.getPosition();var n=this.position.x,r=this.position.y,i=parseInt(e,10),s=parseInt(t,10),o=i===this.position.x&&s===this.position.y;this.setPosition(e,t);if(o&&!this.isTransitioning){this.layoutPosition();return}var u=e-n,a=t-r,f={},l=this.layout.options;u=l.isOriginLeft?u:-u,a=l.isOriginTop?a:-a,f.transform=v(u,a),this.transition({to:f,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})},d.prototype.goTo=function(e,t){this.setPosition(e,t),this.layoutPosition()},d.prototype.moveTo=f?d.prototype._transitionTo:d.prototype.goTo,d.prototype.setPosition=function(e,t){this.position.x=parseInt(e,10),this.position.y=parseInt(t,10)},d.prototype._nonTransition=function(e){this.css(e.to),e.isCleaning&&this._removeStyles(e.to);for(var t in e.onTransitionEnd)e.onTransitionEnd[t].call(this)},d.prototype._transition=function(e){if(!parseFloat(this.layout.options.transitionDuration)){this._nonTransition(e);return}var t=this._transition;for(var n in e.onTransitionEnd)t.onEnd[n]=e.onTransitionEnd[n];for(n in e.to)t.ingProperties[n]=!0,e.isCleaning&&(t.clean[n]=!0);if(e.from){this.css(e.from);var r=this.element.offsetHeight;r=null}this.enableTransition(e.to),this.css(e.to),this.isTransitioning=!0};var m=a&&s(a)+",opacity";d.prototype.enableTransition=function(){if(this.isTransitioning)return;this.css({transitionProperty:m,transitionDuration:this.layout.options.transitionDuration}),this.element.addEventListener(c,this,!1)},d.prototype.transition=d.prototype[u?"_transition":"_nonTransition"],d.prototype.onwebkitTransitionEnd=function(e){this.ontransitionend(e)},d.prototype.onotransitionend=function(e){this.ontransitionend(e)};var g={"-webkit-transform":"transform","-moz-transform":"transform","-o-transform":"transform"};d.prototype.ontransitionend=function(e){if(e.target!==this.element)return;var t=this._transition,n=g[e.propertyName]||e.propertyName;delete t.ingProperties[n],i(t.ingProperties)&&this.disableTransition(),n in t.clean&&(this.element.style[e.propertyName]="",delete t.clean[n]);if(n in t.onEnd){var r=t.onEnd[n];r.call(this),delete t.onEnd[n]}this.emitEvent("transitionEnd",[this])},d.prototype.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(c,this,!1),this.isTransitioning=!1},d.prototype._removeStyles=function(e){var t={};for(var n in e)t[n]="";this.css(t)};var y={transitionProperty:"",transitionDuration:""};return d.prototype.removeTransitionStyles=function(){this.css(y)},d.prototype.removeElem=function(){this.element.parentNode.removeChild(this.element),this.emitEvent("remove",[this])},d.prototype.remove=function(){if(!u||!parseFloat(this.layout.options.transitionDuration)){this.removeElem();return}var e=this;this.on("transitionEnd",function(){return e.removeElem(),!0}),this.hide()},d.prototype.reveal=function(){delete this.isHidden,this.css({display:""});var e=this.layout.options;this.transition({from:e.hiddenStyle,to:e.visibleStyle,isCleaning:!0})},d.prototype.hide=function(){this.isHidden=!0,this.css({display:""});var e=this.layout.options;this.transition({from:e.visibleStyle,to:e.hiddenStyle,isCleaning:!0,onTransitionEnd:{opacity:function(){this.css({display:"none"})}}})},d.prototype.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},d}var t=document.defaultView,n=t&&t.getComputedStyle?function(e){return t.getComputedStyle(e,null)}:function(e){return e.currentStyle};typeof define=="function"&&define.amd?define("outlayer/item",["eventEmitter/EventEmitter","get-size/get-size","get-style-property/get-style-property"],o):(e.Outlayer={},e.Outlayer.Item=o(e.EventEmitter,e.getSize,e.getStyleProperty))}(window),function(e){function s(e,t){for(var n in t)e[n]=t[n];return e}function u(e){return o.call(e)==="[object Array]"}function a(e){var t=[];if(u(e))t=e;else if(e&&typeof e.length=="number")for(var n=0,r=e.length;n<r;n++)t.push(e[n]);else t.push(e);return t}function c(e,t){var n=l(t,e);n!==-1&&t.splice(n,1)}function h(e){return e.replace(/(.)([A-Z])/g,function(e,t,n){return t+"-"+n}).toLowerCase()}function p(o,u,l,p,d,v){function y(e,r){typeof e=="string"&&(e=t.querySelector(e));if(!e||!f(e)){n&&n.error("Bad "+this.settings.namespace+" element: "+e);return}this.element=e,this.options=s({},this.options),this.option(r);var i=++m;this.element.outlayerGUID=i,g[i]=this,this._create(),this.options.isInitLayout&&this.layout()}function b(e,t){e.prototype[t]=s({},y.prototype[t])}var m=0,g={};return y.prototype.settings={namespace:"outlayer",item:v},y.prototype.options={containerStyle:{position:"relative"},isInitLayout:!0,isOriginLeft:!0,isOriginTop:!0,isResizeBound:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}},s(y.prototype,l.prototype),y.prototype.option=function(e){s(this.options,e)},y.prototype._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),s(this.element.style,this.options.containerStyle),this.options.isResizeBound&&this.bindResize()},y.prototype.reloadItems=function(){this.items=this._itemize(this.element.children)},y.prototype._itemize=function(e){var t=this._filterFindItemElements(e),n=this.settings.item,r=[];for(var i=0,s=t.length;i<s;i++){var o=t[i],u=new n(o,this);r.push(u)}return r},y.prototype._filterFindItemElements=function(e){e=a(e);var t=this.options.itemSelector,n=[];for(var r=0,i=e.length;r<i;r++){var s=e[r];if(!f(s))continue;if(t){d(s,t)&&n.push(s);var o=s.querySelectorAll(t);for(var u=0,l=o.length;u<l;u++)n.push(o[u])}else n.push(s)}return n},y.prototype.getItemElements=function(){var e=[];for(var t=0,n=this.items.length;t<n;t++)e.push(this.items[t].element);return e},y.prototype.layout=function(){this._resetLayout(),this._manageStamps();var e=this.options.isLayoutInstant!==undefined?this.options.isLayoutInstant:!this._isLayoutInited;this.layoutItems(this.items,e),this._isLayoutInited=!0},y.prototype._init=y.prototype.layout,y.prototype._resetLayout=function(){this.getSize()},y.prototype.getSize=function(){this.size=p(this.element)},y.prototype._getMeasurement=function(e,t){var n=this.options[e],r;n?(typeof n=="string"?r=this.element.querySelector(n):f(n)&&(r=n),this[e]=r?p(r)[t]:n):this[e]=0},y.prototype.layoutItems=function(e,t){e=this._getItemsForLayout(e),this._layoutItems(e,t),this._postLayout()},y.prototype._getItemsForLayout=function(e){var t=[];for(var n=0,r=e.length;n<r;n++){var i=e[n];i.isIgnored||t.push(i)}return t},y.prototype._layoutItems=function(e,t){if(!e||!e.length){this.emitEvent("layoutComplete",[this,e]);return}this._itemsOn(e,"layout",function(){this.emitEvent("layoutComplete",[this,e])});var n=[];for(var r=0,i=e.length;r<i;r++){var s=e[r],o=this._getItemLayoutPosition(s);o.item=s,o.isInstant=t,n.push(o)}this._processLayoutQueue(n)},y.prototype._getItemLayoutPosition=function(){return{x:0,y:0}},y.prototype._processLayoutQueue=function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t];this._positionItem(r.item,r.x,r.y,r.isInstant)}},y.prototype._positionItem=function(e,t,n,r){r?e.goTo(t,n):e.moveTo(t,n)},y.prototype._postLayout=function(){var e=this._getContainerSize();e&&(this._setContainerMeasure(e.width,!0),this._setContainerMeasure(e.height,!1))},y.prototype._getContainerSize=i,y.prototype._setContainerMeasure=function(e,t){if(e===undefined)return;var n=this.size;n.isBorderBox&&(e+=t?n.paddingLeft+n.paddingRight+n.borderLeftWidth+n.borderRightWidth:n.paddingBottom+n.paddingTop+n.borderTopWidth+n.borderBottomWidth),e=Math.max(e,0),this.element.style[t?"width":"height"]=e+"px"},y.prototype._itemsOn=function(e,t,n){function o(){return r++,r===i&&n.call(s),!0}var r=0,i=e.length,s=this;for(var u=0,a=e.length;u<a;u++){var f=e[u];f.on(t,o)}},y.prototype.ignore=function(e){var t=this.getItem(e);t&&(t.isIgnored=!0)},y.prototype.unignore=function(e){var t=this.getItem(e);t&&delete t.isIgnored},y.prototype.stamp=function(e){e=this._find(e);if(!e)return;this.stamps=this.stamps.concat(e);for(var t=0,n=e.length;t<n;t++){var r=e[t];this.ignore(r)}},y.prototype.unstamp=function(e){e=this._find(e);if(!e)return;for(var t=0,n=e.length;t<n;t++){var r=e[t];c(r,this.stamps),this.unignore(r)}},y.prototype._find=function(e){if(!e)return;return typeof e=="string"&&(e=this.element.querySelectorAll(e)),e=a(e),e},y.prototype._manageStamps=function(){if(!this.stamps||!this.stamps.length)return;this._getBoundingRect();for(var e=0,t=this.stamps.length;e<t;e++){var n=this.stamps[e];this._manageStamp(n)}},y.prototype._getBoundingRect=function(){var e=this.element.getBoundingClientRect(),t=this.size;this._boundingRect={left:e.left+t.paddingLeft+t.borderLeftWidth,top:e.top+t.paddingTop+t.borderTopWidth,right:e.right-(t.paddingRight+t.borderRightWidth),bottom:e.bottom-(t.paddingBottom+t.borderBottomWidth)}},y.prototype._manageStamp=i,y.prototype._getElementOffset=function(e){var t=e.getBoundingClientRect(),n=this._boundingRect,r=p(e),i={left:t.left-n.left-r.marginLeft,top:t.top-n.top-r.marginTop,right:n.right-t.right-r.marginRight,bottom:n.bottom-t.bottom-r.marginBottom};return i},y.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},y.prototype.bindResize=function(){if(this.isResizeBound)return;o.bind(e,"resize",this),this.isResizeBound=!0},y.prototype.unbindResize=function(){o.unbind(e,"resize",this),this.isResizeBound=!1},y.prototype.onresize=function(){function t(){e.resize(),delete e.resizeTimeout}this.resizeTimeout&&clearTimeout(this.resizeTimeout);var e=this;this.resizeTimeout=setTimeout(t,100)},y.prototype.resize=function(){var e=p(this.element),t=this.size&&e;if(t&&e.innerWidth===this.size.innerWidth)return;this.layout()},y.prototype.addItems=function(e){var t=this._itemize(e);return t.length&&(this.items=this.items.concat(t)),t},y.prototype.appended=function(e){var t=this.addItems(e);if(!t.length)return;this.layoutItems(t,!0),this.reveal(t)},y.prototype.prepended=function(e){var t=this._itemize(e);if(!t.length)return;var n=this.items.slice(0);this.items=t.concat(n),this._resetLayout(),this._manageStamps(),this.layoutItems(t,!0),this.reveal(t),this.layoutItems(n)},y.prototype.reveal=function(e){if(!e||!e.length)return;for(var t=0,n=e.length;t<n;t++){var r=e[t];r.reveal()}},y.prototype.hide=function(e){if(!e||!e.length)return;for(var t=0,n=e.length;t<n;t++){var r=e[t];r.hide()}},y.prototype.getItem=function(e){for(var t=0,n=this.items.length;t<n;t++){var r=this.items[t];if(r.element===e)return r}},y.prototype.getItems=function(e){if(!e||!e.length)return;var t=[];for(var n=0,r=e.length;n<r;n++){var i=e[n],s=this.getItem(i);s&&t.push(s)}return t},y.prototype.remove=function(e){e=a(e);var t=this.getItems(e);if(!t||!t.length)return;this._itemsOn(t,"remove",function(){this.emitEvent("removeComplete",[this,t])});for(var n=0,r=t.length;n<r;n++){var i=t[n];i.remove(),c(i,this.items)}},y.prototype.destroy=function(){var e=this.element.style;e.height="",e.position="",e.width="";for(var t=0,n=this.items.length;t<n;t++){var i=this.items[t];i.destroy()}this.unbindResize(),delete this.element.outlayerGUID,r&&r.removeData(this.element,this.settings.namespace)},y.data=function(e){var t=e&&e.outlayerGUID;return t&&g[t]},y.create=function(e,i){function o(){y.apply(this,arguments)}return s(o.prototype,y.prototype),b(o,"options"),b(o,"settings"),s(o.prototype.options,i),o.prototype.settings.namespace=e,o.data=y.data,o.Item=function(){v.apply(this,arguments)},o.Item.prototype=new v,o.prototype.settings.item=o.Item,u(function(){var i=h(e),s=t.querySelectorAll(".js-"+i),u="data-"+i+"-options";for(var a=0,f=s.length;a<f;a++){var l=s[a],c=l.getAttribute(u),p;try{p=c&&JSON.parse(c)}catch(d){n&&n.error("Error parsing "+u+" on "+l.nodeName.toLowerCase()+(l.id?"#"+l.id:"")+": "+d);continue}var v=new o(l,p);r&&r.data(l,e,v)}}),r&&r.bridget&&r.bridget(e,o),o},y.Item=v,y}var t=e.document,n=e.console,r=e.jQuery,i=function(){},o=Object.prototype.toString,f=typeof HTMLElement=="object"?function(t){return t instanceof HTMLElement}:function(t){return t&&typeof t=="object"&&t.nodeType===1&&typeof t.nodeName=="string"},l=Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1};typeof define=="function"&&define.amd?define("outlayer/outlayer",["eventie/eventie","doc-ready/doc-ready","eventEmitter/EventEmitter","get-size/get-size","matches-selector/matches-selector","./item"],p):e.Outlayer=p(e.eventie,e.docReady,e.EventEmitter,e.getSize,e.matchesSelector,e.Outlayer.Item)}(window),function(e){function n(){function e(t){for(var n in e.defaults)this[n]=e.defaults[n];for(n in t)this[n]=t[n]}return t.Rect=e,e.defaults={x:0,y:0,width:0,height:0},e.prototype.contains=function(e){var t=e.width||0,n=e.height||0;return this.x<=e.x&&this.y<=e.y&&this.x+this.width>=e.x+t&&this.y+this.height>=e.y+n},e.prototype.overlaps=function(e){var t=this.x+this.width,n=this.y+this.height,r=e.x+e.width,i=e.y+e.height;return this.x<r&&t>e.x&&this.y<i&&n>e.y},e.prototype.getMaximalFreeRects=function(t){if(!this.overlaps(t))return!1;var n=[],r,i=this.x+this.width,s=this.y+this.height,o=t.x+t.width,u=t.y+t.height;return this.y<t.y&&(r=new e({x:this.x,y:this.y,width:this.width,height:t.y-this.y}),n.push(r)),i>o&&(r=new e({x:o,y:this.y,width:i-o,height:this.height}),n.push(r)),s>u&&(r=new e({x:this.x,y:u,width:this.width,height:s-u}),n.push(r)),this.x<t.x&&(r=new e({x:this.x,y:this.y,width:t.x-this.x,height:this.height}),n.push(r)),n},e.prototype.canFit=function(e){return this.width>=e.width&&this.height>=e.height},e}var t=e.Packery=function(){};typeof define=="function"&&define.amd?define("packery/rect",n):(e.Packery=e.Packery||{},e.Packery.Rect=n())}(window),function(e){function t(e){function t(e,t){this.width=e||0,this.height=t||0,this.reset()}return t.prototype.reset=function(){this.spaces=[],this.newSpaces=[];var t=new e({x:0,y:0,width:this.width,height:this.height});this.spaces.push(t)},t.prototype.pack=function(e){for(var t=0,n=this.spaces.length;t<n;t++){var r=this.spaces[t];if(r.canFit(e)){this.placeInSpace(e,r);break}}},t.prototype.placeInSpace=function(e,t){e.x=t.x,e.y=t.y,this.placed(e)},t.prototype.placed=function(e){var n=[];for(var r=0,i=this.spaces.length;r<i;r++){var s=this.spaces[r],o=s.getMaximalFreeRects(e);o?n.push.apply(n,o):n.push(s)}this.spaces=n,t.mergeRects(this.spaces),this.spaces.sort(t.spaceSorterTopLeft)},t.mergeRects=function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t];if(!r)continue;var i=e.slice(0);i.splice(t,1);var s=0;for(var o=0,u=i.length;o<u;o++){var a=i[o],f=t>o?0:1;r.contains(a)&&(e.splice(o+f-s,1),s++)}}return e},t.spaceSorterTopLeft=function(e,t){return e.y-t.y||e.x-t.x},t.spaceSorterLeftTop=function(e,t){return e.x-t.x||e.y-t.y},t}if(typeof define=="function"&&define.amd)define("packery/packer",["./rect"],t);else{var n=e.Packery=e.Packery||{};n.Packer=t(n.Rect)}}(window),function(e){function t(e,t,n){var r=e("transform"),i=function(){t.Item.apply(this,arguments)};i.prototype=new t.Item;var s=i.prototype._create;return i.prototype._create=function(){s.call(this),this.rect=new n,this.placeRect=new n},i.prototype.dragStart=function(){this.getPosition(),this.removeTransitionStyles(),this.isTransitioning&&r&&(this.element.style[r]="none"),this.getSize(),this.isPlacing=!0,this.needsPositioning=!1,this.positionPlaceRect(this.position.x,this.position.y),this.isTransitioning=!1,this.didDrag=!1},i.prototype.dragMove=function(e,t){this.didDrag=!0;var n=this.layout.size;e-=n.paddingLeft,t-=n.paddingTop,this.positionPlaceRect(e,t)},i.prototype.dragStop=function(){this.getPosition();var e=this.position.x!==this.placeRect.x,t=this.position.y!==this.placeRect.y;this.needsPositioning=e||t,this.didDrag=!1},i.prototype.positionPlaceRect=function(e,t,n){this.placeRect.x=this.getPlaceRectCoord(e,!0),this.placeRect.y=this.getPlaceRectCoord(t,!1,n)},i.prototype.getPlaceRectCoord=function(e,t,n){var r=t?"Width":"Height",i=this.size["outer"+r],s=this.layout[t?"columnWidth":"rowHeight"],o=this.layout.size["inner"+r];t||(o=Math.max(o,this.layout.maxY),this.layout.rowHeight||(o-=this.layout.gutter));var u;if(s){s+=this.layout.gutter,o+=t?this.layout.gutter:0,e=Math.round(e/s);var a=Math[t?"floor":"ceil"](o/s);a-=Math.ceil(i/s),u=a}else u=o-i;return e=n?e:Math.min(e,u),e*=s||1,Math.max(0,e)},i.prototype.copyPlaceRectPosition=function(){this.rect.x=this.placeRect.x,this.rect.y=this.placeRect.y},i}typeof define=="function"&&define.amd?define("packery/item",["get-style-property/get-style-property","outlayer/outlayer","./rect"],t):e.Packery.Item=t(e.getStyleProperty,e.Outlayer,e.Packery.Rect)}(window),function(e){function t(e,t,n,r,i,s){var o=n.create("packery");return o.Item=o.prototype.settings.item=s,o.prototype._create=function(){n.prototype._create.call(this),this.packer=new i,this.stamp(this.options.stamped);var e=this;this.handleDraggabilly={dragStart:function(t){e.itemDragStart(t.element)},dragMove:function(t){e.itemDragMove(t.element,t.position.x,t.position.y)},dragEnd:function(t){e.itemDragEnd(t.element)}},this.handleUIDraggable={start:function(n){e.itemDragStart(n.currentTarget)},drag:function(n,r){e.itemDragMove(n.currentTarget,r.position.left,r.position.top)},stop:function(n){e.itemDragEnd(n.currentTarget)}}},o.prototype._resetLayout=function(){this.getSize(),this._getMeasurements(),this.packer.width=this.size.innerWidth+this.gutter,this.packer.height=Number.POSITIVE_INFINITY,this.packer.reset(),this.maxY=0},o.prototype._getMeasurements=function(){this._getMeasurement("columnWidth","width"),this._getMeasurement("rowHeight","height"),this._getMeasurement("gutter","width")},o.prototype._getItemLayoutPosition=function(e){return this._packItem(e),e.rect},o.prototype._packItem=function(e){this._setRectSize(e.element,e.rect),this.packer.pack(e.rect),this._setMaxY(e.rect)},o.prototype._setMaxY=function(e){this.maxY=Math.max(e.y+e.height,this.maxY)},o.prototype._setRectSize=function(e,n){var r=t(e),i=r.outerWidth,s=r.outerHeight,o=this.columnWidth+this.gutter,u=this.rowHeight+this.gutter;i=this.columnWidth?Math.ceil(i/o)*o:i+this.gutter,s=this.rowHeight?Math.ceil(s/u)*u:s+this.gutter,n.width=Math.min(i,this.packer.width),n.height=s},o.prototype._getContainerSize=function(){return{height:this.maxY-this.gutter}},o.prototype._manageStamp=function(e){var t=this.getItem(e),n;if(t&&t.isPlacing)n=t.placeRect;else{var i=this._getElementOffset(e);n=new r({x:this.options.isOriginLeft?i.left:i.right,y:this.options.isOriginTop?i.top:i.bottom})}this._setRectSize(e,n),this.packer.placed(n),this._setMaxY(n)},o.prototype.sortItemsByPosition=function(){this.items.sort(function(e,t){return e.position.y-t.position.y||e.position.x-t.position.x})},o.prototype.fit=function(e,t,n){var r=this.getItem(e);if(!r)return;this._getMeasurements(),this.stamp(r.element),r.getSize(),r.isPlacing=!0,t=t===undefined?r.rect.x:t,n=n===undefined?r.rect.y:n,r.positionPlaceRect(t,n,!0),this._bindFitEvents(r),r.moveTo(r.placeRect.x,r.placeRect.y),this.layout(),this.unstamp(r.element),this.sortItemsByPosition(),r.isPlacing=!1,r.copyPlaceRectPosition()},o.prototype._bindFitEvents=function(e){function r(){n++;if(n!==2)return;t.emitEvent("fitComplete",[t,e])}var t=this,n=0;e.on("layout",function(){return r(),!0}),this.on("layoutComplete",function(){return r(),!0})},o.prototype.itemDragStart=function(e){this.stamp(e);var t=this.getItem(e);t&&t.dragStart()},o.prototype.itemDragMove=function(e,t,n){function s(){i.layout(),delete i.dragTimeout}var r=this.getItem(e);r&&r.dragMove(t,n);var i=this;this.clearDragTimeout(),this.dragTimeout=setTimeout(s,40)},o.prototype.clearDragTimeout=function(){this.dragTimeout&&clearTimeout(this.dragTimeout)},o.prototype.itemDragEnd=function(t){var n=this.getItem(t),r;n&&(r=n.didDrag,n.dragStop());if(!n||!r&&!n.needsPositioning){this.unstamp(t);return}e.add(n.element,"is-positioning-post-drag");var i=this._getDragEndLayoutComplete(t,n);n.needsPositioning?(n.on("layout",i),n.moveTo(n.placeRect.x,n.placeRect.y)):n&&n.copyPlaceRectPosition(),this.clearDragTimeout(),this.on("layoutComplete",i),this.layout()},o.prototype._getDragEndLayoutComplete=function(t,n){var r=n&&n.needsPositioning,i=0,s=r?2:1,o=this;return function(){return i++,i!==s?!0:(n&&(e.remove(n.element,"is-positioning-post-drag"),n.isPlacing=!1,n.copyPlaceRectPosition()),o.unstamp(t),o.sortItemsByPosition(),r&&o.emitEvent("dragItemPositioned",[o,n]),!0)}},o.prototype.bindDraggabillyEvents=function(e){e.on("dragStart",this.handleDraggabilly.dragStart),e.on("dragMove",this.handleDraggabilly.dragMove),e.on("dragEnd",this.handleDraggabilly.dragEnd)},o.prototype.bindUIDraggableEvents=function(e){e.on("dragstart",this.handleUIDraggable.start).on("drag",this.handleUIDraggable.drag).on("dragstop",this.handleUIDraggable.stop)},o.Rect=r,o.Packer=i,o}typeof define=="function"&&define.amd?define("packery/packery",["classie/classie","get-size/get-size","outlayer/outlayer","./rect","./packer","./item"],t):e.Packery=t(e.classie,e.getSize,e.Outlayer,e.Packery.Rect,e.Packery.Packer,e.Packery.Item)}(window),function(e){function i(e,t){for(var n in t)e[n]=t[n];return e}function o(e){return s.call(e)==="[object Array]"}function u(e){var t=[];if(o(e))t=e;else if(typeof e.length=="number")for(var n=0,r=e.length;n<r;n++)t.push(e[n]);else t.push(e);return t}function a(e,s){function o(e,n,r){if(!(this instanceof o))return new o(e,n);typeof e=="string"&&(e=document.querySelectorAll(e)),this.elements=u(e),this.options=i({},this.options),typeof n=="function"?r=n:i(this.options,n),r&&this.on("always",r),this.getImages(),t&&(this.jqDeferred=new t.Deferred);var s=this;setTimeout(function(){s.check()})}function f(e){this.img=e}o.prototype=new e,o.prototype.options={},o.prototype.getImages=function(){this.images=[];for(var e=0,t=this.elements.length;e<t;e++){var n=this.elements[e];n.nodeName==="IMG"&&this.addImage(n);var r=n.querySelectorAll("img");for(var i=0,s=r.length;i<s;i++){var o=r[i];this.addImage(o)}}},o.prototype.addImage=function(e){var t=new f(e);this.images.push(t)},o.prototype.check=function(){function s(s,o){return e.options.debug&&r&&n.log("confirm",s,o),e.progress(s),t++,t===i&&e.complete(),!0}var e=this,t=0,i=this.images.length;this.hasAnyBroken=!1;if(!i){this.complete();return}for(var o=0;o<i;o++){var u=this.images[o];u.on("confirm",s),u.check()}},o.prototype.progress=function(e){this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;var t=this;setTimeout(function(){t.emit("progress",t,e),t.jqDeferred&&t.jqDeferred.notify(t,e)})},o.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var t=this;setTimeout(function(){t.emit(e,t),t.emit("always",t);if(t.jqDeferred){var n=t.hasAnyBroken?"reject":"resolve";t.jqDeferred[n](t)}})},t&&(t.fn.imagesLoaded=function(e,n){var r=new o(this,e,n);return r.jqDeferred.promise(t(this))});var a={};return f.prototype=new e,f.prototype.check=function(){var e=a[this.img.src];if(e){this.useCached(e);return}a[this.img.src]=this;if(this.img.complete&&this.img.naturalWidth!==undefined){this.confirm(this.img.naturalWidth!==0,"naturalWidth");return}var t=this.proxyImage=new Image;s.bind(t,"load",this),s.bind(t,"error",this),t.src=this.img.src},f.prototype.useCached=function(e){if(e.isConfirmed)this.confirm(e.isLoaded,"cached was confirmed");else{var t=this;e.on("confirm",function(e){return t.confirm(e.isLoaded,"cache emitted confirmed"),!0})}},f.prototype.confirm=function(e,t){this.isConfirmed=!0,this.isLoaded=e,this.emit("confirm",this,t)},f.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},f.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindProxyEvents()},f.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindProxyEvents()},f.prototype.unbindProxyEvents=function(){s.unbind(this.proxyImage,"load",this),s.unbind(this.proxyImage,"error",this)},o}var t=e.jQuery,n=e.console,r=typeof n!="undefined",s=Object.prototype.toString;typeof define=="function"&&define.amd?define("imagesloaded",["eventEmitter/EventEmitter","eventie/eventie"],a):e.imagesLoaded=a(e.EventEmitter,e.eventie)}(window),function(){function r(e){var n=!1;return function(){if(n)throw new Error("Callback was already called.");n=!0,e.apply(t,arguments)}}var e={},t,n;t=this,t!=null&&(n=t.async),e.noConflict=function(){return t.async=n,e};var i=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n+=1)t(e[n],n,e)},s=function(e,t){if(e.map)return e.map(t);var n=[];return i(e,function(e,r,i){n.push(t(e,r,i))}),n},o=function(e,t,n){return e.reduce?e.reduce(t,n):(i(e,function(e,r,i){n=t(n,e,r,i)}),n)},u=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};typeof process=="undefined"||!process.nextTick?typeof setImmediate=="function"?(e.nextTick=function(e){setImmediate(e)},e.setImmediate=e.nextTick):(e.nextTick=function(e){setTimeout(e,0)},e.setImmediate=e.nextTick):(e.nextTick=process.nextTick,typeof setImmediate!="undefined"?e.setImmediate=setImmediate:e.setImmediate=e.nextTick),e.each=function(e,t,n){n=n||function(){};if(!e.length)return n();var s=0;i(e,function(i){t(i,r(function(t){t?(n(t),n=function(){}):(s+=1,s>=e.length&&n(null))}))})},e.forEach=e.each,e.eachSeries=function(e,t,n){n=n||function(){};if(!e.length)return n();var r=0,i=function(){t(e[r],function(t){t?(n(t),n=function(){}):(r+=1,r>=e.length?n(null):i())})};i()},e.forEachSeries=e.eachSeries,e.eachLimit=function(e,t,n,r){var i=a(t);i.apply(null,[e,n,r])},e.forEachLimit=e.eachLimit;var a=function(e){return function(t,n,r){r=r||function(){};if(!t.length||e<=0)return r();var i=0,s=0,o=0;(function u(){if(i>=t.length)return r();while(o<e&&s<t.length)s+=1,o+=1,n(t[s-1],function(e){e?(r(e),r=function(){}):(i+=1,o-=1,i>=t.length?r():u())})})()}},f=function(t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[e.each].concat(n))}},l=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[a(e)].concat(n))}},c=function(t){return function(){var n=Array.prototype.slice.call(arguments);return t.apply(null,[e.eachSeries].concat(n))}},h=function(e,t,n,r){var i=[];t=s(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n,r){i[e.index]=r,t(n)})},function(e){r(e,i)})};e.map=f(h),e.mapSeries=c(h),e.mapLimit=function(e,t,n,r){return p(t)(e,n,r)};var p=function(e){return l(e,h)};e.reduce=function(t,n,r,i){e.eachSeries(t,function(e,t){r(n,e,function(e,r){n=r,t(e)})},function(e){i(e,n)})},e.inject=e.reduce,e.foldl=e.reduce,e.reduceRight=function(t,n,r,i){var o=s(t,function(e){return e}).reverse();e.reduce(o,n,r,i)},e.foldr=e.reduceRight;var d=function(e,t,n,r){var i=[];t=s(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n&&i.push(e),t()})},function(e){r(s(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};e.filter=f(d),e.filterSeries=c(d),e.select=e.filter,e.selectSeries=e.filterSeries;var v=function(e,t,n,r){var i=[];t=s(t,function(e,t){return{index:t,value:e}}),e(t,function(e,t){n(e.value,function(n){n||i.push(e),t()})},function(e){r(s(i.sort(function(e,t){return e.index-t.index}),function(e){return e.value}))})};e.reject=f(v),e.rejectSeries=c(v);var m=function(e,t,n,r){e(t,function(e,t){n(e,function(n){n?(r(e),r=function(){}):t()})},function(e){r()})};e.detect=f(m),e.detectSeries=c(m),e.some=function(t,n,r){e.each(t,function(e,t){n(e,function(e){e&&(r(!0),r=function(){}),t()})},function(e){r(!1)})},e.any=e.some,e.every=function(t,n,r){e.each(t,function(e,t){n(e,function(e){e||(r(!1),r=function(){}),t()})},function(e){r(!0)})},e.all=e.every,e.sortBy=function(t,n,r){e.map(t,function(e,t){n(e,function(n,r){n?t(n):t(null,{value:e,criteria:r})})},function(e,t){if(e)return r(e);var n=function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0};r(null,s(t.sort(n),function(e){return e.value}))})},e.auto=function(t,n){n=n||function(){};var r=u(t);if(!r.length)return n(null);var s={},a=[],f=function(e){a.unshift(e)},l=function(e){for(var t=0;t<a.length;t+=1)if(a[t]===e){a.splice(t,1);return}},c=function(){i(a.slice(0),function(e){e()})};f(function(){u(s).length===r.length&&(n(null,s),n=function(){})}),i(r,function(r){var a=t[r]instanceof Function?[t[r]]:t[r],h=function(t){var o=Array.prototype.slice.call(arguments,1);o.length<=1&&(o=o[0]);if(t){var a={};i(u(s),function(e){a[e]=s[e]}),a[r]=o,n(t,a),n=function(){}}else s[r]=o,e.setImmediate(c)},p=a.slice(0,Math.abs(a.length-1))||[],d=function(){return o(p,function(e,t){return e&&s.hasOwnProperty(t)},!0)&&!s.hasOwnProperty(r)};if(d())a[a.length-1](h,s);else{var v=function(){d()&&(l(v),a[a.length-1](h,s))};f(v)}})},e.waterfall=function(t,n){n=n||function(){};if(t.constructor!==Array){var r=new Error("First argument to waterfall must be an array of functions");return n(r)}if(!t.length)return n();var i=function(t){return function(r){if(r)n.apply(null,arguments),n=function(){};else{var s=Array.prototype.slice.call(arguments,1),o=t.next();o?s.push(i(o)):s.push(n),e.setImmediate(function(){t.apply(null,s)})}}};i(e.iterator(t))()};var g=function(e,t,n){n=n||function(){};if(t.constructor===Array)e.map(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var r={};e.each(u(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(e){n(e,r)})}};e.parallel=function(t,n){g({map:e.map,each:e.each},t,n)},e.parallelLimit=function(e,t,n){g({map:p(t),each:a(t)},e,n)},e.series=function(t,n){n=n||function(){};if(t.constructor===Array)e.mapSeries(t,function(e,t){e&&e(function(e){var n=Array.prototype.slice.call(arguments,1);n.length<=1&&(n=n[0]),t.call(null,e,n)})},n);else{var r={};e.eachSeries(u(t),function(e,n){t[e](function(t){var i=Array.prototype.slice.call(arguments,1);i.length<=1&&(i=i[0]),r[e]=i,n(t)})},function(e){n(e,r)})}},e.iterator=function(e){var t=function(n){var r=function(){return e.length&&e[n].apply(null,arguments),r.next()};return r.next=function(){return n<e.length-1?t(n+1):null},r};return t(0)},e.apply=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var y=function(e,t,n,r){var i=[];e(t,function(e,t){n(e,function(e,n){i=i.concat(n||[]),t(e)})},function(e){r(e,i)})};e.concat=f(y),e.concatSeries=c(y),e.whilst=function(t,n,r){t()?n(function(i){if(i)return r(i);e.whilst(t,n,r)}):r()},e.doWhilst=function(t,n,r){t(function(i){if(i)return r(i);n()?e.doWhilst(t,n,r):r()})},e.until=function(t,n,r){t()?r():n(function(i){if(i)return r(i);e.until(t,n,r)})},e.doUntil=function(t,n,r){t(function(i){if(i)return r(i);n()?r():e.doUntil(t,n,r)})},e.queue=function(t,n){function s(t,r,s,o){r.constructor!==Array&&(r=[r]),i(r,function(r){var i={data:r,callback:typeof o=="function"?o:null};s?t.tasks.unshift(i):t.tasks.push(i),t.saturated&&t.tasks.length===n&&t.saturated(),e.setImmediate(t.process)})}n===undefined&&(n=1);var o=0,u={tasks:[],concurrency:n,saturated:null,empty:null,drain:null,push:function(e,t){s(u,e,!1,t)},unshift:function(e,t){s(u,e,!0,t)},process:function(){if(o<u.concurrency&&u.tasks.length){var e=u.tasks.shift();u.empty&&u.tasks.length===0&&u.empty(),o+=1;var n=function(){o-=1,e.callback&&e.callback.apply(e,arguments),u.drain&&u.tasks.length+o===0&&u.drain(),u.process()},i=r(n);t(e.data,i)}},length:function(){return u.tasks.length},running:function(){return o}};return u},e.cargo=function(t,n){var r=!1,o=[],u={tasks:o,payload:n,saturated:null,empty:null,drain:null,push:function(t,r){t.constructor!==Array&&(t=[t]),i(t,function(e){o.push({data:e,callback:typeof r=="function"?r:null}),u.saturated&&o.length===n&&u.saturated()}),e.setImmediate(u.process)},process:function a(){if(r)return;if(o.length===0){u.drain&&u.drain();return}var e=typeof n=="number"?o.splice(0,n):o.splice(0),f=s(e,function(e){return e.data});u.empty&&u.empty(),r=!0,t(f,function(){r=!1;var t=arguments;i(e,function(e){e.callback&&e.callback.apply(null,t)}),a()})},length:function(){return o.length},running:function(){return r}};return u};var b=function(e){return function(t){var n=Array.prototype.slice.call(arguments,1);t.apply(null,n.concat([function(t){var n=Array.prototype.slice.call(arguments,1);typeof console!="undefined"&&(t?console.error&&console.error(t):console[e]&&i(n,function(t){console[e](t)}))}]))}};e.log=b("log"),e.dir=b("dir"),e.memoize=function(e,t){var n={},r={};t=t||function(e){return e};var i=function(){var i=Array.prototype.slice.call(arguments),s=i.pop(),o=t.apply(null,i);o in n?s.apply(null,n[o]):o in r?r[o].push(s):(r[o]=[s],e.apply(null,i.concat([function(){n[o]=arguments;var e=r[o];delete r[o];for(var t=0,i=e.length;t<i;t++)e[t].apply(null,arguments)}])))};return i.memo=n,i.unmemoized=e,i},e.unmemoize=function(e){return function(){return(e.unmemoized||e).apply(null,arguments)}},e.times=function(t,n,r){var i=[];for(var s=0;s<t;s++)i.push(s);return e.map(i,n,r)},e.timesSeries=function(t,n,r){var i=[];for(var s=0;s<t;s++)i.push(s);return e.mapSeries(i,n,r)},e.compose=function(){var t=Array.prototype.reverse.call(arguments);return function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();e.reduce(t,r,function(e,t,r){t.apply(n,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);r(e,t)}]))},function(e,t){i.apply(n,[e].concat(t))})}};var w=function(e,t){var n=function(){var n=this,r=Array.prototype.slice.call(arguments),i=r.pop();return e(t,function(e,t){e.apply(n,r.concat([t]))},i)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return n.apply(this,r)}return n};e.applyEach=f(w),e.applyEachSeries=c(w),e.forever=function(e,t){function n(r){if(r){if(t)return t(r);throw r}e(n)}n()},typeof define!="undefined"&&define.amd?define("async",[],function(){return e}):typeof module!="undefined"&&module.exports?module.exports=e:t.async=e}(),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.5.2";var T=x.each=x.forEach=function(e,t,r){if(null!=e)if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o=x.keys(e),i=0,s=o.length;s>i;i++)if(t.call(r,e[o[i]],o[i],e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?void 0:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return arguments.length<2||n?e[x.random(e.length-1)]:x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(r>n||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={},s=null==n?x.identity:k(n);return T(t,function(n,o){var u=s.call(r,n,o,t);e(i,u,n)}),i}};x.groupBy=L(function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=null==n?x.identity:k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);r>i;)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:new Date,o=null,s=e.apply(r,i)};return function(){var f=new Date;u||n.leading!==!1||(u=f);var l=t-(f-u);return r=this,i=arguments,0>=l?(clearTimeout(o),o=null,u=f,s=e.apply(r,i)):o||n.trailing===!1||(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u;return function(){s=this,i=arguments,o=new Date;var a=function(){var f=new Date-o;t>f?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i)))},f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i)),u}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){for(var t=x.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=e[t[i]];return r},x.pairs=function(e){for(var t=x.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){for(var t={},n=x.keys(e),r=0,i=n.length;i>r;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u))return!1;n.push(e),r.push(t);var a=0,l=!0;if("[object Array]"==i){if(a=e.length,l=a==t.length)for(;a--&&(l=M(e[a],t[a],n,r)););}else{for(var c in e)if(x.has(e,c)&&(a++,!(l=x.has(t,c)&&M(e[c],t[c],n,r))))break;if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof /./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(Math.max(0,e)),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(null==e)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(){}),function(e){function t(t,n){var r;return e.Notification?r=new e.Notification(t,{icon:y(n.icon)?n.icon:n.icon.x32,body:n.body||d,tag:n.tag||d}):e.webkitNotifications?(r=e.webkitNotifications.createNotification(n.icon,t,n.body),r.show()):navigator.mozNotification?(r=navigator.mozNotification.createNotification(t,n.body,n.icon),r.show()):e.external&&e.external.msIsSiteMode()&&(e.external.msSiteModeClearIconOverlay(),e.external.msSiteModeSetIconOverlay(y(n.icon)?n.icon:n.icon.x16,t),e.external.msSiteModeActivate(),r={ieVerification:m+1}),r}function n(t){return{close:function(){t&&(t.close?t.close():e.external&&e.external.msIsSiteMode()&&t.ieVerification===m&&e.external.msSiteModeClearIconOverlay())}}}function r(t){if(!v)return;var n=g(t)?t:E;e.webkitNotifications&&e.webkitNotifications.checkPermission?e.webkitNotifications.requestPermission(n):e.Notification&&e.Notification.requestPermission&&e.Notification.requestPermission(n)}function i(){var t;if(!v)return;return e.Notification&&e.Notification.permissionLevel?t=e.Notification.permissionLevel():e.webkitNotifications&&e.webkitNotifications.checkPermission?t=c[e.webkitNotifications.checkPermission()]:navigator.mozNotification?t=f:e.Notification&&e.Notification.permission?t=e.Notification.permission:e.external&&e.external.msIsSiteMode()!==undefined&&(t=e.external.msIsSiteMode()?f:a),t}function s(e){return e&&b(e)&&w(S,e),S}function o(){return S.pageVisibility?document.hidden||document.msHidden||document.mozHidden||document.webkitHidden:!0}function u(r,s){var u,a;return v&&o()&&y(r)&&s&&(y(s.icon)||b(s.icon))&&i()===f&&(u=t(r,s)),a=n(u),S.autoClose&&u&&!u.ieVerification&&u.addEventListener&&u.addEventListener("show",function(){var t=a;e.setTimeout(function(){t.close()},S.autoClose)}),a}var a="default",f="granted",l="denied",c=[f,a,l],h={pageVisibility:!1,autoClose:0},p={},d="",v=function(){var t=!1;try{t=!!(e.Notification||e.webkitNotifications||navigator.mozNotification||e.external&&e.external.msIsSiteMode()!==undefined)}catch(n){}return t}(),m=Math.floor(Math.random()*10+1),g=function(e){return e&&e.constructor===Function},y=function(e){return e&&e.constructor===String},b=function(e){return e&&e.constructor===Object},w=function(e,t){var n,r;for(n in t){r=t[n];if(!(n in e)||e[n]!==r&&(!(n in p)||p[n]!==r))e[n]=r}return e},E=function(){},S=h;e.notify={PERMISSION_DEFAULT:a,PERMISSION_GRANTED:f,PERMISSION_DENIED:l,isSupported:v,config:s,createNotification:u,permissionLevel:i,requestPermission:r},g(Object.freeze)&&Object.freeze(e.notify)}(window),define("notify",function(){}),function(e){typeof define=="function"&&define.amd?define("cookie",["jquery"],e):e(jQuery)}(function(e){function n(e){return e}function r(e){return decodeURIComponent(e.replace(t," "))}function i(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return s.json?JSON.parse(e):e}catch(t){}}var t=/\+/g,s=e.cookie=function(t,o,u){if(o!==undefined){u=e.extend({},s.defaults,u);if(typeof u.expires=="number"){var a=u.expires,f=u.expires=new Date;f.setDate(f.getDate()+a)}return o=s.json?JSON.stringify(o):String(o),document.cookie=[s.raw?t:encodeURIComponent(t),"=",s.raw?o:encodeURIComponent(o),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join("")}var l=s.raw?n:r,c=document.cookie.split("; "),h=t?undefined:{};for(var p=0,d=c.length;p<d;p++){var v=c[p].split("="),m=l(v.shift()),g=l(v.join("="));if(t&&t===m){h=i(g);break}t||(h[m]=i(g))}return h};s.defaults={},e.removeCookie=function(t,n){return e.cookie(t)!==undefined?(e.cookie(t,"",e.extend({},n,{expires:-1})),!0):!1}}),function(e){var t,n,r,i;return i="quickfit",r={min:18,max:20,tolerance:.02,truncate:!0,width:240,sample_number_of_letters:10,sample_font_size:12},n=function(){function n(t){this.options=t,this.item=e('<span id="meassure"></span>'),this.item.css({position:"absolute",left:"-1000px",top:"-1000px","font-size":""+this.options.sample_font_size+"px"}),e("body").append(this.item),this.meassures={}}var t;return t=null,n.instance=function(e){return t||(t=new n(e)),t},n.prototype.get_meassure=function(e){var t;return t=this.meassures[e],t===void 0&&(t=this.set_meassure(e)),t},n.prototype.set_meassure=function(e){var t,n,r,i,s;i="",r=e===" "?"&nbsp;":e;for(n=0,s=this.options.sample_number_of_letters-1;0<=s?n<=s:n>=s;0<=s?n++:n--)i+=r;return this.item.html(i),t=this.item.width()/this.options.sample_number_of_letters/this.options.sample_font_size,this.meassures[e]=t,t},n}(),t=function(){function t(t,s){this.element=t,this.options=e.extend({},r,s),this.element=e(this.element),this._defaults=r,this._name=i,this.quickfit_helper=n.instance(this.options)}return t.prototype.fit=function(){var e;return this.options.width||(e=this.element.width(),this.options.width=e-this.options.tolerance*e),(this.text=this.element.attr("data-quickfit"))?this.previously_truncated=!0:this.text=this.element.html(),this.calculate_font_size(),this.options.truncate&&this.truncate(),this.element.css("font-size",""+this.font_size+"px")},t.prototype.calculate_font_size=function(){var e,t,n,r,i;t=0,i=this.text;for(n=0,r=i.length;n<r;n++)e=i[n],t+=this.quickfit_helper.get_meassure(e);return this.target_font_size=parseInt(this.options.width/t),this.font_size=Math.max(this.options.min,Math.min(this.options.max,this.target_font_size))},t.prototype.truncate=function(){var e,t,n,r,i;if(this.font_size>this.target_font_size){r="",i=3*this.quickfit_helper.get_meassure(".")*this.font_size,e=0;while(i<this.options.width&&e<this.text.length)n=this.text[e++],t&&(r+=t),i+=this.font_size*this.quickfit_helper.get_meassure(n),t=n;return r.length+1===this.text.length?r=this.text:r+="...",this.text_was_truncated=!0,this.element.attr("data-quickfit",this.text).html(r)}if(this.previously_truncated)return this.element.html(this.text)},t}(),e.fn.quickfit=function(e){return this.each(function(){return(new t(this,e)).fit()})}}(jQuery,window),define("quickfit",function(){}),define("desktop",["text!../views/albums.ejs","text!../views/movies.ejs","text!../views/others.ejs","packery/packery","imagesloaded","async","jquery","underscore","notify","cookie","quickfit"],function(e,t,n,r,i,s,o){o.expr[":"].contains=o.expr.createPseudo(function(e){return function(t){return o(t).text().toLowerCase().indexOf(e.toLowerCase())>=0}}),o.expr[":"].startsWith=o.expr.createPseudo(function(e){return function(t){return o(t).text().replace(/\s+/g,"").charAt(0).toUpperCase()==e.toUpperCase()}}),o.expr[":"].match=o.expr.createPseudo(function(e){return function(t){var n=o(t).text().replace(/\s+/g,"").charAt(0);return n.match(new RegExp(e,"ig"))}});var u={firstLoad:!0,$container:o("section#desktop"),itemSelector:".element",displaySelector:null,pckry:null,hasLayout:!1,toRemove:null,socket:null,hasLayout:function(){},alphabet:{A:0,B:0,C:0,D:0,E:0,F:0,G:0,H:0,I:0,J:0,K:0,L:0,M:0,N:0,O:0,P:0,Q:0,R:0,S:0,T:0,U:0,V:0,W:0,X:0,Y:0,Z:0,"#":0},loader:function(){var e=o("#loader");e.is(":visible")?e.fadeOut():e.fadeIn()},showNotification:function(e){},init:function(){var e=this;return e.pckry===null&&isDesktop==1&&(e.pckry=new r(document.querySelector("section#desktop"),{itemSelector:".element",transitionDuration:"0"})),e.socket===null&&(e.socket=io.connect("wss://"+document.domain+":3001")),user&&isDesktop&&jQuery.getJSON("http://localhost:3001/api/526926db6d8dc0727718fd2f",function(t,n){t?(u.append(t.paths),e.socket.emit("update",user.id)):console.error(n,t)}),e.toRemove=window.location.hash.substr(1),e},template:function(e,t){var n=function(t){var n=["Bytes","KB","MB","GB","TB"];if(t==0)return"n/a";var r=parseInt(Math.floor(Math.log(t)/Math.log(1024)));return r==0?t+" "+n[r]:(t/Math.pow(1024,r)).toFixed(1)+" "+n[r]};return _.template(e,_.extend(t,{bytesToSize:n}))},render:{files:function(e,t){var n=this;s.map(e,n.path,function(e,n){var r=n.length-1,i="";do n[r]&&(i+=n[r].movies+n[r].albums+n[r].others);while(r--);i.length==0&&(e="Aucun fichiers, le chemin est-il surveillé ?"),t(e,i)})},path:function(r,i){var o=u.render;s.parallel({movies:function(e){r.movies.length?e(null,u.template(t,{movies:r.movies})):e(null,"")},albums:function(t){r.albums.length?t(null,u.template(e,{albums:r.albums})):t(null,"")},others:function(e){r.others.length?e(null,u.template(n,{others:r.others})):e(null,"")}},function(e,t){i(e,t)})}},remove:function(e,t){var n=this,r=o(n.itemSelector+'[data-id="'+e+'"]'),t=t===undefined?!0:t,i=r.find("h1:first").text();t&&n.showNotification({title:"Fichier supprimé",tag:e,text:i+" a été supprimé"}),n.pckry.remove(r),n.layout()},append:function(e){var t=this,n=o.cookie("display")===undefined?".list":o.cookie("display");o("#displayFilters li").each(function(e,t){o(t).attr("data-display",n)}),t.render.files(e,function(e,r){e&&console.log(e);var i=o.parseHTML(r),s=[];_.each(i,function(e){var t=e instanceof Text;t||s.push(e)}),i=s,delete s,i.sort(function(e,t){return e=o(e),t=o(t),e.data("date-added")==t.data("date-added")?0:e.data("date-added")<t.data("date-added")?1:-1}),t.firstLoad?(t.$container.addClass("notransition").css("visibility","hidden").append(i),t.pckry.appended(i)):(t.$container.addClass("notransition").css("visibility","hidden").prepend(i),t.pckry.prepended(i)),t.displaySelector=n,t.layout(n,function(){if(t.firstLoad)t.firstLoad=!1,t.toRemove&&(t.remove(t.toRemove),t.toRemove=null,location.hash="#"),t.loader();else{var e=0,n=[];_.each(i,function(e){o(e).hasClass("list")&&n.push(o(e))}),e=n.length;if(e==1){var r=n[0].find("h1").text();t.showNotification({title:"Fichier ajouté",text:r+" ajouté !"})}else e!=0&&t.showNotification({title:"Fichiers ajoutés",text:e+" fichiers ajoutés"})}t.$container.removeClass("notransition").css("visibility","visible")})})},countElementsByLetter:function(){var e=this,t=e.$container.find(e.itemSelector+".list");t.each(function(t,n){var r=o(this).find("h1").text().charAt(0).toUpperCase();r.match(/\d/g)&&(r="#"),e.alphabet[r]++})},layout:function(e,t){var n=this;e=e?e:n.displaySelector,n.displaySelector=e,o(n.itemSelector+".miniature").css("visibility","hidden");var r=document.querySelector("#"+n.$container.attr("id")+" .miniature");r!==null&&r.length&&i(r,function(){n.pckry.layout(),o(n.itemSelector+".miniature h1").quickfit(),o(n.itemSelector+".miniature").css("visibility","visible")}),n.firstLoad||n.loader(),o(n.itemSelector).css("display","none"),o(n.itemSelector+e).each(function(){o(this).css("display","block")}),n.pckry.layout(),n.firstLoad||n.loader(),n.countElementsByLetter(),n.hasLayout(),typeof t=="function"&&t()}};return u.init()}),!function(e,t){var n,r=e.document;n=function(){var n,i,s,o,u,f,l,c,h,p,v,m,g,y={},w={},E=!1,S={ENTER:13,ESC:27,SPACE:32},x=[];return w={buttons:{holder:'<nav class="alertify-buttons">{{buttons}}</nav>',submit:'<button type="submit" class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',ok:'<button class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>',cancel:'<button class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}</button>'},input:'<div class="alertify-text-wrapper"><input type="text" class="alertify-text" id="alertify-text"></div>',message:'<p class="alertify-message">{{message}}</p>',log:'<article class="alertify-log{{class}}">{{message}}</article>'},g=function(){var e,n,i=!1,s=r.createElement("fakeelement"),o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"};for(e in o)if(s.style[e]!==t){n=o[e],i=!0;break}return{type:n,supported:i}},n=function(e){return r.getElementById(e)},y={labels:{ok:"OK",cancel:"Cancel"},delay:5e3,buttonReverse:!1,buttonFocus:"ok",transition:t,addListeners:function(e){var t,n,a,f,l,c="undefined"!=typeof s,h="undefined"!=typeof i,p="undefined"!=typeof m,v="",g=this;t=function(t){return"undefined"!=typeof t.preventDefault&&t.preventDefault(),a(t),"undefined"!=typeof m&&(v=m.value),"function"==typeof e&&("undefined"!=typeof m?e(!0,v):e(!0)),!1},n=function(t){return"undefined"!=typeof t.preventDefault&&t.preventDefault(),a(t),"function"==typeof e&&e(!1),!1},a=function(){g.hide(),g.unbind(r.body,"keyup",f),g.unbind(o,"focus",l),c&&g.unbind(s,"click",t),h&&g.unbind(i,"click",n)},f=function(e){var r=e.keyCode;(r===S.SPACE&&!p||p&&r===S.ENTER)&&t(e),r===S.ESC&&h&&n(e)},l=function(){p?m.focus():!h||g.buttonReverse?s.focus():i.focus()},this.bind(o,"focus",l),this.bind(u,"focus",l),c&&this.bind(s,"click",t),h&&this.bind(i,"click",n),this.bind(r.body,"keyup",f),this.transition.supported||this.setFocus()},bind:function(e,t,n){"function"==typeof e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)},handleErrors:function(){if("undefined"!=typeof e.onerror){var t=this;return e.onerror=function(e,n,r){t.error("["+e+" on line "+r+" of "+n+"]",0)},!0}return!1},appendButtons:function(e,t){return this.buttonReverse?t+e:e+t},build:function(e){var t="",n=e.type,r=e.message,i=e.cssClass||"";switch(t+='<div class="alertify-dialog">',t+='<a id="alertify-resetFocusBack" class="alertify-resetFocus" href="#">Reset Focus</a>',"none"===y.buttonFocus&&(t+='<a href="#" id="alertify-noneFocus" class="alertify-hidden"></a>'),"prompt"===n&&(t+='<div id="alertify-form">'),t+='<article class="alertify-inner">',t+=w.message.replace("{{message}}",r),"prompt"===n&&(t+=w.input),t+=w.buttons.holder,t+="</article>","prompt"===n&&(t+="</div>"),t+='<a id="alertify-resetFocus" class="alertify-resetFocus" href="#">Reset Focus</a>',t+="</div>",n){case"confirm":t=t.replace("{{buttons}}",this.appendButtons(w.buttons.cancel,w.buttons.ok)),t=t.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case"prompt":t=t.replace("{{buttons}}",this.appendButtons(w.buttons.cancel,w.buttons.submit)),t=t.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case"alert":t=t.replace("{{buttons}}",w.buttons.ok),t=t.replace("{{ok}}",this.labels.ok)}return h.className="alertify alertify-"+n+" "+i,c.className="alertify-cover",t},close:function(e,t){var n,r,i=t&&!isNaN(t)?+t:this.delay,s=this;this.bind(e,"click",function(){n(e)}),r=function(e){e.stopPropagation(),s.unbind(this,s.transition.type,r),p.removeChild(this),p.hasChildNodes()||(p.className+=" alertify-logs-hidden")},n=function(e){"undefined"!=typeof e&&e.parentNode===p&&(s.transition.supported?(s.bind(e,s.transition.type,r),e.className+=" alertify-log-hide"):(p.removeChild(e),p.hasChildNodes()||(p.className+=" alertify-logs-hidden")))},0!==t&&setTimeout(function(){n(e)},i)},dialog:function(e,t,n,i,s){l=r.activeElement;var o=function(){p&&null!==p.scrollTop&&c&&null!==c.scrollTop||o()};if("string"!=typeof e)throw new Error("message must be a string");if("string"!=typeof t)throw new Error("type must be a string");if("undefined"!=typeof n&&"function"!=typeof n)throw new Error("fn must be a function");return this.init(),o(),x.push({type:t,message:e,callback:n,placeholder:i,cssClass:s}),E||this.setup(),this},extend:function(e){if("string"!=typeof e)throw new Error("extend method must have exactly one paramter");return function(t,n){return this.log(t,e,n),this}},hide:function(){var e,t=this;x.splice(0,1),x.length>0?this.setup(!0):(E=!1,e=function(n){n.stopPropagation(),t.unbind(h,t.transition.type,e)},this.transition.supported?(this.bind(h,this.transition.type,e),h.className="alertify alertify-hide alertify-hidden"):h.className="alertify alertify-hide alertify-hidden alertify-isHidden",c.className="alertify-cover alertify-cover-hidden",l.focus())},init:function(){r.createElement("nav"),r.createElement("article"),r.createElement("section"),null==n("alertify-cover")&&(c=r.createElement("div"),c.setAttribute("id","alertify-cover"),c.className="alertify-cover alertify-cover-hidden",r.body.appendChild(c)),null==n("alertify")&&(E=!1,x=[],h=r.createElement("section"),h.setAttribute("id","alertify"),h.className="alertify alertify-hidden",r.body.appendChild(h)),null==n("alertify-logs")&&(p=r.createElement("section"),p.setAttribute("id","alertify-logs"),p.className="alertify-logs alertify-logs-hidden",r.body.appendChild(p)),r.body.setAttribute("tabindex","0"),this.transition=g()},log:function(e,t,n){var r=function(){p&&null!==p.scrollTop||r()};return this.init(),r(),p.className="alertify-logs",this.notify(e,t,n),this},notify:function(e,t,n){var i=r.createElement("article");i.className="alertify-log"+("string"==typeof t&&""!==t?" alertify-log-"+t:""),i.innerHTML=e,p.appendChild(i),setTimeout(function(){i.className=i.className+" alertify-log-show"},50),this.close(i,n)},set:function(e){var t;if("object"!=typeof e&&e instanceof Array)throw new Error("args must be an object");for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t])},setFocus:function(){m?(m.focus(),m.select()):f.focus()},setup:function(e){var r,a=x[0],l=this;E=!0,r=function(e){e.stopPropagation(),l.setFocus(),l.unbind(h,l.transition.type,r)},this.transition.supported&&!e&&this.bind(h,this.transition.type,r),h.innerHTML=this.build(a),o=n("alertify-resetFocus"),u=n("alertify-resetFocusBack"),s=n("alertify-ok")||t,i=n("alertify-cancel")||t,f="cancel"===y.buttonFocus?i:"none"===y.buttonFocus?n("alertify-noneFocus"):s,m=n("alertify-text")||t,v=n("alertify-form")||t,"string"==typeof a.placeholder&&""!==a.placeholder&&(m.value=a.placeholder),e&&this.setFocus(),this.addListeners(a.callback)},unbind:function(e,t,n){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}},{alert:function(e,t,n){return y.dialog(e,"alert",t,"",n),this},confirm:function(e,t,n){return y.dialog(e,"confirm",t,"",n),this},extend:y.extend,init:y.init,log:function(e,t,n){return y.log(e,t,n),this},prompt:function(e,t,n,r){return y.dialog(e,"prompt",t,n,r),this},success:function(e,t){return y.log(e,"success",t),this},error:function(e,t){return y.log(e,"error",t),this},set:function(e){y.set(e)},labels:y.labels,debug:y.handleErrors}},"function"==typeof define?define("alertify",[],function(){return new n}):"undefined"==typeof e.alertify&&(e.alertify=new n)}(this),define("theme",["jquery","desktop","alertify","underscore"],function(e,t,n){$section=t.$container,e(".select-on-click").on("click",function(t){e(this).select()}),e("#alert .entypo-cross").on("click",function(t){e(this).parent().empty()}),e(window).load(function(){var t=notify.permissionLevel();switch(t){case notify.PERMISSION_DEFAULT:e("#alert").append('<p class="warning"><i class="entypo-warning"></i> <a href="#" class="allow-notify">Cliquez ici pour activer les notifications de bureau.</a></p>');break;case notify.PERMISSION_DENIED:}var r=e("#alert").find(".msg");r.length&&(r.hasClass("error")?n.error(r.text()):r.hasClass("success")?n.success(r.text()):n.log(r.text()))}).on("scroll",function(){var t=e("body").scrollTop()||e("html").scrollTop();t>e("header").height()+7?i():i(!1)}),e("body").on("click",".delete-item",function(r){r.preventDefault();var i=e(this).attr("href");n.confirm("Attention cette fonction ne supprime pas le torrent, il est conseillé de supprimer torrent et données depuis votre client ! Êtes-vous sûr de vouloir effectuer cette action ?",function(n){if(!n)return!1;e.get(i,function(e){t.remove(e.id,!1)},"json")})}),e("body").on("click",".reset-db",function(t){t.preventDefault();var r=e(this).attr("href");n.confirm("Cette fonction réindexe la base de données des fichiers ! L'opération peut-être longue ! Êtes-vous sûr de vouloir effectuer cette action ?",function(e){if(!e)return!1;window.location=r})}),e("body").on("click",".allow-notify",function(){notify.requestPermission(function(){e("#alert").empty()})}),e("body").on("click",".reset-item",function(n){var r=e(this).closest(".element"),i=r.attr("data-id"),s=e(this).attr("data-type");e.get("/reset/"+s+"/"+i,function(){t.remove(i,!1)},"json")});var r=function(t){var t=t===undefined?!1:t,n=e("body").scrollTop()||e("html").scrollTop();n>e("header").height()+7&&(t!==!0?e("body, html").animate({scrollTop:e("header").height()+10}):e("body, html").animate({scrollTop:0}))},i=function(t){var t=t===undefined?!0:t;t?e("nav#display").hasClass("fixed")||(e("nav#display").addClass("fixed").css("opacity","0.7"),$section.css("marginTop","80px"),e("#toTop").stop().animate({opacity:"0.8"})):(e("nav#display").removeClass("fixed").css("opacity","1"),$section.css("marginTop","20px"),e("#toTop").stop().animate({opacity:"0"}))};e("#toTop").on("click",function(e){r(!0)}),e("body").on("click",".showFiles",function(){$button=e(this),$button.data("text")===undefined&&$button.data("text",$button.text()),$files=e(this).next(".files"),$element=e(this).parent();var n=$files.height()+20;$files.hasClass("open")?($button.html('<i class="entypo-attach"></i>'+$button.data("text")),$element.toggleClass("notransition").css({"margin-bottom":"20px"}),$files.css({visibility:"hidden",opacity:"0"}),t.layout(null,function(){$element.toggleClass("notransition")})):($button.html('<i class="entypo-attach"></i>Cacher'),$element.toggleClass("notransition").css({"margin-bottom":"+"+n+"px"}),t.layout(null,function(){$files.css({top:$element.height()+20+"px",visibility:"visible",opacity:1}),$element.toggleClass("notransition")})),$files.toggleClass("open")}),e("body").on({mouseenter:function(){e(this).css("opacity","1")},mouseleave:function(){e(this).css("opacity","0.7")}},"nav#display.fixed"),e("#search input").on("keyup",function(n){r();var i="",s=e("#displayFilters li:first-child").attr("data-display");e("#displayFilters li.active").length&&(i=e("#displayFilters li.active").attr("data-filter"));if(e(this).val().length>2){var o=$section.find(t.itemSelector+':contains("'+e(this).val()+'")');o.each(function(n,r){if(!e(r).hasClass("highlight")){var i=e(r).attr("data-id");$section.find(t.itemSelector+'[data-id="'+i+'"]').addClass("highlight")}}),t.layout(s+i+".highlight")}else $section.find(".highlight").toggleClass("highlight"),t.layout(s+i)}),e("body").on("click","#displayFilters li",function(){r();if(!e(this).hasClass("active")){var n=e(this).attr("data-filter"),i=e(this).attr("data-display");e("#displayFilters li.active").removeClass("active"),e(this).addClass("active"),t.layout(i+n)}else e(this).removeClass("active"),t.layout(e(this).attr("data-display"));return!1}),e("body").on("click","#displayOptions i",function(){var n=e(this).attr("data-filter"),i="";return e(this).hasClass("active")||(e(this).parent().find(".active").removeClass("active"),e(this).addClass("active"),e.cookie("display",n),r(),e("#displayFilters li.active").length&&(i=e("#displayFilters li.active").attr("data-filter")),t.layout(n+i),e("#displayFilters li").each(function(){e(this).attr("data-display",n)})),!1}),t=_.extend(t,{hasLayout:function(){var n=150,r=100,i=0,s=0;_.each(t.alphabet,function(e){s=e>s?e:s,i=i>e?e:i});var o=(n-r)/(s-i);e("#alpha-nav li a").each(function(n,u){var a=e(this).attr("href").substr(1),f=t.alphabet[a];if(parseInt(f)!==NaN){var l=r+(s-(s-(f-i)))*o+"%";e(this).css("font-size",l)}})}}),e("#alpha-nav li a").on("click",function(n){n.preventDefault(),r();var i=e(this),s=e(this).parent().hasClass("active")?"":i.attr("href").substr(1);$section.find(".startsWith").toggleClass("startsWith"),e(this).closest("ul").find("li.active").removeClass("active");var o="",u=e("#displayFilters li:first-child").attr("data-display");e("#displayFilters li.active").length&&(o=e("#displayFilters li.active").attr("data-filter"));if(s.length||s==="#"){var a;s=="#"?a=$section.find(t.itemSelector+':match("\\d+")'):a=$section.find(t.itemSelector+':startsWith("'+s+'")'),a.each(function(n,r){if(!e(r).hasClass("startsWith")){var i=e(r).attr("data-id");$section.find(t.itemSelector+'[data-id="'+i+'"]').addClass("startsWith")}}),t.layout(u+o+".startsWith",function(){i.parent().addClass("active")})}else t.layout(u+o)});var s=t.socket;s.on("size",function(t){e("#diskSpace #usedBar").css("width",t.percent),e("#diskSpace .used").text(t.pretty),e("#diskSpace .left").text(" / "+t.left)});var o;s.on("compressing",function(t){var n=e(".element.list[data-id="+t.id+"]"),r=e("#archiving"),i=n.find("a.archive").attr("data-full-size"),s=parseInt(t.done)/parseInt(i)*100;s=Math.round(s*100)/100,s=s<100?s:100,s==100&&o==undefined&&(o=setTimeout(r.find(".progress").text("En attente..."),750)),r.find(".percent").text(s+"%"),r.find(".progress").css("width",s+"%")}),$section.on("click",".archive",function(t){t.preventDefault();var n=e(this).closest(".element"),r=n.attr("data-id"),i=n.find("h1").text(),o=e("#archiving");s.emit("archive",r),o.find(".name").text(i),o.show(),e(window).bind("beforeunload",function(){return"Une compression est en cours"}),e.get(e(this).attr("href"),function(t){t.error==null?(e(window).unbind("beforeunload"),window.location.href="/download/archive/"+r,o.find(".percent").text("Téléchargement en cours..."),o.find(".progress").css("width","100%"),setTimeout(function(){o.fadeOut("800"),o.find(".percent").delay("800").text("0%")},3e3)):(o.find(".percent").text(t.error),o.find(".progress").css("width","100%"),console.log(t.error))},"json")})}),function(e){function t(t,r){r=r||{};var i=this,s=r.query||"> :even";e.extend(i,{$el:t,options:r,sections:[],isAccordion:r.accordion||!1,db:r.persist?jQueryCollapseStorage(t[0].id):!1}),i.states=i.db?i.db.read():[],i.$el.find(s).each(function(){var t=new n(e(this),i);i.sections.push(t);var r=i.states[t._index()];r===0&&t.$summary.removeClass("open"),r===1&&t.$summary.addClass("open"),t.$summary.hasClass("open")?t.open(!0):t.close(!0)}),function(t){i.$el.on("click","[data-collapse-summary]",e.proxy(i.handleClick,t))}(i)}function n(t,n){e.extend(this,{isOpen:!1,$summary:t.attr("data-collapse-summary","").wrapInner('<a href="#"/>'),$details:t.next(),options:n.options,parent:n})}t.prototype={handleClick:function(t){t.preventDefault();var n=this.sections,r=n.length;while(r--)if(e.contains(n[r].$summary[0],t.target)){n[r].toggle();break}},open:function(t){if(isFinite(t))return this.sections[t].open();e.each(this.sections,function(){this.open()})},close:function(t){if(isFinite(t))return this.sections[t].close();e.each(this.sections,function(){this.close()})}},n.prototype={toggle:function(){this.isOpen?this.close():this.open()},close:function(e){this._changeState("close",e)},open:function(t){var n=this;n.options.accordion&&!t&&e.each(n.parent.sections,function(){this.close()}),n._changeState("open",t)},_index:function(){return e.inArray(this,this.parent.sections)},_changeState:function(t,n){var r=this;r.isOpen=t=="open",e.isFunction(r.options[t])&&!n?r.options[t].apply(r.$details):r.isOpen?r.$details.show():r.$details.hide(),r.$summary.removeClass("open close").addClass(t),r.$details.attr("aria-hidden",t=="close"),r.parent.$el.trigger(t,r),r.parent.db&&r.parent.db.write(r._index(),r.isOpen)}},e.fn.extend({collapse:function(n,r){var i=r?e("body").find("[data-collapse]"):e(this);return i.each(function(){var i=r?{}:n,s=e(this).attr("data-collapse")||"";e.each(s.split(" "),function(e,t){t&&(i[t]=!0)}),new t(e(this),i)})}}),e(function(){e.fn.collapse(!1,!0)}),jQueryCollapse=t}(window.jQuery),define("collapse",function(){}),function(e){function n(t){var n;try{n=window.localStorage||e.fn.collapse.cookieStorage}catch(i){n=!1}return n?new r(t,n):!1}function r(e,t){this.id=e,this.db=t,this.data=[]}var t="jQuery-Collapse";r.prototype={write:function(n,r){var i=this;i.data[n]=r?1:0,e.each(i.data,function(e){typeof i.data[e]=="undefined"&&(i.data[e]=0)});var s=this.getDataObject();s[this.id]=this.data,this.db.setItem(t,JSON.stringify(s))},read:function(){var e=this.getDataObject();return e[this.id]||[]},getDataObject:function(){var e=this.db.getItem(t);return e?JSON.parse(e):{}}},jQueryCollapseStorage=n}(jQuery),define("collapse_storage",function(){}),function(e){e.fn.extend({customSelect:function(t){if(typeof document.body.style.maxHeight=="undefined")return this;var n={customClass:"customSelect",mapClass:!0,mapStyle:!0,loaded:function(){console.log("loaded")}},t=e.extend(n,t),r=t.customClass,i=function(t,n){var r=t.find(":selected"),i=n.children(":first"),o=r.html()||"&nbsp;";i.html(o),r.attr("disabled")?n.addClass(s("DisabledOption")):n.removeClass(s("DisabledOption")),setTimeout(function(){n.removeClass(s("Open")),e(document).off("mouseup."+s("Open"))},60)},s=function(e){return r+e};return this.each(function(){var n=e(this),o=e("<span />").addClass(s("Inner")),u=e("<span />");n.after(u.append(o)),u.addClass(r),t.mapClass&&u.addClass(n.attr("class")),t.mapStyle&&u.attr("style",n.attr("style")),n.addClass("hasCustomSelect").on("update",function(){i(n,u);var e=parseInt(n.outerWidth(),10)-(parseInt(u.outerWidth(),10)-parseInt(u.width(),10));u.css({display:"inline-block"});var r=u.outerHeight();n.attr("disabled")?u.addClass(s("Disabled")):u.removeClass(s("Disabled")),o.css({width:e,display:"inline-block"}),n.css({"-webkit-appearance":"menulist-button",width:u.outerWidth(),position:"absolute",opacity:0,height:r,fontSize:u.css("font-size")}),t.loaded()}).on("change",function(){u.addClass(s("Changed")),i(n,u)}).on("keyup",function(e){u.hasClass(s("Open"))?(e.which==13||e.which==27)&&i(n,u):(n.blur(),n.focus())}).on("mousedown",function(e){u.removeClass(s("Changed"))}).on("mouseup",function(t){u.hasClass(s("Open"))||(e("."+s("Open")).not(u).length>0&&typeof InstallTrigger!="undefined"?n.focus():(u.addClass(s("Open")),t.stopPropagation(),e(document).one("mouseup."+s("Open"),function(t){t.target!=n.get(0)&&e.inArray(t.target,n.find("*").get())<0?n.blur():i(n,u)})))}).focus(function(){u.removeClass(s("Changed")).addClass(s("Focus"))}).blur(function(){u.removeClass(s("Focus")+" "+s("Open"))}).hover(function(){u.addClass(s("Hover"))},function(){u.removeClass(s("Hover"))}).trigger("update")})}})}(jQuery),define("customselect",function(){}),define("admin",["jquery","alertify","collapse","collapse_storage","customselect"],function(e,t){var n=function(){e("#admin.collapse").collapse({open:function(){this.slideDown(100)},close:function(){this.slideUp(100)},accordion:!0,persist:!0})},r;e("select").customSelect({loaded:function(){r!==undefined&&clearTimeout(r),r=setTimeout(function(){n()},10)}}),e('#change-theme input[type="submit"]').on("click",function(n){n.preventDefault(),t.confirm("Pas encore tout à fais au point, si vous avez une erreur 502 ou que ça charge dans le vide c'est normal, actualisez :)",function(t){return t?e("#change-theme").submit():!1})}),e('a[href="#more"]').click(function(){e(this).closest("li").find(".user-more").slideToggle()})}),define("text!../../plugins/chat/public/views/message.ejs",[],function(){return"<%\nvar l = messages.length;\n\nfor(var i = 0; i < l - 1; i++) {\n	var m = messages[i], prev = i >= 1 ? messages[i-1] : null;\n\n	if(prev !== null && m.user == prev.user) {\n\n		print(m.message);\n\n	} else {\n%>\n	<%= prev === null ? '<li>' : '</li><li>' %>\n		<span class=\"pseudo\" data-user=\"<%= m.user %>\"><%= m.user %></span><%= m.message %>\n<%\n	}\n%>\n\n\n<%= i == l - 2 ? '</li>': '' %>\n\n\n<% \n\n} //end loop\n\n%>"}),define("chat-chat",["jquery","desktop","text!../../plugins/chat/public/views/message.ejs"],function(e,t,n){if(user){var r=t.socket,i=e("#chat .messages");e("#chat").on("keydown","#textarea",function(t){t.keyCode==13&&!t.shiftKey&&(t.preventDefault(),r.emit("chat:message",user.username,e(this).text()),e(this).empty())}),e(document).ready(function(){e.cookie("chatclosed")||(e("#chat").css({height:"350px"}).toggleClass("closed"),e('#chat i[class*="entypo"]').toggleClass("entypo-minus-squared").toggleClass("entypo-plus-squared"))}),e("#chat .top").on("click",function(){var t=e("#chat");t.hasClass("closed")?(t.animate({height:"350px"}).toggleClass("closed"),e.cookie("chatclosed",!1)):(t.animate({height:"20px"}).toggleClass("closed"),e.cookie("chatclosed",!0)),e(this).find('i[class*="entypo"]').toggleClass("entypo-minus-squared").toggleClass("entypo-plus-squared")}),r.on("connect",function(){r.emit("chat:join",user.username)}),r.on("chat:init",function(e){i.prepend(_.template(n,{messages:e})),i.scrollTop(i[0].scrollHeight)}),r.on("chat:message",function(e){var t=i.find("li:last .pseudo").attr("data-user"),n=i.find("li:last");t==e.user?n.append(e.message):i.append('<li><span class="pseudo" data-user="'+e.user+'">'+e.user+"</span>"+e.message+"</li>"),i.scrollTop(i[0].scrollHeight)}),r.on("chat:joined",function(t){var n=t.length,t=t.join(", ");n<4?e("#chat .users").text(t):e("#chat .users").html('<span title="'+t+'">'+n+" utilisateurs")})}}),define("checkforupdates-checkforupdates",["jquery","desktop","alertify"],function(e,t,n){if(user){var r=t.socket;r.emit("ckecker:launch",user),r.on("checker:available",function(e){alertify.error("Ezseed à besoin d'un coup de neuf ! La version "+e+" est sortie !",0)})}}),function(){function e(e,t,n,r,i){this.fromSampleRate=e,this.toSampleRate=t,this.channels=n|0,this.outputBufferSize=r,this.noReturn=!!i,this.initialize()}function t(e){this.stream=e,this.sync=!1,this.freerate=0,this.this_frame=e.stream.offset,this.next_frame=e.stream.offset,this.main_data=new Uint8Array(z),this.md_len=0;for(var t in e)typeof e[t]=="function"&&(this[t]=e[t].bind(e))}function n(){this.layer=0,this.mode=0,this.mode_extension=0,this.emphasis=0,this.bitrate=0,this.samplerate=0,this.crc_check=0,this.crc_target=0,this.flags=0,this.private_bits=0}function r(){this.header=null,this.options=0,this.sbsample=i([2,36,32]),this.overlap=i([2,32,18]),this.decoders=[]}function i(e,t){t||(t=Float64Array);if(e.length===1)return new t(e[0]);var n=[],r=e[0];for(var s=0;s<r;s++)n[s]=i(e.slice(1),t);return n}function s(){this.filter=i([2,2,2,16,8]),this.phase=0,this.pcm={samplerate:0,channels:0,length:0,samples:[new Float64Array(1152),new Float64Array(1152)]}}function o(){this.allocation=i([2,32],Uint8Array),this.scalefactor=i([2,32],Uint8Array)}function u(){this.samples=new Float64Array(3),this.allocation=i([2,32],Uint8Array),this.scfsi=i([2,32],Uint8Array),this.scalefactor=i([2,32,3],Uint8Array)}function a(e,t,n){this.table=e,this.linbits=t,this.startbits=n}function l(){this.main_data_begin=null,this.private_bits=null,this.gr=[new c,new c],this.scfsi=new Uint8Array(2)}function c(){this.ch=[new h,new h]}function h(){this.part2_3_length=null,this.big_values=null,this.global_gain=null,this.scalefac_compress=null,this.flags=null,this.block_type=null,this.table_select=new Uint8Array(3),this.subblock_gain=new Uint8Array(3),this.region0_count=null,this.region1_count=null,this.scalefac=new Uint8Array(39)}function p(){this.imdct=new Un,this.si=new l,this.xr=[new Float64Array(576),new Float64Array(576)],this._exponents=new Int32Array(39),this.reqcache=new Float64Array(16),this.modes=new Int16Array(39),this.output=new Float64Array(36),this.tmp=i([32,3,6]),this.tmp2=new Float64Array(576)}var d;d=this;var v;v={};var m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},y=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};v.Base=function(){function e(){}var t;return t=/\b_super\b/,e.extend=function(e){var n,r,i,s,o,u,a;n=function(e){function t(){return o=t.__super__.constructor.apply(this,arguments),o}return g(t,e),t}(this);if(typeof e=="function"){s=Object.keys(n.prototype),e.call(n,n),e={},u=n.prototype;for(i in u)r=u[i],y.call(s,i)<0&&(e[i]=r)}a=n.__super__;for(i in e)r=e[i],typeof r=="function"&&t.test(r)?function(e,t){return n.prototype[e]=function(){var n,r;return r=this._super,this._super=a[e],n=t.apply(this,arguments),this._super=r,n}}(i,r):n.prototype[i]=r;return n},e}(),v.Buffer=function(){function e(e){var t;if(e instanceof Uint8Array)this.data=e;else if(e instanceof ArrayBuffer||Array.isArray(e)||typeof e=="number"||v.isNode&&((t=d.Buffer)!=null?t.isBuffer(e):void 0))this.data=new Uint8Array(e);else if(e.buffer instanceof ArrayBuffer)this.data=new Uint8Array(e.buffer,e.byteOffset,e.length*e.BYTES_PER_ELEMENT);else{if(!(e instanceof v.Buffer))throw new Error("Constructing buffer with unknown type.");this.data=e.data}this.length=this.data.length,this.next=null,this.prev=null}var t,n;return e.allocate=function(e){return new v.Buffer(e)},e.prototype.copy=function(){return new v.Buffer(new Uint8Array(this.data))},e.prototype.slice=function(e,t){return t==null&&(t=this.length),e===0&&t>=this.length?new v.Buffer(this.data):new v.Buffer(this.data.subarray(e,e+t))},t=d.BlobBuilder||d.MozBlobBuilder||d.WebKitBlobBuilder,n=d.URL||d.webkitURL||d.mozURL,e.makeBlob=function(e,n){var r;n==null&&(n="application/octet-stream");try{return new Blob([e],{type:n})}catch(i){}return t!=null?(r=new t,r.append(e),r.getBlob(n)):null},e.makeBlobURL=function(e,t){return n!=null?n.createObjectURL(this.makeBlob(e,t)):void 0},e.revokeBlobURL=function(e){return n!=null?n.revokeObjectURL(e):void 0},e.prototype.toBlob=function(){return e.makeBlob(this.data.buffer)},e.prototype.toBlobURL=function(){return e.makeBlobURL(this.data.buffer)},e}(),v.BufferList=function(){function e(){this.first=null,this.last=null,this.numBuffers=0,this.availableBytes=0,this.availableBuffers=0}return e.prototype.copy=function(){var e;return e=new v.BufferList,e.first=this.first,e.last=this.last,e.numBuffers=this.numBuffers,e.availableBytes=this.availableBytes,e.availableBuffers=this.availableBuffers,e},e.prototype.append=function(e){var t;return e.prev=this.last,(t=this.last)!=null&&(t.next=e),this.last=e,this.first==null&&(this.first=e),this.availableBytes+=e.length,this.availableBuffers++,this.numBuffers++},e.prototype.advance=function(){return this.first?(this.availableBytes-=this.first.length,this.availableBuffers--,this.first=this.first.next,this.first!=null):!1},e.prototype.rewind=function(){var e;return this.first&&!this.first.prev?!1:(this.first=((e=this.first)!=null?e.prev:void 0)||this.last,this.first&&(this.availableBytes+=this.first.length,this.availableBuffers++),this.first!=null)},e.prototype.reset=function(){var e;e=[];while(this.rewind())continue;return e},e}();var m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.Stream=function(){function e(e){this.list=e,this.localOffset=0,this.offset=0}var t,n,r,i,s,o,u,a,f,l,c,h,p;return t=new ArrayBuffer(16),p=new Uint8Array(t),f=new Int8Array(t),c=new Uint16Array(t),u=new Int16Array(t),h=new Uint32Array(t),a=new Int32Array(t),r=new Float32Array(t),typeof Float64Array!="undefined"&&Float64Array!==null&&(i=new Float64Array(t)),l=(new Uint16Array((new Uint8Array([18,52])).buffer))[0]===13330,v.UnderflowError=function(e){function t(){this.name="AV.UnderflowError"}return g(t,e),t}(Error),e.fromBuffer=function(e){var t;return t=new v.BufferList,t.append(e),new v.Stream(t)},e.prototype.copy=function(){var e;return e=new v.Stream(this.list.copy()),e.localOffset=this.localOffset,e.offset=this.offset,e},e.prototype.available=function(e){return e<=this.list.availableBytes-this.localOffset},e.prototype.remainingBytes=function(){return this.list.availableBytes-this.localOffset},e.prototype.advance=function(e){if(!this.available(e))throw new v.UnderflowError;this.localOffset+=e,this.offset+=e;while(this.list.first&&this.localOffset>=this.list.first.length)this.localOffset-=this.list.first.length,this.list.advance();return this},e.prototype.rewind=function(e){if(e>this.offset)throw new v.UnderflowError;this.list.first||(this.list.rewind(),this.localOffset=this.list.first.length),this.localOffset-=e,this.offset-=e;while(this.list.first.prev&&this.localOffset<0)this.list.rewind(),this.localOffset+=this.list.first.length;return this},e.prototype.seek=function(e){if(e>this.offset)return this.advance(e-this.offset);if(e<this.offset)return this.rewind(this.offset-e)},e.prototype.readUInt8=function(){var e;if(!this.available(1))throw new v.UnderflowError;return e=this.list.first.data[this.localOffset],this.localOffset+=1,this.offset+=1,this.localOffset===this.list.first.length&&(this.localOffset=0,this.list.advance()),e},e.prototype.peekUInt8=function(e){var t;e==null&&(e=0);if(!this.available(e+1))throw new v.UnderflowError;e=this.localOffset+e,t=this.list.first;while(t){if(t.length>e)return t.data[e];e-=t.length,t=t.next}return 0},e.prototype.read=function(e,t){var n,r,i,s;t==null&&(t=!1);if(t===l)for(n=r=0;r<e;n=r+=1)p[n]=this.readUInt8();else for(n=i=s=e-1;i>=0;n=i+=-1)p[n]=this.readUInt8()},e.prototype.peek=function(e,t,n){var r,i,s;n==null&&(n=!1);if(n===l)for(r=i=0;i<e;r=i+=1)p[r]=this.peekUInt8(t+r);else for(r=s=0;s<e;r=s+=1)p[e-r-1]=this.peekUInt8(t+r)},e.prototype.readInt8=function(){return this.read(1),f[0]},e.prototype.peekInt8=function(e){return e==null&&(e=0),this.peek(1,e),f[0]},e.prototype.readUInt16=function(e){return this.read(2,e),c[0]},e.prototype.peekUInt16=function(e,t){return e==null&&(e=0),this.peek(2,e,t),c[0]},e.prototype.readInt16=function(e){return this.read(2,e),u[0]},e.prototype.peekInt16=function(e,t){return e==null&&(e=0),this.peek(2,e,t),u[0]},e.prototype.readUInt24=function(e){return e?this.readUInt16(!0)+(this.readUInt8()<<16):(this.readUInt16()<<8)+this.readUInt8()},e.prototype.peekUInt24=function(e,t){return e==null&&(e=0),t?this.peekUInt16(e,!0)+(this.peekUInt8(e+2)<<16):(this.peekUInt16(e)<<8)+this.peekUInt8(e+2)},e.prototype.readInt24=function(e){return e?this.readUInt16(!0)+(this.readInt8()<<16):(this.readInt16()<<8)+this.readUInt8()},e.prototype.peekInt24=function(e,t){return e==null&&(e=0),t?this.peekUInt16(e,!0)+(this.peekInt8(e+2)<<16):(this.peekInt16(e)<<8)+this.peekUInt8(e+2)},e.prototype.readUInt32=function(e){return this.read(4,e),h[0]},e.prototype.peekUInt32=function(e,t){return e==null&&(e=0),this.peek(4,e,t),h[0]},e.prototype.readInt32=function(e){return this.read(4,e),a[0]},e.prototype.peekInt32=function(e,t){return e==null&&(e=0),this.peek(4,e,t),a[0]},e.prototype.readFloat32=function(e){return this.read(4,e),r[0]},e.prototype.peekFloat32=function(e,t){return e==null&&(e=0),this.peek(4,e,t),r[0]},e.prototype.readFloat64=function(e){return this.read(8,e),i?i[0]:s()},s=function(){var e,t,n,r,i,s;return r=h[0],n=h[1],!n||n===2147483648?0:(s=1-(n>>>31)*2,e=n>>>20&2047,t=n&1048575,e===2047?t?NaN:s*Infinity:(e-=1023,i=(t|1048576)*Math.pow(2,e-20),i+=r*Math.pow(2,e-52),s*i))},e.prototype.peekFloat64=function(e,t){return e==null&&(e=0),this.peek(8,e,t),i?i[0]:s()},e.prototype.readFloat80=function(e){return this.read(10,e),o()},o=function(){var e,t,n,r,i,s,o;return r=h[0],i=h[1],e=p[9],t=p[8],o=1-(e>>>7)*2,n=(e&127)<<8|t,n===0&&i===0&&r===0?0:n===32767?i===0&&r===0?o*Infinity:NaN:(n-=16383,s=i*Math.pow(2,n-31),s+=r*Math.pow(2,n-63),o*s)},e.prototype.peekFloat80=function(e,t){return e==null&&(e=0),this.peek(10,e,t),o()},e.prototype.readBuffer=function(e){var t,n,r,i;n=v.Buffer.allocate(e),r=n.data;for(t=i=0;i<e;t=i+=1)r[t]=this.readUInt8();return n},e.prototype.peekBuffer=function(e,t){var n,r,i,s;e==null&&(e=0),r=v.Buffer.allocate(t),i=r.data;for(n=s=0;s<t;n=s+=1)i[n]=this.peekUInt8(e+n);return r},e.prototype.readSingleBuffer=function(e){var t;return t=this.list.first.slice(this.localOffset,e),this.advance(t.length),t},e.prototype.peekSingleBuffer=function(e,t){var n;return n=this.list.first.slice(this.localOffset+e,t),n},e.prototype.readString=function(e,t){return t==null&&(t="ascii"),n.call(this,0,e,t,!0)},e.prototype.peekString=function(e,t,r){return e==null&&(e=0),r==null&&(r="ascii"),n.call(this,e,t,r,!1)},n=function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m;n=n.toLowerCase(),h=t===null?0:-1,t==null&&(t=Infinity),l=e+t,d="";switch(n){case"ascii":case"latin1":while(e<l&&(f=this.peekUInt8(e++))!==h)d+=String.fromCharCode(f);break;case"utf8":case"utf-8":while(e<l&&(i=this.peekUInt8(e++))!==h)(i&128)===0?d+=String.fromCharCode(i):(i&224)===192?(s=this.peekUInt8(e++)&63,d+=String.fromCharCode((i&31)<<6|s)):(i&240)===224?(s=this.peekUInt8(e++)&63,o=this.peekUInt8(e++)&63,d+=String.fromCharCode((i&15)<<12|s<<6|o)):(i&248)===240&&(s=this.peekUInt8(e++)&63,o=this.peekUInt8(e++)&63,u=this.peekUInt8(e++)&63,p=((i&15)<<18|s<<12|o<<6|u)-65536,d+=String.fromCharCode(55296+(p>>10),56320+(p&1023)));break;case"utf16-be":case"utf16be":case"utf16le":case"utf16-le":case"utf16bom":case"utf16-bom":switch(n){case"utf16be":case"utf16-be":c=!1;break;case"utf16le":case"utf16-le":c=!0;break;case"utf16bom":case"utf16-bom":if(t<2||(a=this.peekUInt16(e))===h)return r&&this.advance(e+=2),d;c=a===65534,e+=2}while(e<l&&(v=this.peekUInt16(e,c))!==h){e+=2;if(v<55296||v>57343)d+=String.fromCharCode(v);else{if(v>56319)throw new Error("Invalid utf16 sequence.");m=this.peekUInt16(e,c);if(m<56320||m>57343)throw new Error("Invalid utf16 sequence.");d+=String.fromCharCode(v,m),e+=2}}v===h&&(e+=2);break;default:throw new Error("Unknown encoding: "+n)}return r&&this.advance(e),d},e}(),v.Bitstream=function(){function e(e){this.stream=e,this.bitPosition=0}return e.prototype.copy=function(){var e;return e=new v.Bitstream(this.stream.copy()),e.bitPosition=this.bitPosition,e},e.prototype.offset=function(){return 8*this.stream.offset+this.bitPosition},e.prototype.available=function(e){return this.stream.available((e+8-this.bitPosition)/8)},e.prototype.advance=function(e){var t;return t=this.bitPosition+e,this.stream.advance(t>>3),this.bitPosition=t&7},e.prototype.rewind=function(e){var t;return t=this.bitPosition-e,this.stream.rewind(Math.abs(t>>3)),this.bitPosition=t&7},e.prototype.seek=function(e){var t;t=this.offset();if(e>t)return this.advance(e-t);if(e<t)return this.rewind(t-e)},e.prototype.align=function(){if(this.bitPosition!==0)return this.bitPosition=0,this.stream.advance(1)},e.prototype.read=function(e,t){var n,r,i,s,o,u,a;if(e===0)return 0;a=e+this.bitPosition;if(a<=8)n=(this.stream.peekUInt8()<<this.bitPosition&255)>>>8-e;else if(a<=16)n=(this.stream.peekUInt16()<<this.bitPosition&65535)>>>16-e;else if(a<=24)n=(this.stream.peekUInt24()<<this.bitPosition&16777215)>>>24-e;else if(a<=32)n=this.stream.peekUInt32()<<this.bitPosition>>>32-e;else{if(!(a<=40))throw new Error("Too many bits!");r=this.stream.peekUInt8(0)*4294967296,i=this.stream.peekUInt8(1)<<24>>>0,s=this.stream.peekUInt8(2)<<16,o=this.stream.peekUInt8(3)<<8,u=this.stream.peekUInt8(4),n=r+i+s+o+u,n%=Math.pow(2,40-this.bitPosition),n=Math.floor(n/Math.pow(2,40-this.bitPosition-e))}return t&&(a<32?n>>>e-1&&(n=((1<<e>>>0)-n)*-1):n/Math.pow(2,e-1)|0&&(n=(Math.pow(2,e)-n)*-1)),this.advance(e),n},e.prototype.peek=function(e,t){var n,r,i,s,o,u,a;if(e===0)return 0;a=e+this.bitPosition;if(a<=8)n=(this.stream.peekUInt8()<<this.bitPosition&255)>>>8-e;else if(a<=16)n=(this.stream.peekUInt16()<<this.bitPosition&65535)>>>16-e;else if(a<=24)n=(this.stream.peekUInt24()<<this.bitPosition&16777215)>>>24-e;else if(a<=32)n=this.stream.peekUInt32()<<this.bitPosition>>>32-e;else{if(!(a<=40))throw new Error("Too many bits!");r=this.stream.peekUInt8(0)*4294967296,i=this.stream.peekUInt8(1)<<24>>>0,s=this.stream.peekUInt8(2)<<16,o=this.stream.peekUInt8(3)<<8,u=this.stream.peekUInt8(4),n=r+i+s+o+u,n%=Math.pow(2,40-this.bitPosition),n=Math.floor(n/Math.pow(2,40-this.bitPosition-e))}return t&&(a<32?n>>>e-1&&(n=((1<<e>>>0)-n)*-1):n/Math.pow(2,e-1)|0&&(n=(Math.pow(2,e)-n)*-1)),n},e.prototype.readLSB=function(e,t){var n,r;if(e===0)return 0;if(e>40)throw new Error("Too many bits!");return r=e+this.bitPosition,n=this.stream.peekUInt8(0)>>>this.bitPosition,r>8&&(n|=this.stream.peekUInt8(1)<<8-this.bitPosition),r>16&&(n|=this.stream.peekUInt8(2)<<16-this.bitPosition),r>24&&(n+=this.stream.peekUInt8(3)<<24-this.bitPosition>>>0),r>32&&(n+=this.stream.peekUInt8(4)*Math.pow(2,32-this.bitPosition)),r>=32?n%=Math.pow(2,e):n&=(1<<e)-1,t&&(r<32?n>>>e-1&&(n=((1<<e>>>0)-n)*-1):n/Math.pow(2,e-1)|0&&(n=(Math.pow(2,e)-n)*-1)),this.advance(e),n},e.prototype.peekLSB=function(e,t){var n,r;if(e===0)return 0;if(e>40)throw new Error("Too many bits!");return r=e+this.bitPosition,n=this.stream.peekUInt8(0)>>>this.bitPosition,r>8&&(n|=this.stream.peekUInt8(1)<<8-this.bitPosition),r>16&&(n|=this.stream.peekUInt8(2)<<16-this.bitPosition),r>24&&(n+=this.stream.peekUInt8(3)<<24-this.bitPosition>>>0),r>32&&(n+=this.stream.peekUInt8(4)*Math.pow(2,32-this.bitPosition)),r>=32?n%=Math.pow(2,e):n&=(1<<e)-1,t&&(r<32?n>>>e-1&&(n=((1<<e>>>0)-n)*-1):n/Math.pow(2,e-1)|0&&(n=(Math.pow(2,e)-n)*-1)),n},e}();var b,m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},w=[].slice;v.EventEmitter=function(e){function t(){return b=t.__super__.constructor.apply(this,arguments),b}return g(t,e),t.prototype.on=function(e,t){var n;return this.events==null&&(this.events={}),(n=this.events)[e]==null&&(n[e]=[]),this.events[e].push(t)},t.prototype.off=function(e,t){var n,r;if((r=this.events)!=null?!r[e]:!void 0)return;n=this.events[e].indexOf(t);if(~n)return this.events[e].splice(n,1)},t.prototype.once=function(e,t){var n;return this.on(e,n=function(){return this.off(e,n),t.apply(this,arguments)})},t.prototype.emit=function(){var e,t,n,r,i,s,o;t=arguments[0],e=2<=arguments.length?w.call(arguments,1):[];if((s=this.events)!=null?!s[t]:!void 0)return;o=this.events[t].slice();for(r=0,i=o.length;r<i;r++)n=o[r],n.apply(this,e)},t}(v.Base);var E=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.BufferSource=function(e){function t(e){this.loop=E(this.loop,this),e instanceof v.BufferList?this.list=e:(this.list=new v.BufferList,this.list.append(new v.Buffer(e))),this.paused=!0}var n,r;return g(t,e),r=d.setImmediate||function(e){return d.setTimeout(e,0)},n=d.clearImmediate||function(e){return d.clearTimeout(e)},t.prototype.start=function(){return this.paused=!1,this._timer=r(this.loop)},t.prototype.loop=function(){return this.emit("progress",(this.list.numBuffers-this.list.availableBuffers+1)/this.list.numBuffers*100|0),this.emit("data",this.list.first),this.list.advance()?r(this.loop):this.emit("end")},t.prototype.pause=function(){return n(this._timer),this.paused=!0},t.prototype.reset=function(){return this.pause(),this.list.rewind()},t}(v.EventEmitter);var m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.Demuxer=function(e){function t(e,t){var n,r,i=this;n=new v.BufferList,n.append(t),this.stream=new v.Stream(n),r=!1,e.on("data",function(e){return r=!0,n.append(e),i.readChunk(e)}),e.on("error",function(e){return i.emit("error",e)}),e.on("end",function(){return r||i.readChunk(t),i.emit("end")}),this.seekPoints=[],this.init()}var n;return g(t,e),t.probe=function(e){return!1},t.prototype.init=function(){},t.prototype.readChunk=function(e){},t.prototype.addSeekPoint=function(e,t){var n;return n=this.searchTimestamp(t),this.seekPoints.splice(n,0,{offset:e,timestamp:t})},t.prototype.searchTimestamp=function(e,t){var n,r,i,s;r=0,n=this.seekPoints.length;if(n>0&&this.seekPoints[n-1].timestamp<e)return n;while(r<n)i=r+n>>1,s=this.seekPoints[i].timestamp,s<e?r=i+1:s>=e&&(n=i);return n>this.seekPoints.length&&(n=this.seekPoints.length),n},t.prototype.seek=function(e){var t,n;return this.format&&this.format.framesPerPacket>0&&this.format.bytesPerPacket>0?(n={timestamp:e,offset:this.format.bytesPerPacket*e/this.format.framesPerPacket},n):(t=this.searchTimestamp(e),this.seekPoints[t])},n=[],t.register=function(e){return n.push(e)},t.find=function(e){var t,r,i,s;r=v.Stream.fromBuffer(e);for(i=0,s=n.length;i<s;i++){t=n[i];if(t.probe(r))return t}return null},t}(v.EventEmitter);var m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.Decoder=function(e){function t(e,t){var n,r=this;this.demuxer=e,this.format=t,n=new v.BufferList,this.stream=new v.Stream(n),this.bitstream=new v.Bitstream(this.stream),this.receivedFinalBuffer=!1,this.waiting=!1,this.demuxer.on("cookie",function(e){var t;try{return r.setCookie(e)}catch(n){return t=n,r.emit("error",t)}}),this.demuxer.on("data",function(e){n.append(e);if(r.waiting)return r.decode()}),this.demuxer.on("end",function(){r.receivedFinalBuffer=!0;if(r.waiting)return r.decode()}),this.init()}var n;return g(t,e),t.prototype.init=function(){},t.prototype.setCookie=function(e){},t.prototype.readChunk=function(){},t.prototype.decode=function(){var e,t,n;this.waiting=!1,t=this.bitstream.offset();try{n=this.readChunk()}catch(r){e=r;if(!(e instanceof v.UnderflowError))return this.emit("error",e),!1}return n?(this.emit("data",n),!0):(this.receivedFinalBuffer?this.emit("end"):(this.bitstream.seek(t),this.waiting=!0),!1)},t.prototype.seek=function(e){var t;return t=this.demuxer.seek(e),this.stream.seek(t.offset),t.timestamp},n={},t.register=function(e,t){return n[e]=t},t.find=function(e){return n[e]||null},t}(v.EventEmitter);var E=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.Queue=function(e){function t(e){var t=this;this.asset=e,this.write=E(this.write,this),this.readyMark=64,this.finished=!1,this.buffering=!0,this.ended=!1,this.buffers=[],this.asset.on("data",this.write),this.asset.on("end",function(){return t.ended=!0}),this.asset.decodePacket()}return g(t,e),t.prototype.write=function(e){e&&this.buffers.push(e);if(this.buffering)return this.buffers.length>=this.readyMark||this.ended?(this.buffering=!1,this.emit("ready")):this.asset.decodePacket()},t.prototype.read=function(){return this.buffers.length===0?null:(this.asset.decodePacket(),this.buffers.shift())},t.prototype.reset=function(){return this.buffers.length=0,this.buffering=!0,this.asset.decodePacket()},t}(v.EventEmitter);var E=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.AudioDevice=function(e){function t(e,t){this.sampleRate=e,this.channels=t,this.updateTime=E(this.updateTime,this),this.playing=!1,this.currentTime=0,this._lastTime=0}var n;return g(t,e),t.prototype.start=function(){var e=this;if(this.playing)return;this.playing=!0,this.device==null&&(this.device=v.AudioDevice.create(this.sampleRate,this.channels));if(!this.device)throw new Error("No supported audio device found.");return this._lastTime=this.device.getDeviceTime(),this._timer=setInterval(this.updateTime,200),this.device.on("refill",this.refill=function(t){return e.emit("refill",t)})},t.prototype.stop=function(){if(!this.playing)return;return this.playing=!1,this.device.off("refill",this.refill),clearInterval(this._timer)},t.prototype.destroy=function(){return this.stop(),this.device.destroy()},t.prototype.seek=function(e){return this.currentTime=e,this.playing&&(this._lastTime=this.device.getDeviceTime()),this.emit("timeUpdate",this.currentTime)},t.prototype.updateTime=function(){var e;return e=this.device.getDeviceTime(),this.currentTime+=(e-this._lastTime)/this.device.sampleRate*1e3|0,this._lastTime=e,this.emit("timeUpdate",this.currentTime)},n=[],t.register=function(e){return n.push(e)},t.create=function(e,t){var r,i,s;for(i=0,s=n.length;i<s;i++){r=n[i];if(r.supported)return new r(e,t)}return null},t}(v.EventEmitter);var E=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.Asset=function(e){function t(e){var t=this;this.source=e,this._decode=E(this._decode,this),this.findDecoder=E(this.findDecoder,this),this.probe=E(this.probe,this),this.buffered=0,this.duration=null,this.format=null,this.metadata=null,this.active=!1,this.demuxer=null,this.decoder=null,this.source.once("data",this.probe),this.source.on("error",function(e){return t.emit("error",e),t.stop()}),this.source.on("progress",function(e){return t.buffered=e,t.emit("buffer",t.buffered)})}return g(t,e),t.fromURL=function(e){return new v.Asset(new v.HTTPSource(e))},t.fromFile=function(e){return new v.Asset(new v.FileSource(e))},t.fromBuffer=function(e){return new v.Asset(new v.BufferSource(e))},t.prototype.start=function(e){if(this.active)return;e!=null&&(this.shouldDecode=e),this.shouldDecode==null&&(this.shouldDecode=!0),this.active=!0,this.source.start();if(this.decoder&&this.shouldDecode)return this._decode()},t.prototype.stop=function(){if(!this.active)return;return this.active=!1,this.source.pause()},t.prototype.get=function(e,t){var n=this;if(e!=="format"&&e!=="duration"&&e!=="metadata")return;return this[e]!=null?t(this[e]):(this.once(e,function(e){return n.stop(),t(e)}),this.start())},t.prototype.decodePacket=function(){return this.decoder.decode()},t.prototype.decodeToBuffer=function(e){var t,n,r;return r=0,t=[],this.on("data",n=function(e){return r+=e.length,t.push(e)}),this.once("end",function(){var i,s,o,u,a;i=new Float32Array(r),o=0;for(u=0,a=t.length;u<a;u++)s=t[u],i.set(s,o),o+=s.length;return this.off("data",n),e(i)}),this.start()},t.prototype.probe=function(e){var t,n=this;if(!this.active)return;return t=v.Demuxer.find(e),t?(this.demuxer=new t(this.source,e),this.demuxer.on("format",this.findDecoder),this.demuxer.on("duration",function(e){return n.duration=e,n.emit("duration",n.duration)}),this.demuxer.on("metadata",function(e){return n.metadata=e,n.emit("metadata",n.metadata)}),this.demuxer.on("error",function(e){return n.emit("error",e),n.stop()})):this.emit("error","A demuxer for this container was not found.")},t.prototype.findDecoder=function(e){var t,n,r=this;this.format=e;if(!this.active)return;this.emit("format",this.format),t=v.Decoder.find(this.format.formatID);if(!t)return this.emit("error","A decoder for "+this.format.formatID+" was not found.");this.decoder=new t(this.demuxer,this.format),this.format.floatingPoint?this.decoder.on("data",function(e){return r.emit("data",e)}):(n=Math.pow(2,this.format.bitsPerChannel-1),this.decoder.on("data",function(e){var t,i,s,o,u;t=new Float32Array(e.length);for(i=o=0,u=e.length;o<u;i=++o)s=e[i],t[i]=s/n;return r.emit("data",t)})),this.decoder.on("error",function(e){return r.emit("error",e),r.stop()}),this.decoder.on("end",function(){return r.emit("end")}),this.emit("decodeStart");if(this.shouldDecode)return this._decode()},t.prototype._decode=function(){while(this.decoder.decode()&&this.active)continue;if(this.active)return this.decoder.once("data",this._decode)},t}(v.EventEmitter);var E=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.Player=function(e){function t(e){var t=this;this.asset=e,this.startPlaying=E(this.startPlaying,this),this.playing=!1,this.buffered=0,this.currentTime=0,this.duration=0,this.volume=100,this.pan=0,this.metadata={},this.filters=[new v.VolumeFilter(this,"volume"),new v.BalanceFilter(this,"pan")],this.asset.on("buffer",function(e){return t.buffered=e,t.emit("buffer",t.buffered)}),this.asset.on("decodeStart",function(){return t.queue=new v.Queue(t.asset),t.queue.once("ready",t.startPlaying)}),this.asset.on("format",function(e){return t.format=e,t.emit("format",t.format)}),this.asset.on("metadata",function(e){return t.metadata=e,t.emit("metadata",t.metadata)}),this.asset.on("duration",function(e){return t.duration=e,t.emit("duration",t.duration)}),this.asset.on("error",function(e){return t.emit("error",e)})}return g(t,e),t.fromURL=function(e){return new v.Player(v.Asset.fromURL(e))},t.fromFile=function(e){return new v.Player(v.Asset.fromFile(e))},t.fromBuffer=function(e){return new v.Player(v.Asset.fromBuffer(e))},t.prototype.preload=function(){if(!this.asset)return;return this.startedPreloading=!0,this.asset.start(!1)},t.prototype.play=function(){var e;if(this.playing)return;return this.startedPreloading||this.preload(),this.playing=!0,(e=this.device)!=null?e.start():void 0},t.prototype.pause=function(){var e;if(!this.playing)return;return this.playing=!1,(e=this.device)!=null?e.stop():void 0},t.prototype.togglePlayback=function(){return this.playing?this.pause():this.play()},t.prototype.stop=function(){var e;return this.pause(),this.asset.stop(),(e=this.device)!=null?e.destroy():void 0},t.prototype.seek=function(e){var t,n=this;return(t=this.device)!=null&&t.stop(),this.queue.once("ready",function(){var e,t;(e=n.device)!=null&&e.seek(n.currentTime);if(n.playing)return(t=n.device)!=null?t.start():void 0}),e=e/1e3*this.format.sampleRate,e=this.asset.decoder.seek(e),this.currentTime=e/this.format.sampleRate*1e3|0,this.queue.reset(),this.currentTime},t.prototype.startPlaying=function(){var e,t,n=this;return e=this.queue.read(),t=0,this.device=new v.AudioDevice(this.format.sampleRate,this.format.channelsPerFrame),this.device.on("timeUpdate",function(e){return n.currentTime=e,n.emit("progress",n.currentTime)}),this.refill=function(r){var i,s,o,u,a,f,l,c;if(!n.playing)return;e||(e=n.queue.read(),t=0),i=0;while(e&&i<r.length){u=Math.min(e.length-t,r.length-i);for(o=a=0;a<u;o=a+=1)r[i++]=e[t++];t===e.length&&(e=n.queue.read(),t=0)}c=n.filters;for(f=0,l=c.length;f<l;f++)s=c[f],s.process(r);e||(n.queue.ended?(n.currentTime=n.duration,n.emit("progress",n.currentTime),n.emit("end"),n.stop()):n.device.stop())},this.device.on("refill",this.refill),this.playing&&this.device.start(),this.emit("ready")},t}(v.EventEmitter),v.Filter=function(){function e(e,t){e&&t&&Object.defineProperty(this,"value",{get:function(){return e[t]}})}return e.prototype.process=function(e){},e}();var b,m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.VolumeFilter=function(e){function t(){return b=t.__super__.constructor.apply(this,arguments),b}return g(t,e),t.prototype.process=function(e){var t,n,r,i;if(this.value>=100)return;n=Math.max(0,Math.min(100,this.value))/100;for(t=r=0,i=e.length;r<i;t=r+=1)e[t]*=n},t}(v.Filter);var b,m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.BalanceFilter=function(e){function t(){return b=t.__super__.constructor.apply(this,arguments),b}return g(t,e),t.prototype.process=function(e){var t,n,r,i;if(this.value===0)return;n=Math.max(-50,Math.min(50,this.value));for(t=r=0,i=e.length;r<i;t=r+=2)e[t]*=Math.min(1,(50-n)/50),e[t+1]*=Math.min(1,(50+n)/50)},t}(v.Filter);var S,b,m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};S=function(e){function t(){return b=t.__super__.constructor.apply(this,arguments),b}return g(t,e),v.Demuxer.register(t),t.probe=function(e){return e.peekString(0,4)==="caff"},t.prototype.readChunk=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p;if(!this.format&&this.stream.available(64)){if(this.stream.readString(4)!=="caff")return this.emit("error","Invalid CAF, does not begin with 'caff'");this.stream.advance(4);if(this.stream.readString(4)!=="desc")return this.emit("error","Invalid CAF, 'caff' is not followed by 'desc'");if(this.stream.readUInt32()!==0||this.stream.readUInt32()!==32)return this.emit("error","Invalid 'desc' size, should be 32");this.format={},this.format.sampleRate=this.stream.readFloat64(),this.format.formatID=this.stream.readString(4),i=this.stream.readUInt32(),this.format.formatID==="lpcm"&&(this.format.floatingPoint=Boolean(i&1),this.format.littleEndian=Boolean(i&2)),this.format.bytesPerPacket=this.stream.readUInt32(),this.format.framesPerPacket=this.stream.readUInt32(),this.format.channelsPerFrame=this.stream.readUInt32(),this.format.bitsPerChannel=this.stream.readUInt32(),this.emit("format",this.format)}while(this.stream.available(1)){if(!this.headerCache){this.headerCache={type:this.stream.readString(4),oversize:this.stream.readUInt32()!==0,size:this.stream.readUInt32()};if(this.headerCache.oversize)return this.emit("error","Holy Shit, an oversized file, not supported in JS")}switch(this.headerCache.type){case"kuki":this.stream.available(this.headerCache.size)&&(this.format.formatID==="aac "?(a=this.stream.offset+this.headerCache.size,(n=x.readEsds(this.stream))&&this.emit("cookie",n),this.stream.seek(a)):(e=this.stream.readBuffer(this.headerCache.size),this.emit("cookie",e)),this.headerCache=null);break;case"pakt":if(this.stream.available(this.headerCache.size)){if(this.stream.readUInt32()!==0)return this.emit("error","Sizes greater than 32 bits are not supported.");this.numPackets=this.stream.readUInt32();if(this.stream.readUInt32()!==0)return this.emit("error","Sizes greater than 32 bits are not supported.");this.numFrames=this.stream.readUInt32(),this.primingFrames=this.stream.readUInt32(),this.remainderFrames=this.stream.readUInt32(),this.emit("duration",this.numFrames/this.format.sampleRate*1e3|0),this.sentDuration=!0,t=0,f=0;for(s=c=0,p=this.numPackets;c<p;s=c+=1)this.addSeekPoint(t,f),t+=this.format.bytesPerPacket||x.readDescrLen(this.stream),f+=this.format.framesPerPacket||x.readDescrLen(this.stream);this.headerCache=null}break;case"info":r=this.stream.readUInt32(),u={};for(s=h=0;0<=r?h<r:h>r;s=0<=r?++h:--h)o=this.stream.readString(null),l=this.stream.readString(null),u[o]=l;this.emit("metadata",u),this.headerCache=null;break;case"data":this.sentFirstDataChunk||(this.stream.advance(4),this.headerCache.size-=4,this.format.bytesPerPacket!==0&&!this.sentDuration&&(this.numFrames=this.headerCache.size/this.format.bytesPerPacket,this.emit("duration",this.numFrames/this.format.sampleRate*1e3|0)),this.sentFirstDataChunk=!0),e=this.stream.readSingleBuffer(this.headerCache.size),this.headerCache.size-=e.length,this.emit("data",e),this.headerCache.size<=0&&(this.headerCache=null);break;default:this.stream.available(this.headerCache.size)&&(this.stream.advance(this.headerCache.size),this.headerCache=null)}}},t}(v.Demuxer);var x,b,m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},y=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};x=function(e){function t(){return b=t.__super__.constructor.apply(this,arguments),b}var n,r,i,s,o,u,a,f,l,c,h;return g(t,e),v.Demuxer.register(t),r=["M4A ","M4P ","M4B ","M4V ","isom","mp42","qt  "],t.probe=function(e){var t;return e.peekString(4,4)==="ftyp"&&(t=e.peekString(8,4),y.call(r,t)>=0)},t.prototype.init=function(){return this.atoms=[],this.offsets=[],this.track=null,this.tracks=[]},o={},a={},s=function(e,t){var n,r,i,s,u;n=[],u=e.split(".").slice(0,-1);for(i=0,s=u.length;i<s;i++)r=u[i],n.push(r),a[n.join(".")]=!0;return o[e]==null&&(o[e]={}),o[e].fn=t},i=function(e,t){return o[e]==null&&(o[e]={}),o[e].after=t},t.prototype.readChunk=function(){var e,t,n;this["break"]=!1;while(this.stream.available(1)&&!this["break"]){if(!this.readHeaders){if(!this.stream.available(8))return;this.len=this.stream.readUInt32()-8,this.type=this.stream.readString(4);if(this.len===0)continue;this.atoms.push(this.type),this.offsets.push(this.stream.offset+this.len),this.readHeaders=!0}t=this.atoms.join("."),e=o[t];if(e!=null?e.fn:void 0){if(!this.stream.available(this.len)&&t!=="mdat")return;e.fn.call(this),t in a&&(this.readHeaders=!1)}else if(t in a)this.readHeaders=!1;else{if(!this.stream.available(this.len))return;this.stream.advance(this.len)}while(this.stream.offset>=this.offsets[this.offsets.length-1])e=o[this.atoms.join(".")],(e!=null?e.after:void 0)&&e.after.call(this),n=this.atoms.pop(),this.offsets.pop(),this.readHeaders=!1}},s("ftyp",function(){var e;return(e=this.stream.readString(4),y.call(r,e)<0)?this.emit("error","Not a valid M4A file."):this.stream.advance(this.len-4)}),s("moov.trak",function(){return this.track={},this.tracks.push(this.track)}),s("moov.trak.tkhd",function(){return this.stream.advance(4),this.stream.advance(8),this.track.id=this.stream.readUInt32(),this.stream.advance(this.len-16)}),s("moov.trak.mdia.hdlr",function(){return this.stream.advance(4),this.stream.advance(4),this.track.type=this.stream.readString(4),this.stream.advance(12),this.stream.advance(this.len-24)}),s("moov.trak.mdia.mdhd",function(){return this.stream.advance(4),this.stream.advance(8),this.track.timeScale=this.stream.readUInt32(),this.track.duration=this.stream.readUInt32(),this.stream.advance(4)}),n={ulaw:8,alaw:8,in24:24,in32:32,fl32:32,fl64:64},s("moov.trak.mdia.minf.stbl.stsd",function(){var e,t,r,i,s;this.stream.advance(4),t=this.stream.readUInt32();if(this.track.type!=="soun")return this.stream.advance(this.len-8);if(t!==1)return this.emit("error","Only expecting one entry in sample description atom!");this.stream.advance(4),e=this.track.format={},e.formatID=this.stream.readString(4),this.stream.advance(6),this.stream.advance(2),r=this.stream.readUInt16(),this.stream.advance(6),e.channelsPerFrame=this.stream.readUInt16(),e.bitsPerChannel=this.stream.readUInt16(),this.stream.advance(4),e.sampleRate=this.stream.readUInt16(),this.stream.advance(2),r===1?(e.framesPerPacket=this.stream.readUInt32(),this.stream.advance(4),e.bytesPerFrame=this.stream.readUInt32(),this.stream.advance(4)):r!==0&&this.emit("error","Unknown version in stsd atom"),n[e.formatID]!=null&&(e.bitsPerChannel=n[e.formatID]),e.floatingPoint=(i=e.formatID)==="fl32"||i==="fl64",e.littleEndian=e.formatID==="sowt"&&e.bitsPerChannel>8;if((s=e.formatID)==="twos"||s==="sowt"||s==="in24"||s==="in32"||s==="fl32"||s==="fl64"||s==="raw "||s==="NONE")return e.formatID="lpcm"}),s("moov.trak.mdia.minf.stbl.stsd.alac",function(){return this.stream.advance(4),this.track.cookie=this.stream.readBuffer(this.len-4)}),s("moov.trak.mdia.minf.stbl.stsd.esds",function(){var e;return e=this.stream.offset+this.len,this.track.cookie=t.readEsds(this.stream),this.stream.seek(e)}),s("moov.trak.mdia.minf.stbl.stsd.wave.enda",function(){return this.track.format.littleEndian=!!this.stream.readUInt16()}),t.readDescrLen=function(e){var t,n,r;r=0,n=4;while(n--){t=e.readUInt8(),r=r<<7|t&127;if(!(t&128))break}return r},t.readEsds=function(e){var n,r,i,s;e.advance(4),s=e.readUInt8(),i=t.readDescrLen(e),s===3?(e.advance(2),r=e.readUInt8(),r&128&&e.advance(2),r&64&&e.advance(e.readUInt8()),r&32&&e.advance(2)):e.advance(2),s=e.readUInt8(),i=t.readDescrLen(e);if(s===4){n=e.readUInt8(),e.advance(1),e.advance(3),e.advance(4),e.advance(4),s=e.readUInt8(),i=t.readDescrLen(e);if(s===5)return e.readBuffer(i)}return null},s("moov.trak.mdia.minf.stbl.stts",function(){var e,t,n;this.stream.advance(4),e=this.stream.readUInt32(),this.track.stts=[];for(t=n=0;n<e;t=n+=1)this.track.stts[t]={count:this.stream.readUInt32(),duration:this.stream.readUInt32()};return this.setupSeekPoints()}),s("moov.trak.mdia.minf.stbl.stsc",function(){var e,t,n;this.stream.advance(4),e=this.stream.readUInt32(),this.track.stsc=[];for(t=n=0;n<e;t=n+=1)this.track.stsc[t]={first:this.stream.readUInt32(),count:this.stream.readUInt32(),id:this.stream.readUInt32()};return this.setupSeekPoints()}),s("moov.trak.mdia.minf.stbl.stsz",function(){var e,t,n;this.stream.advance(4),this.track.sampleSize=this.stream.readUInt32(),e=this.stream.readUInt32();if(this.track.sampleSize===0&&e>0){this.track.sampleSizes=[];for(t=n=0;n<e;t=n+=1)this.track.sampleSizes[t]=this.stream.readUInt32()}return this.setupSeekPoints()}),s("moov.trak.mdia.minf.stbl.stco",function(){var e,t,n;this.stream.advance(4),e=this.stream.readUInt32(),this.track.chunkOffsets=[];for(t=n=0;n<e;t=n+=1)this.track.chunkOffsets[t]=this.stream.readUInt32();return this.setupSeekPoints()}),s("moov.trak.tref.chap",function(){var e,t,n;e=this.len>>2,this.track.chapterTracks=[];for(t=n=0;n<e;t=n+=1)this.track.chapterTracks[t]=this.stream.readUInt32()}),t.prototype.setupSeekPoints=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v;if(this.track.chunkOffsets==null||this.track.stsc==null||this.track.sampleSize==null||this.track.stts==null)return;o=0,u=0,u=0,a=0,i=0,n=0,f=0,this.track.seekPoints=[],p=this.track.chunkOffsets,v=[];for(e=l=0,h=p.length;l<h;e=++l){r=p[e];for(t=c=0,d=this.track.stsc[o].count;c<d;t=c+=1)this.track.seekPoints.push({offset:n,position:r,timestamp:f}),s=this.track.sampleSize||this.track.sampleSizes[i++],n+=s,r+=s,f+=this.track.stts[u].duration,u+1<this.track.stts.length&&++a===this.track.stts[u].count&&(a=0,u++);o+1<this.track.stsc.length&&e+1===this.track.stsc[o+1].first?v.push(o++):v.push(void 0)}return v},i("moov",function(){var e,t,n,r;this.mdatOffset!=null&&this.stream.seek(this.mdatOffset-8),r=this.tracks;for(t=0,n=r.length;t<n;t++){e=r[t];if(e.type!=="soun")continue;this.track=e;break}return this.track.type!=="soun"?(this.track=null,this.emit("error","No audio tracks in m4a file.")):(this.emit("format",this.track.format),this.emit("duration",this.track.duration/this.track.timeScale*1e3|0),this.track.cookie&&this.emit("cookie",this.track.cookie),this.seekPoints=this.track.seekPoints)}),s("mdat",function(){var e,t,n,r,i,s,o,u;if(!this.startedData){this.mdatOffset==null&&(this.mdatOffset=this.stream.offset);if(this.tracks.length===0){e=Math.min(this.stream.remainingBytes(),this.len),this.stream.advance(e),this.len-=e;return}this.chunkIndex=0,this.stscIndex=0,this.sampleIndex=0,this.tailOffset=0,this.tailSamples=0,this.startedData=!0}if(!this.readChapters){this.readChapters=this.parseChapters();if(this["break"]=!this.readChapters)return;this.stream.seek(this.mdatOffset)}i=this.track.chunkOffsets[this.chunkIndex]+this.tailOffset,n=0;if(!this.stream.available(i-this.stream.offset)){this["break"]=!0;return}this.stream.seek(i);while(this.chunkIndex<this.track.chunkOffsets.length){r=this.track.stsc[this.stscIndex].count-this.tailSamples,t=0;for(s=u=0;u<r;s=u+=1){o=this.track.sampleSize||this.track.sampleSizes[this.sampleIndex];if(!this.stream.available(n+o))break;n+=o,t+=o,this.sampleIndex++}if(s<r){this.tailOffset+=t,this.tailSamples+=s;break}this.chunkIndex++,this.tailOffset=0,this.tailSamples=0,this.stscIndex+1<this.track.stsc.length&&this.chunkIndex+1===this.track.stsc[this.stscIndex+1].first&&this.stscIndex++;if(i+n!==this.track.chunkOffsets[this.chunkIndex])break}return n>0?(this.emit("data",this.stream.readBuffer(n)),this["break"]=this.chunkIndex===this.track.chunkOffsets.length):this["break"]=!0}),t.prototype.parseChapters=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h;if(((f=this.track.chapterTracks)!=null?f.length:void 0)>0){t=this.track.chapterTracks[0],l=this.tracks;for(u=0,a=l.length;u<a;u++){o=l[u];if(o.id===t)break}o.id!==t&&this.emit("error","Chapter track does not exist."),this.chapters==null&&(this.chapters=[]);while(this.chapters.length<o.seekPoints.length){i=o.seekPoints[this.chapters.length];if(!this.stream.available(i.position-this.stream.offset+32))return!1;this.stream.seek(i.position),n=this.stream.readUInt16(),s=null;if(!this.stream.available(n))return!1;if(n>2){e=this.stream.peekUInt16();if(e===65279||e===65534)s=this.stream.readString(n,"utf16-bom")}s==null&&(s=this.stream.readString(n,"utf8")),r=(c=(h=o.seekPoints[this.chapters.length+1])!=null?h.timestamp:void 0)!=null?c:o.duration,this.chapters.push({title:s,timestamp:i.timestamp/o.timeScale*1e3|0,duration:(r-i.timestamp)/o.timeScale*1e3|0})}return this.emit("chapters",this.chapters),!0}return!0},s("moov.udta.meta",function(){return this.metadata={},this.stream.advance(4)}),i("moov.udta.meta",function(){return this.emit("metadata",this.metadata)}),c=function(e,t,n){return s("moov.udta.meta.ilst."+e+".data",function(){return this.stream.advance(8),this.len-=8,n.call(this,t)})},h=function(e){return this.metadata[e]=this.stream.readString(this.len,"utf8")},c("©alb","album",h),c("©arg","arranger",h),c("©art","artist",h),c("©ART","artist",h),c("aART","albumArtist",h),c("catg","category",h),c("©com","composer",h),c("©cpy","copyright",h),c("cprt","copyright",h),c("©cmt","comments",h),c("©day","releaseDate",h),c("desc","description",h),c("©gen","genre",h),c("©grp","grouping",h),c("©isr","ISRC",h),c("keyw","keywords",h),c("©lab","recordLabel",h),c("ldes","longDescription",h),c("©lyr","lyrics",h),c("©nam","title",h),c("©phg","recordingCopyright",h),c("©prd","producer",h),c("©prf","performers",h),c("purd","purchaseDate",h),c("purl","podcastURL",h),c("©swf","songwriter",h),c("©too","encoder",h),c("©wrt","composer",h),c("covr","coverArt",function(e){return this.metadata[e]=this.stream.readBuffer(this.len)}),l=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychadelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Capella","Euro-House","Dance Hall"],c("gnre","genre",function(e){return this.metadata[e]=l[this.stream.readUInt16()-1]}),c("tmpo","tempo",function(e){return this.metadata[e]=this.stream.readUInt16()}),c("rtng","rating",function(e){var t;return t=this.stream.readUInt8(),this.metadata[e]=t===2?"Clean":t!==0?"Explicit":"None"}),f=function(e){return this.stream.advance(2),this.metadata[e]=this.stream.readUInt16()+" of "+this.stream.readUInt16(),this.stream.advance(this.len-6)},c("disk","diskNumber",f),c("trkn","trackNumber",f),u=function(e){return this.metadata[e]=this.stream.readUInt8()===1},c("cpil","compilation",u),c("pcst","podcast",u),c("pgap","gapless",u),t}(v.Demuxer);var T,b,m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};T=function(e){function t(){return b=t.__super__.constructor.apply(this,arguments),b}return g(t,e),v.Demuxer.register(t),t.probe=function(e){var t;return e.peekString(0,4)==="FORM"&&((t=e.peekString(8,4))==="AIFF"||t==="AIFC")},t.prototype.readChunk=function(){var e,t,n,r;if(!this.readStart&&this.stream.available(12)){if(this.stream.readString(4)!=="FORM")return this.emit("error","Invalid AIFF.");this.fileSize=this.stream.readUInt32(),this.fileType=this.stream.readString(4),this.readStart=!0;if((r=this.fileType)!=="AIFF"&&r!=="AIFC")return this.emit("error","Invalid AIFF.")}while(this.stream.available(1)){!this.readHeaders&&this.stream.available(8)&&(this.type=this.stream.readString(4),this.len=this.stream.readUInt32());switch(this.type){case"COMM":if(!this.stream.available(this.len))return;this.format={formatID:"lpcm",channelsPerFrame:this.stream.readUInt16(),sampleCount:this.stream.readUInt32(),bitsPerChannel:this.stream.readUInt16(),sampleRate:this.stream.readFloat80(),framesPerPacket:1,littleEndian:!1,floatingPoint:!1},this.format.bytesPerPacket=this.format.bitsPerChannel/8*this.format.channelsPerFrame;if(this.fileType==="AIFC"){t=this.stream.readString(4),this.format.littleEndian=t==="sowt"&&this.format.bitsPerChannel>8,this.format.floatingPoint=t==="fl32"||t==="fl64";if(t==="twos"||t==="sowt"||t==="fl32"||t==="fl64"||t==="NONE")t="lpcm";this.format.formatID=t,this.len-=4}this.stream.advance(this.len-18),this.emit("format",this.format),this.emit("duration",this.format.sampleCount/this.format.sampleRate*1e3|0);break;case"SSND":if(!this.readSSNDHeader||!this.stream.available(4))n=this.stream.readUInt32(),this.stream.advance(4),this.stream.advance(n),this.readSSNDHeader=!0;e=this.stream.readSingleBuffer(this.len),this.len-=e.length,this.readHeaders=this.len>0,this.emit("data",e);break;default:if(!this.stream.available(this.len))return;this.stream.advance(this.len)}this.type!=="SSND"&&(this.readHeaders=!1)}},t}(v.Demuxer);var N,b,m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};N=function(e){function t(){return b=t.__super__.constructor.apply(this,arguments),b}var n;return g(t,e),v.Demuxer.register(t),t.probe=function(e){return e.peekString(0,4)==="RIFF"&&e.peekString(8,4)==="WAVE"},n={1:"lpcm",3:"lpcm",6:"alaw",7:"ulaw"},t.prototype.readChunk=function(){var e,t,r;if(!this.readStart&&this.stream.available(12)){if(this.stream.readString(4)!=="RIFF")return this.emit("error","Invalid WAV file.");this.fileSize=this.stream.readUInt32(!0),this.readStart=!0;if(this.stream.readString(4)!=="WAVE")return this.emit("error","Invalid WAV file.")}while(this.stream.available(1)){!this.readHeaders&&this.stream.available(8)&&(this.type=this.stream.readString(4),this.len=this.stream.readUInt32(!0));switch(this.type){case"fmt ":r=this.stream.readUInt16(!0);if(!(r in n))return this.emit("error","Unsupported format in WAV file.");this.format={formatID:n[r],floatingPoint:r===3,littleEndian:n[r]==="lpcm",channelsPerFrame:this.stream.readUInt16(!0),sampleRate:this.stream.readUInt32(!0),framesPerPacket:1},this.stream.advance(4),this.stream.advance(2),this.format.bitsPerChannel=this.stream.readUInt16(!0),this.format.bytesPerPacket=this.format.bitsPerChannel/8*this.format.channelsPerFrame,this.emit("format",this.format),this.stream.advance(this.len-16);break;case"data":this.sentDuration||(t=this.format.bitsPerChannel/8,this.emit("duration",this.len/t/this.format.channelsPerFrame/this.format.sampleRate*1e3|0),this.sentDuration=!0),e=this.stream.readSingleBuffer(this.len),this.len-=e.length,this.readHeaders=this.len>0,this.emit("data",e);break;default:if(!this.stream.available(this.len))return;this.stream.advance(this.len)}this.type!=="data"&&(this.readHeaders=!1)}},t}(v.Demuxer);var C,b,m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};C=function(e){function t(){return b=t.__super__.constructor.apply(this,arguments),b}var n,r;return g(t,e),v.Demuxer.register(t),t.probe=function(e){return e.peekString(0,4)===".snd"},n=[8,8,16,24,32,32,64],n[26]=8,r={1:"ulaw",27:"alaw"},t.prototype.readChunk=function(){var e,t,i,s;if(!this.readHeader&&this.stream.available(24)){if(this.stream.readString(4)!==".snd")return this.emit("error","Invalid AU file.");s=this.stream.readUInt32(),t=this.stream.readUInt32(),i=this.stream.readUInt32(),this.format={formatID:r[i]||"lpcm",littleEndian:!1,floatingPoint:i===6||i===7,bitsPerChannel:n[i-1],sampleRate:this.stream.readUInt32(),channelsPerFrame:this.stream.readUInt32(),framesPerPacket:1};if(this.format.bitsPerChannel==null)return this.emit("error","Unsupported encoding in AU file.");this.format.bytesPerPacket=this.format.bitsPerChannel/8*this.format.channelsPerFrame,t!==4294967295&&(e=this.format.bitsPerChannel/8,this.emit("duration",t/e/this.format.channelsPerFrame/this.format.sampleRate*1e3|0)),this.emit("format",this.format),this.readHeader=!0}if(this.readHeader)while(this.stream.available(1))this.emit("data",this.stream.readSingleBuffer(this.stream.remainingBytes()))},t}(v.Demuxer);var k,b,E=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};k=function(e){function t(){return this.readChunk=E(this.readChunk,this),b=t.__super__.constructor.apply(this,arguments),b}return g(t,e),v.Decoder.register("lpcm",t),t.prototype.readChunk=function(){var e,t,n,r,i,s,o,u,a,f,l,c;s=this.stream,n=this.format.littleEndian,e=Math.min(4096,s.remainingBytes()),i=e/(this.format.bitsPerChannel/8)|0;if(e<this.format.bitsPerChannel/8)return null;if(this.format.floatingPoint)switch(this.format.bitsPerChannel){case 32:r=new Float32Array(i);for(t=o=0;o<i;t=o+=1)r[t]=s.readFloat32(n);break;case 64:r=new Float64Array(i);for(t=u=0;u<i;t=u+=1)r[t]=s.readFloat64(n);break;default:throw new Error("Unsupported bit depth.")}else switch(this.format.bitsPerChannel){case 8:r=new Int8Array(i);for(t=a=0;a<i;t=a+=1)r[t]=s.readInt8();break;case 16:r=new Int16Array(i);for(t=f=0;f<i;t=f+=1)r[t]=s.readInt16(n);break;case 24:r=new Int32Array(i);for(t=l=0;l<i;t=l+=1)r[t]=s.readInt24(n);break;case 32:r=new Int32Array(i);for(t=c=0;c<i;t=c+=1)r[t]=s.readInt32(n);break;default:throw new Error("Unsupported bit depth.")}return r},t}(v.Decoder);var L,b,E=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};L=function(e){function t(){return this.readChunk=E(this.readChunk,this),b=t.__super__.constructor.apply(this,arguments),b}var n,r,i,s,o;return g(t,e),v.Decoder.register("ulaw",t),v.Decoder.register("alaw",t),o=128,r=15,s=4,i=112,n=132,t.prototype.init=function(){var e,t,u,a,l,c,h;this.format.bitsPerChannel=16,this.table=a=new Int16Array(256);if(this.format.formatID==="ulaw")for(e=c=0;c<256;e=++c)l=~e,u=((l&r)<<3)+n,u<<=(l&i)>>>s,a[e]=l&o?n-u:u-n;else for(e=h=0;h<256;e=++h)l=e^85,u=l&r,t=(l&i)>>>s,t?u=u+u+1+32<<t+2:u=u+u+1<<3,a[e]=l&o?u:-u},t.prototype.readChunk=function(){var e,t,n,r,i,s;r=this.stream,i=this.table,n=Math.min(4096,this.stream.remainingBytes());if(n===0)return;t=new Int16Array(n);for(e=s=0;s<n;e=s+=1)t[e]=i[r.readUInt8()];return t},t}(v.Decoder);var m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.HTTPSource=function(e){function t(e){this.url=e,this.chunkSize=1<<20,this.inflight=!1,this.reset()}return g(t,e),t.prototype.start=function(){var e=this;return this.length&&!this.inflight?this.loop():(this.inflight=!0,this.xhr=new XMLHttpRequest,this.xhr.onload=function(t){return e.length=parseInt(e.xhr.getResponseHeader("Content-Length")),e.inflight=!1,e.loop()},this.xhr.onerror=function(t){return e.pause(),e.emit("error",t)},this.xhr.onabort=function(t){return e.inflight=!1},this.xhr.open("HEAD",this.url,!0),this.xhr.send(null))},t.prototype.loop=function(){var e,t=this;return this.inflight||!this.length?this.emit("error","Something is wrong in HTTPSource.loop"):(this.inflight=!0,this.xhr=new XMLHttpRequest,this.xhr.onload=function(e){var n,r,i,s,o,u;if(t.xhr.response)n=new Uint8Array(t.xhr.response);else{s=t.xhr.responseText,n=new Uint8Array(s.length);for(i=o=0,u=s.length;0<=u?o<u:o>u;i=0<=u?++o:--o)n[i]=s.charCodeAt(i)&255}r=new v.Buffer(n),t.offset+=r.length,t.emit("data",r),t.offset>=t.length&&t.emit("end"),t.inflight=!1;if(!(t.offset>=t.length))return t.loop()},this.xhr.onprogress=function(e){return t.emit("progress",(t.offset+e.loaded)/t.length*100)},this.xhr.onerror=function(e){return t.emit("error",e),t.pause()},this.xhr.onabort=function(e){return t.inflight=!1},this.xhr.open("GET",this.url,!0),this.xhr.responseType="arraybuffer",e=Math.min(this.offset+this.chunkSize,this.length),this.xhr.setRequestHeader("Range","bytes="+this.offset+"-"+e),this.xhr.overrideMimeType("text/plain; charset=x-user-defined"),this.xhr.send(null))},t.prototype.pause=function(){var e;return this.inflight=!1,(e=this.xhr)!=null?e.abort():void 0},t.prototype.reset=function(){return this.pause(),this.offset=0},t}(v.EventEmitter);var m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};v.FileSource=function(e){function t(e){this.file=e;if(typeof FileReader=="undefined"||FileReader===null)return this.emit("error","This browser does not have FileReader support.");this.offset=0,this.length=this.file.size,this.chunkSize=1<<20,this.file[this.slice="slice"]||this.file[this.slice="webkitSlice"]||this.file[this.slice="mozSlice"]}return g(t,e),t.prototype.start=function(){var e=this;return this.reader&&!this.active?this.loop():(this.reader=new FileReader,this.active=!0,this.reader.onload=function(t){var n;n=new v.Buffer(new Uint8Array(t.target.result)),e.offset+=n.length,e.emit("data",n),e.active=!1;if(e.offset<e.length)return e.loop()},this.reader.onloadend=function(){if(e.offset===e.length)return e.emit("end"),e.reader=null},this.reader.onerror=function(t){return e.emit("error",t)},this.reader.onprogress=function(t){return e.emit("progress",(e.offset+t.loaded)/e.length*100)},this.loop())},t.prototype.loop=function(){var e,t;return this.active=!0,t=Math.min(this.offset+this.chunkSize,this.length),e=this.file[this.slice](this.offset,t),this.reader.readAsArrayBuffer(e)},t.prototype.pause=function(){var e;return this.active=!1,(e=this.reader)!=null?e.abort():void 0},t.prototype.reset=function(){return this.pause(),this.offset=0},t}(v.EventEmitter),e.prototype.initialize=function(){if(!(this.fromSampleRate>0&&this.toSampleRate>0&&this.channels>0))throw new Error("Invalid settings specified for the resampler.");this.fromSampleRate==this.toSampleRate?(this.resampler=this.bypassResampler,this.ratioWeight=1):(this.fromSampleRate<this.toSampleRate?(this.compileLinearInterpolationFunction(),this.lastWeight=1):(this.compileMultiTapFunction(),this.tailExists=!1,this.lastWeight=0),this.ratioWeight=this.fromSampleRate/this.toSampleRate,this.initializeBuffers())},e.prototype.compileLinearInterpolationFunction=function(){var e="var bufferLength = buffer.length;  var outLength = this.outputBufferSize;  if ((bufferLength % "+this.channels+") == 0) {    if (bufferLength > 0) {     var ratioWeight = this.ratioWeight;     var weight = this.lastWeight;     var firstWeight = 0;      var secondWeight = 0;     var sourceOffset = 0;     var outputOffset = 0;     var outputBuffer = this.outputBuffer;     for (; weight < 1; weight += ratioWeight) {       secondWeight = weight % 1;        firstWeight = 1 - secondWeight;";for(var t=0;t<this.channels;++t)e+="outputBuffer[outputOffset++] = (this.lastOutput["+t+"] * firstWeight) + (buffer["+t+"] * secondWeight);";e+="}      weight -= 1;      for (bufferLength -= "+this.channels+", sourceOffset = Math.floor(weight) * "+this.channels+"; outputOffset < outLength && sourceOffset < bufferLength;) {        secondWeight = weight % 1;        firstWeight = 1 - secondWeight;";for(var t=0;t<this.channels;++t)e+="outputBuffer[outputOffset++] = (buffer[sourceOffset"+(t>0?" + "+t:"")+"] * firstWeight) + (buffer[sourceOffset + "+(this.channels+t)+"] * secondWeight);";e+="weight += ratioWeight;        sourceOffset = Math.floor(weight) * "+this.channels+";      }";for(var t=0;t<this.channels;++t)e+="this.lastOutput["+t+"] = buffer[sourceOffset++];";e+='this.lastWeight = weight % 1;     return this.bufferSlice(outputOffset);    }   else {      return (this.noReturn) ? 0 : [];    } } else {    throw(new Error("Buffer was of incorrect sample length.")); }',this.resampler=Function("buffer",e)},e.prototype.compileMultiTapFunction=function(){var e="var bufferLength = buffer.length; var outLength = this.outputBufferSize;  if ((bufferLength % "+this.channels+") == 0) {    if (bufferLength > 0) {     var ratioWeight = this.ratioWeight;     var weight = 0;";for(var t=0;t<this.channels;++t)e+="var output"+t+" = 0;";e+="var actualPosition = 0;     var amountToNext = 0;     var alreadyProcessedTail = !this.tailExists;      this.tailExists = false;      var outputBuffer = this.outputBuffer;     var outputOffset = 0;     var currentPosition = 0;      do {        if (alreadyProcessedTail) {         weight = ratioWeight;";for(t=0;t<this.channels;++t)e+="output"+t+" = 0;";e+="}       else {          weight = this.lastWeight;";for(t=0;t<this.channels;++t)e+="output"+t+" = this.lastOutput["+t+"];";e+="alreadyProcessedTail = true;       }       while (weight > 0 && actualPosition < bufferLength) {         amountToNext = 1 + actualPosition - currentPosition;          if (weight >= amountToNext) {";for(t=0;t<this.channels;++t)e+="output"+t+" += buffer[actualPosition++] * amountToNext;";e+="currentPosition = actualPosition;            weight -= amountToNext;         }         else {";for(t=0;t<this.channels;++t)e+="output"+t+" += buffer[actualPosition"+(t>0?" + "+t:"")+"] * weight;";e+="currentPosition += weight;            weight = 0;           break;          }       }       if (weight == 0) {";for(t=0;t<this.channels;++t)e+="outputBuffer[outputOffset++] = output"+t+" / ratioWeight;";e+="}       else {          this.lastWeight = weight;";for(t=0;t<this.channels;++t)e+="this.lastOutput["+t+"] = output"+t+";";e+='this.tailExists = true;          break;        }     } while (actualPosition < bufferLength && outputOffset < outLength);      return this.bufferSlice(outputOffset);    }   else {      return (this.noReturn) ? 0 : [];    } } else {    throw(new Error("Buffer was of incorrect sample length.")); }',this.resampler=Function("buffer",e)},e.prototype.bypassResampler=function(e){return this.noReturn?(this.outputBuffer=e,e.length):e},e.prototype.bufferSlice=function(e){if(this.noReturn)return e;try{return this.outputBuffer.subarray(0,e)}catch(t){try{return this.outputBuffer.length=e,this.outputBuffer}catch(t){return this.outputBuffer.slice(0,e)}}},e.prototype.initializeBuffers=function(){try{this.outputBuffer=new Float32Array(this.outputBufferSize),this.lastOutput=new Float32Array(this.channels)}catch(e){this.outputBuffer=[],this.lastOutput=[]}};var A,E=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};A=function(t){function n(t,n){this.sampleRate=t,this.channels=n,this.refill=E(this.refill,this),this.context=s!=null?s:s=new r,this.deviceSampleRate=this.context.sampleRate,this.bufferSize=Math.ceil(4096/(this.deviceSampleRate/this.sampleRate)*this.channels),this.bufferSize+=this.bufferSize%this.channels,this.deviceSampleRate!==this.sampleRate&&(this.resampler=new e(this.sampleRate,this.deviceSampleRate,this.channels,4096*this.channels)),this.node=this.context[i](4096,this.channels,this.channels),this.node.onaudioprocess=this.refill,this.node.connect(this.context.destination)}var r,i,s;return g(n,t),v.AudioDevice.register(n),r=d.AudioContext||d.webkitAudioContext,n.supported=r&&(typeof r.prototype[i="createScriptProcessor"]=="function"||typeof r.prototype[i="createJavaScriptNode"]=="function"),s=null,n.prototype.refill=function(e){var t,n,r,i,s,o,u,a,f,l;o=e.outputBuffer,t=o.numberOfChannels,n=new Array(t);for(i=u=0;u<t;i=u+=1)n[i]=o.getChannelData(i);r=new Float32Array(this.bufferSize),this.emit("refill",r),this.resampler&&(r=this.resampler.resampler(r));for(i=a=0,l=o.length;a<l;i=a+=1)for(s=f=0;f<t;s=f+=1)n[s][i]=r[i*t+s]},n.prototype.destroy=function(){return this.node.disconnect(0)},n.prototype.getDeviceTime=function(){return this.context.currentTime*this.sampleRate},n}(v.EventEmitter);var O,E=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,g=function(e,t){function n(){this.constructor=e}for(var r in t)m.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};O=function(e){function t(e,t){this.sampleRate=e,this.channels=t,this.refill=E(this.refill,this),this.audio=new Audio,this.audio.mozSetup(this.channels,this.sampleRate),this.writePosition=0,this.prebufferSize=this.sampleRate/2,this.tail=null,this.timer=n(this.refill,100)}var n,r;return g(t,e),v.AudioDevice.register(t),t.supported=typeof Audio!="undefined"&&Audio!==null&&"mozWriteAudio"in new Audio,t.prototype.refill=function(){var e,t,n,r;this.tail&&(r=this.audio.mozWriteAudio(this.tail),this.writePosition+=r,this.writePosition<this.tail.length?this.tail=this.tail.subarray(r):this.tail=null),n=this.audio.mozCurrentSampleOffset(),e=n+this.prebufferSize-this.writePosition,e>0&&(t=new Float32Array(e),this.emit("refill",t),r=this.audio.mozWriteAudio(t),r<t.length&&(this.tail=t.subarray(r)),this.writePosition+=r)},t.prototype.destroy=function(){return r(this.timer)},t.prototype.getDeviceTime=function(){return this.audio.mozCurrentSampleOffset()/this.channels},n=function(e,t){var n,r;return n=v.Buffer.makeBlobURL("setInterval(function() { postMessage('ping'); }, "+t+");"),n==null?setInterval(e,t):(r=new Worker(n),r.onmessage=e,r.url=n,r)},r=function(e){return e.terminate?(e.terminate(),URL.revokeObjectURL(e.url)):clearInterval(e)},t}(v.EventEmitter);const M=["latin1","utf16-bom","utf16-be","utf8"];var _=v.Base.extend({constructor:function(e,t){this.header=e,this.stream=t,this.offset=0},read:function(){if(!this.data){this.data={};var e;while(e=this.readFrame())e.key in this.data?(Array.isArray(this.data[e.key])||(this.data[e.key]=[this.data[e.key]]),this.data[e.key].push(e.value)):this.data[e.key]=e.value}return this.data},readFrame:function(){if(this.offset>=this.header.length)return null;var e=this.readHeader(),t=e.identifier;if(e.identifier.charCodeAt(0)===0)return this.offset+=this.header.length+1,null;if(!this.frameTypes[t])for(var n in this.map)if(this.map[n].indexOf(t)!==-1){t=n;break}if(this.frameTypes[t]){var r=this.decodeFrame(e,this.frameTypes[t]),i=Object.keys(r);i.length===1&&(r=r[i[0]]);var s={value:r}}else var s={value:this.stream.readBuffer(Math.min(e.length,this.header.length-this.offset))};return s.key=this.names[e.identifier]?this.names[e.identifier]:e.identifier,s.key==="coverArt"&&(s.value=s.value.data),this.offset+=10+e.length,s},decodeFrame:function(e,t){var n=this.stream,r=n.offset,i=0,s={},o=Object.keys(t).length,u=0;for(var a in t){var f=t[a],l=e.length-(n.offset-r);u++;switch(a){case"encoding":i=n.readUInt8();continue;case"language":s.language=n.readString(3);continue}switch(f){case"latin1":s[a]=n.readString(u===o?l:null,"latin1");break;case"string":s[a]=n.readString(u===o?l:null,M[i]);break;case"binary":s[a]=n.readBuffer(l);break;case"int16":s[a]=n.readInt16();break;case"int8":s[a]=n.readInt8();break;case"int24":s[a]=n.readInt24();break;case"int32":s[a]=n.readInt32();break;case"int32+":s[a]=n.readInt32();if(l>4)throw new Error("Seriously dude? Stop playing this song and get a life!");break;case"date":var c=n.readString(8);s[a]=new Date(c.slice(0,4),c.slice(4,6)-1,c.slice(6,8));break;case"frame_id":s[a]=n.readString(4);break;default:throw new Error("Unknown key type "+f)}}var l=e.length-(n.offset-r);return l>0&&n.advance(l),s}}),D=_.extend({readHeader:function(){var e=this.stream.readString(4),t=0;if(this.header.major===4)for(var n=0;n<4;n++)t=(t<<7)+(this.stream.readUInt8()&127);else t=this.stream.readUInt32();return{identifier:e,length:t,flags:this.stream.readUInt16()}},map:{text:["TIT1","TIT2","TIT3","TALB","TOAL","TRCK","TPOS","TSST","TSRC","TPE1","TPE2","TPE3","TPE4","TOPE","TEXT","TOLY","TCOM","TMCL","TIPL","TENC","TBPM","TLEN","TKEY","TLAN","TCON","TFLT","TMED","TMOO","TCOP","TPRO","TPUB","TOWN","TRSN","TRSO","TOFN","TDLY","TDEN","TDOR","TDRC","TDRL","TDTG","TSSE","TSOA","TSOP","TSOT","TDAT","TIME","TORY","TRDA","TSIZ","TYER","TCMP","TSO2","TSOC"],url:["WCOM","WCOP","WOAF","WOAR","WOAS","WORS","WPAY","WPUB"]},frameTypes:{text:{encoding:1,value:"string"},url:{value:"latin1"},TXXX:{encoding:1,description:"string",value:"string"},WXXX:{encoding:1,description:"string",value:"latin1"},USLT:{encoding:1,language:1,description:"string",value:"string"},COMM:{encoding:1,language:1,description:"string",value:"string"},APIC:{encoding:1,mime:"latin1",type:"int8",description:"string",data:"binary"},UFID:{owner:"latin1",identifier:"binary"},MCDI:{value:"binary"},PRIV:{owner:"latin1",value:"binary"},GEOB:{encoding:1,mime:"latin1",filename:"string",description:"string",data:"binary"},PCNT:{value:"int32+"},POPM:{email:"latin1",rating:"int8",counter:"int32+"},AENC:{owner:"latin1",previewStart:"int16",previewLength:"int16",encryptionInfo:"binary"},ETCO:{format:"int8",data:"binary"},MLLT:{framesBetweenReference:"int16",bytesBetweenReference:"int24",millisecondsBetweenReference:"int24",bitsForBytesDeviation:"int8",bitsForMillisecondsDev:"int8",data:"binary"},SYTC:{format:"int8",tempoData:"binary"},SYLT:{encoding:1,language:1,format:"int8",contentType:"int8",description:"string",data:"binary"},RVA2:{identification:"latin1",data:"binary"},EQU2:{interpolationMethod:"int8",identification:"latin1",data:"binary"},RVRB:{left:"int16",right:"int16",bouncesLeft:"int8",bouncesRight:"int8",feedbackLL:"int8",feedbackLR:"int8",feedbackRR:"int8",feedbackRL:"int8",premixLR:"int8",premixRL:"int8"},RBUF:{size:"int24",flag:"int8",offset:"int32"},LINK:{identifier:"frame_id",url:"latin1",data:"binary"},POSS:{format:"int8",position:"binary"},USER:{encoding:1,language:1,value:"string"},OWNE:{encoding:1,price:"latin1",purchaseDate:"date",seller:"string"},COMR:{encoding:1,price:"latin1",validUntil:"date",contactURL:"latin1",receivedAs:"int8",seller:"string",description:"string",logoMime:"latin1",logo:"binary"},ENCR:{owner:"latin1",methodSymbol:"int8",data:"binary"},GRID:{owner:"latin1",groupSymbol:"int8",data:"binary"},SIGN:{groupSymbol:"int8",signature:"binary"},SEEK:{value:"int32"},ASPI:{dataStart:"int32",dataLength:"int32",numPoints:"int16",bitsPerPoint:"int8",data:"binary"},IPLS:{encoding:1,value:"string"},RVAD:{adjustment:"int8",bits:"int8",data:"binary"},EQUA:{adjustmentBits:"int8",data:"binary"}},names:{TIT1:"grouping",TIT2:"title",TIT3:"subtitle",TALB:"album",TOAL:"originalAlbumTitle",TRCK:"trackNumber",TPOS:"diskNumber",TSST:"setSubtitle",TSRC:"ISRC",TPE1:"artist",TPE2:"albumArtist",TPE3:"conductor",TPE4:"modifiedBy",TOPE:"originalArtist",TEXT:"lyricist",TOLY:"originalLyricist",TCOM:"composer",TMCL:"musicianCreditsList",TIPL:"involvedPeopleList",TENC:"encodedBy",TBPM:"tempo",TLEN:"length",TKEY:"initialKey",TLAN:"language",TCON:"genre",TFLT:"fileType",TMED:"mediaType",TMOO:"mood",TCOP:"copyright",TPRO:"producedNotice",TPUB:"publisher",TOWN:"fileOwner",TRSN:"internetRadioStationName",TRSO:"internetRadioStationOwner",TOFN:"originalFilename",TDLY:"playlistDelay",TDEN:"encodingTime",TDOR:"originalReleaseTime",TDRC:"recordingTime",TDRL:"releaseTime",TDTG:"taggingTime",TSSE:"encodedWith",TSOA:"albumSortOrder",TSOP:"performerSortOrder",TSOT:"titleSortOrder",TXXX:"userText",USLT:"lyrics",APIC:"coverArt",UFID:"uniqueIdentifier",MCDI:"CDIdentifier",COMM:"comments",WCOM:"commercialInformation",WCOP:"copyrightInformation",WOAF:"officialAudioFileWebpage",WOAR:"officialArtistWebpage",WOAS:"officialAudioSourceWebpage",WORS:"officialInternetRadioStationHomepage",WPAY:"payment",WPUB:"officialPublisherWebpage",WXXX:"url",PRIV:"private",GEOB:"generalEncapsulatedObject",PCNT:"playCount",POPM:"rating",AENC:"audioEncryption",ETCO:"eventTimingCodes",MLLT:"MPEGLocationLookupTable",SYTC:"synchronisedTempoCodes",SYLT:"synchronisedLyrics",RVA2:"volumeAdjustment",EQU2:"equalization",RVRB:"reverb",RBUF:"recommendedBufferSize",LINK:"link",POSS:"positionSynchronisation",USER:"termsOfUse",OWNE:"ownership",COMR:"commercial",ENCR:"encryption",GRID:"groupIdentifier",SIGN:"signature",SEEK:"seek",ASPI:"audioSeekPointIndex",TDAT:"date",TIME:"time",TORY:"originalReleaseYear",TRDA:"recordingDates",TSIZ:"size",TYER:"year",IPLS:"involvedPeopleList",RVAD:"volumeAdjustment",EQUA:"equalization",TCMP:"compilation",TSO2:"albumArtistSortOrder",TSOC:"composerSortOrder"}}),P=D.extend({readHeader:function(){var e=this.stream.readString(3);return this.frameReplacements[e]&&!this.frameTypes[e]&&(this.frameTypes[e]=this.frameReplacements[e]),{identifier:this.replacements[e]||e,length:this.stream.readUInt24()}},replacements:{UFI:"UFID",TT1:"TIT1",TT2:"TIT2",TT3:"TIT3",TP1:"TPE1",TP2:"TPE2",TP3:"TPE3",TP4:"TPE4",TCM:"TCOM",TXT:"TEXT",TLA:"TLAN",TCO:"TCON",TAL:"TALB",TPA:"TPOS",TRK:"TRCK",TRC:"TSRC",TYE:"TYER",TDA:"TDAT",TIM:"TIME",TRD:"TRDA",TMT:"TMED",TFT:"TFLT",TBP:"TBPM",TCR:"TCOP",TPB:"TPUB",TEN:"TENC",TSS:"TSSE",TOF:"TOFN",TLE:"TLEN",TSI:"TSIZ",TDY:"TDLY",TKE:"TKEY",TOT:"TOAL",TOA:"TOPE",TOL:"TOLY",TOR:"TORY",TXX:"TXXX",WAF:"WOAF",WAR:"WOAR",WAS:"WOAS",WCM:"WCOM",WCP:"WCOP",WPB:"WPUB",WXX:"WXXX",IPL:"IPLS",MCI:"MCDI",ETC:"ETCO",MLL:"MLLT",STC:"SYTC",ULT:"USLT",SLT:"SYLT",COM:"COMM",RVA:"RVAD",EQU:"EQUA",REV:"RVRB",GEO:"GEOB",CNT:"PCNT",POP:"POPM",BUF:"RBUF",CRA:"AENC",LNK:"LINK",TST:"TSOT",TSP:"TSOP",TSA:"TSOA",TCP:"TCMP",TS2:"TSO2",TSC:"TSOC"},frameReplacements:{PIC:{encoding:1,format:"int24",type:"int8",description:"string",data:"binary"},CRM:{owner:"latin1",description:"latin1",data:"binary"}}}),H=v.Demuxer.extend(function(){v.Demuxer.register(this),this.probe=function(e){var r=e.offset,i=H.getID3v2Header(e);i&&e.advance(10+i.length);var s=new t(new v.Bitstream(e)),o=null;try{o=n.decode(s)}catch(u){}return e.seek(r),!!o},this.getID3v2Header=function(e){if(e.peekString(0,3)=="ID3"){e=v.Stream.fromBuffer(e.peekBuffer(0,10)),e.advance(3);var t=e.readUInt8(),n=e.readUInt8(),r=e.readUInt8(),i=e.readBuffer(4).data,s=i[0]<<21|i[1]<<14|i[2]<<7|i[3];return{version:"2."+t+"."+n,major:t,minor:n,flags:r,length:s}}return null};const e=[[32,17],[17,9]];this.prototype.parseDuration=function(t){var n=this.stream,r,i=n.offset;if(!t||t.layer!==3)return!1;n.advance(e[t.flags&F.LSF_EXT?1:0][t.nchannels()===1?1:0]);var s=n.readString(4);if(s==="Xing"||s==="Info"){var o=n.readUInt32();o&1&&(r=n.readUInt32());if(o&2)var u=n.readUInt32();if(o&4&&r&&u)for(var a=0;a<100;a++){var f=n.readUInt8(),l=f/256*u|0,c=a/100*r*t.nbsamples()*32|0;this.addSeekPoint(l,c)}o&8&&n.advance(4)}else{n.seek(i+4+32),s=n.readString(4);if(s=="VBRI"&&n.readUInt16()===1){n.advance(4),n.advance(4),r=n.readUInt32();var h=n.readUInt16(),p=n.readUInt16(),d=n.readUInt16(),v=n.readUInt16(),m="readUInt"+d*8,l=0;for(var a=0;a<h;a++)this.addSeekPoint(l,v*a),l+=n[m]()}}return r?(this.emit("duration",r*t.nbsamples()*32/t.samplerate*1e3|0),!0):!1},this.prototype.readChunk=function(){var e=this.stream;if(!this.sentInfo){var r=H.getID3v2Header(e);if(r){e.advance(10);if(r.major>2)var i=new D(r,e);else var i=new P(r,e);this.emit("metadata",i.read())}var s=e.offset,o=new t(new v.Bitstream(e)),u=n.decode(o);if(!u)return this.emit("error","Could not find first frame.");this.emit("format",{formatID:"mp3",sampleRate:u.samplerate,channelsPerFrame:u.nchannels(),bitrate:u.bitrate,floatingPoint:!0});var a=this.parseDuration(u);e.advance(s-e.offset),this.dataSize=0,a||this.on("end",function(){this.emit("duration",this.dataSize*8/u.bitrate*1e3|0)}),this.sentInfo=!0}while(e.available(1)){var f=e.readSingleBuffer(e.remainingBytes());this.dataSize+=f.length,this.emit("data",f)}}});t.prototype.getU8=function(e){var t=this.stream.stream;return t.peekUInt8(e-t.offset)},t.prototype.nextByte=function(){var e=this.stream;return e.bitPosition===0?e.stream.offset:e.stream.offset+1},t.prototype.doSync=function(){var e=this.stream.stream;this.align();while(this.available(16)&&(e.peekUInt8(0)!==255||(e.peekUInt8(1)&224)!==224))this.advance(8);return this.available(U)?!0:!1},t.prototype.reset=function(e){this.seek(e*8),this.next_frame=e,this.sync=!0};const B=[[0,32e3,64e3,96e3,128e3,16e4,192e3,224e3,256e3,288e3,32e4,352e3,384e3,416e3,448e3],[0,32e3,48e3,56e3,64e3,8e4,96e3,112e3,128e3,16e4,192e3,224e3,256e3,32e4,384e3],[0,32e3,4e4,48e3,56e3,64e3,8e4,96e3,112e3,128e3,16e4,192e3,224e3,256e3,32e4],[0,32e3,48e3,56e3,64e3,8e4,96e3,112e3,128e3,144e3,16e4,176e3,192e3,224e3,256e3],[0,8e3,16e3,24e3,32e3,4e4,48e3,56e3,64e3,8e4,96e3,112e3,128e3,144e3,16e4]],j=[44100,48e3,32e3],F={NPRIVATE_III:7,INCOMPLETE:8,PROTECTION:16,COPYRIGHT:32,ORIGINAL:64,PADDING:128,I_STEREO:256,MS_STEREO:512,FREEFORMAT:1024,LSF_EXT:4096,MC_EXT:8192,MPEG_2_5_EXT:16384},I={HEADER:256,III:31},q={SINGLE_CHANNEL:0,DUAL_CHANNEL:1,JOINT_STEREO:2,STEREO:3},R={NONE:0,_50_15_US:1,CCITT_J_17:3,RESERVED:2},U=8,z=2559+U;n.prototype.copy=function(){var e=new n,t=Object.keys(this);for(var r in t)e[r]=this[r];return e},n.prototype.nchannels=function(){return this.mode===0?1:2},n.prototype.nbsamples=function(){return this.layer===1?12:this.layer===3&&this.flags&F.LSF_EXT?18:36},n.prototype.framesize=function(){if(this.bitrate===0)return null;var e=this.flags&F.PADDING?1:0;switch(this.layer){case 1:var t=this.bitrate*12/this.samplerate|0;return(t+e)*4;case 2:var t=this.bitrate*144/this.samplerate|0;return t+e;case 3:default:var n=this.flags&F.LSF_EXT?1:0,t=this.bitrate*144/(this.samplerate<<n)|0;return t+e}},n.prototype.decode=function(e){this.flags=0,this.private_bits=0,e.advance(11),e.read(1)===0&&(this.flags|=F.MPEG_2_5_EXT);if(e.read(1)===0)this.flags|=F.LSF_EXT;else if(this.flags&F.MPEG_2_5_EXT)throw new v.UnderflowError;this.layer=4-e.read(2);if(this.layer===4)throw new Error("Invalid layer");e.read(1)===0&&(this.flags|=F.PROTECTION);var t=e.read(4);if(t===15)throw new Error("Invalid bitrate");this.flags&F.LSF_EXT?this.bitrate=B[3+(this.layer>>1)][t]:this.bitrate=B[this.layer-1][t],t=e.read(2);if(t===3)throw new Error("Invalid sampling frequency");this.samplerate=j[t],this.flags&F.LSF_EXT&&(this.samplerate/=2,this.flags&F.MPEG_2_5_EXT&&(this.samplerate/=2)),e.read(1)&&(this.flags|=F.PADDING),e.read(1)&&(this.private_bits|=I.HEADER),this.mode=3-e.read(2),this.mode_extension=e.read(2),e.read(1)&&(this.flags|=F.COPYRIGHT),e.read(1)&&(this.flags|=F.ORIGINAL),this.emphasis=e.read(2),this.flags&F.PROTECTION&&(this.crc_target=e.read(16))},n.decode=function(e){var t=e.next_frame,r=!0,i=null;while(r){r=!1;if(e.sync){if(!e.available(U))throw e.next_frame=t,new v.UnderflowError;if(e.getU8(t)!==255||(e.getU8(t+1)&224)!==224)throw e.this_frame=t,e.next_frame=t+1,new v.UnderflowError}else{e.seek(t*8);if(!e.doSync())throw new v.UnderflowError;t=e.nextByte()}e.this_frame=t,e.next_frame=t+1,e.seek(e.this_frame*8),i=new n,i.decode(e),i.bitrate===0&&((e.freerate===0||!e.sync||i.layer===3&&e.freerate>64e4)&&n.free_bitrate(e,i),i.bitrate=e.freerate,i.flags|=F.FREEFORMAT);var s=i.flags&F.PADDING?1:0;if(i.layer===1)var o=((12*i.bitrate/i.samplerate<<0)+s)*4;else var u=i.layer===3&&i.flags&F.LSF_EXT?72:144,o=(u*i.bitrate/i.samplerate<<0)+s;if(!e.available(o+U))throw e.next_frame=e.this_frame,new v.UnderflowError;e.next_frame=e.this_frame+o;if(!e.sync){t=e.next_frame;if(e.getU8(t)!==255||(e.getU8(t+1)&224)!==224){t=e.next_frame=e.this_frame+1,r=!0;continue}e.sync=!0}}return i.flags|=F.INCOMPLETE,i},n.free_bitrate=function(e,t){var n=t.flags&F.PADDING?1:0,r=t.layer===3&&t.flags&F.LSF_EXT?72:144,i=e.offset(),s=0;while(e.doSync()){var o=t.copy(),u=e.copy();if(o.decode(u)&&o.layer===t.layer&&o.samplerate===t.samplerate){var a=e.nextByte()-e.this_frame;t.layer===1?s=t.samplerate*(a-4*n+4)/48/1e3|0:s=t.samplerate*(a-n+1)/r/1e3|0;if(s>=8)break}e.advance(8)}e.seek(i);if(s<8||t.layer===3&&s>640)throw new v.UnderflowError;e.freerate=s*1e3},r.layers=[],r.prototype.decode=function(e){if(!this.header||!(this.header.flags&F.INCOMPLETE))this.header=n.decode(e);this.header.flags&=~F.INCOMPLETE;var t=this.decoders[this.header.layer-1];if(!t){var i=r.layers[this.header.layer];if(!i)throw new Error("Layer "+this.header.layer+" is not supported.");t=this.decoders[this.header.layer-1]=new i}t.decode(e,this)};const W=.998795456,X=.995184727,V=.98917651,$=.98078528,J=.970031253,K=.956940336,Q=.941544065,G=.923879533,Y=.903989293,Z=.881921264,et=.85772861,tt=.831469612,nt=.803207531,rt=.773010453,it=.740951125,st=.707106781,ot=.671558955,ut=.634393284,at=.595699304,ft=.555570233,lt=.514102744,ct=.471396737,ht=.427555093,pt=.382683432,dt=.336889853,vt=.290284677,mt=.24298018,gt=.195090322,yt=.146730474,bt=.09801714,wt=.049067674;s.dct32=function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt,Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,Kt,Qt,Gt,Yt,Zt,en,tn,nn,rn,sn,on,un,an,fn,ln,cn,hn,pn,dn,vn,mn,gn,yn,bn,wn,En,Sn,xn,Tn,Nn,Cn,kn,Ln,An,On,Mn,_n,Dn,Pn,Hn,Bn,jn,Fn,In,qn,Rn,Un,zn,Wn,Xn,Vn,$n,Jn,Kn,Qn,Gn,Yn,Zn,er,tr,nr,rr,ir,sr,or,ur,ar,fr,lr,cr,hr,pr,dr,vr,mr,gr,yr,br,wr,Er,Sr,xr,Tr,Nr,Cr,kr,Lr,Ar,Or,Mr,_r,Dr,Pr,Hr,Br,jr,Fr,Ir,qr,Rr,Ur,zr,Wr,Xr,Vr,$r,Jr,Kr,Qr;i=e[0]+e[31],w=(e[0]-e[31])*W,s=e[15]+e[16],E=(e[15]-e[16])*wt,St=w+E,qt=(w-E)*X,j=i+s,Mt=(i-s)*X,o=e[7]+e[24],S=(e[7]-e[24])*it,u=e[8]+e[23],x=(e[8]-e[23])*ot,xt=S+x,Rt=(S-x)*bt,F=o+u,_t=(o-u)*bt,a=e[3]+e[28],T=(e[3]-e[28])*Q,f=e[12]+e[19],N=(e[12]-e[19])*dt,Tt=T+N,Ut=(T-N)*rt,I=a+f,Dt=(a-f)*rt,l=e[4]+e[27],C=(e[4]-e[27])*Y,c=e[11]+e[20],k=(e[11]-e[20])*ht,Nt=C+k,zt=(C-k)*ut,q=l+c,Pt=(l-c)*ut,h=e[1]+e[30],L=(e[1]-e[30])*V,p=e[14]+e[17],A=(e[14]-e[17])*yt,Ct=L+A,Wt=(L-A)*K,R=h+p,Ht=(h-p)*K,d=e[6]+e[25],O=(e[6]-e[25])*nt,v=e[9]+e[22],M=(e[9]-e[22])*at,kt=O+M,Xt=(O-M)*vt,U=d+v,Bt=(d-v)*vt,m=e[2]+e[29],_=(e[2]-e[29])*J,g=e[13]+e[18],D=(e[13]-e[18])*mt,Lt=_+D,Vt=(_-D)*Z,z=m+g,jt=(m-g)*Z,y=e[5]+e[26],P=(e[5]-e[26])*et,b=e[10]+e[21],H=(e[10]-e[21])*lt,At=P+H,$t=(P-H)*ct,Et=y+b,Ft=(y-b)*ct,Qt=j+F,gn=(j-F)*$,Gt=I+q,yn=(I-q)*gt,Yt=R+U,bn=(R-U)*tt,Zt=z+Et,wn=(z-Et)*ft,en=St+xt,Sn=(St-xt)*$,tn=Tt+Nt,xn=(Tt-Nt)*gt,nn=Ct+kt,Tn=(Ct-kt)*tt,rn=Lt+At,Nn=(Lt-At)*ft,on=Mt+_t,Ln=(Mt-_t)*$,un=Dt+Pt,An=(Dt-Pt)*gt,an=Ht+Bt,On=(Ht-Bt)*tt,fn=jt+Ft,Mn=(jt-Ft)*ft,cn=qt+Rt,Pn=(qt-Rt)*$,hn=Ut+zt,Hn=(Ut-zt)*gt,pn=Wt+Xt,Bn=(Wt-Xt)*tt,dn=Vt+$t,jn=(Vt-$t)*ft,Rn=Qt+Gt,Un=Yt+Zt,r[15][t]=Rn+Un,n[0][t]=(Rn-Un)*st,zn=en+tn,Wn=nn+rn,B=zn+Wn,r[14][t]=B,Vn=on+un,$n=an+fn,It=Vn+$n,r[13][t]=It,Kn=cn+hn,Qn=pn+dn,Jt=Kn+Qn,Ot=Jt*2-B,r[12][t]=Ot,Zn=gn+yn,er=bn+wn,En=Zn+er,r[11][t]=En,nr=Sn+xn,rr=Tn+Nn,Cn=nr+rr,Kt=Cn*2-Ot,r[10][t]=Kt,or=Ln+An,ur=On+Mn,_n=or+ur,ln=_n*2-It,r[9][t]=ln,lr=Pn+Hn,cr=Bn+jn,Fn=lr+cr,vn=Fn*2-Jt,sn=vn*2-Kt,r[8][t]=sn,vr=(Qt-Gt)*G,mr=(Yt-Zt)*pt,gr=vr+mr,r[7][t]=gr,n[8][t]=(vr-mr)*st*2-gr,yr=(en-tn)*G,br=(nn-rn)*pt,wr=yr+br,mn=wr*2-sn,r[6][t]=mn,Sr=(on-un)*G,xr=(an-fn)*pt,Tr=Sr+xr,Dn=Tr*2-ln,r[5][t]=Dn,Cr=(cn-hn)*G,kr=(pn-dn)*pt,Lr=Cr+kr,In=Lr*2-vn,kn=In*2-mn,r[4][t]=kn,Mr=(gn-yn)*G,_r=(bn-wn)*pt,Dr=Mr+_r,tr=Dr*2-En,r[3][t]=tr,Pr=(Zn-er)*st*2-tr,n[4][t]=Pr,n[12][t]=((Mr-_r)*st*2-Dr)*2-Pr,Hr=(Sn-xn)*G,Br=(Tn-Nn)*pt,jr=Hr+Br,ir=jr*2-Cn,qn=ir*2-kn,r[2][t]=qn,Fr=(nr-rr)*st*2-ir,qr=(Ln-An)*G,Rr=(On-Mn)*pt,Ur=qr+Rr,ar=Ur*2-_n,Jn=ar*2-Dn,r[1][t]=Jn,fr=(Vn-$n)*st*2-Jn,n[2][t]=fr,zr=(or-ur)*st*2-ar,Nr=zr*2-fr,n[6][t]=Nr,Wr=((Sr-xr)*st*2-Tr)*2-Nr,n[10][t]=Wr,n[14][t]=(((qr-Rr)*st*2-Ur)*2-zr)*2-Wr,Xr=(Pn-Hn)*G,Vr=(Bn-jn)*pt,$r=Xr+Vr,hr=$r*2-Fn,Gn=hr*2-In,pr=(Kn-Qn)*st*2-Gn,Xn=Gn*2-qn,r[0][t]=Xn,Yn=(zn-Wn)*st*2-Xn,n[1][t]=Yn,sr=pr*2-Yn,n[3][t]=sr,dr=Fr*2-sr,n[5][t]=dr,Jr=(lr-cr)*st*2-hr,Ar=Jr*2-pr,Er=Ar*2-dr,n[7][t]=Er,Or=((yr-br)*st*2-wr)*2-Er,n[9][t]=Or,Kr=((Cr-kr)*st*2-Lr)*2-Ar,Ir=Kr*2-Or,n[11][t]=Ir,Qr=(((Hr-Br)*st*2-jr)*2-Fr)*2-Ir,n[13][t]=Qr,n[15][t]=((((Xr-Vr)*st*2-$r)*2-Jr)*2-Kr)*2-Qr};const Et=[[0,-0.000442505,.003250122,-0.007003784,.031082153,-0.07862854,.100311279,-0.572036743,1.144989014,.572036743,.100311279,.07862854,.031082153,.007003784,.003250122,442505e-9,0,-0.000442505,.003250122,-0.007003784,.031082153,-0.07862854,.100311279,-0.572036743,1.144989014,.572036743,.100311279,.07862854,.031082153,.007003784,.003250122,442505e-9],[-0.000015259,-0.000473022,.003326416,-0.007919312,.030517578,-0.084182739,.090927124,-0.600219727,1.144287109,.543823242,.108856201,.073059082,.031478882,.006118774,.003173828,396729e-9,-0.000015259,-0.000473022,.003326416,-0.007919312,.030517578,-0.084182739,.090927124,-0.600219727,1.144287109,.543823242,.108856201,.073059082,.031478882,.006118774,.003173828,396729e-9],[-0.000015259,-0.000534058,.003387451,-0.008865356,.029785156,-0.089706421,.080688477,-0.628295898,1.142211914,.515609741,.116577148,.067520142,.031738281,.0052948,.003082275,366211e-9,-0.000015259,-0.000534058,.003387451,-0.008865356,.029785156,-0.089706421,.080688477,-0.628295898,1.142211914,.515609741,.116577148,.067520142,.031738281,.0052948,.003082275,366211e-9],[-0.000015259,-0.000579834,.003433228,-0.009841919,.028884888,-0.095169067,.069595337,-0.656219482,1.138763428,.487472534,.123474121,.06199646,.031845093,.004486084,.002990723,320435e-9,-0.000015259,-0.000579834,.003433228,-0.009841919,.028884888,-0.095169067,.069595337,-0.656219482,1.138763428,.487472534,.123474121,.06199646,.031845093,.004486084,.002990723,320435e-9],[-0.000015259,-0.00062561,.003463745,-0.010848999,.027801514,-0.100540161,.057617187,-0.683914185,1.133926392,.459472656,.129577637,.056533813,.031814575,.003723145,.00289917,289917e-9,-0.000015259,-0.00062561,.003463745,-0.010848999,.027801514,-0.100540161,.057617187,-0.683914185,1.133926392,.459472656,.129577637,.056533813,.031814575,.003723145,.00289917,289917e-9],[-0.000015259,-0.000686646,.003479004,-0.011886597,.026535034,-0.105819702,.044784546,-0.71131897,1.127746582,.431655884,.134887695,.051132202,.031661987,.003005981,.002792358,259399e-9,-0.000015259,-0.000686646,.003479004,-0.011886597,.026535034,-0.105819702,.044784546,-0.71131897,1.127746582,.431655884,.134887695,.051132202,.031661987,.003005981,.002792358,259399e-9],[-0.000015259,-0.000747681,.003479004,-0.012939453,.025085449,-0.110946655,.031082153,-0.738372803,1.120223999,.404083252,.139450073,.045837402,.031387329,.002334595,.002685547,244141e-9,-0.000015259,-0.000747681,.003479004,-0.012939453,.025085449,-0.110946655,.031082153,-0.738372803,1.120223999,.404083252,.139450073,.045837402,.031387329,.002334595,.002685547,244141e-9],[-0.000030518,-0.000808716,.003463745,-0.014022827,.023422241,-0.115921021,.01651001,-0.765029907,1.111373901,.376800537,.143264771,.040634155,.031005859,.001693726,.002578735,213623e-9,-0.000030518,-0.000808716,.003463745,-0.014022827,.023422241,-0.115921021,.01651001,-0.765029907,1.111373901,.376800537,.143264771,.040634155,.031005859,.001693726,.002578735,213623e-9],[-0.000030518,-0.00088501,.003417969,-0.01512146,.021575928,-0.120697021,.001068115,-0.791213989,1.101211548,.349868774,.146362305,.035552979,.030532837,.001098633,.002456665,198364e-9,-0.000030518,-0.00088501,.003417969,-0.01512146,.021575928,-0.120697021,.001068115,-0.791213989,1.101211548,.349868774,.146362305,.035552979,.030532837,.001098633,.002456665,198364e-9],[-0.000030518,-0.000961304,.003372192,-0.016235352,.01953125,-0.125259399,-0.015228271,-0.816864014,1.089782715,.323318481,.148773193,.030609131,.029937744,549316e-9,.002349854,167847e-9,-0.000030518,-0.000961304,.003372192,-0.016235352,.01953125,-0.125259399,-0.015228271,-0.816864014,1.089782715,.323318481,.148773193,.030609131,.029937744,549316e-9,.002349854,167847e-9],[-0.000030518,-0.001037598,.00328064,-0.017349243,.01725769,-0.129562378,-0.03237915,-0.841949463,1.07711792,.297210693,.150497437,.025817871,.029281616,30518e-9,.002243042,152588e-9,-0.000030518,-0.001037598,.00328064,-0.017349243,.01725769,-0.129562378,-0.03237915,-0.841949463,1.07711792,.297210693,.150497437,.025817871,.029281616,30518e-9,.002243042,152588e-9],[-0.000045776,-0.001113892,.003173828,-0.018463135,.014801025,-0.133590698,-0.050354004,-0.866363525,1.063217163,.271591187,.151596069,.021179199,.028533936,-0.000442505,.002120972,137329e-9,-0.000045776,-0.001113892,.003173828,-0.018463135,.014801025,-0.133590698,-0.050354004,-0.866363525,1.063217163,.271591187,.151596069,.021179199,.028533936,-0.000442505,.002120972,137329e-9],[-0.000045776,-0.001205444,.003051758,-0.019577026,.012115479,-0.137298584,-0.069168091,-0.890090942,1.048156738,.246505737,.152069092,.016708374,.02772522,-0.000869751,.00201416,12207e-8,-0.000045776,-0.001205444,.003051758,-0.019577026,.012115479,-0.137298584,-0.069168091,-0.890090942,1.048156738,.246505737,.152069092,.016708374,.02772522,-0.000869751,.00201416,12207e-8],[-0.000061035,-0.001296997,.002883911,-0.020690918,.009231567,-0.140670776,-0.088775635,-0.91305542,1.031936646,.221984863,.15196228,.012420654,.02684021,-0.001266479,.001907349,106812e-9,-0.000061035,-0.001296997,.002883911,-0.020690918,.009231567,-0.140670776,-0.088775635,-0.91305542,1.031936646,.221984863,.15196228,.012420654,.02684021,-0.001266479,.001907349,106812e-9],[-0.000061035,-0.00138855,.002700806,-0.021789551,.006134033,-0.143676758,-0.109161377,-0.935195923,1.01461792,.198059082,.151306152,.00831604,.025909424,-0.001617432,.001785278,106812e-9,-0.000061035,-0.00138855,.002700806,-0.021789551,.006134033,-0.143676758,-0.109161377,-0.935195923,1.01461792,.198059082,.151306152,.00831604,.025909424,-0.001617432,.001785278,106812e-9],[-0.000076294,-0.001480103,.002487183,-0.022857666,.002822876,-0.146255493,-0.130310059,-0.956481934,.996246338,.174789429,.150115967,.004394531,.024932861,-0.001937866,.001693726,91553e-9,-0.000076294,-0.001480103,.002487183,-0.022857666,.002822876,-0.146255493,-0.130310059,-0.956481934,.996246338,.174789429,.150115967,.004394531,.024932861,-0.001937866,.001693726,91553e-9],[-0.000076294,-0.001586914,.002227783,-0.023910522,-0.000686646,-0.148422241,-0.152206421,-0.976852417,.976852417,.152206421,.148422241,686646e-9,.023910522,-0.002227783,.001586914,76294e-9,-0.000076294,-0.001586914,.002227783,-0.023910522,-0.000686646,-0.148422241,-0.152206421,-0.976852417,.976852417,.152206421,.148422241,686646e-9,.023910522,-0.002227783,.001586914,76294e-9]];s.prototype.full=function(e,t,n){var r,i,o,u;for(var a=0;a<t;++a){var f=e.sbsample[a],l=this.filter[a],c=this.phase,h=this.pcm.samples[a],p=0,d=0;for(var v=0;v<n;++v){s.dct32(f[v],c>>1,l[0][c&1],l[1][c&1]);var m=c&-2,g=c-1&15|1,y=l[0][c&1],b=l[0][~c&1],w=l[1][~c&1],E=0,S=0,x=0;r=0,u=Et[r],_fx=b[S],_fe=y[E],o=_fx[0]*u[g+0],o+=_fx[1]*u[g+14],o+=_fx[2]*u[g+12],o+=_fx[3]*u[g+10],o+=_fx[4]*u[g+8],o+=_fx[5]*u[g+6],o+=_fx[6]*u[g+4],o+=_fx[7]*u[g+2],o=-o,o+=_fe[0]*u[m+0],o+=_fe[1]*u[m+14],o+=_fe[2]*u[m+12],o+=_fe[3]*u[m+10],o+=_fe[4]*u[m+8],o+=_fe[5]*u[m+6],o+=_fe[6]*u[m+4],o+=_fe[7]*u[m+2],h[p++]=o,d=p+30;for(var T=1;T<16;++T)++E,++r,u=Et[r],_fo=w[x],_fe=y[E],o=_fo[0]*u[g+0],o+=_fo[1]*u[g+14],o+=_fo[2]*u[g+12],o+=_fo[3]*u[g+10],o+=_fo[4]*u[g+8],o+=_fo[5]*u[g+6],o+=_fo[6]*u[g+4],o+=_fo[7]*u[g+2],o=-o,o+=_fe[7]*u[m+2],o+=_fe[6]*u[m+4],o+=_fe[5]*u[m+6],o+=_fe[4]*u[m+8],o+=_fe[3]*u[m+10],o+=_fe[2]*u[m+12],o+=_fe[1]*u[m+14],o+=_fe[0]*u[m+0],h[p++]=o,o=_fe[0]*u[-m+31-16],o+=_fe[1]*u[-m+31-14],o+=_fe[2]*u[-m+31-12],o+=_fe[3]*u[-m+31-10],o+=_fe[4]*u[-m+31-8],o+=_fe[5]*u[-m+31-6],o+=_fe[6]*u[-m+31-4],o+=_fe[7]*u[-m+31-2],o+=_fo[7]*u[-g+31-2],o+=_fo[6]*u[-g+31-4],o+=_fo[5]*u[-g+31-6],o+=_fo[4]*u[-g+31-8],o+=_fo[3]*u[-g+31-10],o+=_fo[2]*u[-g+31-12],o+=_fo[1]*u[-g+31-14],o+=_fo[0]*u[-g+31-16],h[d--]=o,++x;++r,u=Et[r],_fo=w[x],o=_fo[0]*u[g+0],o+=_fo[1]*u[g+14],o+=_fo[2]*u[g+12],o+=_fo[3]*u[g+10],o+=_fo[4]*u[g+8],o+=_fo[5]*u[g+6],o+=_fo[6]*u[g+4],o+=_fo[7]*u[g+2],h[p]=-o,p+=16,c=(c+1)%16}}},s.prototype.frame=function(e){var t=e.header.nchannels(),n=e.header.nbsamples();this.pcm.samplerate=e.header.samplerate,this.pcm.channels=t,this.pcm.length=32*n,this.full(e,t,n),this.phase=(this.phase+n)%16};const St=new Float32Array([2,1.587401051968,1.259921049895,1,.793700525984,.629960524947,.5,.396850262992,.314980262474,.25,.198425131496,.157490131237,.125,.099212565748,.078745065618,.0625,.049606282874,.039372532809,.03125,.024803141437,.019686266405,.015625,.012401570719,.009843133202,.0078125,.006200785359,.004921566601,.00390625,.00310039268,.002460783301,.001953125,.00155019634,.00123039165,.0009765625,.00077509817,.000615195825,.00048828125,.000387549085,.000307597913,.000244140625,.000193774542,.000153798956,.000122070313,96887271e-12,76899478e-12,61035156e-12,48443636e-12,38449739e-12,30517578e-12,24221818e-12,1922487e-11,15258789e-12,12110909e-12,9612435e-12,7629395e-12,6055454e-12,4806217e-12,3814697e-12,3027727e-12,2403109e-12,1907349e-12,1513864e-12,1201554e-12,0]),xt=new Uint8Array([4,4,4,4,4,4,6,6,6,8,10,12,16,18,22,28,34,40,46,54,54,192]),Tt=new Uint8Array([4,4,4,4,4,4,6,6,8,8,10,12,16,20,24,28,34,42,50,54,76,158]),Nt=new Uint8Array([4,4,4,4,4,4,6,6,8,10,12,16,20,24,30,38,46,56,68,84,102,26]),Ct=new Uint8Array([4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,6,6,6,10,10,10,12,12,12,14,14,14,16,16,16,20,20,20,26,26,26,66,66,66]),kt=new Uint8Array([4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,22,22,22,30,30,30,56,56,56]),Lt=new Uint8Array([4,4,4,4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,12,12,12,16,16,16,20,20,20,26,26,26,34,34,34,42,42,42,12,12,12]),At=new Uint8Array([4,4,4,4,4,4,6,6,4,4,4,6,6,6,6,6,6,10,10,10,12,12,12,14,14,14,16,16,16,20,20,20,26,26,26,66,66,66]),Ot=new Uint8Array([4,4,4,4,4,4,6,6,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,22,22,22,30,30,30,56,56,56]),Mt=new Uint8Array([4,4,4,4,4,4,6,6,4,4,4,6,6,6,8,8,8,12,12,12,16,16,16,20,20,20,26,26,26,34,34,34,42,42,42,12,12,12]),_t=new Uint8Array([6,6,6,6,6,6,8,10,12,14,16,18,22,26,32,38,46,54,62,70,76,36]),Dt=new Uint8Array([6,6,6,6,6,6,8,10,12,14,16,20,24,28,32,38,46,52,60,68,58,54]),Pt=Dt,Ht=new Uint8Array([4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,32,32,32,44,44,44,12,12,12]),Bt=new Uint8Array([4,4,4,4,4,4,4,4,4,6,6,6,6,6,6,8,8,8,10,10,10,14,14,14,18,18,18,26,26,26,32,32,32,42,42,42,18,18,18]),jt=new Uint8Array([4,4,4,4,4,4,4,4,4,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,30,30,30,40,40,40,18,18,18]),Ft=new Uint8Array([6,6,6,6,6,6,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,32,32,32,44,44,44,12,12,12]),It=new Uint8Array([6,6,6,6,6,6,6,6,6,6,6,6,8,8,8,10,10,10,14,14,14,18,18,18,26,26,26,32,32,32,42,42,42,18,18,18]),qt=new Uint8Array([6,6,6,6,6,6,6,6,6,8,8,8,10,10,10,12,12,12,14,14,14,18,18,18,24,24,24,30,30,30,40,40,40,18,18,18]),Rt=Pt,Ut=Rt,zt=new Uint8Array([12,12,12,12,12,12,16,20,24,28,32,40,48,56,64,76,90,2,2,2,2,2]),Wt=jt,Xt=Wt,Vt=new Uint8Array([8,8,8,8,8,8,8,8,8,12,12,12,16,16,16,20,20,20,24,24,24,28,28,28,36,36,36,2,2,2,2,2,2,2,2,2,26,26,26]),$t=qt,Jt=$t,Kt=new Uint8Array([12,12,12,4,4,4,8,8,8,12,12,12,16,16,16,20,20,20,24,24,24,28,28,28,36,36,36,2,2,2,2,2,2,2,2,2,26,26,26]),Qt=[{l:xt,s:Ct,m:At},{l:Tt,s:kt,m:Ot},{l:Nt,s:Lt,m:Mt},{l:_t,s:Ht,m:Ft},{l:Dt,s:Bt,m:It},{l:Pt,s:jt,m:qt},{l:Rt,s:Wt,m:$t},{l:Ut,s:Xt,m:Jt},{l:zt,s:Vt,m:Kt}],Gt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0]),Yt=new Float32Array([.59460355750136,.70710678118655,.84089641525371,1,1.18920711500272,1.4142135623731,1.68179283050743]),Zt=new Float32Array([.857492926,.881741997,.949628649,.983314592,.995517816,.999160558,.999899195,.999993155]),en=new Float32Array([-0.514495755,-0.471731969,-0.313377454,-0.1819132,-0.094574193,-0.040965583,-0.014198569,-0.003699975]),tn=1,nn=2,rn=4,sn=8,on=1,un=2,an=new Float32Array([.043619387,.130526192,.216439614,.3007058,.382683432,.461748613,.537299608,.608761429,.675590208,.737277337,.79335334,.843391446,.887010833,.923879533,.953716951,.976296007,.991444861,.999048222,.999048222,.991444861,.976296007,.953716951,.923879533,.887010833,.843391446,.79335334,.737277337,.675590208,.608761429,.537299608,.461748613,.382683432,.3007058,.216439614,.130526192,.043619387]),fn=new Float32Array([.130526192,.382683432,.608761429,.79335334,.923879533,.991444861,.991444861,.923879533,.79335334,.608761429,.382683432,.130526192]),ln=new Float32Array([0,.211324865,.366025404,.5,.633974596,.788675135,1]),cn=[new Float32Array([.840896415,.707106781,.594603558,.5,.420448208,.353553391,.297301779,.25,.210224104,.176776695,.148650889,.125,.105112052,.088388348,.074325445]),new Float32Array([.707106781,.5,.353553391,.25,.176776695,.125,.088388348,.0625,.044194174,.03125,.022097087,.015625,.011048543,.0078125,.005524272])],hn=[{slen1:0,slen2:0},{slen1:0,slen2:1},{slen1:0,slen2:2},{slen1:0,slen2:3},{slen1:3,slen2:0},{slen1:1,slen2:1},{slen1:1,slen2:2},{slen1:1,slen2:3},{slen1:2,slen2:1},{slen1:2,slen2:2},{slen1:2,slen2:3},{slen1:3,slen2:1},{slen1:3,slen2:2},{slen1:3,slen2:3},{slen1:4,slen2:2},{slen1:4,slen2:3}],pn=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];r.layers[1]=o;const dn=new Float32Array([1.33333333333333,1.14285714285714,1.06666666666667,1.03225806451613,1.01587301587302,1.00787401574803,1.00392156862745,1.00195694716243,1.00097751710655,1.00048851978505,1.0002442002442,1.00012208521548,1.00006103888177,1.00003051850948]);o.prototype.decode=function(e,t){var n=t.header,r=n.nchannels(),i=32;n.mode===q.JOINT_STEREO&&(n.flags|=F.I_STEREO,i=4+n.mode_extension*4),n.flags&F.PROTECTION;var s=this.allocation;for(var o=0;o<i;o++)for(var u=0;u<r;u++){var a=e.read(4);if(a===15)throw new Error("forbidden bit allocation value");s[u][o]=a?a+1:0}for(var o=i;o<32;o++){var a=e.read(4);if(a===15)throw new Error("forbidden bit allocation value");s[0][o]=s[1][o]=a?a+1:0}var f=this.scalefactor;for(var o=0;o<32;o++)for(var u=0;u<r;u++)s[u][o]&&(f[u][o]=e.read(6));for(var l=0;l<12;l++){for(var o=0;o<i;o++)for(var u=0;u<r;u++){var a=s[u][o];t.sbsample[u][l][o]=a?this.sample(e,a)*St[f[u][o]]:0}for(var o=i;o<32;o++){var a=s[0][o];if(a){var c=this.sample(e,a);for(var u=0;u<r;u++)t.sbsample[u][l][o]=c*St[f[u][o]]}else for(var u=0;u<r;u++)t.sbsample[u][l][o]=0}}},o.prototype.sample=function(e,t){var n=e.read(t);return n^=1<<t-1,n|=-(n&1<<t-1),n/=1<<t-1,n+=1>>t-1,n*dn[t-2]},r.layers[2]=u;const vn=[{sblimit:27,offsets:[7,7,7,6,6,6,6,6,6,6,6,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0]},{sblimit:30,offsets:[7,7,7,6,6,6,6,6,6,6,6,3,3,3,3,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0]},{sblimit:8,offsets:[5,5,2,2,2,2,2,2]},{sblimit:12,offsets:[5,5,2,2,2,2,2,2,2,2,2,2]},{sblimit:30,offsets:[4,4,4,4,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}],mn=[{nbal:2,offset:0},{nbal:2,offset:3},{nbal:3,offset:3},{nbal:3,offset:1},{nbal:4,offset:2},{nbal:4,offset:3},{nbal:4,offset:4},{nbal:4,offset:5}],gn=[[0,1,16],[0,1,2,3,4,5,16],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],[0,1,3,4,5,6,7,8,9,10,11,12,13,14,15],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,16],[0,2,4,5,6,7,8,9,10,11,12,13,14,15,16]],yn=[{nlevels:3,group:2,bits:5,C:1.33333333333,D:.5},{nlevels:5,group:3,bits:7,C:1.6,D:.5},{nlevels:7,group:0,bits:3,C:1.14285714286,D:.25},{nlevels:9,group:4,bits:10,C:1.77777777777,D:.5},{nlevels:15,group:0,bits:4,C:1.06666666666,D:.125},{nlevels:31,group:0,bits:5,C:1.03225806452,D:.0625},{nlevels:63,group:0,bits:6,C:1.01587301587,D:.03125},{nlevels:127,group:0,bits:7,C:1.00787401575,D:.015625},{nlevels:255,group:0,bits:8,C:1.00392156863,D:.0078125},{nlevels:511,group:0,bits:9,C:1.00195694716,D:.00390625},{nlevels:1023,group:0,bits:10,C:1.00097751711,D:.001953125},{nlevels:2047,group:0,bits:11,C:1.00048851979,D:.0009765625},{nlevels:4095,group:0,bits:12,C:1.00024420024,D:.00048828125},{nlevels:8191,group:0,bits:13,C:1.00012208522,D:.00024414063},{nlevels:16383,group:0,bits:14,C:1.00006103888,D:.00012207031},{nlevels:32767,group:0,bits:15,C:1.00003051851,D:6103516e-11},{nlevels:65535,group:0,bits:16,C:1.00001525902,D:3051758e-11}];u.prototype.decode=function(e,t){var n=t.header,r=n.nchannels(),i;if(n.flags&F.LSF_EXT)i=4;else if(n.flags&F.FREEFORMAT)i=n.samplerate===48e3?0:1;else{var s=n.bitrate;if(r===2)s/=2;else if(s>192e3)throw new Error("bad bitrate/mode combination");s<=48e3?i=n.samplerate===32e3?3:2:s<=8e4?i=0:i=n.samplerate===48e3?0:1}var o=vn[i].sblimit,u=vn[i].offsets,a=32;n.mode===q.JOINT_STEREO&&(n.flags|=F.I_STEREO,a=4+n.mode_extension*4),a>o&&(a=o);var f=this.allocation;for(var l=0;l<a;l++){var c=mn[u[l]].nbal;for(var h=0;h<r;h++)f[h][l]=e.read(c)}for(var l=a;l<o;l++){var c=mn[u[l]].nbal;f[0][l]=f[1][l]=e.read(c)}var p=this.scfsi;for(var l=0;l<o;l++)for(var h=0;h<r;h++)f[h][l]&&(p[h][l]=e.read(2));n.flags&F.PROTECTION;var d=this.scalefactor;for(var l=0;l<o;l++)for(var h=0;h<r;h++)if(f[h][l]){d[h][l][0]=e.read(6);switch(p[h][l]){case 2:d[h][l][2]=d[h][l][1]=d[h][l][0];break;case 0:d[h][l][1]=e.read(6);case 1:case 3:d[h][l][2]=e.read(6)}p[h][l]&1&&(d[h][l][1]=d[h][l][p[h][l]-1])}for(var v=0;v<12;v++){for(var l=0;l<a;l++)for(var h=0;h<r;h++)if(i=f[h][l]){i=gn[mn[u[l]].offset][i-1],this.decodeSamples(e,yn[i]);var m=St[d[h][l][v>>2]];for(var g=0;g<3;g++)t.sbsample[h][3*v+g][l]=this.samples[g]*m}else for(var g=0;g<3;g++)t.sbsample[h][3*v+g][l]=0;for(var l=a;l<o;l++)if(i=f[0][l]){i=gn[mn[u[l]].offset][i-1],this.decodeSamples(e,yn[i]);for(var h=0;h<r;h++){var m=St[d[h][l][v>>2]];for(var g=0;g<3;g++)t.sbsample[h][3*v+g][l]=this.samples[g]*m}}else for(var h=0;h<r;h++)for(var g=0;g<3;g++)t.sbsample[h][3*v+g][l]=0;for(var h=0;h<r;h++)for(var g=0;g<3;g++)for(var l=o;l<32;l++)t.sbsample[h][3*v+g][l]=0}},u.prototype.decodeSamples=function(e,t){var n=this.samples,r=t.group;if(r){var i=e.read(t.bits),s=t.nlevels;for(var o=0;o<3;o++)n[o]=i%s,i=i/s|0}else{r=t.bits;for(var o=0;o<3;o++)n[o]=e.read(r)}for(var o=0;o<3;o++){var u=n[o]^1<<r-1;u|=-(u&1<<r-1),u/=1<<r-1,n[o]=(u+t.D)*t.C}};var bn=function(e,t){return{"final":0,ptr:{bits:t,offset:e}}},wn=function(e,t,n,r,i){return{"final":1,value:{v:e,w:t,x:n,y:r}}};const En=[bn(16,2),bn(20,2),bn(24,1),bn(26,1),wn(0,0,1,0,4),wn(0,0,0,1,4),wn(0,1,0,0,4),wn(1,0,0,0,4),wn(0,0,0,0,1),wn(0,0,0,0,1),wn(0,0,0,0,1),wn(0,0,0,0,1),wn(0,0,0,0,1),wn(0,0,0,0,1),wn(0,0,0,0,1),wn(0,0,0,0,1),wn(1,0,1,1,2),wn(1,1,1,1,2),wn(1,1,0,1,2),wn(1,1,1,0,2),wn(0,1,1,1,2),wn(0,1,0,1,2),wn(1,0,0,1,1),wn(1,0,0,1,1),wn(0,1,1,0,1),wn(0,0,1,1,1),wn(1,0,1,0,1),wn(1,1,0,0,1)],Sn=[wn(1,1,1,1,4),wn(1,1,1,0,4),wn(1,1,0,1,4),wn(1,1,0,0,4),wn(1,0,1,1,4),wn(1,0,1,0,4),wn(1,0,0,1,4),wn(1,0,0,0,4),wn(0,1,1,1,4),wn(0,1,1,0,4),wn(0,1,0,1,4),wn(0,1,0,0,4),wn(0,0,1,1,4),wn(0,0,1,0,4),wn(0,0,0,1,4),wn(0,0,0,0,4)];var xn=function(e,t,n){return{"final":1,value:{x:e,y:t,hlen:n}}};const Tn=[xn(0,0,0)],Nn=[xn(1,1,3),xn(0,1,3),xn(1,0,2),xn(1,0,2),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1)],Cn=[bn(8,3),xn(1,1,3),xn(0,1,3),xn(1,0,3),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(2,2,3),xn(0,2,3),xn(1,2,2),xn(1,2,2),xn(2,1,2),xn(2,1,2),xn(2,0,2),xn(2,0,2)],kn=[bn(8,3),xn(1,0,3),xn(1,1,2),xn(1,1,2),xn(0,1,2),xn(0,1,2),xn(0,0,2),xn(0,0,2),xn(2,2,3),xn(0,2,3),xn(1,2,2),xn(1,2,2),xn(2,1,2),xn(2,1,2),xn(2,0,2),xn(2,0,2)],Ln=[bn(8,4),xn(1,1,3),xn(0,1,3),xn(1,0,3),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),bn(24,1),xn(3,2,4),xn(3,1,3),xn(3,1,3),xn(1,3,4),xn(0,3,4),xn(3,0,4),xn(2,2,4),xn(1,2,3),xn(1,2,3),xn(2,1,3),xn(2,1,3),xn(0,2,3),xn(0,2,3),xn(2,0,3),xn(2,0,3),xn(3,3,1),xn(2,3,1)],An=[bn(16,3),bn(24,1),bn(26,1),xn(1,2,4),xn(2,1,4),xn(2,0,4),xn(0,1,3),xn(0,1,3),xn(1,1,2),xn(1,1,2),xn(1,1,2),xn(1,1,2),xn(1,0,3),xn(1,0,3),xn(0,0,3),xn(0,0,3),xn(3,3,3),xn(0,3,3),xn(2,3,2),xn(2,3,2),xn(3,2,2),xn(3,2,2),xn(3,0,2),xn(3,0,2),xn(1,3,1),xn(3,1,1),xn(2,2,1),xn(0,2,1)],On=[bn(16,4),bn(32,4),bn(48,2),xn(1,1,4),xn(0,1,3),xn(0,1,3),xn(1,0,3),xn(1,0,3),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),bn(52,2),bn(56,1),bn(58,1),xn(1,5,4),xn(5,1,4),bn(60,1),xn(5,0,4),bn(62,1),xn(2,4,4),xn(4,2,4),xn(1,4,3),xn(1,4,3),xn(4,1,3),xn(4,1,3),xn(4,0,3),xn(4,0,3),xn(0,4,4),xn(2,3,4),xn(3,2,4),xn(0,3,4),xn(1,3,3),xn(1,3,3),xn(3,1,3),xn(3,1,3),xn(3,0,3),xn(3,0,3),xn(2,2,3),xn(2,2,3),xn(1,2,2),xn(1,2,2),xn(1,2,2),xn(1,2,2),xn(2,1,1),xn(2,1,1),xn(0,2,2),xn(2,0,2),xn(5,5,2),xn(4,5,2),xn(5,4,2),xn(5,3,2),xn(3,5,1),xn(4,4,1),xn(2,5,1),xn(5,2,1),xn(0,5,1),xn(3,4,1),xn(4,3,1),xn(3,3,1)],Mn=[bn(16,4),bn(32,4),xn(1,2,4),xn(2,1,4),xn(1,1,2),xn(1,1,2),xn(1,1,2),xn(1,1,2),xn(0,1,3),xn(0,1,3),xn(1,0,3),xn(1,0,3),xn(0,0,2),xn(0,0,2),xn(0,0,2),xn(0,0,2),bn(48,3),bn(56,2),bn(60,1),xn(1,5,4),xn(5,1,4),bn(62,1),bn(64,1),xn(2,4,4),xn(4,2,4),xn(1,4,4),xn(4,1,3),xn(4,1,3),xn(0,4,4),xn(4,0,4),xn(2,3,4),xn(3,2,4),xn(1,3,4),xn(3,1,4),xn(0,3,4),xn(3,0,4),xn(2,2,2),xn(2,2,2),xn(2,2,2),xn(2,2,2),xn(0,2,2),xn(0,2,2),xn(0,2,2),xn(0,2,2),xn(2,0,2),xn(2,0,2),xn(2,0,2),xn(2,0,2),xn(5,5,3),xn(5,4,3),xn(4,5,2),xn(4,5,2),xn(5,3,1),xn(5,3,1),xn(5,3,1),xn(5,3,1),xn(3,5,2),xn(4,4,2),xn(2,5,1),xn(2,5,1),xn(5,2,1),xn(0,5,1),xn(3,4,1),xn(4,3,1),xn(5,0,1),xn(3,3,1)],_n=[bn(16,4),bn(32,3),bn(40,2),bn(44,2),bn(48,1),xn(1,2,4),xn(2,1,4),xn(2,0,4),xn(1,1,3),xn(1,1,3),xn(0,1,3),xn(0,1,3),xn(1,0,3),xn(1,0,3),xn(0,0,3),xn(0,0,3),bn(50,1),xn(3,5,4),xn(5,3,4),bn(52,1),xn(4,4,4),xn(2,5,4),xn(5,2,4),xn(1,5,4),xn(5,1,3),xn(5,1,3),xn(3,4,3),xn(3,4,3),xn(4,3,3),xn(4,3,3),xn(5,0,4),xn(0,4,4),xn(2,4,3),xn(4,2,3),xn(3,3,3),xn(4,0,3),xn(1,4,2),xn(1,4,2),xn(4,1,2),xn(4,1,2),xn(2,3,2),xn(3,2,2),xn(1,3,1),xn(1,3,1),xn(3,1,1),xn(3,1,1),xn(0,3,2),xn(3,0,2),xn(2,2,1),xn(0,2,1),xn(5,5,1),xn(4,5,1),xn(5,4,1),xn(0,5,1)],Dn=[bn(16,4),bn(32,4),bn(48,2),xn(1,1,4),xn(0,1,3),xn(0,1,3),xn(1,0,3),xn(1,0,3),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),bn(52,3),bn(60,2),bn(64,3),bn(72,1),bn(74,2),bn(78,2),bn(82,2),xn(1,7,4),xn(7,1,4),bn(86,1),bn(88,2),bn(92,2),xn(1,6,4),xn(6,1,4),xn(6,0,4),bn(96,1),bn(98,1),bn(100,1),xn(1,4,4),xn(4,1,4),xn(4,0,4),xn(2,3,4),xn(3,2,4),xn(0,3,4),xn(1,3,3),xn(1,3,3),xn(3,1,3),xn(3,1,3),xn(3,0,3),xn(3,0,3),xn(2,2,3),xn(2,2,3),xn(1,2,2),xn(2,1,2),xn(0,2,2),xn(2,0,2),xn(7,7,3),xn(6,7,3),xn(7,6,3),xn(5,7,3),xn(7,5,3),xn(6,6,3),xn(4,7,2),xn(4,7,2),xn(7,4,2),xn(5,6,2),xn(6,5,2),xn(3,7,2),xn(7,3,2),xn(7,3,2),xn(4,6,2),xn(4,6,2),xn(5,5,3),xn(5,4,3),xn(6,3,2),xn(6,3,2),xn(2,7,1),xn(7,2,1),xn(6,4,2),xn(0,7,2),xn(7,0,1),xn(7,0,1),xn(6,2,1),xn(6,2,1),xn(4,5,2),xn(3,5,2),xn(0,6,1),xn(0,6,1),xn(5,3,2),xn(4,4,2),xn(3,6,1),xn(2,6,1),xn(2,5,2),xn(5,2,2),xn(1,5,1),xn(1,5,1),xn(5,1,1),xn(5,1,1),xn(3,4,2),xn(4,3,2),xn(0,5,1),xn(5,0,1),xn(2,4,1),xn(4,2,1),xn(3,3,1),xn(0,4,1)],Pn=[bn(16,4),bn(32,4),bn(48,4),bn(64,3),xn(1,2,4),bn(72,1),xn(1,1,3),xn(1,1,3),xn(0,1,3),xn(0,1,3),xn(1,0,3),xn(1,0,3),xn(0,0,2),xn(0,0,2),xn(0,0,2),xn(0,0,2),bn(74,2),bn(78,3),bn(86,2),bn(90,1),bn(92,2),xn(2,7,4),xn(7,2,4),bn(96,1),xn(7,1,3),xn(7,1,3),xn(1,7,4),xn(7,0,4),xn(3,6,4),xn(6,3,4),xn(6,0,4),bn(98,1),bn(100,1),xn(1,5,4),xn(6,2,3),xn(6,2,3),xn(2,6,4),xn(0,6,4),xn(1,6,3),xn(1,6,3),xn(6,1,3),xn(6,1,3),xn(5,1,4),xn(3,4,4),xn(5,0,4),bn(102,1),xn(2,4,4),xn(4,2,4),xn(1,4,4),xn(4,1,4),xn(0,4,4),xn(4,0,4),xn(2,3,3),xn(2,3,3),xn(3,2,3),xn(3,2,3),xn(1,3,2),xn(1,3,2),xn(1,3,2),xn(1,3,2),xn(3,1,2),xn(3,1,2),xn(3,1,2),xn(3,1,2),xn(0,3,3),xn(3,0,3),xn(2,2,2),xn(2,2,2),xn(2,1,1),xn(2,1,1),xn(2,1,1),xn(2,1,1),xn(0,2,1),xn(2,0,1),xn(7,7,2),xn(6,7,2),xn(7,6,2),xn(7,5,2),xn(6,6,2),xn(6,6,2),xn(4,7,2),xn(4,7,2),xn(7,4,2),xn(7,4,2),xn(5,7,3),xn(5,5,3),xn(5,6,2),xn(6,5,2),xn(3,7,1),xn(3,7,1),xn(7,3,1),xn(4,6,1),xn(4,5,2),xn(5,4,2),xn(3,5,2),xn(5,3,2),xn(6,4,1),xn(0,7,1),xn(4,4,1),xn(2,5,1),xn(5,2,1),xn(0,5,1),xn(4,3,1),xn(3,3,1)],Hn=[bn(16,4),bn(32,4),bn(48,4),bn(64,2),bn(68,3),bn(76,1),xn(1,2,4),xn(2,1,4),bn(78,1),xn(0,0,4),xn(1,1,3),xn(1,1,3),xn(0,1,3),xn(0,1,3),xn(1,0,3),xn(1,0,3),bn(80,2),bn(84,1),bn(86,1),bn(88,1),xn(5,6,4),xn(3,7,4),bn(90,1),xn(2,7,4),xn(7,2,4),xn(4,6,4),xn(6,4,4),xn(1,7,4),xn(7,1,4),bn(92,1),xn(3,6,4),xn(6,3,4),xn(4,5,4),xn(5,4,4),xn(4,4,4),bn(94,1),xn(2,6,3),xn(2,6,3),xn(6,2,3),xn(6,2,3),xn(6,1,3),xn(6,1,3),xn(1,6,4),xn(6,0,4),xn(3,5,4),xn(5,3,4),xn(2,5,4),xn(5,2,4),xn(1,5,3),xn(1,5,3),xn(5,1,3),xn(5,1,3),xn(3,4,3),xn(3,4,3),xn(4,3,3),xn(4,3,3),xn(5,0,4),xn(0,4,4),xn(2,4,3),xn(2,4,3),xn(4,2,3),xn(4,2,3),xn(1,4,3),xn(1,4,3),xn(3,3,2),xn(4,1,2),xn(2,3,2),xn(3,2,2),xn(4,0,3),xn(0,3,3),xn(3,0,2),xn(3,0,2),xn(1,3,1),xn(1,3,1),xn(1,3,1),xn(1,3,1),xn(3,1,1),xn(2,2,1),xn(0,2,1),xn(2,0,1),xn(7,7,2),xn(6,7,2),xn(7,6,1),xn(7,6,1),xn(5,7,1),xn(7,5,1),xn(6,6,1),xn(4,7,1),xn(7,4,1),xn(6,5,1),xn(7,3,1),xn(5,5,1),xn(0,7,1),xn(7,0,1),xn(0,6,1),xn(0,5,1)],Bn=[bn(16,4),bn(32,4),bn(48,4),bn(64,2),xn(1,1,4),xn(0,1,4),xn(1,0,3),xn(1,0,3),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),bn(68,4),bn(84,4),bn(100,4),bn(116,4),bn(132,4),bn(148,4),bn(164,3),bn(172,3),bn(180,3),bn(188,3),bn(196,3),bn(204,3),bn(212,1),bn(214,2),bn(218,3),bn(226,1),bn(228,2),bn(232,2),bn(236,2),bn(240,2),xn(8,1,4),bn(244,1),bn(246,1),bn(248,1),bn(250,2),bn(254,1),xn(1,5,4),xn(5,1,4),bn(256,1),bn(258,1),bn(260,1),xn(1,4,4),xn(4,1,3),xn(4,1,3),xn(0,4,4),xn(4,0,4),xn(2,3,4),xn(3,2,4),xn(1,3,3),xn(1,3,3),xn(3,1,3),xn(3,1,3),xn(0,3,3),xn(0,3,3),xn(3,0,3),xn(3,0,3),xn(2,2,3),xn(2,2,3),xn(1,2,2),xn(2,1,2),xn(0,2,2),xn(2,0,2),bn(262,4),bn(278,4),bn(294,4),bn(310,3),bn(318,2),bn(322,2),bn(326,3),bn(334,2),bn(338,1),bn(340,2),bn(344,2),bn(348,2),bn(352,2),bn(356,2),xn(1,15,4),xn(15,1,4),xn(15,0,4),bn(360,1),bn(362,1),bn(364,1),xn(14,2,4),bn(366,1),xn(1,14,4),xn(14,1,4),bn(368,1),bn(370,1),bn(372,1),bn(374,1),bn(376,1),bn(378,1),xn(12,6,4),xn(3,13,4),bn(380,1),xn(2,13,4),xn(13,2,4),xn(1,13,4),xn(11,7,4),bn(382,1),bn(384,1),xn(12,3,4),bn(386,1),xn(4,11,4),xn(13,1,3),xn(13,1,3),xn(0,13,4),xn(13,0,4),xn(8,10,4),xn(10,8,4),xn(4,12,4),xn(12,4,4),xn(6,11,4),xn(11,6,4),xn(3,12,3),xn(3,12,3),xn(2,12,3),xn(2,12,3),xn(12,2,3),xn(12,2,3),xn(5,11,3),xn(5,11,3),xn(11,5,4),xn(8,9,4),xn(1,12,3),xn(1,12,3),xn(12,1,3),xn(12,1,3),xn(9,8,4),xn(0,12,4),xn(12,0,3),xn(12,0,3),xn(11,4,4),xn(6,10,4),xn(10,6,4),xn(7,9,4),xn(3,11,3),xn(3,11,3),xn(11,3,3),xn(11,3,3),xn(8,8,4),xn(5,10,4),xn(2,11,3),xn(2,11,3),xn(10,5,4),xn(6,9,4),xn(10,4,3),xn(10,4,3),xn(7,8,4),xn(8,7,4),xn(9,4,3),xn(9,4,3),xn(7,7,4),xn(7,6,4),xn(11,2,2),xn(11,2,2),xn(11,2,2),xn(11,2,2),xn(1,11,2),xn(1,11,2),xn(11,1,2),xn(11,1,2),xn(0,11,3),xn(11,0,3),xn(9,6,3),xn(4,10,3),xn(3,10,3),xn(10,3,3),xn(5,9,3),xn(9,5,3),xn(2,10,2),xn(2,10,2),xn(10,2,2),xn(10,2,2),xn(1,10,2),xn(1,10,2),xn(10,1,2),xn(10,1,2),xn(0,10,3),xn(6,8,3),xn(10,0,2),xn(10,0,2),xn(8,6,3),xn(4,9,3),xn(9,3,2),xn(9,3,2),xn(3,9,3),xn(5,8,3),xn(8,5,3),xn(6,7,3),xn(2,9,2),xn(2,9,2),xn(9,2,2),xn(9,2,2),xn(5,7,3),xn(7,5,3),xn(3,8,2),xn(3,8,2),xn(8,3,2),xn(8,3,2),xn(6,6,3),xn(4,7,3),xn(7,4,3),xn(5,6,3),xn(6,5,3),xn(7,3,3),xn(1,9,1),xn(9,1,1),xn(0,9,2),xn(9,0,2),xn(4,8,2),xn(8,4,2),xn(7,2,2),xn(7,2,2),xn(4,6,3),xn(6,4,3),xn(2,8,1),xn(2,8,1),xn(2,8,1),xn(2,8,1),xn(8,2,1),xn(1,8,1),xn(3,7,2),xn(2,7,2),xn(1,7,1),xn(1,7,1),xn(7,1,1),xn(7,1,1),xn(5,5,2),xn(0,7,2),xn(7,0,2),xn(3,6,2),xn(6,3,2),xn(4,5,2),xn(5,4,2),xn(2,6,2),xn(6,2,2),xn(3,5,2),xn(0,8,1),xn(8,0,1),xn(1,6,1),xn(6,1,1),xn(0,6,1),xn(6,0,1),xn(5,3,2),xn(4,4,2),xn(2,5,1),xn(2,5,1),xn(5,2,1),xn(0,5,1),xn(3,4,1),xn(4,3,1),xn(5,0,1),xn(2,4,1),xn(4,2,1),xn(3,3,1),bn(388,3),xn(15,15,4),xn(14,15,4),xn(13,15,4),xn(14,14,4),xn(12,15,4),xn(13,14,4),xn(11,15,4),xn(15,11,4),xn(12,14,4),xn(13,12,4),bn(396,1),xn(14,12,3),xn(14,12,3),xn(13,13,3),xn(13,13,3),xn(15,10,4),xn(12,13,4),xn(11,14,3),xn(11,14,3),xn(14,11,3),xn(14,11,3),xn(9,15,3),xn(9,15,3),xn(15,9,3),xn(15,9,3),xn(14,10,3),xn(14,10,3),xn(11,13,3),xn(11,13,3),xn(13,11,3),xn(13,11,3),xn(8,15,3),xn(8,15,3),xn(15,8,3),xn(15,8,3),xn(12,12,3),xn(12,12,3),xn(10,14,4),xn(9,14,4),xn(8,14,3),xn(8,14,3),xn(7,15,4),xn(7,14,4),xn(15,7,2),xn(15,7,2),xn(15,7,2),xn(15,7,2),xn(13,10,2),xn(13,10,2),xn(10,13,3),xn(11,12,3),xn(12,11,3),xn(15,6,3),xn(6,15,2),xn(6,15,2),xn(14,8,2),xn(5,15,2),xn(9,13,2),xn(13,9,2),xn(15,5,2),xn(14,7,2),xn(10,12,2),xn(11,11,2),xn(4,15,2),xn(4,15,2),xn(15,4,2),xn(15,4,2),xn(12,10,3),xn(14,6,3),xn(15,3,2),xn(15,3,2),xn(3,15,1),xn(3,15,1),xn(8,13,2),xn(13,8,2),xn(2,15,1),xn(15,2,1),xn(6,14,2),xn(9,12,2),xn(0,15,1),xn(0,15,1),xn(12,9,2),xn(5,14,2),xn(10,11,1),xn(10,11,1),xn(7,13,2),xn(13,7,2),xn(4,14,1),xn(4,14,1),xn(12,8,2),xn(13,6,2),xn(3,14,1),xn(3,14,1),xn(11,9,1),xn(11,9,1),xn(9,11,2),xn(10,10,2),xn(11,10,1),xn(14,5,1),xn(14,4,1),xn(8,12,1),xn(6,13,1),xn(14,3,1),xn(2,14,1),xn(0,14,1),xn(14,0,1),xn(5,13,1),xn(13,5,1),xn(7,12,1),xn(12,7,1),xn(4,13,1),xn(8,11,1),xn(11,8,1),xn(13,4,1),xn(9,10,1),xn(10,9,1),xn(6,12,1),xn(13,3,1),xn(7,11,1),xn(5,12,1),xn(12,5,1),xn(9,9,1),xn(7,10,1),xn(10,7,1),xn(9,7,1),xn(15,14,3),xn(15,12,3),xn(15,13,2),xn(15,13,2),xn(14,13,1),xn(14,13,1),xn(14,13,1),xn(14,13,1),xn(10,15,1),xn(14,9,1)],jn=[bn(16,4),bn(32,4),bn(48,4),bn(64,4),bn(80,4),bn(96,3),bn(104,3),bn(112,2),bn(116,1),bn(118,1),xn(1,1,3),xn(1,1,3),xn(0,1,4),xn(1,0,4),xn(0,0,3),xn(0,0,3),bn(120,4),bn(136,4),bn(152,4),bn(168,4),bn(184,4),bn(200,3),bn(208,3),bn(216,4),bn(232,3),bn(240,3),bn(248,3),bn(256,3),bn(264,2),bn(268,3),bn(276,3),bn(284,2),bn(288,2),bn(292,2),bn(296,2),bn(300,2),bn(304,2),bn(308,2),bn(312,2),bn(316,2),bn(320,1),bn(322,1),bn(324,1),bn(326,2),bn(330,1),bn(332,1),bn(334,2),bn(338,1),bn(340,1),bn(342,1),xn(9,1,4),bn(344,1),bn(346,1),bn(348,1),bn(350,1),bn(352,1),xn(2,8,4),xn(8,2,4),xn(1,8,4),xn(8,1,4),bn(354,1),bn(356,1),bn(358,1),bn(360,1),xn(2,7,4),xn(7,2,4),xn(6,4,4),xn(1,7,4),xn(5,5,4),xn(7,1,4),bn(362,1),xn(3,6,4),xn(6,3,4),xn(4,5,4),xn(5,4,4),xn(2,6,4),xn(6,2,4),xn(1,6,4),bn(364,1),xn(3,5,4),xn(6,1,3),xn(6,1,3),xn(5,3,4),xn(4,4,4),xn(2,5,3),xn(2,5,3),xn(5,2,3),xn(5,2,3),xn(1,5,3),xn(1,5,3),xn(5,1,3),xn(5,1,3),xn(0,5,4),xn(5,0,4),xn(3,4,3),xn(3,4,3),xn(4,3,3),xn(2,4,3),xn(4,2,3),xn(3,3,3),xn(4,1,2),xn(4,1,2),xn(1,4,3),xn(0,4,3),xn(2,3,2),xn(2,3,2),xn(3,2,2),xn(3,2,2),xn(4,0,3),xn(0,3,3),xn(1,3,2),xn(1,3,2),xn(3,1,2),xn(3,0,2),xn(2,2,1),xn(2,2,1),xn(1,2,1),xn(2,1,1),xn(0,2,1),xn(2,0,1),bn(366,1),bn(368,1),xn(14,14,4),bn(370,1),bn(372,1),bn(374,1),xn(15,11,4),bn(376,1),xn(13,13,4),xn(10,15,4),xn(15,10,4),xn(11,14,4),xn(14,11,4),xn(12,13,4),xn(13,12,4),xn(9,15,4),xn(15,9,4),xn(14,10,4),xn(11,13,4),xn(13,11,4),xn(8,15,4),xn(15,8,4),xn(12,12,4),xn(9,14,4),xn(14,9,4),xn(7,15,4),xn(15,7,4),xn(10,13,4),xn(13,10,4),xn(11,12,4),xn(6,15,4),bn(378,1),xn(12,11,3),xn(12,11,3),xn(15,6,3),xn(15,6,3),xn(8,14,4),xn(14,8,4),xn(5,15,4),xn(9,13,4),xn(15,5,3),xn(15,5,3),xn(7,14,3),xn(7,14,3),xn(14,7,3),xn(14,7,3),xn(10,12,3),xn(10,12,3),xn(12,10,3),xn(12,10,3),xn(11,11,3),xn(11,11,3),xn(13,9,4),xn(8,13,4),xn(4,15,3),xn(4,15,3),xn(15,4,3),xn(15,4,3),xn(3,15,3),xn(3,15,3),xn(15,3,3),xn(15,3,3),xn(13,8,3),xn(13,8,3),xn(14,6,3),xn(14,6,3),xn(2,15,3),xn(2,15,3),xn(15,2,3),xn(15,2,3),xn(6,14,4),xn(15,0,4),xn(1,15,3),xn(1,15,3),xn(15,1,3),xn(15,1,3),xn(9,12,3),xn(9,12,3),xn(12,9,3),xn(12,9,3),xn(5,14,3),xn(10,11,3),xn(11,10,3),xn(14,5,3),xn(7,13,3),xn(13,7,3),xn(4,14,3),xn(14,4,3),xn(8,12,3),xn(12,8,3),xn(3,14,3),xn(6,13,3),xn(13,6,3),xn(14,3,3),xn(9,11,3),xn(11,9,3),xn(2,14,3),xn(2,14,3),xn(10,10,3),xn(10,10,3),xn(14,2,3),xn(14,2,3),xn(1,14,3),xn(1,14,3),xn(14,1,3),xn(14,1,3),xn(0,14,4),xn(14,0,4),xn(5,13,3),xn(5,13,3),xn(13,5,3),xn(13,5,3),xn(7,12,3),xn(12,7,3),xn(4,13,3),xn(8,11,3),xn(13,4,2),xn(13,4,2),xn(11,8,3),xn(9,10,3),xn(10,9,3),xn(6,12,3),xn(12,6,3),xn(3,13,3),xn(13,3,2),xn(13,3,2),xn(13,2,2),xn(13,2,2),xn(2,13,3),xn(0,13,3),xn(1,13,2),xn(1,13,2),xn(7,11,2),xn(7,11,2),xn(11,7,2),xn(11,7,2),xn(13,1,2),xn(13,1,2),xn(5,12,3),xn(13,0,3),xn(12,5,2),xn(12,5,2),xn(8,10,2),xn(8,10,2),xn(10,8,2),xn(4,12,2),xn(12,4,2),xn(6,11,2),xn(11,6,2),xn(11,6,2),xn(9,9,3),xn(0,12,3),xn(3,12,2),xn(3,12,2),xn(12,3,2),xn(12,3,2),xn(7,10,2),xn(7,10,2),xn(10,7,2),xn(10,7,2),xn(10,6,2),xn(10,6,2),xn(12,0,3),xn(0,11,3),xn(12,2,1),xn(12,2,1),xn(2,12,2),xn(5,11,2),xn(11,5,2),xn(1,12,2),xn(8,9,2),xn(9,8,2),xn(12,1,2),xn(4,11,2),xn(11,4,2),xn(6,10,2),xn(3,11,2),xn(7,9,2),xn(11,3,1),xn(11,3,1),xn(9,7,2),xn(8,8,2),xn(2,11,2),xn(5,10,2),xn(11,2,1),xn(11,2,1),xn(10,5,2),xn(1,11,2),xn(11,1,1),xn(11,1,1),xn(11,0,2),xn(6,9,2),xn(9,6,2),xn(4,10,2),xn(10,4,2),xn(7,8,2),xn(8,7,2),xn(3,10,2),xn(10,3,1),xn(10,3,1),xn(5,9,1),xn(9,5,1),xn(2,10,1),xn(10,2,1),xn(1,10,1),xn(10,1,1),xn(0,10,2),xn(10,0,2),xn(6,8,1),xn(6,8,1),xn(8,6,1),xn(4,9,1),xn(9,4,1),xn(3,9,1),xn(9,3,1),xn(9,3,1),xn(7,7,2),xn(0,9,2),xn(5,8,1),xn(8,5,1),xn(2,9,1),xn(6,7,1),xn(7,6,1),xn(9,2,1),xn(1,9,1),xn(9,0,1),xn(4,8,1),xn(8,4,1),xn(5,7,1),xn(7,5,1),xn(3,8,1),xn(8,3,1),xn(6,6,1),xn(4,7,1),xn(7,4,1),xn(0,8,1),xn(8,0,1),xn(5,6,1),xn(6,5,1),xn(3,7,1),xn(7,3,1),xn(4,6,1),xn(0,7,1),xn(7,0,1),xn(0,6,1),xn(6,0,1),xn(15,15,1),xn(14,15,1),xn(15,14,1),xn(13,15,1),xn(15,13,1),xn(12,15,1),xn(15,12,1),xn(13,14,1),xn(14,13,1),xn(11,15,1),xn(12,14,1),xn(14,12,1),xn(10,14,1),xn(0,15,1)],Fn=[bn(16,4),bn(32,4),bn(48,4),bn(64,2),xn(1,1,4),xn(0,1,4),xn(1,0,3),xn(1,0,3),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),xn(0,0,1),bn(68,3),bn(76,3),bn(84,2),xn(15,15,4),bn(88,2),bn(92,1),bn(94,4),xn(15,2,4),bn(110,1),xn(1,15,4),xn(15,1,4),bn(112,4),bn(128,4),bn(144,4),bn(160,4),bn(176,4),bn(192,4),bn(208,3),bn(216,3),bn(224,3),bn(232,3),bn(240,3),bn(248,3),bn(256,3),bn(264,2),bn(268,2),bn(272,1),bn(274,2),bn(278,2),bn(282,1),xn(5,1,4),bn(284,1),bn(286,1),bn(288,1),bn(290,1),xn(1,4,4),xn(4,1,4),bn(292,1),xn(2,3,4),xn(3,2,4),xn(1,3,3),xn(1,3,3),xn(3,1,3),xn(3,1,3),xn(0,3,4),xn(3,0,4),xn(2,2,3),xn(2,2,3),xn(1,2,2),xn(2,1,2),xn(0,2,2),xn(2,0,2),xn(14,15,3),xn(15,14,3),xn(13,15,3),xn(15,13,3),xn(12,15,3),xn(15,12,3),xn(11,15,3),xn(15,11,3),xn(10,15,2),xn(10,15,2),xn(15,10,3),xn(9,15,3),xn(15,9,3),xn(15,8,3),xn(8,15,2),xn(8,15,2),xn(7,15,2),xn(15,7,2),xn(6,15,2),xn(15,6,2),xn(5,15,2),xn(15,5,2),xn(4,15,1),xn(4,15,1),xn(15,4,1),xn(15,3,1),xn(15,0,1),xn(15,0,1),xn(15,0,1),xn(15,0,1),xn(15,0,1),xn(15,0,1),xn(15,0,1),xn(15,0,1),xn(3,15,2),xn(3,15,2),xn(3,15,2),xn(3,15,2),bn(294,4),bn(310,3),bn(318,3),bn(326,3),xn(2,15,1),xn(0,15,1),bn(334,2),bn(338,2),bn(342,2),bn(346,1),bn(348,2),bn(352,2),bn(356,1),bn(358,2),bn(362,2),bn(366,2),bn(370,2),xn(14,3,4),bn(374,1),bn(376,1),bn(378,1),bn(380,1),bn(382,1),bn(384,1),bn(386,1),xn(0,13,4),bn(388,1),bn(390,1),bn(392,1),xn(3,12,4),bn(394,1),xn(1,12,4),xn(12,0,4),bn(396,1),xn(14,2,3),xn(14,2,3),xn(2,14,4),xn(1,14,4),xn(13,3,4),xn(2,13,4),xn(13,2,4),xn(13,1,4),xn(3,11,4),bn(398,1),xn(1,13,3),xn(1,13,3),xn(12,4,4),xn(6,11,4),xn(12,3,4),xn(10,7,4),xn(2,12,3),xn(2,12,3),xn(12,2,4),xn(11,5,4),xn(12,1,4),xn(0,12,4),xn(4,11,4),xn(11,4,4),xn(6,10,4),xn(10,6,4),xn(11,3,3),xn(11,3,3),xn(5,10,4),xn(10,5,4),xn(2,11,3),xn(2,11,3),xn(11,2,3),xn(11,2,3),xn(1,11,3),xn(1,11,3),xn(11,1,3),xn(11,1,3),xn(0,11,4),xn(11,0,4),xn(6,9,4),xn(9,6,4),xn(4,10,4),xn(10,4,4),xn(7,8,4),xn(8,7,4),xn(10,3,3),xn(10,3,3),xn(3,10,4),xn(5,9,4),xn(2,10,3),xn(2,10,3),xn(9,5,4),xn(6,8,4),xn(10,1,3),xn(10,1,3),xn(8,6,4),xn(7,7,4),xn(9,4,3),xn(9,4,3),xn(4,9,4),xn(5,7,4),xn(6,7,3),xn(6,7,3),xn(10,2,2),xn(10,2,2),xn(10,2,2),xn(10,2,2),xn(1,10,2),xn(1,10,2),xn(0,10,3),xn(10,0,3),xn(3,9,3),xn(9,3,3),xn(5,8,3),xn(8,5,3),xn(2,9,2),xn(2,9,2),xn(9,2,2),xn(9,2,2),xn(7,6,3),xn(0,9,3),xn(1,9,2),xn(1,9,2),xn(9,1,2),xn(9,1,2),xn(9,0,3),xn(4,8,3),xn(8,4,3),xn(7,5,3),xn(3,8,3),xn(8,3,3),xn(6,6,3),xn(2,8,3),xn(8,2,2),xn(8,2,2),xn(4,7,3),xn(7,4,3),xn(1,8,2),xn(1,8,2),xn(8,1,2),xn(8,1,2),xn(8,0,2),xn(8,0,2),xn(0,8,3),xn(5,6,3),xn(3,7,2),xn(3,7,2),xn(7,3,2),xn(7,3,2),xn(6,5,3),xn(4,6,3),xn(2,7,2),xn(2,7,2),xn(7,2,2),xn(7,2,2),xn(6,4,3),xn(5,5,3),xn(0,7,2),xn(0,7,2),xn(1,7,1),xn(1,7,1),xn(1,7,1),xn(1,7,1),xn(7,1,1),xn(7,1,1),xn(7,0,2),xn(3,6,2),xn(6,3,2),xn(4,5,2),xn(5,4,2),xn(2,6,2),xn(6,2,1),xn(1,6,1),xn(6,1,1),xn(6,1,1),xn(0,6,2),xn(6,0,2),xn(5,3,1),xn(5,3,1),xn(3,5,2),xn(4,4,2),xn(2,5,1),xn(5,2,1),xn(1,5,1),xn(0,5,1),xn(3,4,1),xn(4,3,1),xn(5,0,1),xn(2,4,1),xn(4,2,1),xn(3,3,1),xn(0,4,1),xn(4,0,1),xn(12,14,4),bn(400,1),xn(13,14,3),xn(13,14,3),xn(14,9,3),xn(14,9,3),xn(14,10,4),xn(13,9,4),xn(14,14,2),xn(14,14,2),xn(14,14,2),xn(14,14,2),xn(14,13,3),xn(14,13,3),xn(14,11,3),xn(14,11,3),xn(11,14,2),xn(11,14,2),xn(12,13,2),xn(12,13,2),xn(13,12,3),xn(13,11,3),xn(10,14,2),xn(10,14,2),xn(12,12,2),xn(12,12,2),xn(10,13,3),xn(13,10,3),xn(7,14,3),xn(10,12,3),xn(12,10,2),xn(12,10,2),xn(12,9,3),xn(7,13,3),xn(5,14,2),xn(5,14,2),xn(11,13,1),xn(11,13,1),xn(11,13,1),xn(11,13,1),xn(9,14,1),xn(9,14,1),xn(11,12,2),xn(12,11,2),xn(8,14,2),xn(14,8,2),xn(9,13,2),xn(14,7,2),xn(11,11,2),xn(8,13,2),xn(13,8,2),xn(6,14,2),xn(14,6,1),xn(9,12,1),xn(10,11,2),xn(11,10,2),xn(14,5,2),xn(13,7,2),xn(4,14,1),xn(4,14,1),xn(14,4,2),xn(8,12,2),xn(12,8,1),xn(3,14,1),xn(6,13,1),xn(6,13,1),xn(13,6,2),xn(9,11,2),xn(11,9,2),xn(10,10,2),xn(14,1,1),xn(14,1,1),xn(13,4,1),xn(13,4,1),xn(11,8,2),xn(10,9,2),xn(7,11,1),xn(7,11,1),xn(11,7,2),xn(13,0,2),xn(0,14,1),xn(14,0,1),xn(5,13,1),xn(13,5,1),xn(7,12,1),xn(12,7,1),xn(4,13,1),xn(8,11,1),xn(9,10,1),xn(6,12,1),xn(12,6,1),xn(3,13,1),xn(5,12,1),xn(12,5,1),xn(8,10,1),xn(10,8,1),xn(9,9,1),xn(4,12,1),xn(11,6,1),xn(7,10,1),xn(5,11,1),xn(8,9,1),xn(9,8,1),xn(7,9,1),xn(9,7,1),xn(8,8,1),xn(14,12,1),xn(13,13,1)],In=[bn(16,4),bn(32,4),bn(48,4),xn(15,15,4),bn(64,4),bn(80,4),bn(96,4),bn(112,4),bn(128,4),bn(144,4),bn(160,3),bn(168,2),xn(1,1,4),xn(0,1,4),xn(1,0,4),xn(0,0,4),xn(14,15,4),xn(15,14,4),xn(13,15,4),xn(15,13,4),xn(12,15,4),xn(15,12,4),xn(11,15,4),xn(15,11,4),xn(15,10,3),xn(15,10,3),xn(10,15,4),xn(9,15,4),xn(15,9,3),xn(15,9,3),xn(15,8,3),xn(15,8,3),xn(8,15,4),xn(7,15,4),xn(15,7,3),xn(15,7,3),xn(6,15,3),xn(6,15,3),xn(15,6,3),xn(15,6,3),xn(5,15,3),xn(5,15,3),xn(15,5,3),xn(15,5,3),xn(4,15,3),xn(4,15,3),xn(15,4,3),xn(15,4,3),xn(3,15,3),xn(3,15,3),xn(15,3,3),xn(15,3,3),xn(2,15,3),xn(2,15,3),xn(15,2,3),xn(15,2,3),xn(15,1,3),xn(15,1,3),xn(1,15,4),xn(15,0,4),bn(172,3),bn(180,3),bn(188,3),bn(196,3),bn(204,4),bn(220,3),bn(228,3),bn(236,3),bn(244,2),bn(248,2),bn(252,2),bn(256,2),bn(260,2),bn(264,2),bn(268,2),bn(272,2),bn(276,2),bn(280,3),bn(288,2),bn(292,2),bn(296,2),bn(300,3),bn(308,2),bn(312,3),bn(320,1),bn(322,2),bn(326,2),bn(330,1),bn(332,2),bn(336,1),bn(338,1),bn(340,1),bn(342,1),bn(344,1),bn(346,1),bn(348,1),bn(350,1),bn(352,1),bn(354,1),bn(356,1),bn(358,1),bn(360,1),bn(362,1),bn(364,1),bn(366,1),bn(368,1),bn(370,2),bn(374,1),bn(376,2),xn(7,3,4),bn(380,1),xn(7,2,4),xn(4,6,4),xn(6,4,4),xn(5,5,4),xn(7,1,4),xn(3,6,4),xn(6,3,4),xn(4,5,4),xn(5,4,4),xn(2,6,4),xn(6,2,4),xn(1,6,4),xn(6,1,4),bn(382,1),xn(3,5,4),xn(5,3,4),xn(4,4,4),xn(2,5,4),xn(5,2,4),xn(1,5,4),bn(384,1),xn(5,1,3),xn(5,1,3),xn(3,4,4),xn(4,3,4),xn(2,4,3),xn(2,4,3),xn(4,2,3),xn(4,2,3),xn(3,3,3),xn(3,3,3),xn(1,4,3),xn(1,4,3),xn(4,1,3),xn(4,1,3),xn(0,4,4),xn(4,0,4),xn(2,3,3),xn(2,3,3),xn(3,2,3),xn(3,2,3),xn(1,3,2),xn(1,3,2),xn(1,3,2),xn(1,3,2),xn(3,1,2),xn(3,1,2),xn(3,1,2),xn(3,1,2),xn(0,3,3),xn(3,0,3),xn(2,2,2),xn(2,2,2),xn(1,2,1),xn(1,2,1),xn(1,2,1),xn(1,2,1),xn(2,1,1),xn(2,1,1),xn(0,2,2),xn(2,0,2),xn(0,15,1),xn(0,15,1),xn(0,15,1),xn(0,15,1),xn(14,14,3),xn(13,14,3),xn(14,13,3),xn(12,14,3),xn(14,12,3),xn(13,13,3),xn(11,14,3),xn(14,11,3),xn(12,13,3),xn(13,12,3),xn(10,14,3),xn(14,10,3),xn(11,13,3),xn(13,11,3),xn(12,12,3),xn(9,14,3),xn(14,9,3),xn(10,13,3),xn(13,10,3),xn(11,12,3),xn(12,11,3),xn(8,14,3),xn(14,8,3),xn(9,13,3),xn(13,9,3),xn(7,14,3),xn(14,7,3),xn(10,12,3),xn(12,10,3),xn(12,10,3),xn(11,11,3),xn(11,11,3),xn(8,13,3),xn(8,13,3),xn(13,8,3),xn(13,8,3),xn(0,14,4),xn(14,0,4),xn(0,13,3),xn(0,13,3),xn(14,6,2),xn(14,6,2),xn(14,6,2),xn(14,6,2),xn(6,14,3),xn(9,12,3),xn(12,9,2),xn(12,9,2),xn(5,14,2),xn(5,14,2),xn(11,10,2),xn(11,10,2),xn(14,5,2),xn(14,5,2),xn(10,11,3),xn(7,13,3),xn(13,7,2),xn(13,7,2),xn(14,4,2),xn(14,4,2),xn(8,12,2),xn(8,12,2),xn(12,8,2),xn(12,8,2),xn(4,14,3),xn(2,14,3),xn(3,14,2),xn(3,14,2),xn(6,13,2),xn(13,6,2),xn(14,3,2),xn(9,11,2),xn(11,9,2),xn(10,10,2),xn(14,2,2),xn(1,14,2),xn(14,1,2),xn(5,13,2),xn(13,5,2),xn(7,12,2),xn(12,7,2),xn(4,13,2),xn(8,11,2),xn(11,8,2),xn(13,4,2),xn(9,10,2),xn(10,9,2),xn(6,12,2),xn(12,6,2),xn(3,13,2),xn(13,3,2),xn(2,13,2),xn(13,2,2),xn(1,13,2),xn(7,11,2),xn(11,7,2),xn(13,1,2),xn(5,12,2),xn(12,5,2),xn(8,10,2),xn(10,8,2),xn(9,9,2),xn(4,12,2),xn(12,4,2),xn(6,11,2),xn(6,11,2),xn(11,6,2),xn(11,6,2),xn(13,0,3),xn(0,12,3),xn(3,12,2),xn(3,12,2),xn(12,3,2),xn(7,10,2),xn(10,7,2),xn(2,12,2),xn(12,2,2),xn(5,11,2),xn(11,5,2),xn(1,12,2),xn(8,9,2),xn(9,8,2),xn(12,1,2),xn(4,11,2),xn(12,0,3),xn(0,11,3),xn(3,11,2),xn(3,11,2),xn(11,0,3),xn(0,10,3),xn(1,10,2),xn(1,10,2),xn(11,4,1),xn(11,4,1),xn(6,10,2),xn(10,6,2),xn(7,9,2),xn(7,9,2),xn(9,7,2),xn(9,7,2),xn(10,0,3),xn(0,9,3),xn(9,0,2),xn(9,0,2),xn(11,3,1),xn(8,8,1),xn(2,11,2),xn(5,10,2),xn(11,2,1),xn(11,2,1),xn(10,5,2),xn(1,11,2),xn(11,1,2),xn(6,9,2),xn(9,6,1),xn(10,4,1),xn(4,10,2),xn(7,8,2),xn(8,7,1),xn(8,7,1),xn(3,10,1),xn(10,3,1),xn(5,9,1),xn(9,5,1),xn(2,10,1),xn(10,2,1),xn(10,1,1),xn(6,8,1),xn(8,6,1),xn(7,7,1),xn(4,9,1),xn(9,4,1),xn(3,9,1),xn(9,3,1),xn(5,8,1),xn(8,5,1),xn(2,9,1),xn(6,7,1),xn(7,6,1),xn(9,2,1),xn(1,9,1),xn(9,1,1),xn(4,8,1),xn(8,4,1),xn(5,7,1),xn(7,5,1),xn(3,8,1),xn(8,3,1),xn(6,6,1),xn(2,8,1),xn(8,2,1),xn(1,8,1),xn(4,7,1),xn(7,4,1),xn(8,1,1),xn(8,1,1),xn(0,8,2),xn(8,0,2),xn(5,6,1),xn(6,5,1),xn(1,7,1),xn(1,7,1),xn(0,7,2),xn(7,0,2),xn(3,7,1),xn(2,7,1),xn(0,6,1),xn(6,0,1),xn(0,5,1),xn(5,0,1)],qn=[En,Sn],Rn=[new a(Tn,0,0),new a(Nn,0,3),new a(Cn,0,3),new a(kn,0,3),null,new a(Ln,0,3),new a(An,0,4),new a(On,0,4),new a(Mn,0,4),new a(_n,0,4),new a(Dn,0,4),new a(Pn,0,4),new a(Hn,0,4),new a(Bn,0,4),null,new a(jn,0,4),new a(Fn,1,4),new a(Fn,2,4),new a(Fn,3,4),new a(Fn,4,4),new a(Fn,6,4),new a(Fn,8,4),new a(Fn,10,4),new a(Fn,13,4),new a(In,4,4),new a(In,5,4),new a(In,6,4),new a(In,7,4),new a(In,8,4),new a(In,9,4),new a(In,11,4),new a(In,13,4)];var Un=function(){function e(){this.tmp_imdct36=new Float64Array(18),this.tmp_dctIV=new Float64Array(18),this.tmp_sdctII=new Float64Array(9)}function t(e,t,n){var r,i,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z;r=e[3]+e[5],i=e[3]-e[5],h=e[6]+e[2],p=e[6]-e[2],d=e[1]+e[7],v=e[1]-e[7],m=e[8]+e[0],g=e[8]-e[0],y=r+h,b=r-h,w=r-m,E=h-m,S=y+m,x=i-p,T=x+g,N=p+g,C=i-g,k=i+p,B=k*-a,j=C*-s,F=N*-f,I=T*-o,q=v*-o,R=E*-c,U=w*-l,z=b*-u,L=e[4]+d,A=2*e[4]-d,O=A+R,M=A-R,_=A+U,D=q+F,P=q-F,H=q+j,t[n+0]=L+S,t[n+2]=B-H,t[n+4]=z-O,t[n+6]=I,t[n+8]=M-U,t[n+10]=P-j,t[n+12]=S-2*L,t[n+14]=D+B,t[n+16]=_+z}e.prototype.imdct36=function(e,t){var n=this.tmp_imdct36;this.dctIV(e,n);for(var r=0;r<9;++r)t[r]=n[9+r];for(var r=9;r<27;++r)t[r]=-n[36-(9+r)-1];for(var r=27;r<36;++r)t[r]=-n[r-27]};var n=[];for(i=0;i<18;i++)n[i]=2*Math.cos(Math.PI*(2*i+1)/72);e.prototype.dctIV=function(e,t){var r=this.tmp_dctIV;for(var i=0;i<18;++i)r[i]=e[i]*n[i];this.sdctII(r,t),t[0]/=2;for(var i=1;i<18;++i)t[i]=t[i]/2-t[i-1]};var r=[];for(var i=0;i<9;++i)r[i]=2*Math.cos(Math.PI*(2*i+1)/36);e.prototype.sdctII=function(e,n){var i=this.tmp_sdctII;for(var s=0;s<9;++s)i[s]=e[s]+e[18-s-1];t(i,n,0);for(var s=0;s<9;++s)i[s]=(e[s]-e[18-s-1])*r[s];t(i,n,1);for(var s=3;s<18;s+=2)n[s]-=n[s-2]};var s=2*Math.cos(1*Math.PI/18),o=2*Math.cos(3*Math.PI/18),u=2*Math.cos(4*Math.PI/18),a=2*Math.cos(5*Math.PI/18),f=2*Math.cos(7*Math.PI/18),l=2*Math.cos(8*Math.PI/18),c=2*Math.cos(16*Math.PI/18);return e}();const zn=[[.608761429,-0.923879533,-0.130526192,.991444861,-0.382683432,-0.79335334],[-0.79335334,.382683432,.991444861,.130526192,-0.923879533,-0.608761429],[.382683432,-0.923879533,.923879533,-0.382683432,-0.382683432,.923879533],[-0.923879533,-0.382683432,.382683432,.923879533,.923879533,.382683432],[.130526192,-0.382683432,.608761429,-0.79335334,.923879533,-0.991444861],[-0.991444861,-0.923879533,-0.79335334,-0.608761429,-0.382683432,-0.130526192]];r.layers[3]=p,p.prototype.decode=function(e,t){var n=t.header,r=0,i=0,s=n.nchannels(),o=n.flags&F.LSF_EXT?s===1?9:17:s===1?17:32;if(e.next_frame-e.nextByte()<o)throw e.md_len=0,new Error("Bad frame length");n.flags&F.PROTECTION;var u=this.sideInfo(e,s,n.flags&F.LSF_EXT),a=u.si,f=u.data_bitlen,l=u.priv_bitlen;n.flags|=l,n.private_bits|=a.private_bits;var c=e.copy();c.seek(e.next_frame*8);var h=c.read(16);(h&65510)===65506&&((h&1)===0&&c.advance(16),c.advance(16),r=c.read(h&8?9:8));var p=e.next_frame-e.nextByte();r>a.main_data_begin+p&&(r=0);var i=a.main_data_begin+p-r,d=0,m;if(a.main_data_begin===0)m=e.stream,e.md_len=0,d=i;else{if(a.main_data_begin>e.md_len)throw new Error("bad main_data_begin pointer");var g=e.md_len;if(i>a.main_data_begin){if(e.md_len+i-a.main_data_begin>z)throw new Error("Assertion failed: (stream.md_len + md_len - si.main_data_begin <= MAD_BUFFER_MDLEN)");d=i-a.main_data_begin,this.memcpy(e.main_data,e.md_len,e.stream.stream,e.nextByte(),d),e.md_len+=d}m=new v.Bitstream(v.Stream.fromBuffer(new v.Buffer(e.main_data))),m.advance((g-a.main_data_begin)*8)}var y=p-d;this.decodeMainData(m,t,a,s);if(y>=r)this.memcpy(e.main_data,0,e.stream.stream,e.next_frame-r,r),e.md_len=r;else{if(i<a.main_data_begin){var b=a.main_data_begin-i;b+y>r&&(b=r-y),b<e.md_len&&(this.memcpy(e.main_data,0,e.main_data,e.md_len-b,b),e.md_len=b)}else e.md_len=0;this.memcpy(e.main_data,e.md_len,e.stream.stream,e.next_frame-y,y),e.md_len+=y}},p.prototype.memcpy=function(e,t,n,r,i){var s;return n.subarray?s=n.subarray(r,r+i):s=n.peekBuffer(r-n.offset,i).data,e.set(s,t),e},p.prototype.sideInfo=function(e,t,n){var r=this.si,i=0,s=n?t===1?1:2:t===1?5:3;r.main_data_begin=e.read(n?8:9),r.private_bits=e.read(s);var o=1;if(!n){o=2;for(var u=0;u<t;++u)r.scfsi[u]=e.read(4)}for(var a=0;a<o;a++){var f=r.gr[a];for(var u=0;u<t;u++){var l=f.ch[u];l.part2_3_length=e.read(12),l.big_values=e.read(9),l.global_gain=e.read(8),l.scalefac_compress=e.read(n?9:4),i+=l.part2_3_length;if(l.big_values>288)throw new Error("bad big_values count");l.flags=0;if(e.read(1)){l.block_type=e.read(2);if(l.block_type===0)throw new Error("reserved block_type");if(!n&&l.block_type===2&&r.scfsi[u])throw new Error("bad scalefactor selection info");l.region0_count=7,l.region1_count=36,e.read(1)?l.flags|=sn:l.block_type===2&&(l.region0_count=8);for(var c=0;c<2;c++)l.table_select[c]=e.read(5);for(var c=0;c<3;c++)l.subblock_gain[c]=e.read(3)}else{l.block_type=0;for(var c=0;c<3;c++)l.table_select[c]=e.read(5);l.region0_count=e.read(4),l.region1_count=e.read(3)}l.flags|=e.read(n?2:3)}}return{si:r,data_bitlen:i,priv_bitlen:s}},p.prototype.decodeMainData=function(e,t,n,r){var i=t.header,s=i.samplerate;i.flags&F.MPEG_2_5_EXT&&(s*=2);var o=(s>>7&15)+(s>>15&1)-8;i.flags&F.MPEG_2_5_EXT&&(o+=3);var u=i.flags&F.LSF_EXT?1:2,a=this.xr;for(var f=0;f<u;++f){var l=n.gr[f],c=[],h=0;for(var p=0;p<r;++p){var d=l.ch[p],v;c[p]=Qt[o].l,d.block_type===2&&(c[p]=d.flags&sn?Qt[o].m:Qt[o].s),i.flags&F.LSF_EXT?v=this.scalefactors_lsf(e,d,p===0?0:n.gr[1].ch[1],i.mode_extension):v=this.scalefactors(e,d,n.gr[0].ch[p],f===0?0:n.scfsi[p]),this.huffmanDecode(e,a[p],d,c[p],v)}i.mode===q.JOINT_STEREO&&i.mode_extension!==0&&this.stereo(a,n.gr,f,i,c[0]);for(var p=0;p<r;p++){var d=l.ch[p],m=t.sbsample[p].slice(18*f),g,h=0,y,b,w=this.output;d.block_type===2?(this.reorder(a[p],d,c[p]),d.flags&sn&&this.aliasreduce(a[p],36)):this.aliasreduce(a[p],576);if(d.block_type!==2||d.flags&sn){var E=d.block_type;d.flags&sn&&(E=0);for(var g=0;g<2;++g,h+=18)this.imdct_l(a[p].subarray(h,h+18),w,E),this.overlap(w,t.overlap[p][g],m,g)}else for(var g=0;g<2;++g,h+=18)this.imdct_s(a[p].subarray(h,h+18),w),this.overlap(w,t.overlap[p][g],m,g);this.freqinver(m,1);var y=576;while(y>36&&a[p][y-1]===0)--y;b=32-((576-y)/18<<0);if(d.block_type!==2)for(var g=2;g<b;++g,h+=18)this.imdct_l(a[p].subarray(h,h+18),w,d.block_type),this.overlap(w,t.overlap[p][g],m,g),g&1&&this.freqinver(m,g);else for(var g=2;g<b;++g,h+=18)this.imdct_s(a[p].subarray(h,h+18),w),this.overlap(w,t.overlap[p][g],m,g),g&1&&this.freqinver(m,g);for(var g=b;g<32;++g)this.overlap_z(t.overlap[p][g],m,g),g&1&&this.freqinver(m,g)}}},p.prototype.scalefactors=function(e,t,n,r){var i=e.offset(),s=hn[t.scalefac_compress].slen1,o=hn[t.scalefac_compress].slen2,u;if(t.block_type===2){u=0;var a=t.flags&sn?17:18;while(a--)t.scalefac[u++]=e.read(s);a=18;while(a--)t.scalefac[u++]=e.read(o);a=3;while(a--)t.scalefac[u++]=0}else{if(r&8)for(var u=0;u<6;++u)t.scalefac[u]=n.scalefac[u];else for(var u=0;u<6;++u)t.scalefac[u]=e.read(s);if(r&4)for(var u=6;u<11;++u)t.scalefac[u]=n.scalefac[u];else for(var u=6;u<11;++u)t.scalefac[u]=e.read(s);if(r&2)for(var u=11;u<16;++u)t.scalefac[u]=n.scalefac[u];else for(var u=11;u<16;++u)t.scalefac[u]=e.read(o);if(r&1)for(var u=16;u<21;++u)t.scalefac[u]=n.scalefac[u];else for(var u=16;u<21;++u)t.scalefac[u]=e.read(o);t.scalefac[21]=0}return e.offset()-i},p.prototype.scalefactors_lsf=function(e,t,n,r){var i=e.offset(),s=t.scalefac_compress,o=t.block_type===2?t.flags&sn?2:1:0,u=new Int32Array(4),a;if(!(r&on&&n)){s<400?(u[0]=(s>>>4)/5,u[1]=(s>>>4)%5,u[2]=s%16>>>2,u[3]=s%4,a=pn[0][o]):s<500?(s-=400,u[0]=(s>>>2)/5,u[1]=(s>>>2)%5,u[2]=s%4,u[3]=0,a=pn[1][o]):(s-=500,u[0]=s/3,u[1]=s%3,u[2]=0,u[3]=0,t.flags|=rn,a=pn[2][o]);var f=0;for(var l=0;l<4;l++)for(var c=0;c<a[l];c++)t.scalefac[f++]=e.read(u[l]);while(f<39)t.scalefac[f++]=0}else{s>>>=1,s<180?(u[0]=s/36,u[1]=s%36/6,u[2]=s%36%6,u[3]=0,a=pn[3][o]):s<244?(s-=180,u[0]=s%64>>>4,u[1]=s%16>>>2,u[2]=s%4,u[3]=0,a=pn[4][o]):(s-=244,u[0]=s/3,u[1]=s%3,u[2]=0,u[3]=0,a=pn[5][o]);var f=0;for(var l=0;l<4;++l){var h=(1<<u[l])-1;for(var c=0;c<a[l];++c){var p=e.read(u[l]);t.scalefac[f]=p,n.scalefac[f++]=p===h?1:0}}while(f<39)t.scalefac[f]=0,n.scalefac[f++]=0}return e.offset()-i},p.prototype.huffmanDecode=function(e,t,n,r,i){var s=this._exponents,o=0,u=n.part2_3_length-i;if(u<0)throw new Error("bad audio data length");this.exponents(n,r,s);var a=e.copy();e.advance(u);var f=8-a.bitPosition;f+=7+(24-f)&-8;var l=a.read(f);u-=f;var c=0,h=0,p=this.reqcache,d=c+r[o++],v=n.region0_count+1,m=Rn[n.table_select[h]],g=m.table,y=m.linbits,b=m.startbits;if(typeof g=="undefined")throw new Error("bad Huffman table select");var w=0,E=s[w++],S=0,x=n.big_values;while(x--&&f+u>0){if(c===d){d+=r[o++];if(--v===0){h===0?v=n.region1_count+1:v=0,m=Rn[n.table_select[++h]],g=m.table,y=m.linbits,b=m.startbits;if(typeof g=="undefined")throw new Error("bad Huffman table select")}E!==s[w]&&(E=s[w],S=0),++w}if(f<21){var T=10+(21-f)&-8;l=l<<T|a.read(T),f+=T,u-=T}var N=b,C=g[l>>f-N&(1<<N)-1];while(!C.final)f-=N,N=C.ptr.bits,C=g[C.ptr.offset+(l>>f-N&(1<<N)-1)];f-=C.value.hlen;if(y){var k=C.value.x,L=!1;switch(k){case 0:t[c]=0;break;case 15:f<y+2&&(l=l<<16|a.read(16),f+=16,u-=16),k+=l>>f-y&(1<<y)-1,f-=y,O=this.requantize(k,E),L=!0;break;default:S&1<<k?O=p[k]:(S|=1<<k,O=p[k]=this.requantize(k,E)),L=!0}L&&(t[c]=l&1<<f-- -1?-O:O),k=C.value.y;var A=!1;switch(k){case 0:t[c+1]=0;break;case 15:f<y+1&&(l=l<<16|a.read(16),f+=16,u-=16),k+=l>>f-y&(1<<y)-1,f-=y,O=this.requantize(k,E),A=!0;break;default:S&1<<k?O=p[k]:(S|=1<<k,p[k]=this.requantize(k,E),O=p[k]),A=!0}A&&(t[c+1]=l&1<<f-- -1?-O:O)}else{var k=C.value.x;k===0?t[c]=0:(S&1<<k?O=p[k]:(S|=1<<k,O=p[k]=this.requantize(k,E)),t[c]=l&1<<f-- -1?-O:O),k=C.value.y,k===0?t[c+1]=0:(S&1<<k?O=p[k]:(S|=1<<k,O=p[k]=this.requantize(k,E)),t[c+1]=l&1<<f-- -1?-O:O)}c+=2}if(f+u<0)throw new Error("Huffman data overrun");var g=qn[n.flags&tn],O=this.requantize(1,E);while(f+u>0&&c<=572){f<10&&(l=l<<16|a.read(16),f+=16,u-=16);var M=g[l>>f-4&15];M.final||(f-=4,M=g[M.ptr.offset+(l>>f-M.ptr.bits&(1<<M.ptr.bits)-1)]),f-=M.value.hlen,c===d&&(d+=r[o++],E!==s[w]&&(E=s[w],O=this.requantize(1,E)),++w),t[c]=M.value.v?l&1<<f-- -1?-O:O:0,t[c+1]=M.value.w?l&1<<f-- -1?-O:O:0,c+=2,c===d&&(d+=r[o++],E!==s[w]&&(E=s[w],O=this.requantize(1,E)),++w),t[c]=M.value.x?l&1<<f-- -1?-O:O:0,t[c+1]=M.value.y?l&1<<f-- -1?-O:O:0,c+=2,f+u<0&&(c-=4)}if(-u>U*8)throw new Error("assertion failed: (-bits_left <= BUFFER_GUARD * CHAR_BIT)");while(c<576)t[c]=0,t[c+1]=0,c+=2},p.prototype.requantize=function(e,t){var n=t%4>>0;t=t/4>>0;var r=Math.pow(e,4/3);return r*=Math.pow(2,t/4),n&&(r*=Math.pow(2,n/4)),t<0&&(r/=Math.pow(2,-t*.75)),r},p.prototype.exponents=function(e,t,n){var r=e.global_gain-210,i=e.flags&nn?2:1;if(e.block_type===2){var s=0,o=0;if(e.flags&sn){var u=e.flags&rn?-1:0;while(o<36)n[s]=r-(e.scalefac[s]+(Gt[s]&u)<<i),o+=t[s++]}var a=r-8*e.subblock_gain[0],f=r-8*e.subblock_gain[1],l=r-8*e.subblock_gain[2];while(o<576)n[s+0]=a-(e.scalefac[s+0]<<i),n[s+1]=f-(e.scalefac[s+1]<<i),n[s+2]=l-(e.scalefac[s+2]<<i),o+=3*t[s],s+=3}else if(e.flags&rn)for(var s=0;s<22;s++)n[s]=r-(e.scalefac[s]+Gt[s]<<i);else for(var s=0;s<22;s++)n[s]=r-(e.scalefac[s]<<i)},p.prototype.stereo=function(e,t,n,r,i){var s=t[n],o=this.modes,u,a,f,l;if(s.ch[0].block_type!==s.ch[1].block_type||(s.ch[0].flags&sn)!==(s.ch[1].flags&sn))throw new Error("incompatible stereo block_type");for(var l=0;l<39;l++)o[l]=r.mode_extension;if(r.mode_extension&on){var c=s.ch[1],h=e[1];r.flags|=F.I_STEREO;if(c.block_type===2){var p,d,v,m=new Uint32Array(3),g;p=d=v=m[0]=m[1]=m[2]=0,u=a=0;if(c.flags&sn){while(a<36){f=i[u++];for(var l=0;l<f;++l)if(h[l]){p=u;break}h+=f,a+=f}d=u}var g=0;while(a<576){f=i[u++];for(l=0;l<f;++l)if(h[l]){v=m[g]=u;break}h+=f,a+=f,g=(g+1)%3}v&&(p=d);for(l=0;l<p;++l)o[l]=r.mode_extension&~on;g=0;for(l=d;l<v;++l)l<m[g]&&(o[l]=r.mode_extension&~on),g=(g+1)%3}else{var m=0;for(u=a=0;a<576;a+=f){f=i[u++];for(l=0;l<f;++l)if(h[l]){m=u;break}h+=f}for(l=0;l<m;++l)o[l]=r.mode_extension&~on}if(r.flags&F.LSF_EXT){var y=t[n+1].ch[1].scalefac,b=cn[c.scalefac_compress&1];for(u=a=0;a<576;++u,a+=f){f=i[u];if(!(o[u]&on))continue;if(y[u]){o[u]&=~on;continue}is_pos=c.scalefac[u];for(l=0;l<f;++l){var w=e[0][a+l];if(is_pos===0)e[1][a+l]=w;else{var E=w*b[(is_pos-1)/2];is_pos&1?(e[0][a+l]=E,e[1][a+l]=w):e[1][a+l]=E}}}}else for(u=a=0;a<576;++u,a+=f){f=i[u];if(!(o[u]&on))continue;is_pos=c.scalefac[u];if(is_pos>=7){o[u]&=~on;continue}for(l=0;l<f;++l){var w=e[0][a+l];e[0][a+l]=w*ln[is_pos],e[1][a+l]=w*ln[6-is_pos]}}}if(r.mode_extension&un){r.flags|=F.MS_STEREO;var S=Yt[1];for(u=a=0;a<576;++u,a+=f){f=i[u];if(o[u]!==un)continue;for(l=0;l<f;++l){var x=e[0][a+l],T=e[1][a+l];e[0][a+l]=(x+T)*S,e[1][a+l]=(x-T)*S}}}},p.prototype.aliasreduce=function(e,t){for(var n=18;n<t;n+=18)for(var r=0;r<8;++r){var i=e[n-r-1],s=e[n+r];e[n-r-1]=i*Zt[r]-s*en[r],e[n+r]=s*Zt[r]+i*en[r]}},p.prototype.imdct_l=function(e,t,n){this.imdct.imdct36(e,t);switch(n){case 0:for(var r=0;r<36;++r)t[r]=t[r]*an[r];break;case 1:for(var r=0;r<18;++r)t[r]=t[r]*an[r];for(var r=24;r<30;++r)t[r]=t[r]*fn[r-18];for(var r=30;r<36;++r)t[r]=0;break;case 3:for(var r=0;r<6;++r)t[r]=0;for(var r=6;r<12;++r)t[r]=t[r]*fn[r-6];for(var r=18;r<36;++r)t[r]=t[r]*an[r]}},p.prototype.imdct_s=function(e,t){var n=0,r,i=0,s=new Float64Array(36),o,u;for(var a=0;a<3;++a){var f=0;for(var l=0;l<3;++l)u=e[i+0]*zn[f][0]+e[i+1]*zn[f][1]+e[i+2]*zn[f][2]+e[i+3]*zn[f][3]+e[i+4]*zn[f][4]+e[i+5]*zn[f][5],s[n+l+0]=u,s[n+5-l]=-s[n+l+0],++f,u=e[i+0]*zn[f][0]+e[i+1]*zn[f][1]+e[i+2]*zn[f][2]+e[i+3]*zn[f][3]+e[i+4]*zn[f][4]+e[i+5]*zn[f][5],s[n+l+6]=u,s[n+11-l]=s[n+l+6],++f;n+=12,i+=6}n=0;var r=0;for(var l=0;l<6;++l)t[l+0]=0,t[l+6]=s[n+0+0]*fn[r+0],u=s[n+0+6]*fn[r+6]+s[n+12+0]*fn[r+0],t[l+12]=u,u=s[n+12+6]*fn[r+6]+s[n+24+0]*fn[r+0],t[l+18]=u,t[l+24]=s[n+24+6]*fn[r+6],t[l+30]=0,++n,++r},p.prototype.overlap=function(e,t,n,r){for(var i=0;i<18;++i)n[i][r]=e[i]+t[i],t[i]=e[i+18]},p.prototype.freqinver=function(e,t){for(var n=1;n<18;n+=2)e[n][t]=-e[n][t]},p.prototype.overlap_z=function(e,t,n){for(var r=0;r<18;++r)t[r][n]=e[r],e[r]=0},p.prototype.reorder=function(e,t,n){var r=0,i=this.tmp,s=new Uint32Array(3),o=new Uint32Array(3),u=0;if(t.flags&sn){var u=2,a=0;while(a<36)a+=n[r++]}for(var l=0;l<3;++l)s[l]=u,o[l]=0;f=n[r++],l=0;for(var a=18*u;a<576;++a)f--===0&&(f=n[r++]-1,l=(l+1)%3),i[s[l]][l][o[l]++]=e[a],o[l]===6&&(o[l]=0,++s[l]);var c=this.tmp2,h=0;for(var p=0;p<32;p++)for(var d=0;d<3;d++)for(var v=0;v<6;v++)c[h++]=i[p][d][v];var m=576-18*u;for(var p=0;p<m;p++)e[18*u+p]=c[u+p]};var Wn=v.Decoder.extend(function(){v.Decoder.register("mp3",this),this.prototype.init=function(){this.mp3_stream=new t(this.bitstream),this.frame=new r,this.synth=new s,this.seeking=!1},this.prototype.readChunk=function(){var e=this.mp3_stream,t=this.frame,n=this.synth;if(this.seeking){for(;;)try{t.decode(e);break}catch(r){if(r instanceof v.UnderflowError)throw r}this.seeking=!1}else t.decode(e);n.frame(t);var i=n.pcm.samples,s=n.pcm.channels,o=n.pcm.length,u=new Float32Array(o*s),a=0;for(var f=0;f<o;f++)for(var l=0;l<s;l++)u[a++]=i[l][f];return u},this.prototype.seek=function(e){var t;this.demuxer.seekPoints.length>0?(e=this._super(e),t=this.stream.offset):t=e*this.format.bitrate/8/this.format.sampleRate,this.mp3_stream.reset(t);for(var r=0;r<4096;r++){var i=t+r;for(var s=0;s<3;s++){this.mp3_stream.reset(i);try{var o=n.decode(this.mp3_stream)}catch(u){break}var a=o.framesize();if(a==null)break;i+=a}if(s===3)break}return s!==3&&(r=0),this.mp3_stream.reset(t+r),this.demuxer.seekPoints.length===0&&(e=this.stream.offset/(this.format.bitrate/8)*this.format.sampleRate),this.seeking=!0,e}}),Xn=v.Demuxer.extend(function(){v.Demuxer.register(this),this.probe=function(e){return e.peekString(0,4)==="fLaC"};const e=0,t=1,n=2,r=3,i=4,s=5,o=6,u=127,a=34;this.prototype.readChunk=function(){var t=this.stream;if(!this.readHeader&&t.available(4)){if(t.readString(4)!=="fLaC")return this.emit("error","Invalid FLAC file.");this.readHeader=!0}while(t.available(1)&&!this.last){if(!this.readBlockHeaders){var n=t.readUInt8();this.last=(n&128)===128,this.type=n&127,this.size=t.readUInt24()}if(!this.foundStreamInfo&&this.type!==e)return this.emit("error","STREAMINFO must be the first block");if(!t.available(this.size))return;switch(this.type){case e:if(this.foundStreamInfo)return this.emit("error","STREAMINFO can only occur once.");if(this.size!==a)return this.emit("error","STREAMINFO size is wrong.");this.foundStreamInfo=!0;var s=new v.Bitstream(t),u={minBlockSize:s.read(16),maxBlockSize:s.read(16),minFrameSize:s.read(24),maxFrameSize:s.read(24)};this.format={formatID:"flac",sampleRate:s.read(20),channelsPerFrame:s.read(3)+1,bitsPerChannel:s.read(5)+1},this.emit("format",this.format),this.emit("cookie",u);var l=s.read(36);this.emit("duration",l/this.format.sampleRate*1e3|0),t.advance(16),this.readBlockHeaders=!1;break;case r:for(var c=0;c<this.size/18;c++)if(t.peekUInt32(0)==4294967295&&t.peekUInt32(1)==4294967295)t.advance(18);else{t.readUInt32()>0&&this.emit("error","Seek points with sample number >UInt32 not supported");var h=t.readUInt32();t.readUInt32()>0&&this.emit("error","Seek points with stream offset >UInt32 not supported");var p=t.readUInt32();t.advance(2),this.addSeekPoint(p,h)}break;case i:this.metadata||(this.metadata={});var d=t.readUInt32(!0);this.metadata.vendor=t.readString(d);var m=t.readUInt32(!0);for(var g=0;g<m;g++){d=t.readUInt32(!0);var y=t.readString(d,"utf8"),b=y.indexOf("=");this.metadata[y.slice(0,b).toLowerCase()]=y.slice(b+1)}break;case o:var w=t.readUInt32();if(w!==3)t.advance(this.size-4);else{var E=t.readUInt32(),S=t.readString(E),x=t.readUInt32(),T=t.readString(x),N=t.readUInt32(),C=t.readUInt32(),k=t.readUInt32(),L=t.readUInt32(),m=t.readUInt32(),A=t.readBuffer(m);this.metadata||(this.metadata={}),this.metadata.coverArt=A}break;default:t.advance(this.size),this.readBlockHeaders=!1}this.last&&this.metadata&&this.emit("metadata",this.metadata)}while(t.available(1)&&this.last){var O=t.readSingleBuffer(t.remainingBytes());this.emit("data",O)}}}),Vn=v.Decoder.extend(function(){function e(e){var t=0,n=0;for(;;){n=e>>>24;if(n)break;t+=8,n=e>>>16;if(n&255)break;t+=8,n=e>>>8;if(n&255)break;t+=8,n=e;if(n&255)break;return t+=8,t}return n&240?n>>>=4:t+=4,n&8?t:n&4?t+1:n&2?t+2:n&1?t+3:t+4}v.Decoder.register("flac",this),this.prototype.setCookie=function(e){this.cookie=e,this.decoded=[];for(var t=0;t<this.format.channelsPerFrame;t++)this.decoded[t]=new Int32Array(e.maxBlockSize)};const t=new Int16Array([0,192,576,1152,2304,4608,0,0,256,512,1024,2048,4096,8192,16384,32768]),n=new Int32Array([0,88200,176400,192e3,8e3,16e3,22050,24e3,32e3,44100,48e3,96e3,0,0,0,0]),r=new Int8Array([0,8,12,0,16,20,24,0]),i=8,s=0,o=8,u=9,a=10;this.prototype.readChunk=function(){var e=this.bitstream;if(!e.available(32))return;if((e.read(15)&32767)!==32764)throw new Error("Invalid sync code");var f=e.read(1),l=e.read(4),c=e.read(4),h=e.read(4),p=e.read(3);e.advance(1),this.chMode=h;var d;if(h<i)d=h+1,this.chMode=s;else{if(!(h<=a))throw new Error("Invalid channel mode");d=2}if(d!==this.format.channelsPerFrame)throw new Error("Switching channel layout mid-stream not supported.");if(p===3||p===7)throw new Error("Invalid sample size code");this.bps=r[p];if(this.bps!==this.format.bitsPerChannel)throw new Error("Switching bits per sample mid-stream not supported.");var v,m;this.bps>16?(v=32-this.bps,m=!0):(v=16-this.bps,m=!1);var g=0;while(e.read(1)===1)g++;var y=e.read(7-g);for(;g>1;g--)e.advance(2),y=y<<6|e.read(6);if(l===0)throw new Error("Reserved blocksize code");l===6?this.blockSize=e.read(8)+1:l===7?this.blockSize=e.read(16)+1:this.blockSize=t[l];var b;if(c<12)b=n[c];else if(c===12)b=e.read(8)*1e3;else if(c===13)b=e.read(16);else{if(c!==14)throw new Error("Invalid sample rate code");b=e.read(16)*10}e.advance(8);for(var w=0;w<d;w++)this.decodeSubframe(w);e.align(),e.advance(16);var E=new ArrayBuffer(this.blockSize*d*this.bps/8),S=m?new Int32Array(E):new Int16Array(E),x=this.blockSize,T=this.decoded,N=0;switch(this.chMode){case s:for(var C=0;C<x;C++)for(var w=0;w<d;w++)S[N++]=T[w][C]<<v;break;case o:for(var w=0;w<x;w++){var k=T[0][w],L=T[1][w];S[N++]=k<<v,S[N++]=k-L<<v}break;case u:for(var w=0;w<x;w++){var k=T[0][w],L=T[1][w];S[N++]=k+L<<v,S[N++]=L<<v}break;case a:for(var w=0;w<x;w++){var k=T[0][w],L=T[1][w];k-=L>>1,S[N++]=k+L<<v,S[N++]=k<<v}}return S},this.prototype.decodeSubframe=function(e){var t=0,n=this.bitstream,r=this.blockSize,i=this.decoded;this.curr_bps=this.bps,e===0?this.chMode===u&&this.curr_bps++:(this.chMode===o||this.chMode===a)&&this.curr_bps++;if(n.read(1))throw new Error("Invalid subframe padding");var s=n.read(6);if(n.read(1)){t=1;while(!n.read(1))t++;this.curr_bps-=t}if(this.curr_bps>32)throw new Error("decorrelated bit depth > 32 ("+this.curr_bps+")");if(s===0){var f=n.read(this.curr_bps,!0);for(var l=0;l<r;l++)i[e][l]=f}else if(s===1){var c=this.curr_bps;for(var l=0;l<r;l++)i[e][l]=n.read(c,!0)}else if(s>=8&&s<=12)this.decode_subframe_fixed(e,s&-9);else{if(!(s>=32))throw new Error("Invalid coding type");this.decode_subframe_lpc(e,(s&-33)+1)}if(t)for(var l=0;l<r;l++)i[e][l]<<=t},this.prototype.decode_subframe_fixed=function(e,t){var n=this.decoded[e],r=this.bitstream,i=this.curr_bps;for(var s=0;s<t;s++)n[s]=r.read(i,!0);this.decode_residuals(e,t);var o=0,u=0,a=0,f=0;t>0&&(o=n[t-1]),t>1&&(u=o-n[t-2]),t>2&&(a=u-n[t-2]+n[t-3]),t>3&&(f=a-n[t-2]+2*n[t-3]-n[t-4]);switch(t){case 0:break;case 1:case 2:case 3:case 4:var l=new Int32Array([o,u,a,f]),c=this.blockSize;for(var s=t;s<c;s++){l[t-1]+=n[s];for(var h=t-2;h>=0;h--)l[h]+=l[h+1];n[s]=l[0]}break;default:throw new Error("Invalid Predictor Order "+t)}},this.prototype.decode_subframe_lpc=function(e,t){var n=this.bitstream,r=this.decoded[e],i=this.curr_bps,s=this.blockSize;for(var o=0;o<t;o++)r[o]=n.read(i,!0);var u=n.read(4)+1;if(u===16)throw new Error("Invalid coefficient precision");var a=n.read(5,!0);if(a<0)throw new Error("Negative qlevel, maybe buggy stream");var f=new Int32Array(32);for(var o=0;o<t;o++)f[o]=n.read(u,!0);this.decode_residuals(e,t);if(this.bps>16)throw new Error("no 64-bit integers in JS, could probably use doubles though");for(var o=t;o<s-1;o+=2){var l=r[o-t],c=0,h=0,p;for(var d=t-1;d>0;d--)p=f[d],c+=p*l,l=r[o-d],h+=p*l;p=f[0],c+=p*l,l=r[o]+=c>>a,h+=p*l,r[o+1]+=h>>a}if(o<s){var v=0;for(var d=0;d<t;d++)v+=f[d]*r[o-d-1];r[o]+=v>>a}};const f=32767;this.prototype.decode_residuals=function(e,t){var n=this.bitstream,r=n.read(2);if(r>1)throw new Error("Illegal residual coding method "+r);var i=n.read(4),s=this.blockSize>>>i;if(t>s)throw new Error("Invalid predictor order "+t+" > "+s);var o=this.decoded[e],u=t,a=t;for(var l=0;l<1<<i;l++){var c=n.read(r===0?4:5);if(c===(r===0?15:31)){c=n.read(5);for(;a<s;a++)o[u++]=n.read(c,!0)}else for(;a<s;a++)o[u++]=this.golomb(c,f,0);a=0}};const l=25;this.prototype.golomb=function(t,n,r){var i=this.bitstream,s=i.bitPosition,o=i.peek(32-s)<<s,u=0,a=31-e(o|1);if(a-t>=32-l&&32-a<n)o>>>=a-t,o+=30-a<<t,i.advance(32+t-a),u=o;else{for(var f=0;i.read(1)===0;f++)o=i.peek(32-s)<<s;f<n-1?(t?o=i.read(t):o=0,u=o+(f<<t)):f===n-1?(o=i.read(r),u=o+1):u=-1}return u>>1^-(u&1)}});return d.AV=v}(),define("listen-aurora.min",function(){}),!("classList"in document.documentElement)&&Object.defineProperty&&typeof HTMLElement!="undefined"&&Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){function t(t){return function(n){var r=e.className.split(/\s+/),i=r.indexOf(n);t(r,i,n),e.className=r.join(" ")}}var e=this,n={add:t(function(e,t,n){~t||e.push(n)}),remove:t(function(e,t){~t&&e.splice(t,1)}),toggle:t(function(e,t,n){~t?e.splice(t,1):e.push(n)}),contains:function(t){return!!~e.className.split(/\s+/).indexOf(t)},item:function(t){return e.className.split(/\s+/)[t]||null}};return Object.defineProperty(n,"length",{get:function(){return e.className.split(/\s+/).length}}),n}}),define("listen-classlist",function(){}),UNKNOWN_ART="img/avatar.jpeg",define("listen-DGAuroraPlayer",function(){}),define("listen-player",function(){}),define("listen-listen",["jquery","desktop"],function(e,t){var n=function(){var e=window.AudioContext||window.webkitAudioContext;return e?(new e).sampleRate:44100}();e(window).load(function(){DGPlayer=DGPlayer(document.getElementById("dgplayer")),DGPlayer.album={},DGPlayer.volume=100;var n,r;DGPlayer.on("play",r=function(){n&&n.disconnect(),n=new DGAuroraPlayer(AV.Player.fromURL(DGPlayer.current.url),DGPlayer),DGPlayer.off("play",r)}),DGPlayer.on("playlist",onplaylist=function(){n&&(n.disconnect(),DGPlayer.state="paused"),n=new DGAuroraPlayer(AV.Player.fromURL(DGPlayer.current.url),DGPlayer)}),e(t.$container).on("click",".listen",function(n){n.preventDefault();var r=e(this).closest(t.itemSelector);e.get("/plugins/listen/"+r.attr("data-id"),function(t){DGPlayer.album=t.album,e("#dgplayer").is(":hidden")&&e("#dgplayer").fadeIn().find(".button").click()},"json")})})}),require.config({baseUrl:"/javascripts",paths:{async:"helpers/async",underscore:"helpers/underscore",notify:"modules/desktop-notify",cookie:"modules/jquery.cookie",quickfit:"modules/quickfit",collapse:"modules/jquery.collapse",collapse_storage:"modules/jquery.collapse_storage",customselect:"modules/customselect",text:"text",classie:"packery/classie",eventie:"packery/eventie","doc-ready":"packery/doc-ready",eventEmitter:"packery/eventEmitter","get-style-property":"packery/get-style-property","get-size":"packery/get-size","matches-selector":"packery/matches-selector",outlayer:"packery/outlayer",imagesloaded:"packery/imagesloaded/imagesloaded",packery:"packery/packery/js",desktop:"desktop",alertify:"alertify",theme:"../js/theme",admin:"../js/admin","chat-chat":"/Users/soyuka/Sites/ezseed2/app/plugins/chat/public/js/chat","checkforupdates-checkforupdates":"/Users/soyuka/Sites/ezseed2/app/plugins/checkforupdates/public/js/checkforupdates","listen-DGAuroraPlayer":"/Users/soyuka/Sites/ezseed2/app/plugins/listen/public/js/DGAuroraPlayer","listen-classlist":"/Users/soyuka/Sites/ezseed2/app/plugins/listen/public/js/classlist","listen-listen":"/Users/soyuka/Sites/ezseed2/app/plugins/listen/public/js/listen","listen-player":"/Users/soyuka/Sites/ezseed2/app/plugins/listen/public/js/player","listen-aurora.min":"/Users/soyuka/Sites/ezseed2/app/plugins/listen/public/audiocogs/aurora.min"},shim:{notify:["jquery"],cookie:["jquery"],quickfit:["jquery"],collapse:["jquery"],collapse_storage:["collapse","jquery"],customselect:["jquery"],theme:{deps:["desktop"]},admin:{deps:["collapse","collapse_storage","customselect"]}},waitSeconds:25}),require(["desktop","theme","admin","chat-chat","checkforupdates-checkforupdates","listen-aurora.min","listen-classlist","listen-DGAuroraPlayer","listen-player","listen-listen"],function(e){var t=e.socket;t.on("files",function(t){t=JSON.parse(t),config.location=="/"&&e.append(t.paths)}),t.on("remove",function(t){e.remove(t)})}),define("main.build",function(){});